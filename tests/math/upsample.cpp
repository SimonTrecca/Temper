/**
 * @file ut_upsample.cpp
 * @brief File generated by tests/math/upsample.py. 
 * Tests for math::upsample function with ZEROS and NEAREST modes.
 */

#include <gtest/gtest.h>
#include "temper/Math.hpp"
#include "temper/SYCLQueue.hpp"

using namespace temper;
using namespace temper::math;

template<typename T>
class TypedUpsample : public ::testing:: Test {};

using UpsampleTestTypes = ::testing::Types<float, uint64_t>;
TYPED_TEST_SUITE(TypedUpsample, UpsampleTestTypes);


/**
 * @test TypedUpsample.shape_check_zeros_stride2
 * @brief Check output shape for ZEROS mode
 */
TYPED_TEST(TypedUpsample, shape_check_zeros_stride2)
{
    using value_t = TypeParam;

    Tensor<value_t> input(
        {3, 4, 4},
        MemoryLocation::DEVICE
    );

    Tensor<value_t> result = math::upsample<value_t>(
        input, 2, UpsampleMode::ZEROS
    );

    const std::vector<uint64_t>& result_shape = result.get_dimensions();
    std::vector<uint64_t> expected_shape = {
        3, 7, 7
    };

    EXPECT_EQ(result_shape, expected_shape);
}

/**
 * @test TypedUpsample.shape_check_nearest_stride3
 * @brief Check output shape for NEAREST mode
 */
TYPED_TEST(TypedUpsample, shape_check_nearest_stride3)
{
    using value_t = TypeParam;

    Tensor<value_t> input(
        {2, 5, 5},
        MemoryLocation::DEVICE
    );

    Tensor<value_t> result = math::upsample<value_t>(
        input, 3, UpsampleMode::NEAREST
    );

    const std::vector<uint64_t>& result_shape = result.get_dimensions();
    std::vector<uint64_t> expected_shape = {
        2, 13, 13
    };

    EXPECT_EQ(result_shape, expected_shape);
}

/**
 * @test TypedUpsample.zeros_simple_2x2_stride2
 * @brief Upsample ZEROS mode test: 
 *   input shape: [1, 2, 2]
 *   stride: 2
 *   output shape: (1, 3, 3)
 */
TYPED_TEST(TypedUpsample, zeros_simple_2x2_stride2)
{
    using value_t = TypeParam;

    Tensor<value_t> input(
        {1, 2, 2},
        MemoryLocation:: DEVICE
    );

    std::vector<value_t> input_vals(4);
    input_vals[0] = static_cast<value_t>(-1.74976551532745361);
    input_vals[1] = static_cast<value_t>(0.34268039464950562);
    input_vals[2] = static_cast<value_t>(1.15303575992584229);
    input_vals[3] = static_cast<value_t>(-0.25243604183197021);
    input = input_vals;

    // Run upsample with ZEROS mode
    Tensor<value_t> result = math::upsample<value_t>(
        input, 2, UpsampleMode::ZEROS
    );

    std::vector<value_t> expected(9);
    expected[0] = static_cast<value_t>(-1.74976551532745361);
    expected[1] = static_cast<value_t>(0.00000000000000000);
    expected[2] = static_cast<value_t>(0.34268039464950562);
    expected[3] = static_cast<value_t>(0.00000000000000000);
    expected[4] = static_cast<value_t>(0.00000000000000000);
    expected[5] = static_cast<value_t>(0.00000000000000000);
    expected[6] = static_cast<value_t>(1.15303575992584229);
    expected[7] = static_cast<value_t>(0.00000000000000000);
    expected[8] = static_cast<value_t>(-0.25243604183197021);

    std::vector<value_t> host(expected.size());
    g_sycl_queue.memcpy(host.data(), result.m_p_data.get(),
                        host.size() * sizeof(value_t)).wait();

    // Compare results
    for (size_t i = 0; i < host.size(); ++i)
    {
        if constexpr (std::is_floating_point<value_t>::value)
        {
            EXPECT_NEAR(static_cast<double>(host[i]),
                        static_cast<double>(expected[i]), 0.0001);
        }
        else
        {
            EXPECT_EQ(host[i], expected[i]);
        }
    }
}

/**
 * @test TypedUpsample.zeros_3channels_3x3_stride2
 * @brief Upsample ZEROS mode test: 
 *   input shape: [3, 3, 3]
 *   stride: 2
 *   output shape: (3, 5, 5)
 */
TYPED_TEST(TypedUpsample, zeros_3channels_3x3_stride2)
{
    using value_t = TypeParam;

    Tensor<value_t> input(
        {3, 3, 3},
        MemoryLocation:: DEVICE
    );

    std::vector<value_t> input_vals(27);
    input_vals[0] = static_cast<value_t>(2.70684981346130371);
    input_vals[1] = static_cast<value_t>(0.62813270092010498);
    input_vals[2] = static_cast<value_t>(0.90796947479248047);
    input_vals[3] = static_cast<value_t>(0.50382572412490845);
    input_vals[4] = static_cast<value_t>(0.65111792087554932);
    input_vals[5] = static_cast<value_t>(-0.31931805610656738);
    input_vals[6] = static_cast<value_t>(-0.84807699918746948);
    input_vals[7] = static_cast<value_t>(0.60596537590026855);
    input_vals[8] = static_cast<value_t>(-2.01816821098327637);
    input_vals[9] = static_cast<value_t>(0.74012207984924316);
    input_vals[10] = static_cast<value_t>(0.52881348133087158);
    input_vals[11] = static_cast<value_t>(-0.58900052309036255);
    input_vals[12] = static_cast<value_t>(0.18869531154632568);
    input_vals[13] = static_cast<value_t>(-0.75887203216552734);
    input_vals[14] = static_cast<value_t>(-0.93323719501495361);
    input_vals[15] = static_cast<value_t>(0.95505648851394653);
    input_vals[16] = static_cast<value_t>(0.19079431891441345);
    input_vals[17] = static_cast<value_t>(1.97875738143920898);
    input_vals[18] = static_cast<value_t>(2.60596728324890137);
    input_vals[19] = static_cast<value_t>(0.68350887298583984);
    input_vals[20] = static_cast<value_t>(0.30266544222831726);
    input_vals[21] = static_cast<value_t>(1.69372296333312988);
    input_vals[22] = static_cast<value_t>(-1.70608592033386230);
    input_vals[23] = static_cast<value_t>(-1.15911936759948730);
    input_vals[24] = static_cast<value_t>(-0.13484072685241699);
    input_vals[25] = static_cast<value_t>(0.39052784442901611);
    input_vals[26] = static_cast<value_t>(0.16690464317798615);
    input = input_vals;

    // Run upsample with ZEROS mode
    Tensor<value_t> result = math::upsample<value_t>(
        input, 2, UpsampleMode::ZEROS
    );

    std::vector<value_t> expected(75);
    expected[0] = static_cast<value_t>(2.70684981346130371);
    expected[1] = static_cast<value_t>(0.00000000000000000);
    expected[2] = static_cast<value_t>(0.62813270092010498);
    expected[3] = static_cast<value_t>(0.00000000000000000);
    expected[4] = static_cast<value_t>(0.90796947479248047);
    expected[5] = static_cast<value_t>(0.00000000000000000);
    expected[6] = static_cast<value_t>(0.00000000000000000);
    expected[7] = static_cast<value_t>(0.00000000000000000);
    expected[8] = static_cast<value_t>(0.00000000000000000);
    expected[9] = static_cast<value_t>(0.00000000000000000);
    expected[10] = static_cast<value_t>(0.50382572412490845);
    expected[11] = static_cast<value_t>(0.00000000000000000);
    expected[12] = static_cast<value_t>(0.65111792087554932);
    expected[13] = static_cast<value_t>(0.00000000000000000);
    expected[14] = static_cast<value_t>(-0.31931805610656738);
    expected[15] = static_cast<value_t>(0.00000000000000000);
    expected[16] = static_cast<value_t>(0.00000000000000000);
    expected[17] = static_cast<value_t>(0.00000000000000000);
    expected[18] = static_cast<value_t>(0.00000000000000000);
    expected[19] = static_cast<value_t>(0.00000000000000000);
    expected[20] = static_cast<value_t>(-0.84807699918746948);
    expected[21] = static_cast<value_t>(0.00000000000000000);
    expected[22] = static_cast<value_t>(0.60596537590026855);
    expected[23] = static_cast<value_t>(0.00000000000000000);
    expected[24] = static_cast<value_t>(-2.01816821098327637);
    expected[25] = static_cast<value_t>(0.74012207984924316);
    expected[26] = static_cast<value_t>(0.00000000000000000);
    expected[27] = static_cast<value_t>(0.52881348133087158);
    expected[28] = static_cast<value_t>(0.00000000000000000);
    expected[29] = static_cast<value_t>(-0.58900052309036255);
    expected[30] = static_cast<value_t>(0.00000000000000000);
    expected[31] = static_cast<value_t>(0.00000000000000000);
    expected[32] = static_cast<value_t>(0.00000000000000000);
    expected[33] = static_cast<value_t>(0.00000000000000000);
    expected[34] = static_cast<value_t>(0.00000000000000000);
    expected[35] = static_cast<value_t>(0.18869531154632568);
    expected[36] = static_cast<value_t>(0.00000000000000000);
    expected[37] = static_cast<value_t>(-0.75887203216552734);
    expected[38] = static_cast<value_t>(0.00000000000000000);
    expected[39] = static_cast<value_t>(-0.93323719501495361);
    expected[40] = static_cast<value_t>(0.00000000000000000);
    expected[41] = static_cast<value_t>(0.00000000000000000);
    expected[42] = static_cast<value_t>(0.00000000000000000);
    expected[43] = static_cast<value_t>(0.00000000000000000);
    expected[44] = static_cast<value_t>(0.00000000000000000);
    expected[45] = static_cast<value_t>(0.95505648851394653);
    expected[46] = static_cast<value_t>(0.00000000000000000);
    expected[47] = static_cast<value_t>(0.19079431891441345);
    expected[48] = static_cast<value_t>(0.00000000000000000);
    expected[49] = static_cast<value_t>(1.97875738143920898);
    expected[50] = static_cast<value_t>(2.60596728324890137);
    expected[51] = static_cast<value_t>(0.00000000000000000);
    expected[52] = static_cast<value_t>(0.68350887298583984);
    expected[53] = static_cast<value_t>(0.00000000000000000);
    expected[54] = static_cast<value_t>(0.30266544222831726);
    expected[55] = static_cast<value_t>(0.00000000000000000);
    expected[56] = static_cast<value_t>(0.00000000000000000);
    expected[57] = static_cast<value_t>(0.00000000000000000);
    expected[58] = static_cast<value_t>(0.00000000000000000);
    expected[59] = static_cast<value_t>(0.00000000000000000);
    expected[60] = static_cast<value_t>(1.69372296333312988);
    expected[61] = static_cast<value_t>(0.00000000000000000);
    expected[62] = static_cast<value_t>(-1.70608592033386230);
    expected[63] = static_cast<value_t>(0.00000000000000000);
    expected[64] = static_cast<value_t>(-1.15911936759948730);
    expected[65] = static_cast<value_t>(0.00000000000000000);
    expected[66] = static_cast<value_t>(0.00000000000000000);
    expected[67] = static_cast<value_t>(0.00000000000000000);
    expected[68] = static_cast<value_t>(0.00000000000000000);
    expected[69] = static_cast<value_t>(0.00000000000000000);
    expected[70] = static_cast<value_t>(-0.13484072685241699);
    expected[71] = static_cast<value_t>(0.00000000000000000);
    expected[72] = static_cast<value_t>(0.39052784442901611);
    expected[73] = static_cast<value_t>(0.00000000000000000);
    expected[74] = static_cast<value_t>(0.16690464317798615);

    std::vector<value_t> host(expected.size());
    g_sycl_queue.memcpy(host.data(), result.m_p_data.get(),
                        host.size() * sizeof(value_t)).wait();

    // Compare results
    for (size_t i = 0; i < host.size(); ++i)
    {
        if constexpr (std::is_floating_point<value_t>::value)
        {
            EXPECT_NEAR(static_cast<double>(host[i]),
                        static_cast<double>(expected[i]), 0.0001);
        }
        else
        {
            EXPECT_EQ(host[i], expected[i]);
        }
    }
}

/**
 * @test TypedUpsample.zeros_multichannel_4x4_stride3
 * @brief Upsample ZEROS mode test: 
 *   input shape: [2, 4, 4]
 *   stride: 3
 *   output shape: (2, 10, 10)
 */
TYPED_TEST(TypedUpsample, zeros_multichannel_4x4_stride3)
{
    using value_t = TypeParam;

    Tensor<value_t> input(
        {2, 4, 4},
        MemoryLocation:: DEVICE
    );

    std::vector<value_t> input_vals(32);
    input_vals[0] = static_cast<value_t>(1.66806828975677490);
    input_vals[1] = static_cast<value_t>(0.92586183547973633);
    input_vals[2] = static_cast<value_t>(1.05799674987792969);
    input_vals[3] = static_cast<value_t>(-0.92033898830413818);
    input_vals[4] = static_cast<value_t>(1.29974842071533203);
    input_vals[5] = static_cast<value_t>(0.33118301630020142);
    input_vals[6] = static_cast<value_t>(-0.50984495878219604);
    input_vals[7] = static_cast<value_t>(-0.90309894084930420);
    input_vals[8] = static_cast<value_t>(-0.13001637160778046);
    input_vals[9] = static_cast<value_t>(-2.23820352554321289);
    input_vals[10] = static_cast<value_t>(0.97316485643386841);
    input_vals[11] = static_cast<value_t>(-0.02418481186032295);
    input_vals[12] = static_cast<value_t>(-0.48492774367332458);
    input_vals[13] = static_cast<value_t>(-1.10926437377929688);
    input_vals[14] = static_cast<value_t>(-0.55897474288940430);
    input_vals[15] = static_cast<value_t>(1.04238653182983398);
    input_vals[16] = static_cast<value_t>(-1.71226274967193604);
    input_vals[17] = static_cast<value_t>(0.13611988723278046);
    input_vals[18] = static_cast<value_t>(-0.46444398164749146);
    input_vals[19] = static_cast<value_t>(0.05097983777523041);
    input_vals[20] = static_cast<value_t>(1.44789874553680420);
    input_vals[21] = static_cast<value_t>(0.59313845634460449);
    input_vals[22] = static_cast<value_t>(-0.75561571121215820);
    input_vals[23] = static_cast<value_t>(-0.62716555595397949);
    input_vals[24] = static_cast<value_t>(0.88403487205505371);
    input_vals[25] = static_cast<value_t>(0.16271775960922241);
    input_vals[26] = static_cast<value_t>(-2.50281286239624023);
    input_vals[27] = static_cast<value_t>(0.41079097986221313);
    input_vals[28] = static_cast<value_t>(0.72875040769577026);
    input_vals[29] = static_cast<value_t>(0.02914019674062729);
    input_vals[30] = static_cast<value_t>(-0.29105246067047119);
    input_vals[31] = static_cast<value_t>(0.31429308652877808);
    input = input_vals;

    // Run upsample with ZEROS mode
    Tensor<value_t> result = math::upsample<value_t>(
        input, 3, UpsampleMode::ZEROS
    );

    std::vector<value_t> expected(200);
    expected[0] = static_cast<value_t>(1.66806828975677490);
    expected[1] = static_cast<value_t>(0.00000000000000000);
    expected[2] = static_cast<value_t>(0.00000000000000000);
    expected[3] = static_cast<value_t>(0.92586183547973633);
    expected[4] = static_cast<value_t>(0.00000000000000000);
    expected[5] = static_cast<value_t>(0.00000000000000000);
    expected[6] = static_cast<value_t>(1.05799674987792969);
    expected[7] = static_cast<value_t>(0.00000000000000000);
    expected[8] = static_cast<value_t>(0.00000000000000000);
    expected[9] = static_cast<value_t>(-0.92033898830413818);
    expected[10] = static_cast<value_t>(0.00000000000000000);
    expected[11] = static_cast<value_t>(0.00000000000000000);
    expected[12] = static_cast<value_t>(0.00000000000000000);
    expected[13] = static_cast<value_t>(0.00000000000000000);
    expected[14] = static_cast<value_t>(0.00000000000000000);
    expected[15] = static_cast<value_t>(0.00000000000000000);
    expected[16] = static_cast<value_t>(0.00000000000000000);
    expected[17] = static_cast<value_t>(0.00000000000000000);
    expected[18] = static_cast<value_t>(0.00000000000000000);
    expected[19] = static_cast<value_t>(0.00000000000000000);
    expected[20] = static_cast<value_t>(0.00000000000000000);
    expected[21] = static_cast<value_t>(0.00000000000000000);
    expected[22] = static_cast<value_t>(0.00000000000000000);
    expected[23] = static_cast<value_t>(0.00000000000000000);
    expected[24] = static_cast<value_t>(0.00000000000000000);
    expected[25] = static_cast<value_t>(0.00000000000000000);
    expected[26] = static_cast<value_t>(0.00000000000000000);
    expected[27] = static_cast<value_t>(0.00000000000000000);
    expected[28] = static_cast<value_t>(0.00000000000000000);
    expected[29] = static_cast<value_t>(0.00000000000000000);
    expected[30] = static_cast<value_t>(1.29974842071533203);
    expected[31] = static_cast<value_t>(0.00000000000000000);
    expected[32] = static_cast<value_t>(0.00000000000000000);
    expected[33] = static_cast<value_t>(0.33118301630020142);
    expected[34] = static_cast<value_t>(0.00000000000000000);
    expected[35] = static_cast<value_t>(0.00000000000000000);
    expected[36] = static_cast<value_t>(-0.50984495878219604);
    expected[37] = static_cast<value_t>(0.00000000000000000);
    expected[38] = static_cast<value_t>(0.00000000000000000);
    expected[39] = static_cast<value_t>(-0.90309894084930420);
    expected[40] = static_cast<value_t>(0.00000000000000000);
    expected[41] = static_cast<value_t>(0.00000000000000000);
    expected[42] = static_cast<value_t>(0.00000000000000000);
    expected[43] = static_cast<value_t>(0.00000000000000000);
    expected[44] = static_cast<value_t>(0.00000000000000000);
    expected[45] = static_cast<value_t>(0.00000000000000000);
    expected[46] = static_cast<value_t>(0.00000000000000000);
    expected[47] = static_cast<value_t>(0.00000000000000000);
    expected[48] = static_cast<value_t>(0.00000000000000000);
    expected[49] = static_cast<value_t>(0.00000000000000000);
    expected[50] = static_cast<value_t>(0.00000000000000000);
    expected[51] = static_cast<value_t>(0.00000000000000000);
    expected[52] = static_cast<value_t>(0.00000000000000000);
    expected[53] = static_cast<value_t>(0.00000000000000000);
    expected[54] = static_cast<value_t>(0.00000000000000000);
    expected[55] = static_cast<value_t>(0.00000000000000000);
    expected[56] = static_cast<value_t>(0.00000000000000000);
    expected[57] = static_cast<value_t>(0.00000000000000000);
    expected[58] = static_cast<value_t>(0.00000000000000000);
    expected[59] = static_cast<value_t>(0.00000000000000000);
    expected[60] = static_cast<value_t>(-0.13001637160778046);
    expected[61] = static_cast<value_t>(0.00000000000000000);
    expected[62] = static_cast<value_t>(0.00000000000000000);
    expected[63] = static_cast<value_t>(-2.23820352554321289);
    expected[64] = static_cast<value_t>(0.00000000000000000);
    expected[65] = static_cast<value_t>(0.00000000000000000);
    expected[66] = static_cast<value_t>(0.97316485643386841);
    expected[67] = static_cast<value_t>(0.00000000000000000);
    expected[68] = static_cast<value_t>(0.00000000000000000);
    expected[69] = static_cast<value_t>(-0.02418481186032295);
    expected[70] = static_cast<value_t>(0.00000000000000000);
    expected[71] = static_cast<value_t>(0.00000000000000000);
    expected[72] = static_cast<value_t>(0.00000000000000000);
    expected[73] = static_cast<value_t>(0.00000000000000000);
    expected[74] = static_cast<value_t>(0.00000000000000000);
    expected[75] = static_cast<value_t>(0.00000000000000000);
    expected[76] = static_cast<value_t>(0.00000000000000000);
    expected[77] = static_cast<value_t>(0.00000000000000000);
    expected[78] = static_cast<value_t>(0.00000000000000000);
    expected[79] = static_cast<value_t>(0.00000000000000000);
    expected[80] = static_cast<value_t>(0.00000000000000000);
    expected[81] = static_cast<value_t>(0.00000000000000000);
    expected[82] = static_cast<value_t>(0.00000000000000000);
    expected[83] = static_cast<value_t>(0.00000000000000000);
    expected[84] = static_cast<value_t>(0.00000000000000000);
    expected[85] = static_cast<value_t>(0.00000000000000000);
    expected[86] = static_cast<value_t>(0.00000000000000000);
    expected[87] = static_cast<value_t>(0.00000000000000000);
    expected[88] = static_cast<value_t>(0.00000000000000000);
    expected[89] = static_cast<value_t>(0.00000000000000000);
    expected[90] = static_cast<value_t>(-0.48492774367332458);
    expected[91] = static_cast<value_t>(0.00000000000000000);
    expected[92] = static_cast<value_t>(0.00000000000000000);
    expected[93] = static_cast<value_t>(-1.10926437377929688);
    expected[94] = static_cast<value_t>(0.00000000000000000);
    expected[95] = static_cast<value_t>(0.00000000000000000);
    expected[96] = static_cast<value_t>(-0.55897474288940430);
    expected[97] = static_cast<value_t>(0.00000000000000000);
    expected[98] = static_cast<value_t>(0.00000000000000000);
    expected[99] = static_cast<value_t>(1.04238653182983398);
    expected[100] = static_cast<value_t>(-1.71226274967193604);
    expected[101] = static_cast<value_t>(0.00000000000000000);
    expected[102] = static_cast<value_t>(0.00000000000000000);
    expected[103] = static_cast<value_t>(0.13611988723278046);
    expected[104] = static_cast<value_t>(0.00000000000000000);
    expected[105] = static_cast<value_t>(0.00000000000000000);
    expected[106] = static_cast<value_t>(-0.46444398164749146);
    expected[107] = static_cast<value_t>(0.00000000000000000);
    expected[108] = static_cast<value_t>(0.00000000000000000);
    expected[109] = static_cast<value_t>(0.05097983777523041);
    expected[110] = static_cast<value_t>(0.00000000000000000);
    expected[111] = static_cast<value_t>(0.00000000000000000);
    expected[112] = static_cast<value_t>(0.00000000000000000);
    expected[113] = static_cast<value_t>(0.00000000000000000);
    expected[114] = static_cast<value_t>(0.00000000000000000);
    expected[115] = static_cast<value_t>(0.00000000000000000);
    expected[116] = static_cast<value_t>(0.00000000000000000);
    expected[117] = static_cast<value_t>(0.00000000000000000);
    expected[118] = static_cast<value_t>(0.00000000000000000);
    expected[119] = static_cast<value_t>(0.00000000000000000);
    expected[120] = static_cast<value_t>(0.00000000000000000);
    expected[121] = static_cast<value_t>(0.00000000000000000);
    expected[122] = static_cast<value_t>(0.00000000000000000);
    expected[123] = static_cast<value_t>(0.00000000000000000);
    expected[124] = static_cast<value_t>(0.00000000000000000);
    expected[125] = static_cast<value_t>(0.00000000000000000);
    expected[126] = static_cast<value_t>(0.00000000000000000);
    expected[127] = static_cast<value_t>(0.00000000000000000);
    expected[128] = static_cast<value_t>(0.00000000000000000);
    expected[129] = static_cast<value_t>(0.00000000000000000);
    expected[130] = static_cast<value_t>(1.44789874553680420);
    expected[131] = static_cast<value_t>(0.00000000000000000);
    expected[132] = static_cast<value_t>(0.00000000000000000);
    expected[133] = static_cast<value_t>(0.59313845634460449);
    expected[134] = static_cast<value_t>(0.00000000000000000);
    expected[135] = static_cast<value_t>(0.00000000000000000);
    expected[136] = static_cast<value_t>(-0.75561571121215820);
    expected[137] = static_cast<value_t>(0.00000000000000000);
    expected[138] = static_cast<value_t>(0.00000000000000000);
    expected[139] = static_cast<value_t>(-0.62716555595397949);
    expected[140] = static_cast<value_t>(0.00000000000000000);
    expected[141] = static_cast<value_t>(0.00000000000000000);
    expected[142] = static_cast<value_t>(0.00000000000000000);
    expected[143] = static_cast<value_t>(0.00000000000000000);
    expected[144] = static_cast<value_t>(0.00000000000000000);
    expected[145] = static_cast<value_t>(0.00000000000000000);
    expected[146] = static_cast<value_t>(0.00000000000000000);
    expected[147] = static_cast<value_t>(0.00000000000000000);
    expected[148] = static_cast<value_t>(0.00000000000000000);
    expected[149] = static_cast<value_t>(0.00000000000000000);
    expected[150] = static_cast<value_t>(0.00000000000000000);
    expected[151] = static_cast<value_t>(0.00000000000000000);
    expected[152] = static_cast<value_t>(0.00000000000000000);
    expected[153] = static_cast<value_t>(0.00000000000000000);
    expected[154] = static_cast<value_t>(0.00000000000000000);
    expected[155] = static_cast<value_t>(0.00000000000000000);
    expected[156] = static_cast<value_t>(0.00000000000000000);
    expected[157] = static_cast<value_t>(0.00000000000000000);
    expected[158] = static_cast<value_t>(0.00000000000000000);
    expected[159] = static_cast<value_t>(0.00000000000000000);
    expected[160] = static_cast<value_t>(0.88403487205505371);
    expected[161] = static_cast<value_t>(0.00000000000000000);
    expected[162] = static_cast<value_t>(0.00000000000000000);
    expected[163] = static_cast<value_t>(0.16271775960922241);
    expected[164] = static_cast<value_t>(0.00000000000000000);
    expected[165] = static_cast<value_t>(0.00000000000000000);
    expected[166] = static_cast<value_t>(-2.50281286239624023);
    expected[167] = static_cast<value_t>(0.00000000000000000);
    expected[168] = static_cast<value_t>(0.00000000000000000);
    expected[169] = static_cast<value_t>(0.41079097986221313);
    expected[170] = static_cast<value_t>(0.00000000000000000);
    expected[171] = static_cast<value_t>(0.00000000000000000);
    expected[172] = static_cast<value_t>(0.00000000000000000);
    expected[173] = static_cast<value_t>(0.00000000000000000);
    expected[174] = static_cast<value_t>(0.00000000000000000);
    expected[175] = static_cast<value_t>(0.00000000000000000);
    expected[176] = static_cast<value_t>(0.00000000000000000);
    expected[177] = static_cast<value_t>(0.00000000000000000);
    expected[178] = static_cast<value_t>(0.00000000000000000);
    expected[179] = static_cast<value_t>(0.00000000000000000);
    expected[180] = static_cast<value_t>(0.00000000000000000);
    expected[181] = static_cast<value_t>(0.00000000000000000);
    expected[182] = static_cast<value_t>(0.00000000000000000);
    expected[183] = static_cast<value_t>(0.00000000000000000);
    expected[184] = static_cast<value_t>(0.00000000000000000);
    expected[185] = static_cast<value_t>(0.00000000000000000);
    expected[186] = static_cast<value_t>(0.00000000000000000);
    expected[187] = static_cast<value_t>(0.00000000000000000);
    expected[188] = static_cast<value_t>(0.00000000000000000);
    expected[189] = static_cast<value_t>(0.00000000000000000);
    expected[190] = static_cast<value_t>(0.72875040769577026);
    expected[191] = static_cast<value_t>(0.00000000000000000);
    expected[192] = static_cast<value_t>(0.00000000000000000);
    expected[193] = static_cast<value_t>(0.02914019674062729);
    expected[194] = static_cast<value_t>(0.00000000000000000);
    expected[195] = static_cast<value_t>(0.00000000000000000);
    expected[196] = static_cast<value_t>(-0.29105246067047119);
    expected[197] = static_cast<value_t>(0.00000000000000000);
    expected[198] = static_cast<value_t>(0.00000000000000000);
    expected[199] = static_cast<value_t>(0.31429308652877808);

    std::vector<value_t> host(expected.size());
    g_sycl_queue.memcpy(host.data(), result.m_p_data.get(),
                        host.size() * sizeof(value_t)).wait();

    // Compare results
    for (size_t i = 0; i < host.size(); ++i)
    {
        if constexpr (std::is_floating_point<value_t>::value)
        {
            EXPECT_NEAR(static_cast<double>(host[i]),
                        static_cast<double>(expected[i]), 0.0001);
        }
        else
        {
            EXPECT_EQ(host[i], expected[i]);
        }
    }
}

/**
 * @test TypedUpsample.zeros_nonsquare_3x5_stride2
 * @brief Upsample ZEROS mode test: 
 *   input shape: [1, 3, 5]
 *   stride: 2
 *   output shape: (1, 5, 9)
 */
TYPED_TEST(TypedUpsample, zeros_nonsquare_3x5_stride2)
{
    using value_t = TypeParam;

    Tensor<value_t> input(
        {1, 3, 5},
        MemoryLocation:: DEVICE
    );

    std::vector<value_t> input_vals(15);
    input_vals[0] = static_cast<value_t>(-1.24927830696105957);
    input_vals[1] = static_cast<value_t>(-0.26033142209053040);
    input_vals[2] = static_cast<value_t>(0.38379329442977905);
    input_vals[3] = static_cast<value_t>(-0.38546147942543030);
    input_vals[4] = static_cast<value_t>(-1.08513677120208740);
    input_vals[5] = static_cast<value_t>(2.32721900939941406);
    input_vals[6] = static_cast<value_t>(0.43079295754432678);
    input_vals[7] = static_cast<value_t>(0.43231576681137085);
    input_vals[8] = static_cast<value_t>(-0.98001134395599365);
    input_vals[9] = static_cast<value_t>(-0.63196516036987305);
    input_vals[10] = static_cast<value_t>(0.57744204998016357);
    input_vals[11] = static_cast<value_t>(-0.12475771456956863);
    input_vals[12] = static_cast<value_t>(0.97894787788391113);
    input_vals[13] = static_cast<value_t>(1.59492158889770508);
    input_vals[14] = static_cast<value_t>(-1.20194447040557861);
    input = input_vals;

    // Run upsample with ZEROS mode
    Tensor<value_t> result = math::upsample<value_t>(
        input, 2, UpsampleMode::ZEROS
    );

    std::vector<value_t> expected(45);
    expected[0] = static_cast<value_t>(-1.24927830696105957);
    expected[1] = static_cast<value_t>(0.00000000000000000);
    expected[2] = static_cast<value_t>(-0.26033142209053040);
    expected[3] = static_cast<value_t>(0.00000000000000000);
    expected[4] = static_cast<value_t>(0.38379329442977905);
    expected[5] = static_cast<value_t>(0.00000000000000000);
    expected[6] = static_cast<value_t>(-0.38546147942543030);
    expected[7] = static_cast<value_t>(0.00000000000000000);
    expected[8] = static_cast<value_t>(-1.08513677120208740);
    expected[9] = static_cast<value_t>(0.00000000000000000);
    expected[10] = static_cast<value_t>(0.00000000000000000);
    expected[11] = static_cast<value_t>(0.00000000000000000);
    expected[12] = static_cast<value_t>(0.00000000000000000);
    expected[13] = static_cast<value_t>(0.00000000000000000);
    expected[14] = static_cast<value_t>(0.00000000000000000);
    expected[15] = static_cast<value_t>(0.00000000000000000);
    expected[16] = static_cast<value_t>(0.00000000000000000);
    expected[17] = static_cast<value_t>(0.00000000000000000);
    expected[18] = static_cast<value_t>(2.32721900939941406);
    expected[19] = static_cast<value_t>(0.00000000000000000);
    expected[20] = static_cast<value_t>(0.43079295754432678);
    expected[21] = static_cast<value_t>(0.00000000000000000);
    expected[22] = static_cast<value_t>(0.43231576681137085);
    expected[23] = static_cast<value_t>(0.00000000000000000);
    expected[24] = static_cast<value_t>(-0.98001134395599365);
    expected[25] = static_cast<value_t>(0.00000000000000000);
    expected[26] = static_cast<value_t>(-0.63196516036987305);
    expected[27] = static_cast<value_t>(0.00000000000000000);
    expected[28] = static_cast<value_t>(0.00000000000000000);
    expected[29] = static_cast<value_t>(0.00000000000000000);
    expected[30] = static_cast<value_t>(0.00000000000000000);
    expected[31] = static_cast<value_t>(0.00000000000000000);
    expected[32] = static_cast<value_t>(0.00000000000000000);
    expected[33] = static_cast<value_t>(0.00000000000000000);
    expected[34] = static_cast<value_t>(0.00000000000000000);
    expected[35] = static_cast<value_t>(0.00000000000000000);
    expected[36] = static_cast<value_t>(0.57744204998016357);
    expected[37] = static_cast<value_t>(0.00000000000000000);
    expected[38] = static_cast<value_t>(-0.12475771456956863);
    expected[39] = static_cast<value_t>(0.00000000000000000);
    expected[40] = static_cast<value_t>(0.97894787788391113);
    expected[41] = static_cast<value_t>(0.00000000000000000);
    expected[42] = static_cast<value_t>(1.59492158889770508);
    expected[43] = static_cast<value_t>(0.00000000000000000);
    expected[44] = static_cast<value_t>(-1.20194447040557861);

    std::vector<value_t> host(expected.size());
    g_sycl_queue.memcpy(host.data(), result.m_p_data.get(),
                        host.size() * sizeof(value_t)).wait();

    // Compare results
    for (size_t i = 0; i < host.size(); ++i)
    {
        if constexpr (std::is_floating_point<value_t>::value)
        {
            EXPECT_NEAR(static_cast<double>(host[i]),
                        static_cast<double>(expected[i]), 0.0001);
        }
        else
        {
            EXPECT_EQ(host[i], expected[i]);
        }
    }
}

/**
 * @test TypedUpsample.zeros_batch_2x3x4x4_stride2
 * @brief Upsample ZEROS mode test: 
 *   input shape: [2, 3, 4, 4]
 *   stride: 2
 *   output shape: (2, 3, 7, 7)
 */
TYPED_TEST(TypedUpsample, zeros_batch_2x3x4x4_stride2)
{
    using value_t = TypeParam;

    Tensor<value_t> input(
        {2, 3, 4, 4},
        MemoryLocation:: DEVICE
    );

    std::vector<value_t> input_vals(96);
    input_vals[0] = static_cast<value_t>(-0.41821321845054626);
    input_vals[1] = static_cast<value_t>(-0.54193359613418579);
    input_vals[2] = static_cast<value_t>(-0.60790991783142090);
    input_vals[3] = static_cast<value_t>(0.92756664752960205);
    input_vals[4] = static_cast<value_t>(0.56241208314895630);
    input_vals[5] = static_cast<value_t>(-0.64953356981277466);
    input_vals[6] = static_cast<value_t>(2.17241668701171875);
    input_vals[7] = static_cast<value_t>(-0.20336103439331055);
    input_vals[8] = static_cast<value_t>(-0.31678462028503418);
    input_vals[9] = static_cast<value_t>(0.06683360785245895);
    input_vals[10] = static_cast<value_t>(0.99628394842147827);
    input_vals[11] = static_cast<value_t>(-0.53362756967544556);
    input_vals[12] = static_cast<value_t>(-1.53336000442504883);
    input_vals[13] = static_cast<value_t>(-0.34180060029029846);
    input_vals[14] = static_cast<value_t>(0.71207737922668457);
    input_vals[15] = static_cast<value_t>(-0.13547202944755554);
    input_vals[16] = static_cast<value_t>(0.50596767663955688);
    input_vals[17] = static_cast<value_t>(-0.64883840084075928);
    input_vals[18] = static_cast<value_t>(0.35781762003898621);
    input_vals[19] = static_cast<value_t>(-0.79847091436386108);
    input_vals[20] = static_cast<value_t>(1.00992500782012939);
    input_vals[21] = static_cast<value_t>(1.28805148601531982);
    input_vals[22] = static_cast<value_t>(-1.61640858650207520);
    input_vals[23] = static_cast<value_t>(-0.48616996407508850);
    input_vals[24] = static_cast<value_t>(-0.64680159091949463);
    input_vals[25] = static_cast<value_t>(-0.64978849887847900);
    input_vals[26] = static_cast<value_t>(-0.96577489376068115);
    input_vals[27] = static_cast<value_t>(0.05628735199570656);
    input_vals[28] = static_cast<value_t>(1.23208546638488770);
    input_vals[29] = static_cast<value_t>(1.62145292758941650);
    input_vals[30] = static_cast<value_t>(-0.15720753371715546);
    input_vals[31] = static_cast<value_t>(0.30400943756103516);
    input_vals[32] = static_cast<value_t>(1.56620848178863525);
    input_vals[33] = static_cast<value_t>(1.16694223880767822);
    input_vals[34] = static_cast<value_t>(-0.51487374305725098);
    input_vals[35] = static_cast<value_t>(-0.21902374923229218);
    input_vals[36] = static_cast<value_t>(0.77090531587600708);
    input_vals[37] = static_cast<value_t>(0.44450598955154419);
    input_vals[38] = static_cast<value_t>(-1.02915620803833008);
    input_vals[39] = static_cast<value_t>(-0.74194103479385376);
    input_vals[40] = static_cast<value_t>(0.96381664276123047);
    input_vals[41] = static_cast<value_t>(-0.71821582317352295);
    input_vals[42] = static_cast<value_t>(-0.71397012472152710);
    input_vals[43] = static_cast<value_t>(-0.12390217185020447);
    input_vals[44] = static_cast<value_t>(-0.30710524320602417);
    input_vals[45] = static_cast<value_t>(-0.87936723232269287);
    input_vals[46] = static_cast<value_t>(-0.57712143659591675);
    input_vals[47] = static_cast<value_t>(-0.22630953788757324);
    input_vals[48] = static_cast<value_t>(-0.70363897085189819);
    input_vals[49] = static_cast<value_t>(0.41058504581451416);
    input_vals[50] = static_cast<value_t>(-2.24382781982421875);
    input_vals[51] = static_cast<value_t>(0.55190533399581909);
    input_vals[52] = static_cast<value_t>(0.90725111961364746);
    input_vals[53] = static_cast<value_t>(0.56253910064697266);
    input_vals[54] = static_cast<value_t>(-2.20187425613403320);
    input_vals[55] = static_cast<value_t>(-0.68039232492446899);
    input_vals[56] = static_cast<value_t>(0.05351464077830315);
    input_vals[57] = static_cast<value_t>(0.96100926399230957);
    input_vals[58] = static_cast<value_t>(0.18499962985515594);
    input_vals[59] = static_cast<value_t>(-0.07086566835641861);
    input_vals[60] = static_cast<value_t>(-0.53744995594024658);
    input_vals[61] = static_cast<value_t>(0.18833741545677185);
    input_vals[62] = static_cast<value_t>(0.30202323198318481);
    input_vals[63] = static_cast<value_t>(-1.33185422420501709);
    input_vals[64] = static_cast<value_t>(-0.47411113977432251);
    input_vals[65] = static_cast<value_t>(1.46448397636413574);
    input_vals[66] = static_cast<value_t>(-0.83210825920104980);
    input_vals[67] = static_cast<value_t>(0.92505794763565063);
    input_vals[68] = static_cast<value_t>(1.40102899074554443);
    input_vals[69] = static_cast<value_t>(0.71686124801635742);
    input_vals[70] = static_cast<value_t>(-0.54903650283813477);
    input_vals[71] = static_cast<value_t>(0.79875069856643677);
    input_vals[72] = static_cast<value_t>(-0.24716407060623169);
    input_vals[73] = static_cast<value_t>(-0.36205753684043884);
    input_vals[74] = static_cast<value_t>(-0.67401987314224243);
    input_vals[75] = static_cast<value_t>(-0.97569459676742554);
    input_vals[76] = static_cast<value_t>(0.29289868474006653);
    input_vals[77] = static_cast<value_t>(-0.21490204334259033);
    input_vals[78] = static_cast<value_t>(0.19958595931529999);
    input_vals[79] = static_cast<value_t>(-0.08458172529935837);
    input_vals[80] = static_cast<value_t>(0.45410531759262085);
    input_vals[81] = static_cast<value_t>(-0.86453998088836670);
    input_vals[82] = static_cast<value_t>(1.00393843650817871);
    input_vals[83] = static_cast<value_t>(-1.01355254650115967);
    input_vals[84] = static_cast<value_t>(0.36408725380897522);
    input_vals[85] = static_cast<value_t>(-0.26416271924972534);
    input_vals[86] = static_cast<value_t>(-0.60298585891723633);
    input_vals[87] = static_cast<value_t>(-0.39992108941078186);
    input_vals[88] = static_cast<value_t>(0.20945912599563599);
    input_vals[89] = static_cast<value_t>(-0.87407380342483521);
    input_vals[90] = static_cast<value_t>(-0.75047361850738525);
    input_vals[91] = static_cast<value_t>(1.03525245189666748);
    input_vals[92] = static_cast<value_t>(-0.08701439946889877);
    input_vals[93] = static_cast<value_t>(-0.08543286472558975);
    input_vals[94] = static_cast<value_t>(-1.56627798080444336);
    input_vals[95] = static_cast<value_t>(-0.92746239900588989);
    input = input_vals;

    // Run upsample with ZEROS mode
    Tensor<value_t> result = math::upsample<value_t>(
        input, 2, UpsampleMode::ZEROS
    );

    std::vector<value_t> expected(294);
    expected[0] = static_cast<value_t>(-0.41821321845054626);
    expected[1] = static_cast<value_t>(0.00000000000000000);
    expected[2] = static_cast<value_t>(-0.54193359613418579);
    expected[3] = static_cast<value_t>(0.00000000000000000);
    expected[4] = static_cast<value_t>(-0.60790991783142090);
    expected[5] = static_cast<value_t>(0.00000000000000000);
    expected[6] = static_cast<value_t>(0.92756664752960205);
    expected[7] = static_cast<value_t>(0.00000000000000000);
    expected[8] = static_cast<value_t>(0.00000000000000000);
    expected[9] = static_cast<value_t>(0.00000000000000000);
    expected[10] = static_cast<value_t>(0.00000000000000000);
    expected[11] = static_cast<value_t>(0.00000000000000000);
    expected[12] = static_cast<value_t>(0.00000000000000000);
    expected[13] = static_cast<value_t>(0.00000000000000000);
    expected[14] = static_cast<value_t>(0.56241208314895630);
    expected[15] = static_cast<value_t>(0.00000000000000000);
    expected[16] = static_cast<value_t>(-0.64953356981277466);
    expected[17] = static_cast<value_t>(0.00000000000000000);
    expected[18] = static_cast<value_t>(2.17241668701171875);
    expected[19] = static_cast<value_t>(0.00000000000000000);
    expected[20] = static_cast<value_t>(-0.20336103439331055);
    expected[21] = static_cast<value_t>(0.00000000000000000);
    expected[22] = static_cast<value_t>(0.00000000000000000);
    expected[23] = static_cast<value_t>(0.00000000000000000);
    expected[24] = static_cast<value_t>(0.00000000000000000);
    expected[25] = static_cast<value_t>(0.00000000000000000);
    expected[26] = static_cast<value_t>(0.00000000000000000);
    expected[27] = static_cast<value_t>(0.00000000000000000);
    expected[28] = static_cast<value_t>(-0.31678462028503418);
    expected[29] = static_cast<value_t>(0.00000000000000000);
    expected[30] = static_cast<value_t>(0.06683360785245895);
    expected[31] = static_cast<value_t>(0.00000000000000000);
    expected[32] = static_cast<value_t>(0.99628394842147827);
    expected[33] = static_cast<value_t>(0.00000000000000000);
    expected[34] = static_cast<value_t>(-0.53362756967544556);
    expected[35] = static_cast<value_t>(0.00000000000000000);
    expected[36] = static_cast<value_t>(0.00000000000000000);
    expected[37] = static_cast<value_t>(0.00000000000000000);
    expected[38] = static_cast<value_t>(0.00000000000000000);
    expected[39] = static_cast<value_t>(0.00000000000000000);
    expected[40] = static_cast<value_t>(0.00000000000000000);
    expected[41] = static_cast<value_t>(0.00000000000000000);
    expected[42] = static_cast<value_t>(-1.53336000442504883);
    expected[43] = static_cast<value_t>(0.00000000000000000);
    expected[44] = static_cast<value_t>(-0.34180060029029846);
    expected[45] = static_cast<value_t>(0.00000000000000000);
    expected[46] = static_cast<value_t>(0.71207737922668457);
    expected[47] = static_cast<value_t>(0.00000000000000000);
    expected[48] = static_cast<value_t>(-0.13547202944755554);
    expected[49] = static_cast<value_t>(0.50596767663955688);
    expected[50] = static_cast<value_t>(0.00000000000000000);
    expected[51] = static_cast<value_t>(-0.64883840084075928);
    expected[52] = static_cast<value_t>(0.00000000000000000);
    expected[53] = static_cast<value_t>(0.35781762003898621);
    expected[54] = static_cast<value_t>(0.00000000000000000);
    expected[55] = static_cast<value_t>(-0.79847091436386108);
    expected[56] = static_cast<value_t>(0.00000000000000000);
    expected[57] = static_cast<value_t>(0.00000000000000000);
    expected[58] = static_cast<value_t>(0.00000000000000000);
    expected[59] = static_cast<value_t>(0.00000000000000000);
    expected[60] = static_cast<value_t>(0.00000000000000000);
    expected[61] = static_cast<value_t>(0.00000000000000000);
    expected[62] = static_cast<value_t>(0.00000000000000000);
    expected[63] = static_cast<value_t>(1.00992500782012939);
    expected[64] = static_cast<value_t>(0.00000000000000000);
    expected[65] = static_cast<value_t>(1.28805148601531982);
    expected[66] = static_cast<value_t>(0.00000000000000000);
    expected[67] = static_cast<value_t>(-1.61640858650207520);
    expected[68] = static_cast<value_t>(0.00000000000000000);
    expected[69] = static_cast<value_t>(-0.48616996407508850);
    expected[70] = static_cast<value_t>(0.00000000000000000);
    expected[71] = static_cast<value_t>(0.00000000000000000);
    expected[72] = static_cast<value_t>(0.00000000000000000);
    expected[73] = static_cast<value_t>(0.00000000000000000);
    expected[74] = static_cast<value_t>(0.00000000000000000);
    expected[75] = static_cast<value_t>(0.00000000000000000);
    expected[76] = static_cast<value_t>(0.00000000000000000);
    expected[77] = static_cast<value_t>(-0.64680159091949463);
    expected[78] = static_cast<value_t>(0.00000000000000000);
    expected[79] = static_cast<value_t>(-0.64978849887847900);
    expected[80] = static_cast<value_t>(0.00000000000000000);
    expected[81] = static_cast<value_t>(-0.96577489376068115);
    expected[82] = static_cast<value_t>(0.00000000000000000);
    expected[83] = static_cast<value_t>(0.05628735199570656);
    expected[84] = static_cast<value_t>(0.00000000000000000);
    expected[85] = static_cast<value_t>(0.00000000000000000);
    expected[86] = static_cast<value_t>(0.00000000000000000);
    expected[87] = static_cast<value_t>(0.00000000000000000);
    expected[88] = static_cast<value_t>(0.00000000000000000);
    expected[89] = static_cast<value_t>(0.00000000000000000);
    expected[90] = static_cast<value_t>(0.00000000000000000);
    expected[91] = static_cast<value_t>(1.23208546638488770);
    expected[92] = static_cast<value_t>(0.00000000000000000);
    expected[93] = static_cast<value_t>(1.62145292758941650);
    expected[94] = static_cast<value_t>(0.00000000000000000);
    expected[95] = static_cast<value_t>(-0.15720753371715546);
    expected[96] = static_cast<value_t>(0.00000000000000000);
    expected[97] = static_cast<value_t>(0.30400943756103516);
    expected[98] = static_cast<value_t>(1.56620848178863525);
    expected[99] = static_cast<value_t>(0.00000000000000000);
    expected[100] = static_cast<value_t>(1.16694223880767822);
    expected[101] = static_cast<value_t>(0.00000000000000000);
    expected[102] = static_cast<value_t>(-0.51487374305725098);
    expected[103] = static_cast<value_t>(0.00000000000000000);
    expected[104] = static_cast<value_t>(-0.21902374923229218);
    expected[105] = static_cast<value_t>(0.00000000000000000);
    expected[106] = static_cast<value_t>(0.00000000000000000);
    expected[107] = static_cast<value_t>(0.00000000000000000);
    expected[108] = static_cast<value_t>(0.00000000000000000);
    expected[109] = static_cast<value_t>(0.00000000000000000);
    expected[110] = static_cast<value_t>(0.00000000000000000);
    expected[111] = static_cast<value_t>(0.00000000000000000);
    expected[112] = static_cast<value_t>(0.77090531587600708);
    expected[113] = static_cast<value_t>(0.00000000000000000);
    expected[114] = static_cast<value_t>(0.44450598955154419);
    expected[115] = static_cast<value_t>(0.00000000000000000);
    expected[116] = static_cast<value_t>(-1.02915620803833008);
    expected[117] = static_cast<value_t>(0.00000000000000000);
    expected[118] = static_cast<value_t>(-0.74194103479385376);
    expected[119] = static_cast<value_t>(0.00000000000000000);
    expected[120] = static_cast<value_t>(0.00000000000000000);
    expected[121] = static_cast<value_t>(0.00000000000000000);
    expected[122] = static_cast<value_t>(0.00000000000000000);
    expected[123] = static_cast<value_t>(0.00000000000000000);
    expected[124] = static_cast<value_t>(0.00000000000000000);
    expected[125] = static_cast<value_t>(0.00000000000000000);
    expected[126] = static_cast<value_t>(0.96381664276123047);
    expected[127] = static_cast<value_t>(0.00000000000000000);
    expected[128] = static_cast<value_t>(-0.71821582317352295);
    expected[129] = static_cast<value_t>(0.00000000000000000);
    expected[130] = static_cast<value_t>(-0.71397012472152710);
    expected[131] = static_cast<value_t>(0.00000000000000000);
    expected[132] = static_cast<value_t>(-0.12390217185020447);
    expected[133] = static_cast<value_t>(0.00000000000000000);
    expected[134] = static_cast<value_t>(0.00000000000000000);
    expected[135] = static_cast<value_t>(0.00000000000000000);
    expected[136] = static_cast<value_t>(0.00000000000000000);
    expected[137] = static_cast<value_t>(0.00000000000000000);
    expected[138] = static_cast<value_t>(0.00000000000000000);
    expected[139] = static_cast<value_t>(0.00000000000000000);
    expected[140] = static_cast<value_t>(-0.30710524320602417);
    expected[141] = static_cast<value_t>(0.00000000000000000);
    expected[142] = static_cast<value_t>(-0.87936723232269287);
    expected[143] = static_cast<value_t>(0.00000000000000000);
    expected[144] = static_cast<value_t>(-0.57712143659591675);
    expected[145] = static_cast<value_t>(0.00000000000000000);
    expected[146] = static_cast<value_t>(-0.22630953788757324);
    expected[147] = static_cast<value_t>(-0.70363897085189819);
    expected[148] = static_cast<value_t>(0.00000000000000000);
    expected[149] = static_cast<value_t>(0.41058504581451416);
    expected[150] = static_cast<value_t>(0.00000000000000000);
    expected[151] = static_cast<value_t>(-2.24382781982421875);
    expected[152] = static_cast<value_t>(0.00000000000000000);
    expected[153] = static_cast<value_t>(0.55190533399581909);
    expected[154] = static_cast<value_t>(0.00000000000000000);
    expected[155] = static_cast<value_t>(0.00000000000000000);
    expected[156] = static_cast<value_t>(0.00000000000000000);
    expected[157] = static_cast<value_t>(0.00000000000000000);
    expected[158] = static_cast<value_t>(0.00000000000000000);
    expected[159] = static_cast<value_t>(0.00000000000000000);
    expected[160] = static_cast<value_t>(0.00000000000000000);
    expected[161] = static_cast<value_t>(0.90725111961364746);
    expected[162] = static_cast<value_t>(0.00000000000000000);
    expected[163] = static_cast<value_t>(0.56253910064697266);
    expected[164] = static_cast<value_t>(0.00000000000000000);
    expected[165] = static_cast<value_t>(-2.20187425613403320);
    expected[166] = static_cast<value_t>(0.00000000000000000);
    expected[167] = static_cast<value_t>(-0.68039232492446899);
    expected[168] = static_cast<value_t>(0.00000000000000000);
    expected[169] = static_cast<value_t>(0.00000000000000000);
    expected[170] = static_cast<value_t>(0.00000000000000000);
    expected[171] = static_cast<value_t>(0.00000000000000000);
    expected[172] = static_cast<value_t>(0.00000000000000000);
    expected[173] = static_cast<value_t>(0.00000000000000000);
    expected[174] = static_cast<value_t>(0.00000000000000000);
    expected[175] = static_cast<value_t>(0.05351464077830315);
    expected[176] = static_cast<value_t>(0.00000000000000000);
    expected[177] = static_cast<value_t>(0.96100926399230957);
    expected[178] = static_cast<value_t>(0.00000000000000000);
    expected[179] = static_cast<value_t>(0.18499962985515594);
    expected[180] = static_cast<value_t>(0.00000000000000000);
    expected[181] = static_cast<value_t>(-0.07086566835641861);
    expected[182] = static_cast<value_t>(0.00000000000000000);
    expected[183] = static_cast<value_t>(0.00000000000000000);
    expected[184] = static_cast<value_t>(0.00000000000000000);
    expected[185] = static_cast<value_t>(0.00000000000000000);
    expected[186] = static_cast<value_t>(0.00000000000000000);
    expected[187] = static_cast<value_t>(0.00000000000000000);
    expected[188] = static_cast<value_t>(0.00000000000000000);
    expected[189] = static_cast<value_t>(-0.53744995594024658);
    expected[190] = static_cast<value_t>(0.00000000000000000);
    expected[191] = static_cast<value_t>(0.18833741545677185);
    expected[192] = static_cast<value_t>(0.00000000000000000);
    expected[193] = static_cast<value_t>(0.30202323198318481);
    expected[194] = static_cast<value_t>(0.00000000000000000);
    expected[195] = static_cast<value_t>(-1.33185422420501709);
    expected[196] = static_cast<value_t>(-0.47411113977432251);
    expected[197] = static_cast<value_t>(0.00000000000000000);
    expected[198] = static_cast<value_t>(1.46448397636413574);
    expected[199] = static_cast<value_t>(0.00000000000000000);
    expected[200] = static_cast<value_t>(-0.83210825920104980);
    expected[201] = static_cast<value_t>(0.00000000000000000);
    expected[202] = static_cast<value_t>(0.92505794763565063);
    expected[203] = static_cast<value_t>(0.00000000000000000);
    expected[204] = static_cast<value_t>(0.00000000000000000);
    expected[205] = static_cast<value_t>(0.00000000000000000);
    expected[206] = static_cast<value_t>(0.00000000000000000);
    expected[207] = static_cast<value_t>(0.00000000000000000);
    expected[208] = static_cast<value_t>(0.00000000000000000);
    expected[209] = static_cast<value_t>(0.00000000000000000);
    expected[210] = static_cast<value_t>(1.40102899074554443);
    expected[211] = static_cast<value_t>(0.00000000000000000);
    expected[212] = static_cast<value_t>(0.71686124801635742);
    expected[213] = static_cast<value_t>(0.00000000000000000);
    expected[214] = static_cast<value_t>(-0.54903650283813477);
    expected[215] = static_cast<value_t>(0.00000000000000000);
    expected[216] = static_cast<value_t>(0.79875069856643677);
    expected[217] = static_cast<value_t>(0.00000000000000000);
    expected[218] = static_cast<value_t>(0.00000000000000000);
    expected[219] = static_cast<value_t>(0.00000000000000000);
    expected[220] = static_cast<value_t>(0.00000000000000000);
    expected[221] = static_cast<value_t>(0.00000000000000000);
    expected[222] = static_cast<value_t>(0.00000000000000000);
    expected[223] = static_cast<value_t>(0.00000000000000000);
    expected[224] = static_cast<value_t>(-0.24716407060623169);
    expected[225] = static_cast<value_t>(0.00000000000000000);
    expected[226] = static_cast<value_t>(-0.36205753684043884);
    expected[227] = static_cast<value_t>(0.00000000000000000);
    expected[228] = static_cast<value_t>(-0.67401987314224243);
    expected[229] = static_cast<value_t>(0.00000000000000000);
    expected[230] = static_cast<value_t>(-0.97569459676742554);
    expected[231] = static_cast<value_t>(0.00000000000000000);
    expected[232] = static_cast<value_t>(0.00000000000000000);
    expected[233] = static_cast<value_t>(0.00000000000000000);
    expected[234] = static_cast<value_t>(0.00000000000000000);
    expected[235] = static_cast<value_t>(0.00000000000000000);
    expected[236] = static_cast<value_t>(0.00000000000000000);
    expected[237] = static_cast<value_t>(0.00000000000000000);
    expected[238] = static_cast<value_t>(0.29289868474006653);
    expected[239] = static_cast<value_t>(0.00000000000000000);
    expected[240] = static_cast<value_t>(-0.21490204334259033);
    expected[241] = static_cast<value_t>(0.00000000000000000);
    expected[242] = static_cast<value_t>(0.19958595931529999);
    expected[243] = static_cast<value_t>(0.00000000000000000);
    expected[244] = static_cast<value_t>(-0.08458172529935837);
    expected[245] = static_cast<value_t>(0.45410531759262085);
    expected[246] = static_cast<value_t>(0.00000000000000000);
    expected[247] = static_cast<value_t>(-0.86453998088836670);
    expected[248] = static_cast<value_t>(0.00000000000000000);
    expected[249] = static_cast<value_t>(1.00393843650817871);
    expected[250] = static_cast<value_t>(0.00000000000000000);
    expected[251] = static_cast<value_t>(-1.01355254650115967);
    expected[252] = static_cast<value_t>(0.00000000000000000);
    expected[253] = static_cast<value_t>(0.00000000000000000);
    expected[254] = static_cast<value_t>(0.00000000000000000);
    expected[255] = static_cast<value_t>(0.00000000000000000);
    expected[256] = static_cast<value_t>(0.00000000000000000);
    expected[257] = static_cast<value_t>(0.00000000000000000);
    expected[258] = static_cast<value_t>(0.00000000000000000);
    expected[259] = static_cast<value_t>(0.36408725380897522);
    expected[260] = static_cast<value_t>(0.00000000000000000);
    expected[261] = static_cast<value_t>(-0.26416271924972534);
    expected[262] = static_cast<value_t>(0.00000000000000000);
    expected[263] = static_cast<value_t>(-0.60298585891723633);
    expected[264] = static_cast<value_t>(0.00000000000000000);
    expected[265] = static_cast<value_t>(-0.39992108941078186);
    expected[266] = static_cast<value_t>(0.00000000000000000);
    expected[267] = static_cast<value_t>(0.00000000000000000);
    expected[268] = static_cast<value_t>(0.00000000000000000);
    expected[269] = static_cast<value_t>(0.00000000000000000);
    expected[270] = static_cast<value_t>(0.00000000000000000);
    expected[271] = static_cast<value_t>(0.00000000000000000);
    expected[272] = static_cast<value_t>(0.00000000000000000);
    expected[273] = static_cast<value_t>(0.20945912599563599);
    expected[274] = static_cast<value_t>(0.00000000000000000);
    expected[275] = static_cast<value_t>(-0.87407380342483521);
    expected[276] = static_cast<value_t>(0.00000000000000000);
    expected[277] = static_cast<value_t>(-0.75047361850738525);
    expected[278] = static_cast<value_t>(0.00000000000000000);
    expected[279] = static_cast<value_t>(1.03525245189666748);
    expected[280] = static_cast<value_t>(0.00000000000000000);
    expected[281] = static_cast<value_t>(0.00000000000000000);
    expected[282] = static_cast<value_t>(0.00000000000000000);
    expected[283] = static_cast<value_t>(0.00000000000000000);
    expected[284] = static_cast<value_t>(0.00000000000000000);
    expected[285] = static_cast<value_t>(0.00000000000000000);
    expected[286] = static_cast<value_t>(0.00000000000000000);
    expected[287] = static_cast<value_t>(-0.08701439946889877);
    expected[288] = static_cast<value_t>(0.00000000000000000);
    expected[289] = static_cast<value_t>(-0.08543286472558975);
    expected[290] = static_cast<value_t>(0.00000000000000000);
    expected[291] = static_cast<value_t>(-1.56627798080444336);
    expected[292] = static_cast<value_t>(0.00000000000000000);
    expected[293] = static_cast<value_t>(-0.92746239900588989);

    std::vector<value_t> host(expected.size());
    g_sycl_queue.memcpy(host.data(), result.m_p_data.get(),
                        host.size() * sizeof(value_t)).wait();

    // Compare results
    for (size_t i = 0; i < host.size(); ++i)
    {
        if constexpr (std::is_floating_point<value_t>::value)
        {
            EXPECT_NEAR(static_cast<double>(host[i]),
                        static_cast<double>(expected[i]), 0.0001);
        }
        else
        {
            EXPECT_EQ(host[i], expected[i]);
        }
    }
}

/**
 * @test TypedUpsample.nearest_simple_2x2_stride2
 * @brief Upsample NEAREST mode test: 
 *   input shape: [1, 2, 2]
 *   stride: 2
 *   output shape: (1, 3, 3)
 */
TYPED_TEST(TypedUpsample, nearest_simple_2x2_stride2)
{
    using value_t = TypeParam;

    Tensor<value_t> input(
        {1, 2, 2},
        MemoryLocation:: DEVICE
    );

    std::vector<value_t> input_vals(4);
    input_vals[0] = static_cast<value_t>(-0.24532566964626312);
    input_vals[1] = static_cast<value_t>(-0.61335217952728271);
    input_vals[2] = static_cast<value_t>(-0.72676789760589600);
    input_vals[3] = static_cast<value_t>(0.05936607718467712);
    input = input_vals;

    // Run upsample with NEAREST mode
    Tensor<value_t> result = math::upsample<value_t>(
        input, 2, UpsampleMode::NEAREST
    );

    std::vector<value_t> expected(9);
    expected[0] = static_cast<value_t>(-0.24532566964626312);
    expected[1] = static_cast<value_t>(-0.24532566964626312);
    expected[2] = static_cast<value_t>(-0.61335217952728271);
    expected[3] = static_cast<value_t>(-0.24532566964626312);
    expected[4] = static_cast<value_t>(-0.24532566964626312);
    expected[5] = static_cast<value_t>(-0.61335217952728271);
    expected[6] = static_cast<value_t>(-0.72676789760589600);
    expected[7] = static_cast<value_t>(-0.72676789760589600);
    expected[8] = static_cast<value_t>(0.05936607718467712);

    std::vector<value_t> host(expected.size());
    g_sycl_queue.memcpy(host.data(), result.m_p_data.get(),
                        host.size() * sizeof(value_t)).wait();

    // Compare results
    for (size_t i = 0; i < host.size(); ++i)
    {
        if constexpr (std::is_floating_point<value_t>::value)
        {
            EXPECT_NEAR(static_cast<double>(host[i]),
                        static_cast<double>(expected[i]), 0.0001);
        }
        else
        {
            EXPECT_EQ(host[i], expected[i]);
        }
    }
}

/**
 * @test TypedUpsample.nearest_3channels_3x3_stride2
 * @brief Upsample NEAREST mode test: 
 *   input shape: [3, 3, 3]
 *   stride: 2
 *   output shape: (3, 5, 5)
 */
TYPED_TEST(TypedUpsample, nearest_3channels_3x3_stride2)
{
    using value_t = TypeParam;

    Tensor<value_t> input(
        {3, 3, 3},
        MemoryLocation:: DEVICE
    );

    std::vector<value_t> input_vals(27);
    input_vals[0] = static_cast<value_t>(2.16493487358093262);
    input_vals[1] = static_cast<value_t>(-0.99065172672271729);
    input_vals[2] = static_cast<value_t>(0.45125433802604675);
    input_vals[3] = static_cast<value_t>(0.66525012254714966);
    input_vals[4] = static_cast<value_t>(-1.17361521720886230);
    input_vals[5] = static_cast<value_t>(-0.60203766822814941);
    input_vals[6] = static_cast<value_t>(0.25473606586456299);
    input_vals[7] = static_cast<value_t>(0.17886151373386383);
    input_vals[8] = static_cast<value_t>(1.58154964447021484);
    input_vals[9] = static_cast<value_t>(0.06213479489088058);
    input_vals[10] = static_cast<value_t>(-1.47040677070617676);
    input_vals[11] = static_cast<value_t>(-0.07727841287851334);
    input_vals[12] = static_cast<value_t>(1.55513489246368408);
    input_vals[13] = static_cast<value_t>(-1.97160923480987549);
    input_vals[14] = static_cast<value_t>(0.30369871854782104);
    input_vals[15] = static_cast<value_t>(-2.44727754592895508);
    input_vals[16] = static_cast<value_t>(1.18930923938751221);
    input_vals[17] = static_cast<value_t>(0.39974093437194824);
    input_vals[18] = static_cast<value_t>(-0.69064205884933472);
    input_vals[19] = static_cast<value_t>(-0.92154520750045776);
    input_vals[20] = static_cast<value_t>(-2.03736090660095215);
    input_vals[21] = static_cast<value_t>(-0.91991698741912842);
    input_vals[22] = static_cast<value_t>(-0.26344516873359680);
    input_vals[23] = static_cast<value_t>(-0.45678597688674927);
    input_vals[24] = static_cast<value_t>(0.59893894195556641);
    input_vals[25] = static_cast<value_t>(-0.54487979412078857);
    input_vals[26] = static_cast<value_t>(-0.05908547341823578);
    input = input_vals;

    // Run upsample with NEAREST mode
    Tensor<value_t> result = math::upsample<value_t>(
        input, 2, UpsampleMode::NEAREST
    );

    std::vector<value_t> expected(75);
    expected[0] = static_cast<value_t>(2.16493487358093262);
    expected[1] = static_cast<value_t>(2.16493487358093262);
    expected[2] = static_cast<value_t>(-0.99065172672271729);
    expected[3] = static_cast<value_t>(-0.99065172672271729);
    expected[4] = static_cast<value_t>(0.45125433802604675);
    expected[5] = static_cast<value_t>(2.16493487358093262);
    expected[6] = static_cast<value_t>(2.16493487358093262);
    expected[7] = static_cast<value_t>(-0.99065172672271729);
    expected[8] = static_cast<value_t>(-0.99065172672271729);
    expected[9] = static_cast<value_t>(0.45125433802604675);
    expected[10] = static_cast<value_t>(0.66525012254714966);
    expected[11] = static_cast<value_t>(0.66525012254714966);
    expected[12] = static_cast<value_t>(-1.17361521720886230);
    expected[13] = static_cast<value_t>(-1.17361521720886230);
    expected[14] = static_cast<value_t>(-0.60203766822814941);
    expected[15] = static_cast<value_t>(0.66525012254714966);
    expected[16] = static_cast<value_t>(0.66525012254714966);
    expected[17] = static_cast<value_t>(-1.17361521720886230);
    expected[18] = static_cast<value_t>(-1.17361521720886230);
    expected[19] = static_cast<value_t>(-0.60203766822814941);
    expected[20] = static_cast<value_t>(0.25473606586456299);
    expected[21] = static_cast<value_t>(0.25473606586456299);
    expected[22] = static_cast<value_t>(0.17886151373386383);
    expected[23] = static_cast<value_t>(0.17886151373386383);
    expected[24] = static_cast<value_t>(1.58154964447021484);
    expected[25] = static_cast<value_t>(0.06213479489088058);
    expected[26] = static_cast<value_t>(0.06213479489088058);
    expected[27] = static_cast<value_t>(-1.47040677070617676);
    expected[28] = static_cast<value_t>(-1.47040677070617676);
    expected[29] = static_cast<value_t>(-0.07727841287851334);
    expected[30] = static_cast<value_t>(0.06213479489088058);
    expected[31] = static_cast<value_t>(0.06213479489088058);
    expected[32] = static_cast<value_t>(-1.47040677070617676);
    expected[33] = static_cast<value_t>(-1.47040677070617676);
    expected[34] = static_cast<value_t>(-0.07727841287851334);
    expected[35] = static_cast<value_t>(1.55513489246368408);
    expected[36] = static_cast<value_t>(1.55513489246368408);
    expected[37] = static_cast<value_t>(-1.97160923480987549);
    expected[38] = static_cast<value_t>(-1.97160923480987549);
    expected[39] = static_cast<value_t>(0.30369871854782104);
    expected[40] = static_cast<value_t>(1.55513489246368408);
    expected[41] = static_cast<value_t>(1.55513489246368408);
    expected[42] = static_cast<value_t>(-1.97160923480987549);
    expected[43] = static_cast<value_t>(-1.97160923480987549);
    expected[44] = static_cast<value_t>(0.30369871854782104);
    expected[45] = static_cast<value_t>(-2.44727754592895508);
    expected[46] = static_cast<value_t>(-2.44727754592895508);
    expected[47] = static_cast<value_t>(1.18930923938751221);
    expected[48] = static_cast<value_t>(1.18930923938751221);
    expected[49] = static_cast<value_t>(0.39974093437194824);
    expected[50] = static_cast<value_t>(-0.69064205884933472);
    expected[51] = static_cast<value_t>(-0.69064205884933472);
    expected[52] = static_cast<value_t>(-0.92154520750045776);
    expected[53] = static_cast<value_t>(-0.92154520750045776);
    expected[54] = static_cast<value_t>(-2.03736090660095215);
    expected[55] = static_cast<value_t>(-0.69064205884933472);
    expected[56] = static_cast<value_t>(-0.69064205884933472);
    expected[57] = static_cast<value_t>(-0.92154520750045776);
    expected[58] = static_cast<value_t>(-0.92154520750045776);
    expected[59] = static_cast<value_t>(-2.03736090660095215);
    expected[60] = static_cast<value_t>(-0.91991698741912842);
    expected[61] = static_cast<value_t>(-0.91991698741912842);
    expected[62] = static_cast<value_t>(-0.26344516873359680);
    expected[63] = static_cast<value_t>(-0.26344516873359680);
    expected[64] = static_cast<value_t>(-0.45678597688674927);
    expected[65] = static_cast<value_t>(-0.91991698741912842);
    expected[66] = static_cast<value_t>(-0.91991698741912842);
    expected[67] = static_cast<value_t>(-0.26344516873359680);
    expected[68] = static_cast<value_t>(-0.26344516873359680);
    expected[69] = static_cast<value_t>(-0.45678597688674927);
    expected[70] = static_cast<value_t>(0.59893894195556641);
    expected[71] = static_cast<value_t>(0.59893894195556641);
    expected[72] = static_cast<value_t>(-0.54487979412078857);
    expected[73] = static_cast<value_t>(-0.54487979412078857);
    expected[74] = static_cast<value_t>(-0.05908547341823578);

    std::vector<value_t> host(expected.size());
    g_sycl_queue.memcpy(host.data(), result.m_p_data.get(),
                        host.size() * sizeof(value_t)).wait();

    // Compare results
    for (size_t i = 0; i < host.size(); ++i)
    {
        if constexpr (std::is_floating_point<value_t>::value)
        {
            EXPECT_NEAR(static_cast<double>(host[i]),
                        static_cast<double>(expected[i]), 0.0001);
        }
        else
        {
            EXPECT_EQ(host[i], expected[i]);
        }
    }
}

/**
 * @test TypedUpsample.nearest_multichannel_4x4_stride3
 * @brief Upsample NEAREST mode test: 
 *   input shape: [2, 4, 4]
 *   stride: 3
 *   output shape: (2, 10, 10)
 */
TYPED_TEST(TypedUpsample, nearest_multichannel_4x4_stride3)
{
    using value_t = TypeParam;

    Tensor<value_t> input(
        {2, 4, 4},
        MemoryLocation:: DEVICE
    );

    std::vector<value_t> input_vals(32);
    input_vals[0] = static_cast<value_t>(0.49399194121360779);
    input_vals[1] = static_cast<value_t>(-0.65397775173187256);
    input_vals[2] = static_cast<value_t>(-1.47497761249542236);
    input_vals[3] = static_cast<value_t>(0.34038656949996948);
    input_vals[4] = static_cast<value_t>(-0.94363933801651001);
    input_vals[5] = static_cast<value_t>(-0.43104416131973267);
    input_vals[6] = static_cast<value_t>(-0.34426900744438171);
    input_vals[7] = static_cast<value_t>(-0.11628397554159164);
    input_vals[8] = static_cast<value_t>(0.57592535018920898);
    input_vals[9] = static_cast<value_t>(-1.45498085021972656);
    input_vals[10] = static_cast<value_t>(-0.87185829877853394);
    input_vals[11] = static_cast<value_t>(0.63417935371398926);
    input_vals[12] = static_cast<value_t>(-1.47297883033752441);
    input_vals[13] = static_cast<value_t>(-0.02128035388886929);
    input_vals[14] = static_cast<value_t>(0.57253307104110718);
    input_vals[15] = static_cast<value_t>(0.52090483903884888);
    input_vals[16] = static_cast<value_t>(0.10398175567388535);
    input_vals[17] = static_cast<value_t>(-0.86555474996566772);
    input_vals[18] = static_cast<value_t>(-0.07842533290386200);
    input_vals[19] = static_cast<value_t>(-0.83040565252304077);
    input_vals[20] = static_cast<value_t>(-0.23743093013763428);
    input_vals[21] = static_cast<value_t>(-2.40904331207275391);
    input_vals[22] = static_cast<value_t>(-1.68703389167785645);
    input_vals[23] = static_cast<value_t>(-0.18178197741508484);
    input_vals[24] = static_cast<value_t>(0.81109261512756348);
    input_vals[25] = static_cast<value_t>(-0.13524451851844788);
    input_vals[26] = static_cast<value_t>(0.94947081804275513);
    input_vals[27] = static_cast<value_t>(0.06024326011538506);
    input_vals[28] = static_cast<value_t>(2.37925982475280762);
    input_vals[29] = static_cast<value_t>(0.71093541383743286);
    input_vals[30] = static_cast<value_t>(1.20758843421936035);
    input_vals[31] = static_cast<value_t>(-1.11192452907562256);
    input = input_vals;

    // Run upsample with NEAREST mode
    Tensor<value_t> result = math::upsample<value_t>(
        input, 3, UpsampleMode::NEAREST
    );

    std::vector<value_t> expected(200);
    expected[0] = static_cast<value_t>(0.49399194121360779);
    expected[1] = static_cast<value_t>(0.49399194121360779);
    expected[2] = static_cast<value_t>(0.49399194121360779);
    expected[3] = static_cast<value_t>(-0.65397775173187256);
    expected[4] = static_cast<value_t>(-0.65397775173187256);
    expected[5] = static_cast<value_t>(-0.65397775173187256);
    expected[6] = static_cast<value_t>(-1.47497761249542236);
    expected[7] = static_cast<value_t>(-1.47497761249542236);
    expected[8] = static_cast<value_t>(-1.47497761249542236);
    expected[9] = static_cast<value_t>(0.34038656949996948);
    expected[10] = static_cast<value_t>(0.49399194121360779);
    expected[11] = static_cast<value_t>(0.49399194121360779);
    expected[12] = static_cast<value_t>(0.49399194121360779);
    expected[13] = static_cast<value_t>(-0.65397775173187256);
    expected[14] = static_cast<value_t>(-0.65397775173187256);
    expected[15] = static_cast<value_t>(-0.65397775173187256);
    expected[16] = static_cast<value_t>(-1.47497761249542236);
    expected[17] = static_cast<value_t>(-1.47497761249542236);
    expected[18] = static_cast<value_t>(-1.47497761249542236);
    expected[19] = static_cast<value_t>(0.34038656949996948);
    expected[20] = static_cast<value_t>(0.49399194121360779);
    expected[21] = static_cast<value_t>(0.49399194121360779);
    expected[22] = static_cast<value_t>(0.49399194121360779);
    expected[23] = static_cast<value_t>(-0.65397775173187256);
    expected[24] = static_cast<value_t>(-0.65397775173187256);
    expected[25] = static_cast<value_t>(-0.65397775173187256);
    expected[26] = static_cast<value_t>(-1.47497761249542236);
    expected[27] = static_cast<value_t>(-1.47497761249542236);
    expected[28] = static_cast<value_t>(-1.47497761249542236);
    expected[29] = static_cast<value_t>(0.34038656949996948);
    expected[30] = static_cast<value_t>(-0.94363933801651001);
    expected[31] = static_cast<value_t>(-0.94363933801651001);
    expected[32] = static_cast<value_t>(-0.94363933801651001);
    expected[33] = static_cast<value_t>(-0.43104416131973267);
    expected[34] = static_cast<value_t>(-0.43104416131973267);
    expected[35] = static_cast<value_t>(-0.43104416131973267);
    expected[36] = static_cast<value_t>(-0.34426900744438171);
    expected[37] = static_cast<value_t>(-0.34426900744438171);
    expected[38] = static_cast<value_t>(-0.34426900744438171);
    expected[39] = static_cast<value_t>(-0.11628397554159164);
    expected[40] = static_cast<value_t>(-0.94363933801651001);
    expected[41] = static_cast<value_t>(-0.94363933801651001);
    expected[42] = static_cast<value_t>(-0.94363933801651001);
    expected[43] = static_cast<value_t>(-0.43104416131973267);
    expected[44] = static_cast<value_t>(-0.43104416131973267);
    expected[45] = static_cast<value_t>(-0.43104416131973267);
    expected[46] = static_cast<value_t>(-0.34426900744438171);
    expected[47] = static_cast<value_t>(-0.34426900744438171);
    expected[48] = static_cast<value_t>(-0.34426900744438171);
    expected[49] = static_cast<value_t>(-0.11628397554159164);
    expected[50] = static_cast<value_t>(-0.94363933801651001);
    expected[51] = static_cast<value_t>(-0.94363933801651001);
    expected[52] = static_cast<value_t>(-0.94363933801651001);
    expected[53] = static_cast<value_t>(-0.43104416131973267);
    expected[54] = static_cast<value_t>(-0.43104416131973267);
    expected[55] = static_cast<value_t>(-0.43104416131973267);
    expected[56] = static_cast<value_t>(-0.34426900744438171);
    expected[57] = static_cast<value_t>(-0.34426900744438171);
    expected[58] = static_cast<value_t>(-0.34426900744438171);
    expected[59] = static_cast<value_t>(-0.11628397554159164);
    expected[60] = static_cast<value_t>(0.57592535018920898);
    expected[61] = static_cast<value_t>(0.57592535018920898);
    expected[62] = static_cast<value_t>(0.57592535018920898);
    expected[63] = static_cast<value_t>(-1.45498085021972656);
    expected[64] = static_cast<value_t>(-1.45498085021972656);
    expected[65] = static_cast<value_t>(-1.45498085021972656);
    expected[66] = static_cast<value_t>(-0.87185829877853394);
    expected[67] = static_cast<value_t>(-0.87185829877853394);
    expected[68] = static_cast<value_t>(-0.87185829877853394);
    expected[69] = static_cast<value_t>(0.63417935371398926);
    expected[70] = static_cast<value_t>(0.57592535018920898);
    expected[71] = static_cast<value_t>(0.57592535018920898);
    expected[72] = static_cast<value_t>(0.57592535018920898);
    expected[73] = static_cast<value_t>(-1.45498085021972656);
    expected[74] = static_cast<value_t>(-1.45498085021972656);
    expected[75] = static_cast<value_t>(-1.45498085021972656);
    expected[76] = static_cast<value_t>(-0.87185829877853394);
    expected[77] = static_cast<value_t>(-0.87185829877853394);
    expected[78] = static_cast<value_t>(-0.87185829877853394);
    expected[79] = static_cast<value_t>(0.63417935371398926);
    expected[80] = static_cast<value_t>(0.57592535018920898);
    expected[81] = static_cast<value_t>(0.57592535018920898);
    expected[82] = static_cast<value_t>(0.57592535018920898);
    expected[83] = static_cast<value_t>(-1.45498085021972656);
    expected[84] = static_cast<value_t>(-1.45498085021972656);
    expected[85] = static_cast<value_t>(-1.45498085021972656);
    expected[86] = static_cast<value_t>(-0.87185829877853394);
    expected[87] = static_cast<value_t>(-0.87185829877853394);
    expected[88] = static_cast<value_t>(-0.87185829877853394);
    expected[89] = static_cast<value_t>(0.63417935371398926);
    expected[90] = static_cast<value_t>(-1.47297883033752441);
    expected[91] = static_cast<value_t>(-1.47297883033752441);
    expected[92] = static_cast<value_t>(-1.47297883033752441);
    expected[93] = static_cast<value_t>(-0.02128035388886929);
    expected[94] = static_cast<value_t>(-0.02128035388886929);
    expected[95] = static_cast<value_t>(-0.02128035388886929);
    expected[96] = static_cast<value_t>(0.57253307104110718);
    expected[97] = static_cast<value_t>(0.57253307104110718);
    expected[98] = static_cast<value_t>(0.57253307104110718);
    expected[99] = static_cast<value_t>(0.52090483903884888);
    expected[100] = static_cast<value_t>(0.10398175567388535);
    expected[101] = static_cast<value_t>(0.10398175567388535);
    expected[102] = static_cast<value_t>(0.10398175567388535);
    expected[103] = static_cast<value_t>(-0.86555474996566772);
    expected[104] = static_cast<value_t>(-0.86555474996566772);
    expected[105] = static_cast<value_t>(-0.86555474996566772);
    expected[106] = static_cast<value_t>(-0.07842533290386200);
    expected[107] = static_cast<value_t>(-0.07842533290386200);
    expected[108] = static_cast<value_t>(-0.07842533290386200);
    expected[109] = static_cast<value_t>(-0.83040565252304077);
    expected[110] = static_cast<value_t>(0.10398175567388535);
    expected[111] = static_cast<value_t>(0.10398175567388535);
    expected[112] = static_cast<value_t>(0.10398175567388535);
    expected[113] = static_cast<value_t>(-0.86555474996566772);
    expected[114] = static_cast<value_t>(-0.86555474996566772);
    expected[115] = static_cast<value_t>(-0.86555474996566772);
    expected[116] = static_cast<value_t>(-0.07842533290386200);
    expected[117] = static_cast<value_t>(-0.07842533290386200);
    expected[118] = static_cast<value_t>(-0.07842533290386200);
    expected[119] = static_cast<value_t>(-0.83040565252304077);
    expected[120] = static_cast<value_t>(0.10398175567388535);
    expected[121] = static_cast<value_t>(0.10398175567388535);
    expected[122] = static_cast<value_t>(0.10398175567388535);
    expected[123] = static_cast<value_t>(-0.86555474996566772);
    expected[124] = static_cast<value_t>(-0.86555474996566772);
    expected[125] = static_cast<value_t>(-0.86555474996566772);
    expected[126] = static_cast<value_t>(-0.07842533290386200);
    expected[127] = static_cast<value_t>(-0.07842533290386200);
    expected[128] = static_cast<value_t>(-0.07842533290386200);
    expected[129] = static_cast<value_t>(-0.83040565252304077);
    expected[130] = static_cast<value_t>(-0.23743093013763428);
    expected[131] = static_cast<value_t>(-0.23743093013763428);
    expected[132] = static_cast<value_t>(-0.23743093013763428);
    expected[133] = static_cast<value_t>(-2.40904331207275391);
    expected[134] = static_cast<value_t>(-2.40904331207275391);
    expected[135] = static_cast<value_t>(-2.40904331207275391);
    expected[136] = static_cast<value_t>(-1.68703389167785645);
    expected[137] = static_cast<value_t>(-1.68703389167785645);
    expected[138] = static_cast<value_t>(-1.68703389167785645);
    expected[139] = static_cast<value_t>(-0.18178197741508484);
    expected[140] = static_cast<value_t>(-0.23743093013763428);
    expected[141] = static_cast<value_t>(-0.23743093013763428);
    expected[142] = static_cast<value_t>(-0.23743093013763428);
    expected[143] = static_cast<value_t>(-2.40904331207275391);
    expected[144] = static_cast<value_t>(-2.40904331207275391);
    expected[145] = static_cast<value_t>(-2.40904331207275391);
    expected[146] = static_cast<value_t>(-1.68703389167785645);
    expected[147] = static_cast<value_t>(-1.68703389167785645);
    expected[148] = static_cast<value_t>(-1.68703389167785645);
    expected[149] = static_cast<value_t>(-0.18178197741508484);
    expected[150] = static_cast<value_t>(-0.23743093013763428);
    expected[151] = static_cast<value_t>(-0.23743093013763428);
    expected[152] = static_cast<value_t>(-0.23743093013763428);
    expected[153] = static_cast<value_t>(-2.40904331207275391);
    expected[154] = static_cast<value_t>(-2.40904331207275391);
    expected[155] = static_cast<value_t>(-2.40904331207275391);
    expected[156] = static_cast<value_t>(-1.68703389167785645);
    expected[157] = static_cast<value_t>(-1.68703389167785645);
    expected[158] = static_cast<value_t>(-1.68703389167785645);
    expected[159] = static_cast<value_t>(-0.18178197741508484);
    expected[160] = static_cast<value_t>(0.81109261512756348);
    expected[161] = static_cast<value_t>(0.81109261512756348);
    expected[162] = static_cast<value_t>(0.81109261512756348);
    expected[163] = static_cast<value_t>(-0.13524451851844788);
    expected[164] = static_cast<value_t>(-0.13524451851844788);
    expected[165] = static_cast<value_t>(-0.13524451851844788);
    expected[166] = static_cast<value_t>(0.94947081804275513);
    expected[167] = static_cast<value_t>(0.94947081804275513);
    expected[168] = static_cast<value_t>(0.94947081804275513);
    expected[169] = static_cast<value_t>(0.06024326011538506);
    expected[170] = static_cast<value_t>(0.81109261512756348);
    expected[171] = static_cast<value_t>(0.81109261512756348);
    expected[172] = static_cast<value_t>(0.81109261512756348);
    expected[173] = static_cast<value_t>(-0.13524451851844788);
    expected[174] = static_cast<value_t>(-0.13524451851844788);
    expected[175] = static_cast<value_t>(-0.13524451851844788);
    expected[176] = static_cast<value_t>(0.94947081804275513);
    expected[177] = static_cast<value_t>(0.94947081804275513);
    expected[178] = static_cast<value_t>(0.94947081804275513);
    expected[179] = static_cast<value_t>(0.06024326011538506);
    expected[180] = static_cast<value_t>(0.81109261512756348);
    expected[181] = static_cast<value_t>(0.81109261512756348);
    expected[182] = static_cast<value_t>(0.81109261512756348);
    expected[183] = static_cast<value_t>(-0.13524451851844788);
    expected[184] = static_cast<value_t>(-0.13524451851844788);
    expected[185] = static_cast<value_t>(-0.13524451851844788);
    expected[186] = static_cast<value_t>(0.94947081804275513);
    expected[187] = static_cast<value_t>(0.94947081804275513);
    expected[188] = static_cast<value_t>(0.94947081804275513);
    expected[189] = static_cast<value_t>(0.06024326011538506);
    expected[190] = static_cast<value_t>(2.37925982475280762);
    expected[191] = static_cast<value_t>(2.37925982475280762);
    expected[192] = static_cast<value_t>(2.37925982475280762);
    expected[193] = static_cast<value_t>(0.71093541383743286);
    expected[194] = static_cast<value_t>(0.71093541383743286);
    expected[195] = static_cast<value_t>(0.71093541383743286);
    expected[196] = static_cast<value_t>(1.20758843421936035);
    expected[197] = static_cast<value_t>(1.20758843421936035);
    expected[198] = static_cast<value_t>(1.20758843421936035);
    expected[199] = static_cast<value_t>(-1.11192452907562256);

    std::vector<value_t> host(expected.size());
    g_sycl_queue.memcpy(host.data(), result.m_p_data.get(),
                        host.size() * sizeof(value_t)).wait();

    // Compare results
    for (size_t i = 0; i < host.size(); ++i)
    {
        if constexpr (std::is_floating_point<value_t>::value)
        {
            EXPECT_NEAR(static_cast<double>(host[i]),
                        static_cast<double>(expected[i]), 0.0001);
        }
        else
        {
            EXPECT_EQ(host[i], expected[i]);
        }
    }
}

/**
 * @test TypedUpsample.nearest_nonsquare_3x5_stride2
 * @brief Upsample NEAREST mode test: 
 *   input shape: [1, 3, 5]
 *   stride: 2
 *   output shape: (1, 5, 9)
 */
TYPED_TEST(TypedUpsample, nearest_nonsquare_3x5_stride2)
{
    using value_t = TypeParam;

    Tensor<value_t> input(
        {1, 3, 5},
        MemoryLocation:: DEVICE
    );

    std::vector<value_t> input_vals(15);
    input_vals[0] = static_cast<value_t>(-1.02690446376800537);
    input_vals[1] = static_cast<value_t>(0.22174942493438721);
    input_vals[2] = static_cast<value_t>(1.13039016723632812);
    input_vals[3] = static_cast<value_t>(1.14618515968322754);
    input_vals[4] = static_cast<value_t>(-0.59273427724838257);
    input_vals[5] = static_cast<value_t>(0.11878403276205063);
    input_vals[6] = static_cast<value_t>(-0.48443022370338440);
    input_vals[7] = static_cast<value_t>(-1.94491267204284668);
    input_vals[8] = static_cast<value_t>(0.09207733720541000);
    input_vals[9] = static_cast<value_t>(0.90216910839080811);
    input_vals[10] = static_cast<value_t>(1.31446862220764160);
    input_vals[11] = static_cast<value_t>(0.77110219001770020);
    input_vals[12] = static_cast<value_t>(-0.54014736413955688);
    input_vals[13] = static_cast<value_t>(-0.28411516547203064);
    input_vals[14] = static_cast<value_t>(-0.88933116197586060);
    input = input_vals;

    // Run upsample with NEAREST mode
    Tensor<value_t> result = math::upsample<value_t>(
        input, 2, UpsampleMode::NEAREST
    );

    std::vector<value_t> expected(45);
    expected[0] = static_cast<value_t>(-1.02690446376800537);
    expected[1] = static_cast<value_t>(-1.02690446376800537);
    expected[2] = static_cast<value_t>(0.22174942493438721);
    expected[3] = static_cast<value_t>(0.22174942493438721);
    expected[4] = static_cast<value_t>(1.13039016723632812);
    expected[5] = static_cast<value_t>(1.13039016723632812);
    expected[6] = static_cast<value_t>(1.14618515968322754);
    expected[7] = static_cast<value_t>(1.14618515968322754);
    expected[8] = static_cast<value_t>(-0.59273427724838257);
    expected[9] = static_cast<value_t>(-1.02690446376800537);
    expected[10] = static_cast<value_t>(-1.02690446376800537);
    expected[11] = static_cast<value_t>(0.22174942493438721);
    expected[12] = static_cast<value_t>(0.22174942493438721);
    expected[13] = static_cast<value_t>(1.13039016723632812);
    expected[14] = static_cast<value_t>(1.13039016723632812);
    expected[15] = static_cast<value_t>(1.14618515968322754);
    expected[16] = static_cast<value_t>(1.14618515968322754);
    expected[17] = static_cast<value_t>(-0.59273427724838257);
    expected[18] = static_cast<value_t>(0.11878403276205063);
    expected[19] = static_cast<value_t>(0.11878403276205063);
    expected[20] = static_cast<value_t>(-0.48443022370338440);
    expected[21] = static_cast<value_t>(-0.48443022370338440);
    expected[22] = static_cast<value_t>(-1.94491267204284668);
    expected[23] = static_cast<value_t>(-1.94491267204284668);
    expected[24] = static_cast<value_t>(0.09207733720541000);
    expected[25] = static_cast<value_t>(0.09207733720541000);
    expected[26] = static_cast<value_t>(0.90216910839080811);
    expected[27] = static_cast<value_t>(0.11878403276205063);
    expected[28] = static_cast<value_t>(0.11878403276205063);
    expected[29] = static_cast<value_t>(-0.48443022370338440);
    expected[30] = static_cast<value_t>(-0.48443022370338440);
    expected[31] = static_cast<value_t>(-1.94491267204284668);
    expected[32] = static_cast<value_t>(-1.94491267204284668);
    expected[33] = static_cast<value_t>(0.09207733720541000);
    expected[34] = static_cast<value_t>(0.09207733720541000);
    expected[35] = static_cast<value_t>(0.90216910839080811);
    expected[36] = static_cast<value_t>(1.31446862220764160);
    expected[37] = static_cast<value_t>(1.31446862220764160);
    expected[38] = static_cast<value_t>(0.77110219001770020);
    expected[39] = static_cast<value_t>(0.77110219001770020);
    expected[40] = static_cast<value_t>(-0.54014736413955688);
    expected[41] = static_cast<value_t>(-0.54014736413955688);
    expected[42] = static_cast<value_t>(-0.28411516547203064);
    expected[43] = static_cast<value_t>(-0.28411516547203064);
    expected[44] = static_cast<value_t>(-0.88933116197586060);

    std::vector<value_t> host(expected.size());
    g_sycl_queue.memcpy(host.data(), result.m_p_data.get(),
                        host.size() * sizeof(value_t)).wait();

    // Compare results
    for (size_t i = 0; i < host.size(); ++i)
    {
        if constexpr (std::is_floating_point<value_t>::value)
        {
            EXPECT_NEAR(static_cast<double>(host[i]),
                        static_cast<double>(expected[i]), 0.0001);
        }
        else
        {
            EXPECT_EQ(host[i], expected[i]);
        }
    }
}

/**
 * @test TypedUpsample.nearest_batch_2x3x4x4_stride2
 * @brief Upsample NEAREST mode test: 
 *   input shape: [2, 3, 4, 4]
 *   stride: 2
 *   output shape: (2, 3, 7, 7)
 */
TYPED_TEST(TypedUpsample, nearest_batch_2x3x4x4_stride2)
{
    using value_t = TypeParam;

    Tensor<value_t> input(
        {2, 3, 4, 4},
        MemoryLocation:: DEVICE
    );

    std::vector<value_t> input_vals(96);
    input_vals[0] = static_cast<value_t>(-0.18773493170738220);
    input_vals[1] = static_cast<value_t>(2.44063687324523926);
    input_vals[2] = static_cast<value_t>(-0.94090783596038818);
    input_vals[3] = static_cast<value_t>(0.61391162872314453);
    input_vals[4] = static_cast<value_t>(0.73562669754028320);
    input_vals[5] = static_cast<value_t>(0.97291791439056396);
    input_vals[6] = static_cast<value_t>(0.25919494032859802);
    input_vals[7] = static_cast<value_t>(-0.07407491654157639);
    input_vals[8] = static_cast<value_t>(-0.17768801748752594);
    input_vals[9] = static_cast<value_t>(-0.83874356746673584);
    input_vals[10] = static_cast<value_t>(-0.15628711879253387);
    input_vals[11] = static_cast<value_t>(-0.34176161885261536);
    input_vals[12] = static_cast<value_t>(0.81873029470443726);
    input_vals[13] = static_cast<value_t>(-0.09261394292116165);
    input_vals[14] = static_cast<value_t>(0.50808095932006836);
    input_vals[15] = static_cast<value_t>(-1.75422251224517822);
    input_vals[16] = static_cast<value_t>(-0.36481797695159912);
    input_vals[17] = static_cast<value_t>(-0.03091854602098465);
    input_vals[18] = static_cast<value_t>(-0.12614427506923676);
    input_vals[19] = static_cast<value_t>(0.29918101429939270);
    input_vals[20] = static_cast<value_t>(1.82207405567169189);
    input_vals[21] = static_cast<value_t>(1.41717684268951416);
    input_vals[22] = static_cast<value_t>(-0.45731621980667114);
    input_vals[23] = static_cast<value_t>(0.86019957065582275);
    input_vals[24] = static_cast<value_t>(0.28468257188796997);
    input_vals[25] = static_cast<value_t>(0.51062750816345215);
    input_vals[26] = static_cast<value_t>(1.57829451560974121);
    input_vals[27] = static_cast<value_t>(0.16130870580673218);
    input_vals[28] = static_cast<value_t>(0.71819657087326050);
    input_vals[29] = static_cast<value_t>(-0.80599582195281982);
    input_vals[30] = static_cast<value_t>(-0.59818083047866821);
    input_vals[31] = static_cast<value_t>(1.32383632659912109);
    input_vals[32] = static_cast<value_t>(1.13726711273193359);
    input_vals[33] = static_cast<value_t>(-0.48833018541336060);
    input_vals[34] = static_cast<value_t>(0.34806743264198303);
    input_vals[35] = static_cast<value_t>(-0.97086137533187866);
    input_vals[36] = static_cast<value_t>(-0.21213643252849579);
    input_vals[37] = static_cast<value_t>(0.42335104942321777);
    input_vals[38] = static_cast<value_t>(0.10377003252506256);
    input_vals[39] = static_cast<value_t>(0.05097480863332748);
    input_vals[40] = static_cast<value_t>(-0.67144066095352173);
    input_vals[41] = static_cast<value_t>(0.27170252799987793);
    input_vals[42] = static_cast<value_t>(0.00701349042356014);
    input_vals[43] = static_cast<value_t>(0.32662299275398254);
    input_vals[44] = static_cast<value_t>(0.03618144616484642);
    input_vals[45] = static_cast<value_t>(-1.19327843189239502);
    input_vals[46] = static_cast<value_t>(-0.15810170769691467);
    input_vals[47] = static_cast<value_t>(0.01341776456683874);
    input_vals[48] = static_cast<value_t>(-0.47234681248664856);
    input_vals[49] = static_cast<value_t>(-0.20810645818710327);
    input_vals[50] = static_cast<value_t>(1.44154405593872070);
    input_vals[51] = static_cast<value_t>(-1.67109525203704834);
    input_vals[52] = static_cast<value_t>(0.54455935955047607);
    input_vals[53] = static_cast<value_t>(1.26132178306579590);
    input_vals[54] = static_cast<value_t>(0.96283698081970215);
    input_vals[55] = static_cast<value_t>(-0.27990168333053589);
    input_vals[56] = static_cast<value_t>(-0.23044776916503906);
    input_vals[57] = static_cast<value_t>(0.45213428139686584);
    input_vals[58] = static_cast<value_t>(-0.35421076416969299);
    input_vals[59] = static_cast<value_t>(0.34015303850173950);
    input_vals[60] = static_cast<value_t>(0.63620221614837646);
    input_vals[61] = static_cast<value_t>(0.75003236532211304);
    input_vals[62] = static_cast<value_t>(1.35073781013488770);
    input_vals[63] = static_cast<value_t>(-0.28858894109725952);
    input_vals[64] = static_cast<value_t>(0.08703627437353134);
    input_vals[65] = static_cast<value_t>(-0.08413141965866089);
    input_vals[66] = static_cast<value_t>(-0.99903649091720581);
    input_vals[67] = static_cast<value_t>(0.10133759677410126);
    input_vals[68] = static_cast<value_t>(0.29759278893470764);
    input_vals[69] = static_cast<value_t>(0.27976626157760620);
    input_vals[70] = static_cast<value_t>(-1.30103170871734619);
    input_vals[71] = static_cast<value_t>(-0.10640070587396622);
    input_vals[72] = static_cast<value_t>(-0.67162758111953735);
    input_vals[73] = static_cast<value_t>(-0.47094598412513733);
    input_vals[74] = static_cast<value_t>(1.06090152263641357);
    input_vals[75] = static_cast<value_t>(0.20384488999843597);
    input_vals[76] = static_cast<value_t>(0.41963556408882141);
    input_vals[77] = static_cast<value_t>(1.59819400310516357);
    input_vals[78] = static_cast<value_t>(0.21556393802165985);
    input_vals[79] = static_cast<value_t>(1.84750485420227051);
    input_vals[80] = static_cast<value_t>(-1.79124903678894043);
    input_vals[81] = static_cast<value_t>(-0.30687981843948364);
    input_vals[82] = static_cast<value_t>(-1.17465937137603760);
    input_vals[83] = static_cast<value_t>(0.80492395162582397);
    input_vals[84] = static_cast<value_t>(0.94379329681396484);
    input_vals[85] = static_cast<value_t>(-0.37780198454856873);
    input_vals[86] = static_cast<value_t>(1.46436643600463867);
    input_vals[87] = static_cast<value_t>(-1.30744564533233643);
    input_vals[88] = static_cast<value_t>(-0.36443683505058289);
    input_vals[89] = static_cast<value_t>(-0.29546877741813660);
    input_vals[90] = static_cast<value_t>(-1.24604070186614990);
    input_vals[91] = static_cast<value_t>(-0.72595262527465820);
    input_vals[92] = static_cast<value_t>(-1.70280134677886963);
    input_vals[93] = static_cast<value_t>(0.31912007927894592);
    input_vals[94] = static_cast<value_t>(0.25912556052207947);
    input_vals[95] = static_cast<value_t>(-0.32171306014060974);
    input = input_vals;

    // Run upsample with NEAREST mode
    Tensor<value_t> result = math::upsample<value_t>(
        input, 2, UpsampleMode::NEAREST
    );

    std::vector<value_t> expected(294);
    expected[0] = static_cast<value_t>(-0.18773493170738220);
    expected[1] = static_cast<value_t>(-0.18773493170738220);
    expected[2] = static_cast<value_t>(2.44063687324523926);
    expected[3] = static_cast<value_t>(2.44063687324523926);
    expected[4] = static_cast<value_t>(-0.94090783596038818);
    expected[5] = static_cast<value_t>(-0.94090783596038818);
    expected[6] = static_cast<value_t>(0.61391162872314453);
    expected[7] = static_cast<value_t>(-0.18773493170738220);
    expected[8] = static_cast<value_t>(-0.18773493170738220);
    expected[9] = static_cast<value_t>(2.44063687324523926);
    expected[10] = static_cast<value_t>(2.44063687324523926);
    expected[11] = static_cast<value_t>(-0.94090783596038818);
    expected[12] = static_cast<value_t>(-0.94090783596038818);
    expected[13] = static_cast<value_t>(0.61391162872314453);
    expected[14] = static_cast<value_t>(0.73562669754028320);
    expected[15] = static_cast<value_t>(0.73562669754028320);
    expected[16] = static_cast<value_t>(0.97291791439056396);
    expected[17] = static_cast<value_t>(0.97291791439056396);
    expected[18] = static_cast<value_t>(0.25919494032859802);
    expected[19] = static_cast<value_t>(0.25919494032859802);
    expected[20] = static_cast<value_t>(-0.07407491654157639);
    expected[21] = static_cast<value_t>(0.73562669754028320);
    expected[22] = static_cast<value_t>(0.73562669754028320);
    expected[23] = static_cast<value_t>(0.97291791439056396);
    expected[24] = static_cast<value_t>(0.97291791439056396);
    expected[25] = static_cast<value_t>(0.25919494032859802);
    expected[26] = static_cast<value_t>(0.25919494032859802);
    expected[27] = static_cast<value_t>(-0.07407491654157639);
    expected[28] = static_cast<value_t>(-0.17768801748752594);
    expected[29] = static_cast<value_t>(-0.17768801748752594);
    expected[30] = static_cast<value_t>(-0.83874356746673584);
    expected[31] = static_cast<value_t>(-0.83874356746673584);
    expected[32] = static_cast<value_t>(-0.15628711879253387);
    expected[33] = static_cast<value_t>(-0.15628711879253387);
    expected[34] = static_cast<value_t>(-0.34176161885261536);
    expected[35] = static_cast<value_t>(-0.17768801748752594);
    expected[36] = static_cast<value_t>(-0.17768801748752594);
    expected[37] = static_cast<value_t>(-0.83874356746673584);
    expected[38] = static_cast<value_t>(-0.83874356746673584);
    expected[39] = static_cast<value_t>(-0.15628711879253387);
    expected[40] = static_cast<value_t>(-0.15628711879253387);
    expected[41] = static_cast<value_t>(-0.34176161885261536);
    expected[42] = static_cast<value_t>(0.81873029470443726);
    expected[43] = static_cast<value_t>(0.81873029470443726);
    expected[44] = static_cast<value_t>(-0.09261394292116165);
    expected[45] = static_cast<value_t>(-0.09261394292116165);
    expected[46] = static_cast<value_t>(0.50808095932006836);
    expected[47] = static_cast<value_t>(0.50808095932006836);
    expected[48] = static_cast<value_t>(-1.75422251224517822);
    expected[49] = static_cast<value_t>(-0.36481797695159912);
    expected[50] = static_cast<value_t>(-0.36481797695159912);
    expected[51] = static_cast<value_t>(-0.03091854602098465);
    expected[52] = static_cast<value_t>(-0.03091854602098465);
    expected[53] = static_cast<value_t>(-0.12614427506923676);
    expected[54] = static_cast<value_t>(-0.12614427506923676);
    expected[55] = static_cast<value_t>(0.29918101429939270);
    expected[56] = static_cast<value_t>(-0.36481797695159912);
    expected[57] = static_cast<value_t>(-0.36481797695159912);
    expected[58] = static_cast<value_t>(-0.03091854602098465);
    expected[59] = static_cast<value_t>(-0.03091854602098465);
    expected[60] = static_cast<value_t>(-0.12614427506923676);
    expected[61] = static_cast<value_t>(-0.12614427506923676);
    expected[62] = static_cast<value_t>(0.29918101429939270);
    expected[63] = static_cast<value_t>(1.82207405567169189);
    expected[64] = static_cast<value_t>(1.82207405567169189);
    expected[65] = static_cast<value_t>(1.41717684268951416);
    expected[66] = static_cast<value_t>(1.41717684268951416);
    expected[67] = static_cast<value_t>(-0.45731621980667114);
    expected[68] = static_cast<value_t>(-0.45731621980667114);
    expected[69] = static_cast<value_t>(0.86019957065582275);
    expected[70] = static_cast<value_t>(1.82207405567169189);
    expected[71] = static_cast<value_t>(1.82207405567169189);
    expected[72] = static_cast<value_t>(1.41717684268951416);
    expected[73] = static_cast<value_t>(1.41717684268951416);
    expected[74] = static_cast<value_t>(-0.45731621980667114);
    expected[75] = static_cast<value_t>(-0.45731621980667114);
    expected[76] = static_cast<value_t>(0.86019957065582275);
    expected[77] = static_cast<value_t>(0.28468257188796997);
    expected[78] = static_cast<value_t>(0.28468257188796997);
    expected[79] = static_cast<value_t>(0.51062750816345215);
    expected[80] = static_cast<value_t>(0.51062750816345215);
    expected[81] = static_cast<value_t>(1.57829451560974121);
    expected[82] = static_cast<value_t>(1.57829451560974121);
    expected[83] = static_cast<value_t>(0.16130870580673218);
    expected[84] = static_cast<value_t>(0.28468257188796997);
    expected[85] = static_cast<value_t>(0.28468257188796997);
    expected[86] = static_cast<value_t>(0.51062750816345215);
    expected[87] = static_cast<value_t>(0.51062750816345215);
    expected[88] = static_cast<value_t>(1.57829451560974121);
    expected[89] = static_cast<value_t>(1.57829451560974121);
    expected[90] = static_cast<value_t>(0.16130870580673218);
    expected[91] = static_cast<value_t>(0.71819657087326050);
    expected[92] = static_cast<value_t>(0.71819657087326050);
    expected[93] = static_cast<value_t>(-0.80599582195281982);
    expected[94] = static_cast<value_t>(-0.80599582195281982);
    expected[95] = static_cast<value_t>(-0.59818083047866821);
    expected[96] = static_cast<value_t>(-0.59818083047866821);
    expected[97] = static_cast<value_t>(1.32383632659912109);
    expected[98] = static_cast<value_t>(1.13726711273193359);
    expected[99] = static_cast<value_t>(1.13726711273193359);
    expected[100] = static_cast<value_t>(-0.48833018541336060);
    expected[101] = static_cast<value_t>(-0.48833018541336060);
    expected[102] = static_cast<value_t>(0.34806743264198303);
    expected[103] = static_cast<value_t>(0.34806743264198303);
    expected[104] = static_cast<value_t>(-0.97086137533187866);
    expected[105] = static_cast<value_t>(1.13726711273193359);
    expected[106] = static_cast<value_t>(1.13726711273193359);
    expected[107] = static_cast<value_t>(-0.48833018541336060);
    expected[108] = static_cast<value_t>(-0.48833018541336060);
    expected[109] = static_cast<value_t>(0.34806743264198303);
    expected[110] = static_cast<value_t>(0.34806743264198303);
    expected[111] = static_cast<value_t>(-0.97086137533187866);
    expected[112] = static_cast<value_t>(-0.21213643252849579);
    expected[113] = static_cast<value_t>(-0.21213643252849579);
    expected[114] = static_cast<value_t>(0.42335104942321777);
    expected[115] = static_cast<value_t>(0.42335104942321777);
    expected[116] = static_cast<value_t>(0.10377003252506256);
    expected[117] = static_cast<value_t>(0.10377003252506256);
    expected[118] = static_cast<value_t>(0.05097480863332748);
    expected[119] = static_cast<value_t>(-0.21213643252849579);
    expected[120] = static_cast<value_t>(-0.21213643252849579);
    expected[121] = static_cast<value_t>(0.42335104942321777);
    expected[122] = static_cast<value_t>(0.42335104942321777);
    expected[123] = static_cast<value_t>(0.10377003252506256);
    expected[124] = static_cast<value_t>(0.10377003252506256);
    expected[125] = static_cast<value_t>(0.05097480863332748);
    expected[126] = static_cast<value_t>(-0.67144066095352173);
    expected[127] = static_cast<value_t>(-0.67144066095352173);
    expected[128] = static_cast<value_t>(0.27170252799987793);
    expected[129] = static_cast<value_t>(0.27170252799987793);
    expected[130] = static_cast<value_t>(0.00701349042356014);
    expected[131] = static_cast<value_t>(0.00701349042356014);
    expected[132] = static_cast<value_t>(0.32662299275398254);
    expected[133] = static_cast<value_t>(-0.67144066095352173);
    expected[134] = static_cast<value_t>(-0.67144066095352173);
    expected[135] = static_cast<value_t>(0.27170252799987793);
    expected[136] = static_cast<value_t>(0.27170252799987793);
    expected[137] = static_cast<value_t>(0.00701349042356014);
    expected[138] = static_cast<value_t>(0.00701349042356014);
    expected[139] = static_cast<value_t>(0.32662299275398254);
    expected[140] = static_cast<value_t>(0.03618144616484642);
    expected[141] = static_cast<value_t>(0.03618144616484642);
    expected[142] = static_cast<value_t>(-1.19327843189239502);
    expected[143] = static_cast<value_t>(-1.19327843189239502);
    expected[144] = static_cast<value_t>(-0.15810170769691467);
    expected[145] = static_cast<value_t>(-0.15810170769691467);
    expected[146] = static_cast<value_t>(0.01341776456683874);
    expected[147] = static_cast<value_t>(-0.47234681248664856);
    expected[148] = static_cast<value_t>(-0.47234681248664856);
    expected[149] = static_cast<value_t>(-0.20810645818710327);
    expected[150] = static_cast<value_t>(-0.20810645818710327);
    expected[151] = static_cast<value_t>(1.44154405593872070);
    expected[152] = static_cast<value_t>(1.44154405593872070);
    expected[153] = static_cast<value_t>(-1.67109525203704834);
    expected[154] = static_cast<value_t>(-0.47234681248664856);
    expected[155] = static_cast<value_t>(-0.47234681248664856);
    expected[156] = static_cast<value_t>(-0.20810645818710327);
    expected[157] = static_cast<value_t>(-0.20810645818710327);
    expected[158] = static_cast<value_t>(1.44154405593872070);
    expected[159] = static_cast<value_t>(1.44154405593872070);
    expected[160] = static_cast<value_t>(-1.67109525203704834);
    expected[161] = static_cast<value_t>(0.54455935955047607);
    expected[162] = static_cast<value_t>(0.54455935955047607);
    expected[163] = static_cast<value_t>(1.26132178306579590);
    expected[164] = static_cast<value_t>(1.26132178306579590);
    expected[165] = static_cast<value_t>(0.96283698081970215);
    expected[166] = static_cast<value_t>(0.96283698081970215);
    expected[167] = static_cast<value_t>(-0.27990168333053589);
    expected[168] = static_cast<value_t>(0.54455935955047607);
    expected[169] = static_cast<value_t>(0.54455935955047607);
    expected[170] = static_cast<value_t>(1.26132178306579590);
    expected[171] = static_cast<value_t>(1.26132178306579590);
    expected[172] = static_cast<value_t>(0.96283698081970215);
    expected[173] = static_cast<value_t>(0.96283698081970215);
    expected[174] = static_cast<value_t>(-0.27990168333053589);
    expected[175] = static_cast<value_t>(-0.23044776916503906);
    expected[176] = static_cast<value_t>(-0.23044776916503906);
    expected[177] = static_cast<value_t>(0.45213428139686584);
    expected[178] = static_cast<value_t>(0.45213428139686584);
    expected[179] = static_cast<value_t>(-0.35421076416969299);
    expected[180] = static_cast<value_t>(-0.35421076416969299);
    expected[181] = static_cast<value_t>(0.34015303850173950);
    expected[182] = static_cast<value_t>(-0.23044776916503906);
    expected[183] = static_cast<value_t>(-0.23044776916503906);
    expected[184] = static_cast<value_t>(0.45213428139686584);
    expected[185] = static_cast<value_t>(0.45213428139686584);
    expected[186] = static_cast<value_t>(-0.35421076416969299);
    expected[187] = static_cast<value_t>(-0.35421076416969299);
    expected[188] = static_cast<value_t>(0.34015303850173950);
    expected[189] = static_cast<value_t>(0.63620221614837646);
    expected[190] = static_cast<value_t>(0.63620221614837646);
    expected[191] = static_cast<value_t>(0.75003236532211304);
    expected[192] = static_cast<value_t>(0.75003236532211304);
    expected[193] = static_cast<value_t>(1.35073781013488770);
    expected[194] = static_cast<value_t>(1.35073781013488770);
    expected[195] = static_cast<value_t>(-0.28858894109725952);
    expected[196] = static_cast<value_t>(0.08703627437353134);
    expected[197] = static_cast<value_t>(0.08703627437353134);
    expected[198] = static_cast<value_t>(-0.08413141965866089);
    expected[199] = static_cast<value_t>(-0.08413141965866089);
    expected[200] = static_cast<value_t>(-0.99903649091720581);
    expected[201] = static_cast<value_t>(-0.99903649091720581);
    expected[202] = static_cast<value_t>(0.10133759677410126);
    expected[203] = static_cast<value_t>(0.08703627437353134);
    expected[204] = static_cast<value_t>(0.08703627437353134);
    expected[205] = static_cast<value_t>(-0.08413141965866089);
    expected[206] = static_cast<value_t>(-0.08413141965866089);
    expected[207] = static_cast<value_t>(-0.99903649091720581);
    expected[208] = static_cast<value_t>(-0.99903649091720581);
    expected[209] = static_cast<value_t>(0.10133759677410126);
    expected[210] = static_cast<value_t>(0.29759278893470764);
    expected[211] = static_cast<value_t>(0.29759278893470764);
    expected[212] = static_cast<value_t>(0.27976626157760620);
    expected[213] = static_cast<value_t>(0.27976626157760620);
    expected[214] = static_cast<value_t>(-1.30103170871734619);
    expected[215] = static_cast<value_t>(-1.30103170871734619);
    expected[216] = static_cast<value_t>(-0.10640070587396622);
    expected[217] = static_cast<value_t>(0.29759278893470764);
    expected[218] = static_cast<value_t>(0.29759278893470764);
    expected[219] = static_cast<value_t>(0.27976626157760620);
    expected[220] = static_cast<value_t>(0.27976626157760620);
    expected[221] = static_cast<value_t>(-1.30103170871734619);
    expected[222] = static_cast<value_t>(-1.30103170871734619);
    expected[223] = static_cast<value_t>(-0.10640070587396622);
    expected[224] = static_cast<value_t>(-0.67162758111953735);
    expected[225] = static_cast<value_t>(-0.67162758111953735);
    expected[226] = static_cast<value_t>(-0.47094598412513733);
    expected[227] = static_cast<value_t>(-0.47094598412513733);
    expected[228] = static_cast<value_t>(1.06090152263641357);
    expected[229] = static_cast<value_t>(1.06090152263641357);
    expected[230] = static_cast<value_t>(0.20384488999843597);
    expected[231] = static_cast<value_t>(-0.67162758111953735);
    expected[232] = static_cast<value_t>(-0.67162758111953735);
    expected[233] = static_cast<value_t>(-0.47094598412513733);
    expected[234] = static_cast<value_t>(-0.47094598412513733);
    expected[235] = static_cast<value_t>(1.06090152263641357);
    expected[236] = static_cast<value_t>(1.06090152263641357);
    expected[237] = static_cast<value_t>(0.20384488999843597);
    expected[238] = static_cast<value_t>(0.41963556408882141);
    expected[239] = static_cast<value_t>(0.41963556408882141);
    expected[240] = static_cast<value_t>(1.59819400310516357);
    expected[241] = static_cast<value_t>(1.59819400310516357);
    expected[242] = static_cast<value_t>(0.21556393802165985);
    expected[243] = static_cast<value_t>(0.21556393802165985);
    expected[244] = static_cast<value_t>(1.84750485420227051);
    expected[245] = static_cast<value_t>(-1.79124903678894043);
    expected[246] = static_cast<value_t>(-1.79124903678894043);
    expected[247] = static_cast<value_t>(-0.30687981843948364);
    expected[248] = static_cast<value_t>(-0.30687981843948364);
    expected[249] = static_cast<value_t>(-1.17465937137603760);
    expected[250] = static_cast<value_t>(-1.17465937137603760);
    expected[251] = static_cast<value_t>(0.80492395162582397);
    expected[252] = static_cast<value_t>(-1.79124903678894043);
    expected[253] = static_cast<value_t>(-1.79124903678894043);
    expected[254] = static_cast<value_t>(-0.30687981843948364);
    expected[255] = static_cast<value_t>(-0.30687981843948364);
    expected[256] = static_cast<value_t>(-1.17465937137603760);
    expected[257] = static_cast<value_t>(-1.17465937137603760);
    expected[258] = static_cast<value_t>(0.80492395162582397);
    expected[259] = static_cast<value_t>(0.94379329681396484);
    expected[260] = static_cast<value_t>(0.94379329681396484);
    expected[261] = static_cast<value_t>(-0.37780198454856873);
    expected[262] = static_cast<value_t>(-0.37780198454856873);
    expected[263] = static_cast<value_t>(1.46436643600463867);
    expected[264] = static_cast<value_t>(1.46436643600463867);
    expected[265] = static_cast<value_t>(-1.30744564533233643);
    expected[266] = static_cast<value_t>(0.94379329681396484);
    expected[267] = static_cast<value_t>(0.94379329681396484);
    expected[268] = static_cast<value_t>(-0.37780198454856873);
    expected[269] = static_cast<value_t>(-0.37780198454856873);
    expected[270] = static_cast<value_t>(1.46436643600463867);
    expected[271] = static_cast<value_t>(1.46436643600463867);
    expected[272] = static_cast<value_t>(-1.30744564533233643);
    expected[273] = static_cast<value_t>(-0.36443683505058289);
    expected[274] = static_cast<value_t>(-0.36443683505058289);
    expected[275] = static_cast<value_t>(-0.29546877741813660);
    expected[276] = static_cast<value_t>(-0.29546877741813660);
    expected[277] = static_cast<value_t>(-1.24604070186614990);
    expected[278] = static_cast<value_t>(-1.24604070186614990);
    expected[279] = static_cast<value_t>(-0.72595262527465820);
    expected[280] = static_cast<value_t>(-0.36443683505058289);
    expected[281] = static_cast<value_t>(-0.36443683505058289);
    expected[282] = static_cast<value_t>(-0.29546877741813660);
    expected[283] = static_cast<value_t>(-0.29546877741813660);
    expected[284] = static_cast<value_t>(-1.24604070186614990);
    expected[285] = static_cast<value_t>(-1.24604070186614990);
    expected[286] = static_cast<value_t>(-0.72595262527465820);
    expected[287] = static_cast<value_t>(-1.70280134677886963);
    expected[288] = static_cast<value_t>(-1.70280134677886963);
    expected[289] = static_cast<value_t>(0.31912007927894592);
    expected[290] = static_cast<value_t>(0.31912007927894592);
    expected[291] = static_cast<value_t>(0.25912556052207947);
    expected[292] = static_cast<value_t>(0.25912556052207947);
    expected[293] = static_cast<value_t>(-0.32171306014060974);

    std::vector<value_t> host(expected.size());
    g_sycl_queue.memcpy(host.data(), result.m_p_data.get(),
                        host.size() * sizeof(value_t)).wait();

    // Compare results
    for (size_t i = 0; i < host.size(); ++i)
    {
        if constexpr (std::is_floating_point<value_t>::value)
        {
            EXPECT_NEAR(static_cast<double>(host[i]),
                        static_cast<double>(expected[i]), 0.0001);
        }
        else
        {
            EXPECT_EQ(host[i], expected[i]);
        }
    }
}

/**
 * @test TypedUpsample.zeros_stride1_identity
 * @brief Upsample ZEROS mode test: 
 *   input shape: [2, 3, 3]
 *   stride: 1
 *   output shape: (2, 3, 3)
 */
TYPED_TEST(TypedUpsample, zeros_stride1_identity)
{
    using value_t = TypeParam;

    Tensor<value_t> input(
        {2, 3, 3},
        MemoryLocation:: DEVICE
    );

    std::vector<value_t> input_vals(18);
    input_vals[0] = static_cast<value_t>(0.32859709858894348);
    input_vals[1] = static_cast<value_t>(-0.79619854688644409);
    input_vals[2] = static_cast<value_t>(1.40312385559082031);
    input_vals[3] = static_cast<value_t>(-1.54779279232025146);
    input_vals[4] = static_cast<value_t>(1.16673028469085693);
    input_vals[5] = static_cast<value_t>(1.14772260189056396);
    input_vals[6] = static_cast<value_t>(0.13010932505130768);
    input_vals[7] = static_cast<value_t>(0.43142235279083252);
    input_vals[8] = static_cast<value_t>(-0.86831974983215332);
    input_vals[9] = static_cast<value_t>(0.02715937048196793);
    input_vals[10] = static_cast<value_t>(-1.51873922348022461);
    input_vals[11] = static_cast<value_t>(-0.81556141376495361);
    input_vals[12] = static_cast<value_t>(-0.22363746166229248);
    input_vals[13] = static_cast<value_t>(-2.63109612464904785);
    input_vals[14] = static_cast<value_t>(0.04686695337295532);
    input_vals[15] = static_cast<value_t>(-0.37692171335220337);
    input_vals[16] = static_cast<value_t>(-0.16284018754959106);
    input_vals[17] = static_cast<value_t>(-0.74491786956787109);
    input = input_vals;

    // Run upsample with ZEROS mode
    Tensor<value_t> result = math::upsample<value_t>(
        input, 1, UpsampleMode::ZEROS
    );

    std::vector<value_t> expected(18);
    expected[0] = static_cast<value_t>(0.32859709858894348);
    expected[1] = static_cast<value_t>(-0.79619854688644409);
    expected[2] = static_cast<value_t>(1.40312385559082031);
    expected[3] = static_cast<value_t>(-1.54779279232025146);
    expected[4] = static_cast<value_t>(1.16673028469085693);
    expected[5] = static_cast<value_t>(1.14772260189056396);
    expected[6] = static_cast<value_t>(0.13010932505130768);
    expected[7] = static_cast<value_t>(0.43142235279083252);
    expected[8] = static_cast<value_t>(-0.86831974983215332);
    expected[9] = static_cast<value_t>(0.02715937048196793);
    expected[10] = static_cast<value_t>(-1.51873922348022461);
    expected[11] = static_cast<value_t>(-0.81556141376495361);
    expected[12] = static_cast<value_t>(-0.22363746166229248);
    expected[13] = static_cast<value_t>(-2.63109612464904785);
    expected[14] = static_cast<value_t>(0.04686695337295532);
    expected[15] = static_cast<value_t>(-0.37692171335220337);
    expected[16] = static_cast<value_t>(-0.16284018754959106);
    expected[17] = static_cast<value_t>(-0.74491786956787109);

    std::vector<value_t> host(expected.size());
    g_sycl_queue.memcpy(host.data(), result.m_p_data.get(),
                        host.size() * sizeof(value_t)).wait();

    // Compare results
    for (size_t i = 0; i < host.size(); ++i)
    {
        if constexpr (std::is_floating_point<value_t>::value)
        {
            EXPECT_NEAR(static_cast<double>(host[i]),
                        static_cast<double>(expected[i]), 0.0001);
        }
        else
        {
            EXPECT_EQ(host[i], expected[i]);
        }
    }
}

/**
 * @test TypedUpsample.nearest_stride1_identity
 * @brief Upsample NEAREST mode test: 
 *   input shape: [2, 3, 3]
 *   stride: 1
 *   output shape: (2, 3, 3)
 */
TYPED_TEST(TypedUpsample, nearest_stride1_identity)
{
    using value_t = TypeParam;

    Tensor<value_t> input(
        {2, 3, 3},
        MemoryLocation:: DEVICE
    );

    std::vector<value_t> input_vals(18);
    input_vals[0] = static_cast<value_t>(-1.13383829593658447);
    input_vals[1] = static_cast<value_t>(0.38431918621063232);
    input_vals[2] = static_cast<value_t>(1.49655377864837646);
    input_vals[3] = static_cast<value_t>(-0.35538229346275330);
    input_vals[4] = static_cast<value_t>(-0.78753352165222168);
    input_vals[5] = static_cast<value_t>(-0.45943892002105713);
    input_vals[6] = static_cast<value_t>(-0.05916877090930939);
    input_vals[7] = static_cast<value_t>(-0.35417351126670837);
    input_vals[8] = static_cast<value_t>(-0.73552304506301880);
    input_vals[9] = static_cast<value_t>(-1.18393993377685547);
    input_vals[10] = static_cast<value_t>(0.23889413475990295);
    input_vals[11] = static_cast<value_t>(-0.58992028236389160);
    input_vals[12] = static_cast<value_t>(-1.44058513641357422);
    input_vals[13] = static_cast<value_t>(0.77370309829711914);
    input_vals[14] = static_cast<value_t>(-1.02796733379364014);
    input_vals[15] = static_cast<value_t>(-0.09098625183105469);
    input_vals[16] = static_cast<value_t>(0.49200299382209778);
    input_vals[17] = static_cast<value_t>(0.42467221617698669);
    input = input_vals;

    // Run upsample with NEAREST mode
    Tensor<value_t> result = math::upsample<value_t>(
        input, 1, UpsampleMode::NEAREST
    );

    std::vector<value_t> expected(18);
    expected[0] = static_cast<value_t>(-1.13383829593658447);
    expected[1] = static_cast<value_t>(0.38431918621063232);
    expected[2] = static_cast<value_t>(1.49655377864837646);
    expected[3] = static_cast<value_t>(-0.35538229346275330);
    expected[4] = static_cast<value_t>(-0.78753352165222168);
    expected[5] = static_cast<value_t>(-0.45943892002105713);
    expected[6] = static_cast<value_t>(-0.05916877090930939);
    expected[7] = static_cast<value_t>(-0.35417351126670837);
    expected[8] = static_cast<value_t>(-0.73552304506301880);
    expected[9] = static_cast<value_t>(-1.18393993377685547);
    expected[10] = static_cast<value_t>(0.23889413475990295);
    expected[11] = static_cast<value_t>(-0.58992028236389160);
    expected[12] = static_cast<value_t>(-1.44058513641357422);
    expected[13] = static_cast<value_t>(0.77370309829711914);
    expected[14] = static_cast<value_t>(-1.02796733379364014);
    expected[15] = static_cast<value_t>(-0.09098625183105469);
    expected[16] = static_cast<value_t>(0.49200299382209778);
    expected[17] = static_cast<value_t>(0.42467221617698669);

    std::vector<value_t> host(expected.size());
    g_sycl_queue.memcpy(host.data(), result.m_p_data.get(),
                        host.size() * sizeof(value_t)).wait();

    // Compare results
    for (size_t i = 0; i < host.size(); ++i)
    {
        if constexpr (std::is_floating_point<value_t>::value)
        {
            EXPECT_NEAR(static_cast<double>(host[i]),
                        static_cast<double>(expected[i]), 0.0001);
        }
        else
        {
            EXPECT_EQ(host[i], expected[i]);
        }
    }
}

/**
 * @test TypedUpsample.zeros_large_stride5
 * @brief Upsample ZEROS mode test: 
 *   input shape: [1, 2, 2]
 *   stride: 5
 *   output shape: (1, 6, 6)
 */
TYPED_TEST(TypedUpsample, zeros_large_stride5)
{
    using value_t = TypeParam;

    Tensor<value_t> input(
        {1, 2, 2},
        MemoryLocation:: DEVICE
    );

    std::vector<value_t> input_vals(4);
    input_vals[0] = static_cast<value_t>(1.47773075103759766);
    input_vals[1] = static_cast<value_t>(-1.31593620777130127);
    input_vals[2] = static_cast<value_t>(0.58351331949234009);
    input_vals[3] = static_cast<value_t>(0.48563247919082642);
    input = input_vals;

    // Run upsample with ZEROS mode
    Tensor<value_t> result = math::upsample<value_t>(
        input, 5, UpsampleMode::ZEROS
    );

    std::vector<value_t> expected(36);
    expected[0] = static_cast<value_t>(1.47773075103759766);
    expected[1] = static_cast<value_t>(0.00000000000000000);
    expected[2] = static_cast<value_t>(0.00000000000000000);
    expected[3] = static_cast<value_t>(0.00000000000000000);
    expected[4] = static_cast<value_t>(0.00000000000000000);
    expected[5] = static_cast<value_t>(-1.31593620777130127);
    expected[6] = static_cast<value_t>(0.00000000000000000);
    expected[7] = static_cast<value_t>(0.00000000000000000);
    expected[8] = static_cast<value_t>(0.00000000000000000);
    expected[9] = static_cast<value_t>(0.00000000000000000);
    expected[10] = static_cast<value_t>(0.00000000000000000);
    expected[11] = static_cast<value_t>(0.00000000000000000);
    expected[12] = static_cast<value_t>(0.00000000000000000);
    expected[13] = static_cast<value_t>(0.00000000000000000);
    expected[14] = static_cast<value_t>(0.00000000000000000);
    expected[15] = static_cast<value_t>(0.00000000000000000);
    expected[16] = static_cast<value_t>(0.00000000000000000);
    expected[17] = static_cast<value_t>(0.00000000000000000);
    expected[18] = static_cast<value_t>(0.00000000000000000);
    expected[19] = static_cast<value_t>(0.00000000000000000);
    expected[20] = static_cast<value_t>(0.00000000000000000);
    expected[21] = static_cast<value_t>(0.00000000000000000);
    expected[22] = static_cast<value_t>(0.00000000000000000);
    expected[23] = static_cast<value_t>(0.00000000000000000);
    expected[24] = static_cast<value_t>(0.00000000000000000);
    expected[25] = static_cast<value_t>(0.00000000000000000);
    expected[26] = static_cast<value_t>(0.00000000000000000);
    expected[27] = static_cast<value_t>(0.00000000000000000);
    expected[28] = static_cast<value_t>(0.00000000000000000);
    expected[29] = static_cast<value_t>(0.00000000000000000);
    expected[30] = static_cast<value_t>(0.58351331949234009);
    expected[31] = static_cast<value_t>(0.00000000000000000);
    expected[32] = static_cast<value_t>(0.00000000000000000);
    expected[33] = static_cast<value_t>(0.00000000000000000);
    expected[34] = static_cast<value_t>(0.00000000000000000);
    expected[35] = static_cast<value_t>(0.48563247919082642);

    std::vector<value_t> host(expected.size());
    g_sycl_queue.memcpy(host.data(), result.m_p_data.get(),
                        host.size() * sizeof(value_t)).wait();

    // Compare results
    for (size_t i = 0; i < host.size(); ++i)
    {
        if constexpr (std::is_floating_point<value_t>::value)
        {
            EXPECT_NEAR(static_cast<double>(host[i]),
                        static_cast<double>(expected[i]), 0.0001);
        }
        else
        {
            EXPECT_EQ(host[i], expected[i]);
        }
    }
}

/**
 * @test TypedUpsample.nearest_large_stride5
 * @brief Upsample NEAREST mode test: 
 *   input shape: [1, 2, 2]
 *   stride: 5
 *   output shape: (1, 6, 6)
 */
TYPED_TEST(TypedUpsample, nearest_large_stride5)
{
    using value_t = TypeParam;

    Tensor<value_t> input(
        {1, 2, 2},
        MemoryLocation:: DEVICE
    );

    std::vector<value_t> input_vals(4);
    input_vals[0] = static_cast<value_t>(-0.14998979866504669);
    input_vals[1] = static_cast<value_t>(0.93275141716003418);
    input_vals[2] = static_cast<value_t>(0.20919939875602722);
    input_vals[3] = static_cast<value_t>(-1.02678322792053223);
    input = input_vals;

    // Run upsample with NEAREST mode
    Tensor<value_t> result = math::upsample<value_t>(
        input, 5, UpsampleMode::NEAREST
    );

    std::vector<value_t> expected(36);
    expected[0] = static_cast<value_t>(-0.14998979866504669);
    expected[1] = static_cast<value_t>(-0.14998979866504669);
    expected[2] = static_cast<value_t>(-0.14998979866504669);
    expected[3] = static_cast<value_t>(-0.14998979866504669);
    expected[4] = static_cast<value_t>(-0.14998979866504669);
    expected[5] = static_cast<value_t>(0.93275141716003418);
    expected[6] = static_cast<value_t>(-0.14998979866504669);
    expected[7] = static_cast<value_t>(-0.14998979866504669);
    expected[8] = static_cast<value_t>(-0.14998979866504669);
    expected[9] = static_cast<value_t>(-0.14998979866504669);
    expected[10] = static_cast<value_t>(-0.14998979866504669);
    expected[11] = static_cast<value_t>(0.93275141716003418);
    expected[12] = static_cast<value_t>(-0.14998979866504669);
    expected[13] = static_cast<value_t>(-0.14998979866504669);
    expected[14] = static_cast<value_t>(-0.14998979866504669);
    expected[15] = static_cast<value_t>(-0.14998979866504669);
    expected[16] = static_cast<value_t>(-0.14998979866504669);
    expected[17] = static_cast<value_t>(0.93275141716003418);
    expected[18] = static_cast<value_t>(-0.14998979866504669);
    expected[19] = static_cast<value_t>(-0.14998979866504669);
    expected[20] = static_cast<value_t>(-0.14998979866504669);
    expected[21] = static_cast<value_t>(-0.14998979866504669);
    expected[22] = static_cast<value_t>(-0.14998979866504669);
    expected[23] = static_cast<value_t>(0.93275141716003418);
    expected[24] = static_cast<value_t>(-0.14998979866504669);
    expected[25] = static_cast<value_t>(-0.14998979866504669);
    expected[26] = static_cast<value_t>(-0.14998979866504669);
    expected[27] = static_cast<value_t>(-0.14998979866504669);
    expected[28] = static_cast<value_t>(-0.14998979866504669);
    expected[29] = static_cast<value_t>(0.93275141716003418);
    expected[30] = static_cast<value_t>(0.20919939875602722);
    expected[31] = static_cast<value_t>(0.20919939875602722);
    expected[32] = static_cast<value_t>(0.20919939875602722);
    expected[33] = static_cast<value_t>(0.20919939875602722);
    expected[34] = static_cast<value_t>(0.20919939875602722);
    expected[35] = static_cast<value_t>(-1.02678322792053223);

    std::vector<value_t> host(expected.size());
    g_sycl_queue.memcpy(host.data(), result.m_p_data.get(),
                        host.size() * sizeof(value_t)).wait();

    // Compare results
    for (size_t i = 0; i < host.size(); ++i)
    {
        if constexpr (std::is_floating_point<value_t>::value)
        {
            EXPECT_NEAR(static_cast<double>(host[i]),
                        static_cast<double>(expected[i]), 0.0001);
        }
        else
        {
            EXPECT_EQ(host[i], expected[i]);
        }
    }
}

/**
 * @test TypedUpsample.zeros_view_with_weird_strides
 * @brief Ensure math::upsample accepts non-contiguous/alias views
 *   Mode: ZEROS
 */
TYPED_TEST(TypedUpsample, zeros_view_with_weird_strides)
{
    using value_t = TypeParam;

    Tensor<value_t> owner({50}, MemoryLocation::DEVICE);
    std::vector<value_t> owner_vals = {
        static_cast<value_t>(0.00000000000000000), static_cast<value_t>(1.00000000000000000), static_cast<value_t>(2.00000000000000000), static_cast<value_t>(3.00000000000000000), static_cast<value_t>(4.00000000000000000), static_cast<value_t>(5.00000000000000000), static_cast<value_t>(6.00000000000000000), static_cast<value_t>(7.00000000000000000), static_cast<value_t>(8.00000000000000000), static_cast<value_t>(9.00000000000000000), static_cast<value_t>(10.00000000000000000), static_cast<value_t>(11.00000000000000000), static_cast<value_t>(12.00000000000000000), static_cast<value_t>(13.00000000000000000), static_cast<value_t>(14.00000000000000000), static_cast<value_t>(15.00000000000000000), static_cast<value_t>(16.00000000000000000), static_cast<value_t>(17.00000000000000000), static_cast<value_t>(18.00000000000000000), static_cast<value_t>(19.00000000000000000), static_cast<value_t>(20.00000000000000000), static_cast<value_t>(21.00000000000000000), static_cast<value_t>(22.00000000000000000), static_cast<value_t>(23.00000000000000000), static_cast<value_t>(24.00000000000000000), static_cast<value_t>(25.00000000000000000), static_cast<value_t>(26.00000000000000000), static_cast<value_t>(27.00000000000000000), static_cast<value_t>(28.00000000000000000), static_cast<value_t>(29.00000000000000000), static_cast<value_t>(30.00000000000000000), static_cast<value_t>(31.00000000000000000), static_cast<value_t>(32.00000000000000000), static_cast<value_t>(33.00000000000000000), static_cast<value_t>(34.00000000000000000), static_cast<value_t>(35.00000000000000000), static_cast<value_t>(36.00000000000000000), static_cast<value_t>(37.00000000000000000), static_cast<value_t>(38.00000000000000000), static_cast<value_t>(39.00000000000000000), static_cast<value_t>(40.00000000000000000), static_cast<value_t>(41.00000000000000000), static_cast<value_t>(42.00000000000000000), static_cast<value_t>(43.00000000000000000), static_cast<value_t>(44.00000000000000000), static_cast<value_t>(45.00000000000000000), static_cast<value_t>(46.00000000000000000), static_cast<value_t>(47.00000000000000000), static_cast<value_t>(48.00000000000000000), static_cast<value_t>(49.00000000000000000)
    };
    owner = owner_vals;

    Tensor<value_t> alias(
        owner,
        std::vector<uint64_t>{0ull},
        std::vector<uint64_t>{2ull, 2ull, 2ull},
        std::vector<uint64_t>{16ull, 8ull, 2ull}
    );

    Tensor<value_t> result = math::upsample<value_t>(
        alias, 2, UpsampleMode::ZEROS
    );

    std::vector<value_t> expected(18);
    expected[0] = static_cast<value_t>(0.00000000000000000);
    expected[1] = static_cast<value_t>(0.00000000000000000);
    expected[2] = static_cast<value_t>(2.00000000000000000);
    expected[3] = static_cast<value_t>(0.00000000000000000);
    expected[4] = static_cast<value_t>(0.00000000000000000);
    expected[5] = static_cast<value_t>(0.00000000000000000);
    expected[6] = static_cast<value_t>(8.00000000000000000);
    expected[7] = static_cast<value_t>(0.00000000000000000);
    expected[8] = static_cast<value_t>(10.00000000000000000);
    expected[9] = static_cast<value_t>(16.00000000000000000);
    expected[10] = static_cast<value_t>(0.00000000000000000);
    expected[11] = static_cast<value_t>(18.00000000000000000);
    expected[12] = static_cast<value_t>(0.00000000000000000);
    expected[13] = static_cast<value_t>(0.00000000000000000);
    expected[14] = static_cast<value_t>(0.00000000000000000);
    expected[15] = static_cast<value_t>(24.00000000000000000);
    expected[16] = static_cast<value_t>(0.00000000000000000);
    expected[17] = static_cast<value_t>(26.00000000000000000);

    std::vector<value_t> host(expected.size());
    g_sycl_queue.memcpy(host.data(), result.m_p_data. get(),
                        host.size() * sizeof(value_t)).wait();

    // compare element-wise
    for (size_t i = 0; i < host.size(); ++i)
    {
        if constexpr (std::is_floating_point<value_t>::value)
        {
            EXPECT_NEAR(static_cast<double>(host[i]),
                        static_cast<double>(expected[i]), 0.0001);
        }
        else
        {
            EXPECT_EQ(host[i], expected[i]);
        }
    }
}

/**
 * @test TypedUpsample.nearest_view_with_weird_strides
 * @brief Ensure math::upsample accepts non-contiguous/alias views
 *   Mode: NEAREST
 */
TYPED_TEST(TypedUpsample, nearest_view_with_weird_strides)
{
    using value_t = TypeParam;

    Tensor<value_t> owner({50}, MemoryLocation:: DEVICE);
    std::vector<value_t> owner_vals = {
        static_cast<value_t>(0.00000000000000000), static_cast<value_t>(1.00000000000000000), static_cast<value_t>(2.00000000000000000), static_cast<value_t>(3.00000000000000000), static_cast<value_t>(4.00000000000000000), static_cast<value_t>(5.00000000000000000), static_cast<value_t>(6.00000000000000000), static_cast<value_t>(7.00000000000000000), static_cast<value_t>(8.00000000000000000), static_cast<value_t>(9.00000000000000000), static_cast<value_t>(10.00000000000000000), static_cast<value_t>(11.00000000000000000), static_cast<value_t>(12.00000000000000000), static_cast<value_t>(13.00000000000000000), static_cast<value_t>(14.00000000000000000), static_cast<value_t>(15.00000000000000000), static_cast<value_t>(16.00000000000000000), static_cast<value_t>(17.00000000000000000), static_cast<value_t>(18.00000000000000000), static_cast<value_t>(19.00000000000000000), static_cast<value_t>(20.00000000000000000), static_cast<value_t>(21.00000000000000000), static_cast<value_t>(22.00000000000000000), static_cast<value_t>(23.00000000000000000), static_cast<value_t>(24.00000000000000000), static_cast<value_t>(25.00000000000000000), static_cast<value_t>(26.00000000000000000), static_cast<value_t>(27.00000000000000000), static_cast<value_t>(28.00000000000000000), static_cast<value_t>(29.00000000000000000), static_cast<value_t>(30.00000000000000000), static_cast<value_t>(31.00000000000000000), static_cast<value_t>(32.00000000000000000), static_cast<value_t>(33.00000000000000000), static_cast<value_t>(34.00000000000000000), static_cast<value_t>(35.00000000000000000), static_cast<value_t>(36.00000000000000000), static_cast<value_t>(37.00000000000000000), static_cast<value_t>(38.00000000000000000), static_cast<value_t>(39.00000000000000000), static_cast<value_t>(40.00000000000000000), static_cast<value_t>(41.00000000000000000), static_cast<value_t>(42.00000000000000000), static_cast<value_t>(43.00000000000000000), static_cast<value_t>(44.00000000000000000), static_cast<value_t>(45.00000000000000000), static_cast<value_t>(46.00000000000000000), static_cast<value_t>(47.00000000000000000), static_cast<value_t>(48.00000000000000000), static_cast<value_t>(49.00000000000000000)
    };
    owner = owner_vals;

    Tensor<value_t> alias(
        owner,
        std::vector<uint64_t>{0ull},
        std::vector<uint64_t>{2ull, 2ull, 2ull},
        std::vector<uint64_t>{16ull, 8ull, 2ull}
    );

    Tensor<value_t> result = math::upsample<value_t>(
        alias, 2, UpsampleMode::NEAREST
    );

    std::vector<value_t> expected(18);
    expected[0] = static_cast<value_t>(0.00000000000000000);
    expected[1] = static_cast<value_t>(0.00000000000000000);
    expected[2] = static_cast<value_t>(2.00000000000000000);
    expected[3] = static_cast<value_t>(0.00000000000000000);
    expected[4] = static_cast<value_t>(0.00000000000000000);
    expected[5] = static_cast<value_t>(2.00000000000000000);
    expected[6] = static_cast<value_t>(8.00000000000000000);
    expected[7] = static_cast<value_t>(8.00000000000000000);
    expected[8] = static_cast<value_t>(10.00000000000000000);
    expected[9] = static_cast<value_t>(16.00000000000000000);
    expected[10] = static_cast<value_t>(16.00000000000000000);
    expected[11] = static_cast<value_t>(18.00000000000000000);
    expected[12] = static_cast<value_t>(16.00000000000000000);
    expected[13] = static_cast<value_t>(16.00000000000000000);
    expected[14] = static_cast<value_t>(18.00000000000000000);
    expected[15] = static_cast<value_t>(24.00000000000000000);
    expected[16] = static_cast<value_t>(24.00000000000000000);
    expected[17] = static_cast<value_t>(26.00000000000000000);

    std::vector<value_t> host(expected.size());
    g_sycl_queue.memcpy(host.data(), result.m_p_data. get(),
                        host.size() * sizeof(value_t)).wait();

    // compare element-wise
    for (size_t i = 0; i < host.size(); ++i)
    {
        if constexpr (std::is_floating_point<value_t>::value)
        {
            EXPECT_NEAR(static_cast<double>(host[i]),
                        static_cast<double>(expected[i]), 0.0001);
        }
        else
        {
            EXPECT_EQ(host[i], expected[i]);
        }
    }
}

/**
 * @test TypedUpsample.zeros_view_nonunit_strides
 * @brief Ensure math::upsample accepts non-contiguous/alias views
 *   Mode: ZEROS
 */
TYPED_TEST(TypedUpsample, zeros_view_nonunit_strides)
{
    using value_t = TypeParam;

    Tensor<value_t> owner({100}, MemoryLocation::DEVICE);
    std::vector<value_t> owner_vals = {
        static_cast<value_t>(0.00000000000000000), static_cast<value_t>(1.00000000000000000), static_cast<value_t>(2.00000000000000000), static_cast<value_t>(3.00000000000000000), static_cast<value_t>(4.00000000000000000), static_cast<value_t>(5.00000000000000000), static_cast<value_t>(6.00000000000000000), static_cast<value_t>(7.00000000000000000), static_cast<value_t>(8.00000000000000000), static_cast<value_t>(9.00000000000000000), static_cast<value_t>(10.00000000000000000), static_cast<value_t>(11.00000000000000000), static_cast<value_t>(12.00000000000000000), static_cast<value_t>(13.00000000000000000), static_cast<value_t>(14.00000000000000000), static_cast<value_t>(15.00000000000000000), static_cast<value_t>(16.00000000000000000), static_cast<value_t>(17.00000000000000000), static_cast<value_t>(18.00000000000000000), static_cast<value_t>(19.00000000000000000), static_cast<value_t>(20.00000000000000000), static_cast<value_t>(21.00000000000000000), static_cast<value_t>(22.00000000000000000), static_cast<value_t>(23.00000000000000000), static_cast<value_t>(24.00000000000000000), static_cast<value_t>(25.00000000000000000), static_cast<value_t>(26.00000000000000000), static_cast<value_t>(27.00000000000000000), static_cast<value_t>(28.00000000000000000), static_cast<value_t>(29.00000000000000000), static_cast<value_t>(30.00000000000000000), static_cast<value_t>(31.00000000000000000), static_cast<value_t>(32.00000000000000000), static_cast<value_t>(33.00000000000000000), static_cast<value_t>(34.00000000000000000), static_cast<value_t>(35.00000000000000000), static_cast<value_t>(36.00000000000000000), static_cast<value_t>(37.00000000000000000), static_cast<value_t>(38.00000000000000000), static_cast<value_t>(39.00000000000000000), static_cast<value_t>(40.00000000000000000), static_cast<value_t>(41.00000000000000000), static_cast<value_t>(42.00000000000000000), static_cast<value_t>(43.00000000000000000), static_cast<value_t>(44.00000000000000000), static_cast<value_t>(45.00000000000000000), static_cast<value_t>(46.00000000000000000), static_cast<value_t>(47.00000000000000000), static_cast<value_t>(48.00000000000000000), static_cast<value_t>(49.00000000000000000), static_cast<value_t>(50.00000000000000000), static_cast<value_t>(51.00000000000000000), static_cast<value_t>(52.00000000000000000), static_cast<value_t>(53.00000000000000000), static_cast<value_t>(54.00000000000000000), static_cast<value_t>(55.00000000000000000), static_cast<value_t>(56.00000000000000000), static_cast<value_t>(57.00000000000000000), static_cast<value_t>(58.00000000000000000), static_cast<value_t>(59.00000000000000000), static_cast<value_t>(60.00000000000000000), static_cast<value_t>(61.00000000000000000), static_cast<value_t>(62.00000000000000000), static_cast<value_t>(63.00000000000000000), static_cast<value_t>(64.00000000000000000), static_cast<value_t>(65.00000000000000000), static_cast<value_t>(66.00000000000000000), static_cast<value_t>(67.00000000000000000), static_cast<value_t>(68.00000000000000000), static_cast<value_t>(69.00000000000000000), static_cast<value_t>(70.00000000000000000), static_cast<value_t>(71.00000000000000000), static_cast<value_t>(72.00000000000000000), static_cast<value_t>(73.00000000000000000), static_cast<value_t>(74.00000000000000000), static_cast<value_t>(75.00000000000000000), static_cast<value_t>(76.00000000000000000), static_cast<value_t>(77.00000000000000000), static_cast<value_t>(78.00000000000000000), static_cast<value_t>(79.00000000000000000), static_cast<value_t>(80.00000000000000000), static_cast<value_t>(81.00000000000000000), static_cast<value_t>(82.00000000000000000), static_cast<value_t>(83.00000000000000000), static_cast<value_t>(84.00000000000000000), static_cast<value_t>(85.00000000000000000), static_cast<value_t>(86.00000000000000000), static_cast<value_t>(87.00000000000000000), static_cast<value_t>(88.00000000000000000), static_cast<value_t>(89.00000000000000000), static_cast<value_t>(90.00000000000000000), static_cast<value_t>(91.00000000000000000), static_cast<value_t>(92.00000000000000000), static_cast<value_t>(93.00000000000000000), static_cast<value_t>(94.00000000000000000), static_cast<value_t>(95.00000000000000000), static_cast<value_t>(96.00000000000000000), static_cast<value_t>(97.00000000000000000), static_cast<value_t>(98.00000000000000000), static_cast<value_t>(99.00000000000000000)
    };
    owner = owner_vals;

    Tensor<value_t> alias(
        owner,
        std::vector<uint64_t>{5ull},
        std::vector<uint64_t>{1ull, 3ull, 3ull},
        std::vector<uint64_t>{27ull, 9ull, 3ull}
    );

    Tensor<value_t> result = math::upsample<value_t>(
        alias, 3, UpsampleMode::ZEROS
    );

    std::vector<value_t> expected(49);
    expected[0] = static_cast<value_t>(5.00000000000000000);
    expected[1] = static_cast<value_t>(0.00000000000000000);
    expected[2] = static_cast<value_t>(0.00000000000000000);
    expected[3] = static_cast<value_t>(8.00000000000000000);
    expected[4] = static_cast<value_t>(0.00000000000000000);
    expected[5] = static_cast<value_t>(0.00000000000000000);
    expected[6] = static_cast<value_t>(11.00000000000000000);
    expected[7] = static_cast<value_t>(0.00000000000000000);
    expected[8] = static_cast<value_t>(0.00000000000000000);
    expected[9] = static_cast<value_t>(0.00000000000000000);
    expected[10] = static_cast<value_t>(0.00000000000000000);
    expected[11] = static_cast<value_t>(0.00000000000000000);
    expected[12] = static_cast<value_t>(0.00000000000000000);
    expected[13] = static_cast<value_t>(0.00000000000000000);
    expected[14] = static_cast<value_t>(0.00000000000000000);
    expected[15] = static_cast<value_t>(0.00000000000000000);
    expected[16] = static_cast<value_t>(0.00000000000000000);
    expected[17] = static_cast<value_t>(0.00000000000000000);
    expected[18] = static_cast<value_t>(0.00000000000000000);
    expected[19] = static_cast<value_t>(0.00000000000000000);
    expected[20] = static_cast<value_t>(0.00000000000000000);
    expected[21] = static_cast<value_t>(14.00000000000000000);
    expected[22] = static_cast<value_t>(0.00000000000000000);
    expected[23] = static_cast<value_t>(0.00000000000000000);
    expected[24] = static_cast<value_t>(17.00000000000000000);
    expected[25] = static_cast<value_t>(0.00000000000000000);
    expected[26] = static_cast<value_t>(0.00000000000000000);
    expected[27] = static_cast<value_t>(20.00000000000000000);
    expected[28] = static_cast<value_t>(0.00000000000000000);
    expected[29] = static_cast<value_t>(0.00000000000000000);
    expected[30] = static_cast<value_t>(0.00000000000000000);
    expected[31] = static_cast<value_t>(0.00000000000000000);
    expected[32] = static_cast<value_t>(0.00000000000000000);
    expected[33] = static_cast<value_t>(0.00000000000000000);
    expected[34] = static_cast<value_t>(0.00000000000000000);
    expected[35] = static_cast<value_t>(0.00000000000000000);
    expected[36] = static_cast<value_t>(0.00000000000000000);
    expected[37] = static_cast<value_t>(0.00000000000000000);
    expected[38] = static_cast<value_t>(0.00000000000000000);
    expected[39] = static_cast<value_t>(0.00000000000000000);
    expected[40] = static_cast<value_t>(0.00000000000000000);
    expected[41] = static_cast<value_t>(0.00000000000000000);
    expected[42] = static_cast<value_t>(23.00000000000000000);
    expected[43] = static_cast<value_t>(0.00000000000000000);
    expected[44] = static_cast<value_t>(0.00000000000000000);
    expected[45] = static_cast<value_t>(26.00000000000000000);
    expected[46] = static_cast<value_t>(0.00000000000000000);
    expected[47] = static_cast<value_t>(0.00000000000000000);
    expected[48] = static_cast<value_t>(29.00000000000000000);

    std::vector<value_t> host(expected.size());
    g_sycl_queue.memcpy(host.data(), result.m_p_data. get(),
                        host.size() * sizeof(value_t)).wait();

    // compare element-wise
    for (size_t i = 0; i < host.size(); ++i)
    {
        if constexpr (std::is_floating_point<value_t>::value)
        {
            EXPECT_NEAR(static_cast<double>(host[i]),
                        static_cast<double>(expected[i]), 0.0001);
        }
        else
        {
            EXPECT_EQ(host[i], expected[i]);
        }
    }
}

/**
 * @test TypedUpsample.nearest_view_nonunit_strides
 * @brief Ensure math::upsample accepts non-contiguous/alias views
 *   Mode: NEAREST
 */
TYPED_TEST(TypedUpsample, nearest_view_nonunit_strides)
{
    using value_t = TypeParam;

    Tensor<value_t> owner({100}, MemoryLocation:: DEVICE);
    std::vector<value_t> owner_vals = {
        static_cast<value_t>(0.00000000000000000), static_cast<value_t>(1.00000000000000000), static_cast<value_t>(2.00000000000000000), static_cast<value_t>(3.00000000000000000), static_cast<value_t>(4.00000000000000000), static_cast<value_t>(5.00000000000000000), static_cast<value_t>(6.00000000000000000), static_cast<value_t>(7.00000000000000000), static_cast<value_t>(8.00000000000000000), static_cast<value_t>(9.00000000000000000), static_cast<value_t>(10.00000000000000000), static_cast<value_t>(11.00000000000000000), static_cast<value_t>(12.00000000000000000), static_cast<value_t>(13.00000000000000000), static_cast<value_t>(14.00000000000000000), static_cast<value_t>(15.00000000000000000), static_cast<value_t>(16.00000000000000000), static_cast<value_t>(17.00000000000000000), static_cast<value_t>(18.00000000000000000), static_cast<value_t>(19.00000000000000000), static_cast<value_t>(20.00000000000000000), static_cast<value_t>(21.00000000000000000), static_cast<value_t>(22.00000000000000000), static_cast<value_t>(23.00000000000000000), static_cast<value_t>(24.00000000000000000), static_cast<value_t>(25.00000000000000000), static_cast<value_t>(26.00000000000000000), static_cast<value_t>(27.00000000000000000), static_cast<value_t>(28.00000000000000000), static_cast<value_t>(29.00000000000000000), static_cast<value_t>(30.00000000000000000), static_cast<value_t>(31.00000000000000000), static_cast<value_t>(32.00000000000000000), static_cast<value_t>(33.00000000000000000), static_cast<value_t>(34.00000000000000000), static_cast<value_t>(35.00000000000000000), static_cast<value_t>(36.00000000000000000), static_cast<value_t>(37.00000000000000000), static_cast<value_t>(38.00000000000000000), static_cast<value_t>(39.00000000000000000), static_cast<value_t>(40.00000000000000000), static_cast<value_t>(41.00000000000000000), static_cast<value_t>(42.00000000000000000), static_cast<value_t>(43.00000000000000000), static_cast<value_t>(44.00000000000000000), static_cast<value_t>(45.00000000000000000), static_cast<value_t>(46.00000000000000000), static_cast<value_t>(47.00000000000000000), static_cast<value_t>(48.00000000000000000), static_cast<value_t>(49.00000000000000000), static_cast<value_t>(50.00000000000000000), static_cast<value_t>(51.00000000000000000), static_cast<value_t>(52.00000000000000000), static_cast<value_t>(53.00000000000000000), static_cast<value_t>(54.00000000000000000), static_cast<value_t>(55.00000000000000000), static_cast<value_t>(56.00000000000000000), static_cast<value_t>(57.00000000000000000), static_cast<value_t>(58.00000000000000000), static_cast<value_t>(59.00000000000000000), static_cast<value_t>(60.00000000000000000), static_cast<value_t>(61.00000000000000000), static_cast<value_t>(62.00000000000000000), static_cast<value_t>(63.00000000000000000), static_cast<value_t>(64.00000000000000000), static_cast<value_t>(65.00000000000000000), static_cast<value_t>(66.00000000000000000), static_cast<value_t>(67.00000000000000000), static_cast<value_t>(68.00000000000000000), static_cast<value_t>(69.00000000000000000), static_cast<value_t>(70.00000000000000000), static_cast<value_t>(71.00000000000000000), static_cast<value_t>(72.00000000000000000), static_cast<value_t>(73.00000000000000000), static_cast<value_t>(74.00000000000000000), static_cast<value_t>(75.00000000000000000), static_cast<value_t>(76.00000000000000000), static_cast<value_t>(77.00000000000000000), static_cast<value_t>(78.00000000000000000), static_cast<value_t>(79.00000000000000000), static_cast<value_t>(80.00000000000000000), static_cast<value_t>(81.00000000000000000), static_cast<value_t>(82.00000000000000000), static_cast<value_t>(83.00000000000000000), static_cast<value_t>(84.00000000000000000), static_cast<value_t>(85.00000000000000000), static_cast<value_t>(86.00000000000000000), static_cast<value_t>(87.00000000000000000), static_cast<value_t>(88.00000000000000000), static_cast<value_t>(89.00000000000000000), static_cast<value_t>(90.00000000000000000), static_cast<value_t>(91.00000000000000000), static_cast<value_t>(92.00000000000000000), static_cast<value_t>(93.00000000000000000), static_cast<value_t>(94.00000000000000000), static_cast<value_t>(95.00000000000000000), static_cast<value_t>(96.00000000000000000), static_cast<value_t>(97.00000000000000000), static_cast<value_t>(98.00000000000000000), static_cast<value_t>(99.00000000000000000)
    };
    owner = owner_vals;

    Tensor<value_t> alias(
        owner,
        std::vector<uint64_t>{5ull},
        std::vector<uint64_t>{1ull, 3ull, 3ull},
        std::vector<uint64_t>{27ull, 9ull, 3ull}
    );

    Tensor<value_t> result = math::upsample<value_t>(
        alias, 3, UpsampleMode::NEAREST
    );
    std::vector<value_t> expected(49);
    expected[0] = static_cast<value_t>(5.00000000000000000);
    expected[1] = static_cast<value_t>(5.00000000000000000);
    expected[2] = static_cast<value_t>(5.00000000000000000);
    expected[3] = static_cast<value_t>(8.00000000000000000);
    expected[4] = static_cast<value_t>(8.00000000000000000);
    expected[5] = static_cast<value_t>(8.00000000000000000);
    expected[6] = static_cast<value_t>(11.00000000000000000);
    expected[7] = static_cast<value_t>(5.00000000000000000);
    expected[8] = static_cast<value_t>(5.00000000000000000);
    expected[9] = static_cast<value_t>(5.00000000000000000);
    expected[10] = static_cast<value_t>(8.00000000000000000);
    expected[11] = static_cast<value_t>(8.00000000000000000);
    expected[12] = static_cast<value_t>(8.00000000000000000);
    expected[13] = static_cast<value_t>(11.00000000000000000);
    expected[14] = static_cast<value_t>(5.00000000000000000);
    expected[15] = static_cast<value_t>(5.00000000000000000);
    expected[16] = static_cast<value_t>(5.00000000000000000);
    expected[17] = static_cast<value_t>(8.00000000000000000);
    expected[18] = static_cast<value_t>(8.00000000000000000);
    expected[19] = static_cast<value_t>(8.00000000000000000);
    expected[20] = static_cast<value_t>(11.00000000000000000);
    expected[21] = static_cast<value_t>(14.00000000000000000);
    expected[22] = static_cast<value_t>(14.00000000000000000);
    expected[23] = static_cast<value_t>(14.00000000000000000);
    expected[24] = static_cast<value_t>(17.00000000000000000);
    expected[25] = static_cast<value_t>(17.00000000000000000);
    expected[26] = static_cast<value_t>(17.00000000000000000);
    expected[27] = static_cast<value_t>(20.00000000000000000);
    expected[28] = static_cast<value_t>(14.00000000000000000);
    expected[29] = static_cast<value_t>(14.00000000000000000);
    expected[30] = static_cast<value_t>(14.00000000000000000);
    expected[31] = static_cast<value_t>(17.00000000000000000);
    expected[32] = static_cast<value_t>(17.00000000000000000);
    expected[33] = static_cast<value_t>(17.00000000000000000);
    expected[34] = static_cast<value_t>(20.00000000000000000);
    expected[35] = static_cast<value_t>(14.00000000000000000);
    expected[36] = static_cast<value_t>(14.00000000000000000);
    expected[37] = static_cast<value_t>(14.00000000000000000);
    expected[38] = static_cast<value_t>(17.00000000000000000);
    expected[39] = static_cast<value_t>(17.00000000000000000);
    expected[40] = static_cast<value_t>(17.00000000000000000);
    expected[41] = static_cast<value_t>(20.00000000000000000);
    expected[42] = static_cast<value_t>(23.00000000000000000);
    expected[43] = static_cast<value_t>(23.00000000000000000);
    expected[44] = static_cast<value_t>(23.00000000000000000);
    expected[45] = static_cast<value_t>(26.00000000000000000);
    expected[46] = static_cast<value_t>(26.00000000000000000);
    expected[47] = static_cast<value_t>(26.00000000000000000);
    expected[48] = static_cast<value_t>(29.00000000000000000);

    std::vector<value_t> host(expected.size());
    g_sycl_queue.memcpy(host.data(), result.m_p_data. get(),
                        host.size() * sizeof(value_t)).wait();

    // compare element-wise
    for (size_t i = 0; i < host.size(); ++i)
    {
        if constexpr (std::is_floating_point<value_t>::value)
        {
            EXPECT_NEAR(static_cast<double>(host[i]),
                        static_cast<double>(expected[i]), 0.0001);
        }
        else
        {
            EXPECT_EQ(host[i], expected[i]);
        }
    }
}
