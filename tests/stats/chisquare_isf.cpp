/**
  * @file chisquare_isf.cpp
  * @brief File generated by tests/stats/chisquare_isf.py.
  */

/**
  * @test CHISQUARE.isf_random_test_dof_2
  * @brief Randomly generated chisquare isf test on 100 matrix with dof = 2.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, isf_random_test_dof_2)
{
    Tensor<float> q({100});
    q = std::vector<float>{0.05000000000000000, 0.05909090909090910, 0.06818181818181818, 0.07727272727272727, 0.08636363636363636, 0.09545454545454546, 0.10454545454545455, 0.11363636363636363, 0.12272727272727273, 0.13181818181818183, 0.14090909090909093, 0.14999999999999999, 0.15909090909090909, 0.16818181818181818, 0.17727272727272725, 0.18636363636363634, 0.19545454545454544, 0.20454545454545453, 0.21363636363636362, 0.22272727272727272, 0.23181818181818181, 0.24090909090909091, 0.25000000000000000, 0.25909090909090909, 0.26818181818181819, 0.27727272727272728, 0.28636363636363638, 0.29545454545454547, 0.30454545454545451, 0.31363636363636360, 0.32272727272727270, 0.33181818181818179, 0.34090909090909088, 0.34999999999999998, 0.35909090909090907, 0.36818181818181817, 0.37727272727272726, 0.38636363636363635, 0.39545454545454545, 0.40454545454545454, 0.41363636363636364, 0.42272727272727267, 0.43181818181818177, 0.44090909090909086, 0.44999999999999996, 0.45909090909090905, 0.46818181818181814, 0.47727272727272724, 0.48636363636363633, 0.49545454545454543, 0.50454545454545452, 0.51363636363636367, 0.52272727272727271, 0.53181818181818186, 0.54090909090909089, 0.55000000000000004, 0.55909090909090908, 0.56818181818181823, 0.57727272727272727, 0.58636363636363642, 0.59545454545454546, 0.60454545454545461, 0.61363636363636365, 0.62272727272727280, 0.63181818181818183, 0.64090909090909087, 0.65000000000000002, 0.65909090909090906, 0.66818181818181821, 0.67727272727272725, 0.68636363636363640, 0.69545454545454544, 0.70454545454545459, 0.71363636363636362, 0.72272727272727277, 0.73181818181818181, 0.74090909090909096, 0.75000000000000000, 0.75909090909090915, 0.76818181818181819, 0.77727272727272734, 0.78636363636363638, 0.79545454545454541, 0.80454545454545456, 0.81363636363636360, 0.82272727272727275, 0.83181818181818179, 0.84090909090909094, 0.84999999999999998, 0.85909090909090913, 0.86818181818181817, 0.87727272727272732, 0.88636363636363635, 0.89545454545454550, 0.90454545454545454, 0.91363636363636369, 0.92272727272727273, 0.93181818181818177, 0.94090909090909092, 0.94999999999999996};
    Tensor<float> k({1});
    k = 2.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{5.99146454710798260, 5.65735637778164957, 5.37115469050030292, 5.12082840459229072, 4.89837713437184252, 4.69821021725787791, 4.51626666084642281, 4.34950344296832192, 4.19558136069606391, 4.05266343273177476, 3.91928068373443006, 3.79423996977176214, 3.67655896972589602, 3.56541926741627391, 3.46013180044543001, 3.36011095929610759, 3.26485486131759872, 3.17393011316408380, 3.08695988928460618, 3.00361449648347056, 2.92360382725607115, 2.84667126560047956, 2.77258872223978159, 2.70115255703562296, 2.63218020489328453, 2.56550736435810034, 2.50098563992165746, 2.43848055291344856, 2.37786985392279115, 2.31904208351020413, 2.26189533862209258, 2.20633621040794070, 2.15227886563210236, 2.09964424899735569, 2.04835938777068005, 1.99835678335984546, 1.94957387711152741, 1.90195257972409015, 1.85543885539555586, 1.80998235324044288, 1.76553607967102333, 1.72205610639821161, 1.67950130950364129, 1.63783313569795741, 1.59701539243554347, 1.55701405902220458, 1.51779711624545177, 1.47933439238967668, 1.44159742378091127, 1.40455932824643592, 1.36819469008005545, 1.33247945528004186, 1.29739083597822291, 1.26290722310921111, 1.22900810648166425, 1.19567400151123993, 1.16288638195988803, 1.13062761810012091, 1.09888091978754088, 1.06763028398137916, 1.03686044630241958, 1.00655683626121562, 0.97670553582786379, 0.94729324104847368, 0.91830722644333984, 0.88973531194838662, 0.86156583218490879, 0.83378760786357398, 0.80638991914725067, 0.77936248081380488, 0.75269541907487436, 0.72637924991985192, 0.70040485886623005, 0.67476348200810699, 0.64944668826425989, 0.62444636273579712, 0.59975469109119828, 0.57536414490356180, 0.55126746787121272, 0.52745766285857609, 0.50392797969940317, 0.48067190370916513, 0.45768314485769507, 0.43495562755706474, 0.41248348102321319, 0.39026103017307151, 0.36828278702188127, 0.34654344254807334, 0.32503785899554988, 0.30376106258543822, 0.28270823661146338, 0.26187471489495190, 0.24125597557722950, 0.22084763522874595, 0.20064544325573838, 0.18064527658657145, 0.16084313462114841, 0.14123513442790681, 0.12181750617398490, 0.10258658877510116};
    // run Temper chisquare::isf
    Tensor<float> result = stats::chisquare::isf(q, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.isf_random_test_dof_3
  * @brief Randomly generated chisquare isf test on 100 matrix with dof = 3.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, isf_random_test_dof_3)
{
    Tensor<float> q({100});
    q = std::vector<float>{0.05000000000000000, 0.05909090909090910, 0.06818181818181818, 0.07727272727272727, 0.08636363636363636, 0.09545454545454546, 0.10454545454545455, 0.11363636363636363, 0.12272727272727273, 0.13181818181818183, 0.14090909090909093, 0.14999999999999999, 0.15909090909090909, 0.16818181818181818, 0.17727272727272725, 0.18636363636363634, 0.19545454545454544, 0.20454545454545453, 0.21363636363636362, 0.22272727272727272, 0.23181818181818181, 0.24090909090909091, 0.25000000000000000, 0.25909090909090909, 0.26818181818181819, 0.27727272727272728, 0.28636363636363638, 0.29545454545454547, 0.30454545454545451, 0.31363636363636360, 0.32272727272727270, 0.33181818181818179, 0.34090909090909088, 0.34999999999999998, 0.35909090909090907, 0.36818181818181817, 0.37727272727272726, 0.38636363636363635, 0.39545454545454545, 0.40454545454545454, 0.41363636363636364, 0.42272727272727267, 0.43181818181818177, 0.44090909090909086, 0.44999999999999996, 0.45909090909090905, 0.46818181818181814, 0.47727272727272724, 0.48636363636363633, 0.49545454545454543, 0.50454545454545452, 0.51363636363636367, 0.52272727272727271, 0.53181818181818186, 0.54090909090909089, 0.55000000000000004, 0.55909090909090908, 0.56818181818181823, 0.57727272727272727, 0.58636363636363642, 0.59545454545454546, 0.60454545454545461, 0.61363636363636365, 0.62272727272727280, 0.63181818181818183, 0.64090909090909087, 0.65000000000000002, 0.65909090909090906, 0.66818181818181821, 0.67727272727272725, 0.68636363636363640, 0.69545454545454544, 0.70454545454545459, 0.71363636363636362, 0.72272727272727277, 0.73181818181818181, 0.74090909090909096, 0.75000000000000000, 0.75909090909090915, 0.76818181818181819, 0.77727272727272734, 0.78636363636363638, 0.79545454545454541, 0.80454545454545456, 0.81363636363636360, 0.82272727272727275, 0.83181818181818179, 0.84090909090909094, 0.84999999999999998, 0.85909090909090913, 0.86818181818181817, 0.87727272727272732, 0.88636363636363635, 0.89545454545454550, 0.90454545454545454, 0.91363636363636369, 0.92272727272727273, 0.93181818181818177, 0.94090909090909092, 0.94999999999999996};
    Tensor<float> k({1});
    k = 3.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{7.81472790325117828, 7.44111542531900927, 7.11960111186726419, 6.83717341571904846, 6.58516515814559078, 6.35751027588837747, 6.14979610217182948, 5.95871164542780729, 5.78170848399736759, 5.61678292547533253, 5.46233083387629925, 5.31704783731709085, 5.17985888473352674, 5.04986736303733075, 4.92631759605814334, 4.80856671067336272, 4.69606319433567698, 4.58833031979597550, 4.48495316803573285, 4.38556835049750493, 4.28985578332787565, 4.19753204054538287, 4.10834493563231185, 4.02206906861879609, 3.93850213914586034, 3.85746187250856032, 3.77878344019546830, 3.70231728233332058, 3.62792725906389579, 3.55548907288603777, 3.48488891557467584, 3.41602230229534953, 3.34879306259501242, 3.28311246352550024, 3.21889844458941488, 3.15607494774580788, 3.09457132856820616, 3.03432183696041635, 2.97526515771709388, 2.91734400275692352, 2.86050474812218214, 2.80469710988488297, 2.74987385396759487, 2.69599053561015012, 2.64300526481825537, 2.59087849463764153, 2.53957282952513763, 2.48905285144923516, 2.43928496165902065, 2.39023723632044804, 2.34187929444045206, 2.29418217668830149, 2.24711823388502108, 2.20066102406952302, 2.15478521716790228, 2.10946650639278577, 2.06468152558503526, 2.02040777178226749, 1.97662353235923760, 1.93330781613505809, 1.89044028788273777, 1.84800120570794180, 1.80597136078696319, 1.76433201896855052, 1.72306486375067536, 1.68215194014104541, 1.64157559889881477, 1.60131844063342799, 1.56136325920370722, 1.52169298381447127, 1.48229061914661497, 1.44313918277692288, 1.40422163904162400, 1.36552082836779620, 1.32701939093207111, 1.28869968329767337, 1.25054368641640368, 1.21253290304566885, 1.17464824220004815, 1.13686988770272146, 1.09917714718341131, 1.06154827692999820, 1.02396027676120727, 0.98638864743513688, 0.94880710088031639, 0.91118721049490004, 0.87349798455220873, 0.83570533984230444, 0.79777144424472191, 0.75965388466578998, 0.72130459858534990, 0.68266847986074641, 0.64368152648732468, 0.60426832922147355, 0.56433858609340715, 0.52378213201181800, 0.48246162059413111, 0.44020132802875567, 0.39676920043336417, 0.35184631774927166};
    // run Temper chisquare::isf
    Tensor<float> result = stats::chisquare::isf(q, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.isf_random_test_dof_4
  * @brief Randomly generated chisquare isf test on 100 matrix with dof = 4.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, isf_random_test_dof_4)
{
    Tensor<float> q({100});
    q = std::vector<float>{0.05000000000000000, 0.05909090909090910, 0.06818181818181818, 0.07727272727272727, 0.08636363636363636, 0.09545454545454546, 0.10454545454545455, 0.11363636363636363, 0.12272727272727273, 0.13181818181818183, 0.14090909090909093, 0.14999999999999999, 0.15909090909090909, 0.16818181818181818, 0.17727272727272725, 0.18636363636363634, 0.19545454545454544, 0.20454545454545453, 0.21363636363636362, 0.22272727272727272, 0.23181818181818181, 0.24090909090909091, 0.25000000000000000, 0.25909090909090909, 0.26818181818181819, 0.27727272727272728, 0.28636363636363638, 0.29545454545454547, 0.30454545454545451, 0.31363636363636360, 0.32272727272727270, 0.33181818181818179, 0.34090909090909088, 0.34999999999999998, 0.35909090909090907, 0.36818181818181817, 0.37727272727272726, 0.38636363636363635, 0.39545454545454545, 0.40454545454545454, 0.41363636363636364, 0.42272727272727267, 0.43181818181818177, 0.44090909090909086, 0.44999999999999996, 0.45909090909090905, 0.46818181818181814, 0.47727272727272724, 0.48636363636363633, 0.49545454545454543, 0.50454545454545452, 0.51363636363636367, 0.52272727272727271, 0.53181818181818186, 0.54090909090909089, 0.55000000000000004, 0.55909090909090908, 0.56818181818181823, 0.57727272727272727, 0.58636363636363642, 0.59545454545454546, 0.60454545454545461, 0.61363636363636365, 0.62272727272727280, 0.63181818181818183, 0.64090909090909087, 0.65000000000000002, 0.65909090909090906, 0.66818181818181821, 0.67727272727272725, 0.68636363636363640, 0.69545454545454544, 0.70454545454545459, 0.71363636363636362, 0.72272727272727277, 0.73181818181818181, 0.74090909090909096, 0.75000000000000000, 0.75909090909090915, 0.76818181818181819, 0.77727272727272734, 0.78636363636363638, 0.79545454545454541, 0.80454545454545456, 0.81363636363636360, 0.82272727272727275, 0.83181818181818179, 0.84090909090909094, 0.84999999999999998, 0.85909090909090913, 0.86818181818181817, 0.87727272727272732, 0.88636363636363635, 0.89545454545454550, 0.90454545454545454, 0.91363636363636369, 0.92272727272727273, 0.93181818181818177, 0.94090909090909092, 0.94999999999999996};
    Tensor<float> k({1});
    k = 4.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{9.48772903678115753, 9.08164169156648704, 8.73116448263858125, 8.42246028375174483, 8.14630122965765757, 7.89622199050997953, 7.66751486370755231, 7.45664426423523263, 7.26088657194852694, 7.07809860308956829, 6.90656321153828756, 6.74488308721242014, 6.59190574349036140, 6.44666930296923368, 6.30836251940788095, 6.17629476995168680, 6.04987317299569849, 5.92858489148597734, 5.81198327139098847, 5.69967685845201988, 5.59132060389827856, 5.48660875512376656, 5.38526905777939113, 5.28705798895734791, 5.19175680868224898, 5.09916826647470867, 5.00911383653477404, 4.92143138269269986, 4.83597317519418546, 4.75260419739268158, 4.67120069277462502, 4.59164891235633554, 4.51384403002933698, 4.43768919938480177, 4.36309473028249073, 4.28997736721893475, 4.21825965460070762, 4.14786937649943965, 4.07873906047679036, 4.01080553671376983, 3.94400954503234580, 3.87829538351527603, 3.81361059335759789, 3.74990567535547203, 3.68713383408389417, 3.62525074635620559, 3.56421435101404072, 3.50398465748077914, 3.44452357083652450, 3.38579473144801479, 3.32776336742035550, 3.27039615833541619, 3.21366110890965784, 3.15752743134604996, 3.10196543527421120, 3.04694642427283702, 2.99244259805093193, 2.93842695943134702, 2.88487322533277224, 2.83175574098571481, 2.77904939664466122, 2.72672954607284357, 2.67477192607764902, 2.62315257636319110, 2.57184775894115702, 2.52083387630012679, 2.47008738747531043, 2.41958472108241063, 2.36930218427753925, 2.31921586647523226, 2.26930153649277067, 2.21953453158336877, 2.16988963656341971, 2.12034095091689245, 2.07086174135576861, 2.02142427680681225, 1.97199964215170787, 1.92255752622955400, 1.87306597856355683, 1.82349112792331436, 1.77379685407830578, 1.72394440179464592, 1.67389192307517543, 1.62359392955575088, 1.57300063143254532, 1.52205713169508305, 1.47070243386319710, 1.41886820648077450, 1.36647722614188094, 1.31344138938153732, 1.25965913676842001, 1.20501206065748256, 1.14936035522791746, 1.09253658501922035, 1.03433694317648506, 0.97450864039563456, 0.91273110085572962, 0.84858678862960046, 0.78151368895309814, 0.71072302139732446};
    // run Temper chisquare::isf
    Tensor<float> result = stats::chisquare::isf(q, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.isf_random_test_dof_5
  * @brief Randomly generated chisquare isf test on 100 matrix with dof = 5.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, isf_random_test_dof_5)
{
    Tensor<float> q({100});
    q = std::vector<float>{0.05000000000000000, 0.05909090909090910, 0.06818181818181818, 0.07727272727272727, 0.08636363636363636, 0.09545454545454546, 0.10454545454545455, 0.11363636363636363, 0.12272727272727273, 0.13181818181818183, 0.14090909090909093, 0.14999999999999999, 0.15909090909090909, 0.16818181818181818, 0.17727272727272725, 0.18636363636363634, 0.19545454545454544, 0.20454545454545453, 0.21363636363636362, 0.22272727272727272, 0.23181818181818181, 0.24090909090909091, 0.25000000000000000, 0.25909090909090909, 0.26818181818181819, 0.27727272727272728, 0.28636363636363638, 0.29545454545454547, 0.30454545454545451, 0.31363636363636360, 0.32272727272727270, 0.33181818181818179, 0.34090909090909088, 0.34999999999999998, 0.35909090909090907, 0.36818181818181817, 0.37727272727272726, 0.38636363636363635, 0.39545454545454545, 0.40454545454545454, 0.41363636363636364, 0.42272727272727267, 0.43181818181818177, 0.44090909090909086, 0.44999999999999996, 0.45909090909090905, 0.46818181818181814, 0.47727272727272724, 0.48636363636363633, 0.49545454545454543, 0.50454545454545452, 0.51363636363636367, 0.52272727272727271, 0.53181818181818186, 0.54090909090909089, 0.55000000000000004, 0.55909090909090908, 0.56818181818181823, 0.57727272727272727, 0.58636363636363642, 0.59545454545454546, 0.60454545454545461, 0.61363636363636365, 0.62272727272727280, 0.63181818181818183, 0.64090909090909087, 0.65000000000000002, 0.65909090909090906, 0.66818181818181821, 0.67727272727272725, 0.68636363636363640, 0.69545454545454544, 0.70454545454545459, 0.71363636363636362, 0.72272727272727277, 0.73181818181818181, 0.74090909090909096, 0.75000000000000000, 0.75909090909090915, 0.76818181818181819, 0.77727272727272734, 0.78636363636363638, 0.79545454545454541, 0.80454545454545456, 0.81363636363636360, 0.82272727272727275, 0.83181818181818179, 0.84090909090909094, 0.84999999999999998, 0.85909090909090913, 0.86818181818181817, 0.87727272727272732, 0.88636363636363635, 0.89545454545454550, 0.90454545454545454, 0.91363636363636369, 0.92272727272727273, 0.93181818181818177, 0.94090909090909092, 0.94999999999999996};
    Tensor<float> k({1});
    k = 5.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{11.07049769351635504, 10.63614727607932942, 10.26049696558430036, 9.92898109101017035, 9.63187742073579223, 9.36236884885958887, 9.11548790409134391, 8.88750137460052869, 8.67553156267734238, 8.47731267147275247, 8.29102826493612888, 8.11519941305292214, 7.94860565078058023, 7.79022782789811963, 7.63920594884502346, 7.49480751472978746, 7.35640337381242482, 7.22344903789999737, 7.09547004268412973, 6.97205034399821599, 6.85282302362663120, 6.73746277341511046, 6.62567976382924773, 6.51721460131807095, 6.41183415000806356, 6.30932804548148685, 6.20950576717070479, 6.11219416500612667, 6.01723535801951748, 5.92448493949161747, 5.83381043626711993, 5.74508998000651960, 5.65821115610165482, 5.57307000226776417, 5.48957013382498538, 5.40762197668421329, 5.32714209227517710, 5.24805258126469543, 5.17028055503820116, 5.09375766565689059, 5.01841968643269443, 4.94420613644445073, 4.87105994329800041, 4.79892713924838876, 4.72775658648384578, 4.65749972794203249, 4.58811036050914201, 4.51954442785669830, 4.45175983051205293, 4.38471625104674878, 4.31837499251042356, 4.25269882844327185, 4.18765186297286895, 4.12319939964588755, 4.05930781776525684, 3.99594445510145002, 3.93307749592553568, 3.87067586337202929, 3.80870911518392408, 3.74714734191991861, 3.68596106671611512, 3.62512114569038424, 3.56459866805691217, 3.50436485497970995, 3.44439095613524415, 3.38464814287341520, 3.32510739675921352, 3.26573939214018027, 3.20651437121132066, 3.14740200983187801, 3.08837127207746986, 3.02939025117400984, 2.97042599404000951, 2.91144430614004124, 2.85240953269606701, 2.79328431147811385, 2.73402929135186668, 2.67460280943216322, 2.61496051798823803, 2.55505495004666239, 2.49483500977170713, 2.43424536993419194, 2.37322575377417833, 2.31171007184129884, 2.24962537526275641, 2.18689057431599432, 2.12341485362903137, 2.05909569044072338, 1.99381634645304917, 1.92744265104387535, 1.85981881442191432, 1.79076188765317101, 1.72005429461941040, 1.64743354920042995, 1.57257774680760143, 1.49508450271308924, 1.41443933080047368, 1.32996620858230541, 1.24074636059130872, 1.14547622606176969};
    // run Temper chisquare::isf
    Tensor<float> result = stats::chisquare::isf(q, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.isf_random_test_dof_6
  * @brief Randomly generated chisquare isf test on 100 matrix with dof = 6.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, isf_random_test_dof_6)
{
    Tensor<float> q({100});
    q = std::vector<float>{0.05000000000000000, 0.05909090909090910, 0.06818181818181818, 0.07727272727272727, 0.08636363636363636, 0.09545454545454546, 0.10454545454545455, 0.11363636363636363, 0.12272727272727273, 0.13181818181818183, 0.14090909090909093, 0.14999999999999999, 0.15909090909090909, 0.16818181818181818, 0.17727272727272725, 0.18636363636363634, 0.19545454545454544, 0.20454545454545453, 0.21363636363636362, 0.22272727272727272, 0.23181818181818181, 0.24090909090909091, 0.25000000000000000, 0.25909090909090909, 0.26818181818181819, 0.27727272727272728, 0.28636363636363638, 0.29545454545454547, 0.30454545454545451, 0.31363636363636360, 0.32272727272727270, 0.33181818181818179, 0.34090909090909088, 0.34999999999999998, 0.35909090909090907, 0.36818181818181817, 0.37727272727272726, 0.38636363636363635, 0.39545454545454545, 0.40454545454545454, 0.41363636363636364, 0.42272727272727267, 0.43181818181818177, 0.44090909090909086, 0.44999999999999996, 0.45909090909090905, 0.46818181818181814, 0.47727272727272724, 0.48636363636363633, 0.49545454545454543, 0.50454545454545452, 0.51363636363636367, 0.52272727272727271, 0.53181818181818186, 0.54090909090909089, 0.55000000000000004, 0.55909090909090908, 0.56818181818181823, 0.57727272727272727, 0.58636363636363642, 0.59545454545454546, 0.60454545454545461, 0.61363636363636365, 0.62272727272727280, 0.63181818181818183, 0.64090909090909087, 0.65000000000000002, 0.65909090909090906, 0.66818181818181821, 0.67727272727272725, 0.68636363636363640, 0.69545454545454544, 0.70454545454545459, 0.71363636363636362, 0.72272727272727277, 0.73181818181818181, 0.74090909090909096, 0.75000000000000000, 0.75909090909090915, 0.76818181818181819, 0.77727272727272734, 0.78636363636363638, 0.79545454545454541, 0.80454545454545456, 0.81363636363636360, 0.82272727272727275, 0.83181818181818179, 0.84090909090909094, 0.84999999999999998, 0.85909090909090913, 0.86818181818181817, 0.87727272727272732, 0.88636363636363635, 0.89545454545454550, 0.90454545454545454, 0.91363636363636369, 0.92272727272727273, 0.93181818181818177, 0.94090909090909092, 0.94999999999999996};
    Tensor<float> k({1});
    k = 6.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{12.59158724374398020, 12.13186399957351291, 11.73363471435387240, 11.38167365751161952, 11.06581096484461391, 10.77891117321994940, 10.51577182946422084, 10.27248102705675414, 10.04602180415409762, 9.83401757803794752, 9.63456222923589145, 9.44610312678933361, 9.26735843975296270, 9.09725732958618671, 8.93489581536524469, 8.77950362285122843, 8.63041888864937690, 8.48706858416381671, 8.34895317243009849, 8.21563444350042538, 8.08672576846570834, 7.96188421619848441, 7.84080412058512177, 7.72321178874117642, 7.60886111515982311, 7.49752992139478369, 7.38901688146469660, 7.28313892363276860, 7.17972902231765531, 7.07863431157355993, 6.97971446522989147, 6.88284029940858932, 6.78789256147365982, 6.69476087605439929, 6.60334282402313111, 6.51354313450279765, 6.42527297335785530, 6.33844931435784176, 6.25299438143079556, 6.16883515224693912, 6.08590291487176938, 6.00413287046580724, 5.92346377603444463, 5.84383762208581548, 5.76519934076782370, 5.68749654065314214, 5.61067926484268931, 5.53469976948020026, 5.45951232012601029, 5.38507300373780939, 5.31133955425830617, 5.23827119002134900, 5.16582846136523255, 5.09397310698845107, 5.02266791770329224, 4.95187660633896254, 4.88156368262036544, 4.81169433190336004, 4.74223429668225638, 4.67314975980214431, 4.60440722830618654, 4.53597341682610811, 4.46781512938157199, 4.39989913838868407, 4.33219205958674447, 4.26466022147235346, 4.19726952767532691, 4.12998531051603113, 4.06277217374003108, 3.99559382212292524, 3.92841287526242722, 3.86119066240834430, 3.79388699460162693, 3.72645990967113949, 3.65886538473237088, 3.59105700969439301, 3.52298561384142994, 3.45459883572103843, 3.38584062421732979, 3.31665065564370964, 3.24696364771848289, 3.17670854605733632, 3.10580755185972501, 3.03417495010836147, 2.96171568486164860, 2.88832361064836007, 2.81387932439218869, 2.73824744736222847, 2.66127317614690551, 2.58277784724810555, 2.50255314794176886, 2.42035343358734423, 2.33588533875085558, 2.24879342478476918, 2.15863985622788279, 2.06487478132344782, 1.96679166991741017, 1.86345715501974385, 1.75359514441458941, 1.63538289432790718};
    // run Temper chisquare::isf
    Tensor<float> result = stats::chisquare::isf(q, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.isf_random_test_dof_7
  * @brief Randomly generated chisquare isf test on 100 matrix with dof = 7.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, isf_random_test_dof_7)
{
    Tensor<float> q({100});
    q = std::vector<float>{0.05000000000000000, 0.05909090909090910, 0.06818181818181818, 0.07727272727272727, 0.08636363636363636, 0.09545454545454546, 0.10454545454545455, 0.11363636363636363, 0.12272727272727273, 0.13181818181818183, 0.14090909090909093, 0.14999999999999999, 0.15909090909090909, 0.16818181818181818, 0.17727272727272725, 0.18636363636363634, 0.19545454545454544, 0.20454545454545453, 0.21363636363636362, 0.22272727272727272, 0.23181818181818181, 0.24090909090909091, 0.25000000000000000, 0.25909090909090909, 0.26818181818181819, 0.27727272727272728, 0.28636363636363638, 0.29545454545454547, 0.30454545454545451, 0.31363636363636360, 0.32272727272727270, 0.33181818181818179, 0.34090909090909088, 0.34999999999999998, 0.35909090909090907, 0.36818181818181817, 0.37727272727272726, 0.38636363636363635, 0.39545454545454545, 0.40454545454545454, 0.41363636363636364, 0.42272727272727267, 0.43181818181818177, 0.44090909090909086, 0.44999999999999996, 0.45909090909090905, 0.46818181818181814, 0.47727272727272724, 0.48636363636363633, 0.49545454545454543, 0.50454545454545452, 0.51363636363636367, 0.52272727272727271, 0.53181818181818186, 0.54090909090909089, 0.55000000000000004, 0.55909090909090908, 0.56818181818181823, 0.57727272727272727, 0.58636363636363642, 0.59545454545454546, 0.60454545454545461, 0.61363636363636365, 0.62272727272727280, 0.63181818181818183, 0.64090909090909087, 0.65000000000000002, 0.65909090909090906, 0.66818181818181821, 0.67727272727272725, 0.68636363636363640, 0.69545454545454544, 0.70454545454545459, 0.71363636363636362, 0.72272727272727277, 0.73181818181818181, 0.74090909090909096, 0.75000000000000000, 0.75909090909090915, 0.76818181818181819, 0.77727272727272734, 0.78636363636363638, 0.79545454545454541, 0.80454545454545456, 0.81363636363636360, 0.82272727272727275, 0.83181818181818179, 0.84090909090909094, 0.84999999999999998, 0.85909090909090913, 0.86818181818181817, 0.87727272727272732, 0.88636363636363635, 0.89545454545454550, 0.90454545454545454, 0.91363636363636369, 0.92272727272727273, 0.93181818181818177, 0.94090909090909092, 0.94999999999999996};
    Tensor<float> k({1});
    k = 7.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{14.06714044934016705, 13.58418867162510146, 13.16530159580626602, 12.79464524543806903, 12.46163744009409058, 12.15884958807487592, 11.88086294952769606, 11.62360119098105038, 11.38391924201024885, 11.15933863477937749, 10.94787079149103093, 10.74789533282035769, 10.55807402991146482, 10.37728854959948777, 10.20459450160428894, 10.03918691331471180, 9.88037387891534813, 9.72755616210660357, 9.58021120566396078, 9.43788045085775273, 9.30015917591859953, 9.16668827491772831, 9.03714754790814112, 8.91125018005709357, 8.78873816498437854, 8.66937848440434244, 8.55295989841860305, 8.43929023252794686, 8.32819407148756241, 8.21951078854545791, 8.11309285282390391, 8.00880436867480405, 7.90651980952580402, 7.80612291559680838, 7.70750573032671493, 7.61056775472157021, 7.51521520235604257, 7.42136034061216066, 7.32892090606078561, 7.23781958379246149, 7.14798354206581177, 7.05934401493227526, 6.97183592656528539, 6.88539755191187375, 6.79997020902762284, 6.71549797907767765, 6.63192745050823618, 6.54920748433122135, 6.46728899783372757, 6.38612476433344778, 6.30566922686155173, 6.22587832387188200, 6.14670932525590441, 6.06812067709112668, 5.99007185367082506, 5.91252321545662607, 5.83543587166634481, 5.75877154625740850, 5.68249244609318627, 5.60656113008488877, 5.53094037808555594, 5.45559305827350549, 5.38048199169890218, 5.30556981257588056, 5.23081882278062871, 5.15619083885763541, 5.08164702963627768, 5.00714774230919346, 4.93265231451264707, 4.85811886956354222, 4.78350409153046208, 4.70876297622537976, 4.63384855346867131, 4.55871157506585689, 4.48330016178976187, 4.40755940122154399, 4.33143088648028218, 4.25485218354651540, 4.17775621190029955, 4.10007051933084377, 4.02171642672952867, 3.94260801202736477, 3.86265089357999081, 3.78174076137425264, 3.69976158816995770, 3.61658343023347317, 3.53205969585720103, 3.44602371508230032, 3.35828437920814071, 3.26862052298965677, 3.17677357819339923, 3.08243780456648064, 2.98524705139959057, 2.88475642638097085, 2.78041627355427989, 2.67153414643049292, 2.55721729814477605, 2.43628204207829357, 2.30710347496474277, 2.16734990929805793};
    // run Temper chisquare::isf
    Tensor<float> result = stats::chisquare::isf(q, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.isf_random_test_dof_8
  * @brief Randomly generated chisquare isf test on 100 matrix with dof = 8.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, isf_random_test_dof_8)
{
    Tensor<float> q({100});
    q = std::vector<float>{0.05000000000000000, 0.05909090909090910, 0.06818181818181818, 0.07727272727272727, 0.08636363636363636, 0.09545454545454546, 0.10454545454545455, 0.11363636363636363, 0.12272727272727273, 0.13181818181818183, 0.14090909090909093, 0.14999999999999999, 0.15909090909090909, 0.16818181818181818, 0.17727272727272725, 0.18636363636363634, 0.19545454545454544, 0.20454545454545453, 0.21363636363636362, 0.22272727272727272, 0.23181818181818181, 0.24090909090909091, 0.25000000000000000, 0.25909090909090909, 0.26818181818181819, 0.27727272727272728, 0.28636363636363638, 0.29545454545454547, 0.30454545454545451, 0.31363636363636360, 0.32272727272727270, 0.33181818181818179, 0.34090909090909088, 0.34999999999999998, 0.35909090909090907, 0.36818181818181817, 0.37727272727272726, 0.38636363636363635, 0.39545454545454545, 0.40454545454545454, 0.41363636363636364, 0.42272727272727267, 0.43181818181818177, 0.44090909090909086, 0.44999999999999996, 0.45909090909090905, 0.46818181818181814, 0.47727272727272724, 0.48636363636363633, 0.49545454545454543, 0.50454545454545452, 0.51363636363636367, 0.52272727272727271, 0.53181818181818186, 0.54090909090909089, 0.55000000000000004, 0.55909090909090908, 0.56818181818181823, 0.57727272727272727, 0.58636363636363642, 0.59545454545454546, 0.60454545454545461, 0.61363636363636365, 0.62272727272727280, 0.63181818181818183, 0.64090909090909087, 0.65000000000000002, 0.65909090909090906, 0.66818181818181821, 0.67727272727272725, 0.68636363636363640, 0.69545454545454544, 0.70454545454545459, 0.71363636363636362, 0.72272727272727277, 0.73181818181818181, 0.74090909090909096, 0.75000000000000000, 0.75909090909090915, 0.76818181818181819, 0.77727272727272734, 0.78636363636363638, 0.79545454545454541, 0.80454545454545456, 0.81363636363636360, 0.82272727272727275, 0.83181818181818179, 0.84090909090909094, 0.84999999999999998, 0.85909090909090913, 0.86818181818181817, 0.87727272727272732, 0.88636363636363635, 0.89545454545454550, 0.90454545454545454, 0.91363636363636369, 0.92272727272727273, 0.93181818181818177, 0.94090909090909092, 0.94999999999999996};
    Tensor<float> k({1});
    k = 8.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{15.50731305586545439, 15.00280665843353667, 14.56475954545516238, 14.17677053347500227, 13.82787307315638969, 13.51036539310122109, 13.21862723916526683, 12.94842911776570560, 12.69650665408948775, 12.46028651617069904, 12.23770336437394946, 12.02707376213624002, 11.82700699629828556, 11.63634054148522701, 11.45409241310171744, 11.27942536161152631, 11.11161953875665098, 10.95005133528116303, 10.79417678761485178, 10.64351841677324906, 10.49765467985577239, 10.35621143434007685, 10.21885497024675971, 10.08528627601132754, 9.95523628420658468, 9.82846190222205429, 9.70474267680731550, 9.58387797427555910, 9.46568458310933813, 9.34999466480857144, 9.23665399357026828, 9.12552043687364822, 9.01646263805508319, 8.90935886907784180, 8.80409602736714092, 8.70056875511695083, 8.59867866312888829, 8.49833364420291737, 8.39944726350972459, 8.30193821534660437, 8.20572983730023964, 8.11074967417824055, 8.01692908518110592, 7.92420288870919531, 7.83250903996951919, 7.74178833719165826, 7.65198415280220257, 7.56304218636066139, 7.47491023644056263, 7.38753798895893343, 7.30087681972459013, 7.21487960919850035, 7.12950056764300477, 7.04469506898684372, 6.96041949185206477, 6.87663106628111631, 6.79328772476863740, 6.71034795624476033, 6.62777066167532602, 6.54551500993918367, 6.46354029261329366, 6.38180577624058643, 6.30027055057162055, 6.21889337115525098, 6.13763249450152681, 6.05644550384580693, 5.97528912329894446, 5.89411901786465187, 5.81288957642885595, 5.73155367436123342, 5.65006241179465185, 5.56836482293794965, 5.48640755089531140, 5.40413448136705643, 5.32148632723106818, 5.23840015427295391, 5.15480883614030905, 5.07064042380018698, 4.98581741118625121, 4.90025587406853447, 4.81386445309751299, 4.72654314395157815, 4.63818184682294632, 4.54865861306266250, 4.45783750713875282, 4.36556597487370013, 4.27167157079705095, 4.17595784312308194, 4.07819909611162945, 3.97813363320415725, 3.87545490868874598, 3.76979974417490160, 3.66073233520038244, 3.54772206811003610, 3.43011197275461166, 3.30707253015117342, 3.17753166164930390, 3.04006412027013040, 2.89270760595997123, 2.73263679349966271};
    // run Temper chisquare::isf
    Tensor<float> result = stats::chisquare::isf(q, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.isf_random_test_dof_9
  * @brief Randomly generated chisquare isf test on 100 matrix with dof = 9.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, isf_random_test_dof_9)
{
    Tensor<float> q({100});
    q = std::vector<float>{0.05000000000000000, 0.05909090909090910, 0.06818181818181818, 0.07727272727272727, 0.08636363636363636, 0.09545454545454546, 0.10454545454545455, 0.11363636363636363, 0.12272727272727273, 0.13181818181818183, 0.14090909090909093, 0.14999999999999999, 0.15909090909090909, 0.16818181818181818, 0.17727272727272725, 0.18636363636363634, 0.19545454545454544, 0.20454545454545453, 0.21363636363636362, 0.22272727272727272, 0.23181818181818181, 0.24090909090909091, 0.25000000000000000, 0.25909090909090909, 0.26818181818181819, 0.27727272727272728, 0.28636363636363638, 0.29545454545454547, 0.30454545454545451, 0.31363636363636360, 0.32272727272727270, 0.33181818181818179, 0.34090909090909088, 0.34999999999999998, 0.35909090909090907, 0.36818181818181817, 0.37727272727272726, 0.38636363636363635, 0.39545454545454545, 0.40454545454545454, 0.41363636363636364, 0.42272727272727267, 0.43181818181818177, 0.44090909090909086, 0.44999999999999996, 0.45909090909090905, 0.46818181818181814, 0.47727272727272724, 0.48636363636363633, 0.49545454545454543, 0.50454545454545452, 0.51363636363636367, 0.52272727272727271, 0.53181818181818186, 0.54090909090909089, 0.55000000000000004, 0.55909090909090908, 0.56818181818181823, 0.57727272727272727, 0.58636363636363642, 0.59545454545454546, 0.60454545454545461, 0.61363636363636365, 0.62272727272727280, 0.63181818181818183, 0.64090909090909087, 0.65000000000000002, 0.65909090909090906, 0.66818181818181821, 0.67727272727272725, 0.68636363636363640, 0.69545454545454544, 0.70454545454545459, 0.71363636363636362, 0.72272727272727277, 0.73181818181818181, 0.74090909090909096, 0.75000000000000000, 0.75909090909090915, 0.76818181818181819, 0.77727272727272734, 0.78636363636363638, 0.79545454545454541, 0.80454545454545456, 0.81363636363636360, 0.82272727272727275, 0.83181818181818179, 0.84090909090909094, 0.84999999999999998, 0.85909090909090913, 0.86818181818181817, 0.87727272727272732, 0.88636363636363635, 0.89545454545454550, 0.90454545454545454, 0.91363636363636369, 0.92272727272727273, 0.93181818181818177, 0.94090909090909092, 0.94999999999999996};
    Tensor<float> k({1});
    k = 9.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{16.91897760462045142, 16.39427105677098595, 15.93827457736768238, 15.53405335849724622, 15.17027933528726358, 14.83899385925812808, 14.53438722753863566, 14.25208598416196715, 13.98871363397358181, 13.74160770746376770, 13.50863074764164296, 13.28804008413576376, 13.07839570815925789, 12.87849359200622601, 12.68731644902688238, 12.50399672401056428, 12.32778833539935448, 12.15804479393175086, 11.99420204269015322, 11.83576484440672516, 11.68229586931969877, 11.53340686386838243, 11.38875144047037224, 11.24801914303454531, 11.11093052582432605, 10.97723304420515689, 10.84669760106889669, 10.71911562671584939, 10.59429659575721594, 10.47206590434055329, 10.35226304624809757, 10.23474003829003465, 10.11936005473114442, 10.00599623785215542, 9.89453065760518591, 9.78485339801380150, 9.67686175174679342, 9.57045950735566819, 9.46555631615817639, 9.36206712779007333, 9.25991168512392093, 9.15901407063813622, 9.05930229746676829, 8.96070793931461118, 8.86316579421815653, 8.76661357779848061, 8.67099164220978125, 8.57624271745481437, 8.48231167213069348, 8.38914529099684891, 8.29669206703109197, 8.20490200586711893, 8.11372644069360760, 8.02311785584612380, 7.93302971744213270, 7.84341630949907476, 7.75423257403805888, 7.66543395371202596, 7.57697623550798394, 7.48881539405750107, 7.40090743304730303, 7.31320822315028440, 7.22567333479389706, 7.13825786394343886, 7.05091624889720059, 6.96360207586144764, 6.87626787078718227, 6.78886487459564503, 6.70134279848131165, 6.61364955544032096, 6.52573096350499426, 6.43753041533978809, 6.34898850782997926, 6.26004262401893019, 6.17062645815266908, 6.08066947257995327, 5.99009627270872169, 5.89882588296997135, 5.80677090256303163, 5.71383651434241369, 5.61991931312839377, 5.52490591037951795, 5.42867125970244135, 5.33107663086427142, 5.23196713702084182, 5.13116868812092886, 5.02848419887724063, 4.92368881614223852, 4.81652383831706743, 4.70668886304161838, 4.59383149336002106, 4.47753361373176162, 4.35729274055224192, 4.23249612169934508, 4.10238385147322049, 3.96599478074973000, 3.82208439983010440, 3.66899486313146284, 3.50443845761853012, 3.32511284306681576};
    // run Temper chisquare::isf
    Tensor<float> result = stats::chisquare::isf(q, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.isf_random_test_dof_10
  * @brief Randomly generated chisquare isf test on 100 matrix with dof = 10.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, isf_random_test_dof_10)
{
    Tensor<float> q({100});
    q = std::vector<float>{0.05000000000000000, 0.05909090909090910, 0.06818181818181818, 0.07727272727272727, 0.08636363636363636, 0.09545454545454546, 0.10454545454545455, 0.11363636363636363, 0.12272727272727273, 0.13181818181818183, 0.14090909090909093, 0.14999999999999999, 0.15909090909090909, 0.16818181818181818, 0.17727272727272725, 0.18636363636363634, 0.19545454545454544, 0.20454545454545453, 0.21363636363636362, 0.22272727272727272, 0.23181818181818181, 0.24090909090909091, 0.25000000000000000, 0.25909090909090909, 0.26818181818181819, 0.27727272727272728, 0.28636363636363638, 0.29545454545454547, 0.30454545454545451, 0.31363636363636360, 0.32272727272727270, 0.33181818181818179, 0.34090909090909088, 0.34999999999999998, 0.35909090909090907, 0.36818181818181817, 0.37727272727272726, 0.38636363636363635, 0.39545454545454545, 0.40454545454545454, 0.41363636363636364, 0.42272727272727267, 0.43181818181818177, 0.44090909090909086, 0.44999999999999996, 0.45909090909090905, 0.46818181818181814, 0.47727272727272724, 0.48636363636363633, 0.49545454545454543, 0.50454545454545452, 0.51363636363636367, 0.52272727272727271, 0.53181818181818186, 0.54090909090909089, 0.55000000000000004, 0.55909090909090908, 0.56818181818181823, 0.57727272727272727, 0.58636363636363642, 0.59545454545454546, 0.60454545454545461, 0.61363636363636365, 0.62272727272727280, 0.63181818181818183, 0.64090909090909087, 0.65000000000000002, 0.65909090909090906, 0.66818181818181821, 0.67727272727272725, 0.68636363636363640, 0.69545454545454544, 0.70454545454545459, 0.71363636363636362, 0.72272727272727277, 0.73181818181818181, 0.74090909090909096, 0.75000000000000000, 0.75909090909090915, 0.76818181818181819, 0.77727272727272734, 0.78636363636363638, 0.79545454545454541, 0.80454545454545456, 0.81363636363636360, 0.82272727272727275, 0.83181818181818179, 0.84090909090909094, 0.84999999999999998, 0.85909090909090913, 0.86818181818181817, 0.87727272727272732, 0.88636363636363635, 0.89545454545454550, 0.90454545454545454, 0.91363636363636369, 0.92272727272727273, 0.93181818181818177, 0.94090909090909092, 0.94999999999999996};
    Tensor<float> k({1});
    k = 10.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{18.30703805327514999, 17.76325700806282981, 17.29031647085934154, 16.87077617078809766, 16.49296568059101986, 16.14868313076189921, 15.83193947193403517, 15.53822498363702209, 15.26405706068256762, 15.00668888533724044, 14.76391476634646338, 14.53393599523099944, 14.31526593201236253, 14.10666129373140620, 13.90707140614991744, 13.71560005438770879, 13.53147635044343211, 13.35403217119022479, 13.18268446211377309, 13.01692119722528140, 12.85629012278833194, 12.70038964629453559, 12.54886139688937874, 12.40138410131354973, 12.25766850489974402, 12.11745312993685175, 11.98050071035300057, 11.84659517669726547, 11.71553909197342236, 11.58715145922708167, 11.46126583750532113, 11.33772871504806012, 11.21639809817603428, 11.09714228193177732, 10.97983877457132706, 10.86437335284164263, 10.75063922887567891, 10.63853631269360278, 10.52797055686942862, 10.41885337202563555, 10.31110110354766007, 10.20463456133779268, 10.09937859561050111, 9.99526171271531183, 9.89221572579307917, 9.79017543575734805, 9.68907833866643919, 9.58886435603283971, 9.48947558501934552, 9.39085606580819920, 9.29295156370988806, 9.19570936381039239, 9.09907807614484021, 9.00300744953827348, 8.90744819237224839, 8.81235179862396478, 8.71767037758322161, 8.62335648568308955, 8.52936295888357421, 8.43564274402203651, 8.34214872748980873, 8.24883355950732877, 8.15564947214850555, 8.06254808910268927, 7.96948022495474895, 7.87639567150147357, 7.78324296829606332, 7.68996915420873606, 7.59651949629334400, 7.50283719163643337, 7.40886303710836991, 7.31453506100069450, 7.21978810937341642, 7.12455337849047243, 7.02875788291153114, 6.93232384652933931, 6.83516800095335686, 6.73720077195464206, 6.63832532994715940, 6.53843647433578834, 6.43741931352299979, 6.33514769175019943, 6.23148229978258428, 6.12626838732703849, 6.01933296895342540, 5.91048137913211225, 5.79949298121778867, 5.68611576274812336, 5.57005944421596411, 5.45098657274950771, 5.32850083666797758, 5.20213147223718764, 5.07131205389837980, 4.93535100801148374, 4.79338957491934181, 4.64434008866678649, 4.48679215193654901, 4.31886391170490125, 4.13795388424487420, 3.94029913611906091};
    // run Temper chisquare::isf
    Tensor<float> result = stats::chisquare::isf(q, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.isf_random_test_dof_11
  * @brief Randomly generated chisquare isf test on 100 matrix with dof = 11.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, isf_random_test_dof_11)
{
    Tensor<float> q({100});
    q = std::vector<float>{0.05000000000000000, 0.05909090909090910, 0.06818181818181818, 0.07727272727272727, 0.08636363636363636, 0.09545454545454546, 0.10454545454545455, 0.11363636363636363, 0.12272727272727273, 0.13181818181818183, 0.14090909090909093, 0.14999999999999999, 0.15909090909090909, 0.16818181818181818, 0.17727272727272725, 0.18636363636363634, 0.19545454545454544, 0.20454545454545453, 0.21363636363636362, 0.22272727272727272, 0.23181818181818181, 0.24090909090909091, 0.25000000000000000, 0.25909090909090909, 0.26818181818181819, 0.27727272727272728, 0.28636363636363638, 0.29545454545454547, 0.30454545454545451, 0.31363636363636360, 0.32272727272727270, 0.33181818181818179, 0.34090909090909088, 0.34999999999999998, 0.35909090909090907, 0.36818181818181817, 0.37727272727272726, 0.38636363636363635, 0.39545454545454545, 0.40454545454545454, 0.41363636363636364, 0.42272727272727267, 0.43181818181818177, 0.44090909090909086, 0.44999999999999996, 0.45909090909090905, 0.46818181818181814, 0.47727272727272724, 0.48636363636363633, 0.49545454545454543, 0.50454545454545452, 0.51363636363636367, 0.52272727272727271, 0.53181818181818186, 0.54090909090909089, 0.55000000000000004, 0.55909090909090908, 0.56818181818181823, 0.57727272727272727, 0.58636363636363642, 0.59545454545454546, 0.60454545454545461, 0.61363636363636365, 0.62272727272727280, 0.63181818181818183, 0.64090909090909087, 0.65000000000000002, 0.65909090909090906, 0.66818181818181821, 0.67727272727272725, 0.68636363636363640, 0.69545454545454544, 0.70454545454545459, 0.71363636363636362, 0.72272727272727277, 0.73181818181818181, 0.74090909090909096, 0.75000000000000000, 0.75909090909090915, 0.76818181818181819, 0.77727272727272734, 0.78636363636363638, 0.79545454545454541, 0.80454545454545456, 0.81363636363636360, 0.82272727272727275, 0.83181818181818179, 0.84090909090909094, 0.84999999999999998, 0.85909090909090913, 0.86818181818181817, 0.87727272727272732, 0.88636363636363635, 0.89545454545454550, 0.90454545454545454, 0.91363636363636369, 0.92272727272727273, 0.93181818181818177, 0.94090909090909092, 0.94999999999999996};
    Tensor<float> k({1});
    k = 11.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{19.67513757268249108, 19.11323705828792185, 18.62420480359974206, 18.19011914454866385, 17.79898365384501346, 17.44236490221294034, 17.11410311705545340, 16.80955888204492865, 16.52514860897915128, 16.25804521619472354, 16.00597808876248962, 15.76709520396789443, 15.53986556116768192, 15.32300853661264917, 15.11544169923778469, 14.91624157631838798, 14.72461368838756179, 14.53986933938092463, 14.36140740994056486, 14.18869991058099878, 14.02128039792953906, 13.85873459752566283, 13.70069274601151399, 13.54682328669880675, 13.39682764036547979, 13.25043583767113731, 13.10740284753449458, 12.96750547183500224, 12.83053970412750111, 12.69631847098602506, 12.56466969075834506, 12.43543459710322452, 12.30846628456306213, 12.18362844123435629, 12.06079423981340426, 11.93984536327155865, 11.82067114542362063, 11.70316780990088290, 11.58723779368528817, 11.47278914352520118, 11.35973497533277587, 11.24799298813115378, 11.13748502533664819, 11.02813667717266100, 10.91987691885505640, 10.81263777989406805, 10.70635404044629624, 10.60096295114513865, 10.49640397325026697, 10.39261853630181776, 10.28954981075152020, 10.18714249327895516, 10.08534260269351179, 9.98409728447573741, 9.88335462212982740, 9.78306345360453555, 9.68317319109484131, 9.58363364256187467, 9.48439483330459510, 9.38540682588187458, 9.28661953661730166, 9.18798254681750670, 9.08944490669501803, 8.99095492980287325, 8.89245997555361889, 8.79390621710134823, 8.69523839150005706, 8.59639952860070089, 8.49733065459408721, 8.39797046542294012, 8.29825496444376753, 8.19811705767780019, 8.09748609869834013, 7.99628737359293229, 7.89444151442374675, 7.79186382707194625, 7.68846351613519197, 7.58414278544128528, 7.47879578745954454, 7.37230738804155816, 7.26455170395951377, 7.15539035886744390, 7.04467038750017682, 6.93222169657757004, 6.81785396170597480, 6.70135279915969395, 6.58247499464238572, 6.46094249006060295, 6.33643471156883109, 6.20857864771972512, 6.07693582263793353, 5.94098490015626268, 5.80009800379551432, 5.65350776894915974, 5.50026032769285500, 5.33914621337716166, 5.16859521130418287, 4.98650948523582738, 4.78998474365843219, 4.57481307932222503};
    // run Temper chisquare::isf
    Tensor<float> result = stats::chisquare::isf(q, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.isf_random_test_dof_12
  * @brief Randomly generated chisquare isf test on 100 matrix with dof = 12.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, isf_random_test_dof_12)
{
    Tensor<float> q({100});
    q = std::vector<float>{0.05000000000000000, 0.05909090909090910, 0.06818181818181818, 0.07727272727272727, 0.08636363636363636, 0.09545454545454546, 0.10454545454545455, 0.11363636363636363, 0.12272727272727273, 0.13181818181818183, 0.14090909090909093, 0.14999999999999999, 0.15909090909090909, 0.16818181818181818, 0.17727272727272725, 0.18636363636363634, 0.19545454545454544, 0.20454545454545453, 0.21363636363636362, 0.22272727272727272, 0.23181818181818181, 0.24090909090909091, 0.25000000000000000, 0.25909090909090909, 0.26818181818181819, 0.27727272727272728, 0.28636363636363638, 0.29545454545454547, 0.30454545454545451, 0.31363636363636360, 0.32272727272727270, 0.33181818181818179, 0.34090909090909088, 0.34999999999999998, 0.35909090909090907, 0.36818181818181817, 0.37727272727272726, 0.38636363636363635, 0.39545454545454545, 0.40454545454545454, 0.41363636363636364, 0.42272727272727267, 0.43181818181818177, 0.44090909090909086, 0.44999999999999996, 0.45909090909090905, 0.46818181818181814, 0.47727272727272724, 0.48636363636363633, 0.49545454545454543, 0.50454545454545452, 0.51363636363636367, 0.52272727272727271, 0.53181818181818186, 0.54090909090909089, 0.55000000000000004, 0.55909090909090908, 0.56818181818181823, 0.57727272727272727, 0.58636363636363642, 0.59545454545454546, 0.60454545454545461, 0.61363636363636365, 0.62272727272727280, 0.63181818181818183, 0.64090909090909087, 0.65000000000000002, 0.65909090909090906, 0.66818181818181821, 0.67727272727272725, 0.68636363636363640, 0.69545454545454544, 0.70454545454545459, 0.71363636363636362, 0.72272727272727277, 0.73181818181818181, 0.74090909090909096, 0.75000000000000000, 0.75909090909090915, 0.76818181818181819, 0.77727272727272734, 0.78636363636363638, 0.79545454545454541, 0.80454545454545456, 0.81363636363636360, 0.82272727272727275, 0.83181818181818179, 0.84090909090909094, 0.84999999999999998, 0.85909090909090913, 0.86818181818181817, 0.87727272727272732, 0.88636363636363635, 0.89545454545454550, 0.90454545454545454, 0.91363636363636369, 0.92272727272727273, 0.93181818181818177, 0.94090909090909092, 0.94999999999999996};
    Tensor<float> k({1});
    k = 12.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{21.02606981748306936, 20.44687356367322906, 19.94248432795457404, 19.49451994226244977, 19.09067217365997138, 18.72228614560227555, 18.38303883782895554, 18.06816683089107656, 17.77398999573198424, 17.49760452460968452, 17.23667774593288726, 16.98930668116488718, 16.75391793450626921, 16.52919519839393558, 16.31402569612757247, 16.10745991002493582, 15.90868082022109675, 15.71698007538747710, 15.53173929802488651, 15.35241524877114649, 15.17852792957363661, 15.00965095204375466, 14.84540367104018088, 14.68544470782645739, 14.52946657730613467, 14.37719120006096496, 14.22836612912906773, 14.08276135842612931, 13.94016660776019023, 13.80038900087080656, 13.66325106951776291, 13.52858902956943510, 13.39625128518459540, 13.26609712519993067, 13.13799558221664121, 13.01182442998963396, 12.88746929883978432, 12.76482289214465027, 12.64378428967922829, 12.52425832580029663, 12.40615503229511773, 12.28938913722276283, 12.17387961232564031, 12.05954926262712767, 11.94632435269640069, 11.83413426478449182, 11.72291118464013238, 11.61258981131943990, 11.50310708772668100, 11.39440194897524172, 11.28641508595059229, 11.17908872169695123, 11.07236639844416359, 10.96619277324542985, 10.86051342031400502, 10.75527463823053509, 10.65042326024413200, 10.54590646591027436, 10.44167159229738395, 10.33766594295022045, 10.23383659272029256, 10.13013018645792229, 10.02649272940361058, 9.92286936691151489, 9.81920415087796883, 9.71543978992295010, 9.61151737996992139, 9.50737611137312122, 9.40295294813065574, 9.29818227397078090, 9.19299549917285219, 9.08732062084098402, 8.98108172793006077, 8.87419844055686546, 8.76658527091658968, 8.65815089033796781, 8.54879728347673051, 8.43841876613579345, 8.32690083739608156, 8.21411882921156788, 8.09993630676547305, 7.98420315985696849, 7.86675330818972363, 7.74740191993437488, 7.62594201080742717, 7.50214024639084354, 7.37573170783224974, 7.24641329167525683, 7.11383528464290293, 6.97759046167439934, 6.83719976406121965, 6.69209316261461584, 6.54158359095165221, 6.38483065179690623, 6.22078878865196216, 6.04813105484284286, 5.86513300168463481, 5.66948822462358049, 5.45799981054084693, 5.22602948839264059};
    // run Temper chisquare::isf
    Tensor<float> result = stats::chisquare::isf(q, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.isf_random_test_dof_13
  * @brief Randomly generated chisquare isf test on 100 matrix with dof = 13.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, isf_random_test_dof_13)
{
    Tensor<float> q({100});
    q = std::vector<float>{0.05000000000000000, 0.05909090909090910, 0.06818181818181818, 0.07727272727272727, 0.08636363636363636, 0.09545454545454546, 0.10454545454545455, 0.11363636363636363, 0.12272727272727273, 0.13181818181818183, 0.14090909090909093, 0.14999999999999999, 0.15909090909090909, 0.16818181818181818, 0.17727272727272725, 0.18636363636363634, 0.19545454545454544, 0.20454545454545453, 0.21363636363636362, 0.22272727272727272, 0.23181818181818181, 0.24090909090909091, 0.25000000000000000, 0.25909090909090909, 0.26818181818181819, 0.27727272727272728, 0.28636363636363638, 0.29545454545454547, 0.30454545454545451, 0.31363636363636360, 0.32272727272727270, 0.33181818181818179, 0.34090909090909088, 0.34999999999999998, 0.35909090909090907, 0.36818181818181817, 0.37727272727272726, 0.38636363636363635, 0.39545454545454545, 0.40454545454545454, 0.41363636363636364, 0.42272727272727267, 0.43181818181818177, 0.44090909090909086, 0.44999999999999996, 0.45909090909090905, 0.46818181818181814, 0.47727272727272724, 0.48636363636363633, 0.49545454545454543, 0.50454545454545452, 0.51363636363636367, 0.52272727272727271, 0.53181818181818186, 0.54090909090909089, 0.55000000000000004, 0.55909090909090908, 0.56818181818181823, 0.57727272727272727, 0.58636363636363642, 0.59545454545454546, 0.60454545454545461, 0.61363636363636365, 0.62272727272727280, 0.63181818181818183, 0.64090909090909087, 0.65000000000000002, 0.65909090909090906, 0.66818181818181821, 0.67727272727272725, 0.68636363636363640, 0.69545454545454544, 0.70454545454545459, 0.71363636363636362, 0.72272727272727277, 0.73181818181818181, 0.74090909090909096, 0.75000000000000000, 0.75909090909090915, 0.76818181818181819, 0.77727272727272734, 0.78636363636363638, 0.79545454545454541, 0.80454545454545456, 0.81363636363636360, 0.82272727272727275, 0.83181818181818179, 0.84090909090909094, 0.84999999999999998, 0.85909090909090913, 0.86818181818181817, 0.87727272727272732, 0.88636363636363635, 0.89545454545454550, 0.90454545454545454, 0.91363636363636369, 0.92272727272727273, 0.93181818181818177, 0.94090909090909092, 0.94999999999999996};
    Tensor<float> k({1});
    k = 13.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{22.36203249482694488, 21.76626060648747440, 21.24715638163688070, 20.78589550567021860, 20.36987040961799877, 19.99021365061311428, 19.64044552405116661, 19.31568360414848229, 19.01215511919223999, 18.72688263933199337, 18.45747395122562651, 18.20197718891290251, 17.95877828495707362, 17.72652670072450931, 17.50408055095053683, 17.29046533608307357, 17.08484241699432360, 16.88648459122563494, 16.69475692994998184, 16.50910156912004112, 16.32902551222483822, 16.15409075449236198, 15.98390621631205200, 15.81812110097029667, 15.65641938414696099, 15.49851521046281633, 15.34414902278580151, 15.19308428787937082, 15.04510471071543876, 14.90001185178572207, 14.75762307875108448, 14.61776979701434165, 14.48029591419856565, 14.34505650173129432, 14.21191662327560223, 14.08075030498720182, 13.95143962679688165, 13.82387391733614024, 13.69794903790804064, 13.57356674318345036, 13.45063410817524563, 13.32906301258877058, 13.20876967492668541, 13.08967422979084994, 12.97170034270968486, 12.85477485756035954, 12.73882747227353107, 12.62379043902581621, 12.50959828555729736, 12.39618755461096633, 12.28349655878876767, 12.17146514836291438, 12.06003448977825876, 11.94914685273643862, 11.83874540386952923, 11.72877400509255708, 11.61917701477195131, 11.50989908986229082, 11.40088498714530196, 11.29207936165271420, 11.18342656026557158, 11.07487040835346193, 10.96635398714347254, 10.85781939928346418, 10.74920751978008582, 10.64045772913694243, 10.53150762507997840, 10.42229270871670188, 10.31274604031217912, 10.20279785904806147, 10.09237516012543345, 9.98140122132969942, 9.86979506963538178, 9.75747087650921685, 9.64433726816663750, 9.53029653400839649, 9.41524371262490334, 9.29906552985214319, 9.18163915705326517, 9.06283074961186941, 8.94249371490200495, 8.82046664482700749, 8.69657082908503298, 8.57060723973788541, 8.44235284267119113, 8.31155604303813966, 8.17793100357787317, 8.04115047724907939, 7.90083665392036938, 7.75654931080184973, 7.60777023815869047, 7.45388241831121423, 7.29414164937524934, 7.12763701273939887, 6.95323438388471882, 6.76949328886504631, 6.57454016777267292, 6.36586687372610438, 6.13999328623425811, 5.89186433770984941};
    // run Temper chisquare::isf
    Tensor<float> result = stats::chisquare::isf(q, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.isf_random_test_dof_14
  * @brief Randomly generated chisquare isf test on 100 matrix with dof = 14.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, isf_random_test_dof_14)
{
    Tensor<float> q({100});
    q = std::vector<float>{0.05000000000000000, 0.05909090909090910, 0.06818181818181818, 0.07727272727272727, 0.08636363636363636, 0.09545454545454546, 0.10454545454545455, 0.11363636363636363, 0.12272727272727273, 0.13181818181818183, 0.14090909090909093, 0.14999999999999999, 0.15909090909090909, 0.16818181818181818, 0.17727272727272725, 0.18636363636363634, 0.19545454545454544, 0.20454545454545453, 0.21363636363636362, 0.22272727272727272, 0.23181818181818181, 0.24090909090909091, 0.25000000000000000, 0.25909090909090909, 0.26818181818181819, 0.27727272727272728, 0.28636363636363638, 0.29545454545454547, 0.30454545454545451, 0.31363636363636360, 0.32272727272727270, 0.33181818181818179, 0.34090909090909088, 0.34999999999999998, 0.35909090909090907, 0.36818181818181817, 0.37727272727272726, 0.38636363636363635, 0.39545454545454545, 0.40454545454545454, 0.41363636363636364, 0.42272727272727267, 0.43181818181818177, 0.44090909090909086, 0.44999999999999996, 0.45909090909090905, 0.46818181818181814, 0.47727272727272724, 0.48636363636363633, 0.49545454545454543, 0.50454545454545452, 0.51363636363636367, 0.52272727272727271, 0.53181818181818186, 0.54090909090909089, 0.55000000000000004, 0.55909090909090908, 0.56818181818181823, 0.57727272727272727, 0.58636363636363642, 0.59545454545454546, 0.60454545454545461, 0.61363636363636365, 0.62272727272727280, 0.63181818181818183, 0.64090909090909087, 0.65000000000000002, 0.65909090909090906, 0.66818181818181821, 0.67727272727272725, 0.68636363636363640, 0.69545454545454544, 0.70454545454545459, 0.71363636363636362, 0.72272727272727277, 0.73181818181818181, 0.74090909090909096, 0.75000000000000000, 0.75909090909090915, 0.76818181818181819, 0.77727272727272734, 0.78636363636363638, 0.79545454545454541, 0.80454545454545456, 0.81363636363636360, 0.82272727272727275, 0.83181818181818179, 0.84090909090909094, 0.84999999999999998, 0.85909090909090913, 0.86818181818181817, 0.87727272727272732, 0.88636363636363635, 0.89545454545454550, 0.90454545454545454, 0.91363636363636369, 0.92272727272727273, 0.93181818181818177, 0.94090909090909092, 0.94999999999999996};
    Tensor<float> k({1});
    k = 14.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{23.68479130484057649, 23.07308038389362892, 22.53982847651444388, 22.06578542386615283, 21.63805539113996801, 21.24756625126764575, 20.88768743903655078, 20.55342195507968128, 20.24090784250517316, 19.94709680188907797, 19.66953930792843863, 19.40623644084892874, 19.15553498922880848, 18.91605147083535243, 18.68661598803302581, 18.46623000130962922, 18.25403406831973996, 18.04928284779154879, 17.85132548561641030, 17.65959004676164312, 17.47357102883214353, 17.29281925124880104, 17.11693359600006659, 16.94555420615035146, 16.77835684276045924, 16.61504817027614678, 16.45536179202112947, 16.29905489618166570, 16.14590540207498393, 15.99570951901664095, 15.84827964750357232, 15.70344256598494326, 15.56103785713218990, 15.42091653593114842, 15.28293984861284116, 15.14697821680128698, 15.01291030557562500, 14.88062219764356264, 14.75000665867241878, 14.62096248115608077, 14.49339389611258611, 14.36721004348896358, 14.24232449345980633, 14.11865481189500571, 13.99612216417869348, 13.87465095231855905, 13.75416848091728816, 13.63460464810616557, 13.51589165798232628, 13.39796375145715146, 13.28075695272712942, 13.16420882882542287, 13.04825825991229671, 12.93284521811800936, 12.81791055286853442, 12.70339578070374742, 12.58924287764263639, 12.47539407215981910, 12.36179163681318016, 12.24837767650126708, 12.13509391122940251, 12.02188145112144291, 11.90868056122384644, 11.79543041340459020, 11.68206882234081334, 11.56853196220594704, 11.45475406019333953, 11.34066706243092426, 11.22620026712587382, 11.11127991889858713, 10.99582875718233588, 10.87976551022685179, 10.76300432458531731, 10.64545411789754503, 10.52701784019353326, 10.40759162568032714, 10.28706381283916649, 10.16531380537706220, 10.04221073977729795, 9.91761191636815909, 9.79136093927131590, 9.66328549530828340, 9.53319468152080951, 9.40087576336187780, 9.26609020785435966, 9.12856878366247670, 8.98800544637378174, 8.84404962202231459, 8.69629634876529245, 8.54427350955694109, 8.38742504461965765, 8.22508849857654489, 8.05646440579495859, 7.88057361794817712, 7.69619629495955326, 7.50178205578107526, 7.29531293134370085, 7.07408531372471039, 6.83434456379721578, 6.57063138378934397};
    // run Temper chisquare::isf
    Tensor<float> result = stats::chisquare::isf(q, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.isf_random_test_dof_15
  * @brief Randomly generated chisquare isf test on 100 matrix with dof = 15.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, isf_random_test_dof_15)
{
    Tensor<float> q({100});
    q = std::vector<float>{0.05000000000000000, 0.05909090909090910, 0.06818181818181818, 0.07727272727272727, 0.08636363636363636, 0.09545454545454546, 0.10454545454545455, 0.11363636363636363, 0.12272727272727273, 0.13181818181818183, 0.14090909090909093, 0.14999999999999999, 0.15909090909090909, 0.16818181818181818, 0.17727272727272725, 0.18636363636363634, 0.19545454545454544, 0.20454545454545453, 0.21363636363636362, 0.22272727272727272, 0.23181818181818181, 0.24090909090909091, 0.25000000000000000, 0.25909090909090909, 0.26818181818181819, 0.27727272727272728, 0.28636363636363638, 0.29545454545454547, 0.30454545454545451, 0.31363636363636360, 0.32272727272727270, 0.33181818181818179, 0.34090909090909088, 0.34999999999999998, 0.35909090909090907, 0.36818181818181817, 0.37727272727272726, 0.38636363636363635, 0.39545454545454545, 0.40454545454545454, 0.41363636363636364, 0.42272727272727267, 0.43181818181818177, 0.44090909090909086, 0.44999999999999996, 0.45909090909090905, 0.46818181818181814, 0.47727272727272724, 0.48636363636363633, 0.49545454545454543, 0.50454545454545452, 0.51363636363636367, 0.52272727272727271, 0.53181818181818186, 0.54090909090909089, 0.55000000000000004, 0.55909090909090908, 0.56818181818181823, 0.57727272727272727, 0.58636363636363642, 0.59545454545454546, 0.60454545454545461, 0.61363636363636365, 0.62272727272727280, 0.63181818181818183, 0.64090909090909087, 0.65000000000000002, 0.65909090909090906, 0.66818181818181821, 0.67727272727272725, 0.68636363636363640, 0.69545454545454544, 0.70454545454545459, 0.71363636363636362, 0.72272727272727277, 0.73181818181818181, 0.74090909090909096, 0.75000000000000000, 0.75909090909090915, 0.76818181818181819, 0.77727272727272734, 0.78636363636363638, 0.79545454545454541, 0.80454545454545456, 0.81363636363636360, 0.82272727272727275, 0.83181818181818179, 0.84090909090909094, 0.84999999999999998, 0.85909090909090913, 0.86818181818181817, 0.87727272727272732, 0.88636363636363635, 0.89545454545454550, 0.90454545454545454, 0.91363636363636369, 0.92272727272727273, 0.93181818181818177, 0.94090909090909092, 0.94999999999999996};
    Tensor<float> k({1});
    k = 15.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{24.99579013972862995, 24.36870831805379467, 23.82181483073250661, 23.33544828106626312, 22.89643448425882966, 22.49550368756304408, 22.12587967925717081, 21.78245485434712236, 21.46128116515955853, 21.15924190578036601, 20.87383223395555376, 20.60300781641198142, 20.34507766417672414, 20.09862650287782770, 19.86245740278634742, 19.63554862664797795, 19.41702065850154213, 19.20611065506340864, 19.00215239657038069, 18.80456037191955687, 18.61281701307669678, 18.42646235739855598, 18.24508560241513422, 18.06831815065393343, 17.89582783860283755, 17.72731411481515806, 17.56250398486221442, 17.40114858043515866, 17.24302023994574995, 17.08791001099235984, 16.93562550284153190, 16.78598903092921191, 16.63883600625991477, 16.49401353117935187, 16.35137916983818585, 16.21079986714504884, 16.07215099442197825, 15.93531550355262993, 15.80018317432651287, 15.66664994206608341, 15.53461729458249430, 15.40399172912272618, 15.27468426130961099, 15.14660997918883290, 15.01968763642331162, 14.89383927944899177, 14.76898990405127599, 14.64506713736122023, 14.52200094171968381, 14.39972333723158471, 14.27816814014004443, 14.15727071440176843, 14.03696773404636744, 13.91719695405897639, 13.79789698764134442, 13.67900708778458529, 13.56046693112765844, 13.44221640208120938, 13.32419537516524777, 13.20634349343963443, 13.08859994079660893, 12.97090320572947597, 12.85319083398588447, 12.73539916725094123, 12.61746306467387591, 12.49931560364067984, 12.38088775568786915, 12.26210803282884143, 12.14290209879855631, 12.02319233878177229, 11.90289738003155406, 11.78193155435455708, 11.66020429166571759, 11.53761943160543879, 11.41407443744439298, 11.28945949301372131, 11.16365645897464454, 11.03653765909100848, 10.90796445989333208, 10.77778559767970101, 10.64583519442903459, 10.51193038784172629, 10.37586847885628849, 10.23742347043208056, 10.09634183093928250, 9.95233725940105352, 9.80508415089733809, 9.65420934758120453, 9.49928159654871074, 9.33979789220770229, 9.17516551158146498, 9.00467797778397205, 8.82748227263424567, 8.64253311571728311, 8.44852756594465149, 8.24380865844036315, 8.02621833885190483, 7.79286332573236340, 7.53972248554428770, 7.26094392767003249};
    // run Temper chisquare::isf
    Tensor<float> result = stats::chisquare::isf(q, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.isf_random_test_dof_16
  * @brief Randomly generated chisquare isf test on 100 matrix with dof = 16.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, isf_random_test_dof_16)
{
    Tensor<float> q({100});
    q = std::vector<float>{0.05000000000000000, 0.05909090909090910, 0.06818181818181818, 0.07727272727272727, 0.08636363636363636, 0.09545454545454546, 0.10454545454545455, 0.11363636363636363, 0.12272727272727273, 0.13181818181818183, 0.14090909090909093, 0.14999999999999999, 0.15909090909090909, 0.16818181818181818, 0.17727272727272725, 0.18636363636363634, 0.19545454545454544, 0.20454545454545453, 0.21363636363636362, 0.22272727272727272, 0.23181818181818181, 0.24090909090909091, 0.25000000000000000, 0.25909090909090909, 0.26818181818181819, 0.27727272727272728, 0.28636363636363638, 0.29545454545454547, 0.30454545454545451, 0.31363636363636360, 0.32272727272727270, 0.33181818181818179, 0.34090909090909088, 0.34999999999999998, 0.35909090909090907, 0.36818181818181817, 0.37727272727272726, 0.38636363636363635, 0.39545454545454545, 0.40454545454545454, 0.41363636363636364, 0.42272727272727267, 0.43181818181818177, 0.44090909090909086, 0.44999999999999996, 0.45909090909090905, 0.46818181818181814, 0.47727272727272724, 0.48636363636363633, 0.49545454545454543, 0.50454545454545452, 0.51363636363636367, 0.52272727272727271, 0.53181818181818186, 0.54090909090909089, 0.55000000000000004, 0.55909090909090908, 0.56818181818181823, 0.57727272727272727, 0.58636363636363642, 0.59545454545454546, 0.60454545454545461, 0.61363636363636365, 0.62272727272727280, 0.63181818181818183, 0.64090909090909087, 0.65000000000000002, 0.65909090909090906, 0.66818181818181821, 0.67727272727272725, 0.68636363636363640, 0.69545454545454544, 0.70454545454545459, 0.71363636363636362, 0.72272727272727277, 0.73181818181818181, 0.74090909090909096, 0.75000000000000000, 0.75909090909090915, 0.76818181818181819, 0.77727272727272734, 0.78636363636363638, 0.79545454545454541, 0.80454545454545456, 0.81363636363636360, 0.82272727272727275, 0.83181818181818179, 0.84090909090909094, 0.84999999999999998, 0.85909090909090913, 0.86818181818181817, 0.87727272727272732, 0.88636363636363635, 0.89545454545454550, 0.90454545454545454, 0.91363636363636369, 0.92272727272727273, 0.93181818181818177, 0.94090909090909092, 0.94999999999999996};
    Tensor<float> k({1});
    k = 16.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{26.29622760486424227, 25.65428603432647492, 25.09420616254972813, 24.59592854208238677, 24.14600958832944855, 23.73498829263084886, 23.35594750117887841, 23.00367258282720329, 22.67413219012473746, 22.36414343193441212, 22.07114794795873891, 21.79305747032077178, 21.52814446431960960, 21.27496290135877288, 21.03228970313872992, 20.79908069368079282, 20.57443694087571018, 20.35757867322183756, 20.14782480951694410, 19.94457670846577457, 19.74730513299202173, 19.55553969307068485, 19.36886022058451218, 19.18688966546203645, 19.00928820084745041, 18.83574829741601064, 18.66599058073691708, 18.49976032599941433, 18.33682447508860136, 18.17696908449135407, 18.01999713066715003, 17.86572661366096426, 17.71398891083691396, 17.56462734138832715, 17.41749590926572111, 17.27245819775939850, 17.12938639348140768, 16.98816042114390967, 16.84866717350523402, 16.71079982328834390, 16.57445720587700677, 16.43954326324518789, 16.30596654094221876, 16.17363973109183561, 16.04247925530856733, 15.91240488222400096, 15.78333937497382067, 15.65520816454643693, 15.52793904535203673, 15.40146188975041852, 15.27570837858951158, 15.15061174506097252, 15.02610652938249913, 14.90212834197443037, 14.77861363291313701, 14.65549946551977811, 14.53272329198118307, 14.41022272890002220, 14.28793533063419652, 14.16579835820810551, 14.04374854145825147, 13.92172183190847790, 13.79965314364905105, 13.67747607921246455, 13.55512263708449794, 13.43252289705132796, 13.30960467904290034, 13.18629317046923255, 13.06251051623241644, 12.93817536459662243, 12.81320236086739683, 12.68750157931116718, 12.56097788186079711, 12.43353018980436175, 12.30505065171245072, 12.17542368715197121, 12.04452488103162189, 11.91221969741599374, 11.77836197390890938, 11.64279214766277626, 11.50533515091177073, 11.36579789651945127, 11.22396625076101628, 11.07960135909829802, 10.93243514764140656, 10.78216476325515139, 10.62844563119035612, 10.47088268887958229, 10.30901917953864810, 10.14232212954323664, 9.97016323985647368, 9.79179331037806122, 9.60630734054681845, 9.41259584451732856, 9.20927518427091485, 8.99458487060912226, 8.76623075010011377, 8.52113521177389188, 8.25501805067089656, 7.96164557237855242};
    // run Temper chisquare::isf
    Tensor<float> result = stats::chisquare::isf(q, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.isf_random_test_dof_17
  * @brief Randomly generated chisquare isf test on 100 matrix with dof = 17.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, isf_random_test_dof_17)
{
    Tensor<float> q({100});
    q = std::vector<float>{0.05000000000000000, 0.05909090909090910, 0.06818181818181818, 0.07727272727272727, 0.08636363636363636, 0.09545454545454546, 0.10454545454545455, 0.11363636363636363, 0.12272727272727273, 0.13181818181818183, 0.14090909090909093, 0.14999999999999999, 0.15909090909090909, 0.16818181818181818, 0.17727272727272725, 0.18636363636363634, 0.19545454545454544, 0.20454545454545453, 0.21363636363636362, 0.22272727272727272, 0.23181818181818181, 0.24090909090909091, 0.25000000000000000, 0.25909090909090909, 0.26818181818181819, 0.27727272727272728, 0.28636363636363638, 0.29545454545454547, 0.30454545454545451, 0.31363636363636360, 0.32272727272727270, 0.33181818181818179, 0.34090909090909088, 0.34999999999999998, 0.35909090909090907, 0.36818181818181817, 0.37727272727272726, 0.38636363636363635, 0.39545454545454545, 0.40454545454545454, 0.41363636363636364, 0.42272727272727267, 0.43181818181818177, 0.44090909090909086, 0.44999999999999996, 0.45909090909090905, 0.46818181818181814, 0.47727272727272724, 0.48636363636363633, 0.49545454545454543, 0.50454545454545452, 0.51363636363636367, 0.52272727272727271, 0.53181818181818186, 0.54090909090909089, 0.55000000000000004, 0.55909090909090908, 0.56818181818181823, 0.57727272727272727, 0.58636363636363642, 0.59545454545454546, 0.60454545454545461, 0.61363636363636365, 0.62272727272727280, 0.63181818181818183, 0.64090909090909087, 0.65000000000000002, 0.65909090909090906, 0.66818181818181821, 0.67727272727272725, 0.68636363636363640, 0.69545454545454544, 0.70454545454545459, 0.71363636363636362, 0.72272727272727277, 0.73181818181818181, 0.74090909090909096, 0.75000000000000000, 0.75909090909090915, 0.76818181818181819, 0.77727272727272734, 0.78636363636363638, 0.79545454545454541, 0.80454545454545456, 0.81363636363636360, 0.82272727272727275, 0.83181818181818179, 0.84090909090909094, 0.84999999999999998, 0.85909090909090913, 0.86818181818181817, 0.87727272727272732, 0.88636363636363635, 0.89545454545454550, 0.90454545454545454, 0.91363636363636369, 0.92272727272727273, 0.93181818181818177, 0.94090909090909092, 0.94999999999999996};
    Tensor<float> k({1});
    k = 17.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{27.58711163827533497, 26.93077344542500384, 26.35791949749312124, 25.84810428122101911, 25.38762294472649828, 24.96682901016722411, 24.57866865474205653, 24.21782347193900975, 23.88018134889131971, 23.56249522599341617, 23.26215485799116678, 22.97702938482755641, 22.70535584410962215, 22.44565839496439352, 22.19668861228020162, 21.95738057007070054, 21.72681651660283109, 21.50420027272400247, 21.28883635320334022, 21.08011339101431503, 20.87749083977372067, 20.68048820377219243, 20.48867623839150554, 20.30166970209379329, 20.11912134157874732, 19.94071686548097588, 19.76617071682141002, 19.59522249563325147, 19.42763391445746990, 19.26318619335973636, 19.10167781963420808, 18.94292261178154391, 18.78674803867098575, 18.63299375374694122, 18.48151031126631239, 18.33215803725870074, 18.18480603250037220, 18.03933128851749856, 17.89561790066811042, 17.75355636483435617, 17.61304294629657363, 17.47397911104436830, 17.33627101117349767, 17.19982901717543200, 17.06456729089032009, 16.93040339369814262, 16.79725792519393224, 16.66505418815247808, 16.53371787605448517, 16.40317677983193789, 16.27336051080832746, 16.14420023706759721, 16.01562843069104858, 15.88757862345937788, 15.75998516873233513, 15.63278300729212056, 15.50590743497191859, 15.37929386988690617, 15.25287761704181122, 15.12659362800376961, 15.00037625319961698, 14.87415898421713401, 14.74787418325442978, 14.62145279656190944, 14.49482404834557059, 14.36791511113613495, 14.24065074805590747, 14.11295292171349480, 13.98474036359436923, 13.85592809675815218, 13.72642690335071336, 13.59614272683186620, 13.46497599682576407, 13.33282086201746885, 13.19956431340786018, 13.06508517631798583, 12.92925294455955587, 12.79192642383199185, 12.65295214322149420, 12.51216248304904255, 12.36937345338756877, 12.22438203914265387, 12.07696300295446790, 11.92686500386339610, 11.77380584407238651, 11.61746659285948269, 11.45748424760987128, 11.29344246450745715, 11.12485970592237017, 10.95117387620066474, 10.77172210001963748, 10.58571364884579324, 10.39219298579441464, 10.18998819540922263, 9.97763716060863537, 9.75327869323802332, 9.51448622611206396, 9.25800276578456049, 8.97929591784049030, 8.67176020467007724};
    // run Temper chisquare::isf
    Tensor<float> result = stats::chisquare::isf(q, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.isf_random_test_dof_18
  * @brief Randomly generated chisquare isf test on 100 matrix with dof = 18.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, isf_random_test_dof_18)
{
    Tensor<float> q({100});
    q = std::vector<float>{0.05000000000000000, 0.05909090909090910, 0.06818181818181818, 0.07727272727272727, 0.08636363636363636, 0.09545454545454546, 0.10454545454545455, 0.11363636363636363, 0.12272727272727273, 0.13181818181818183, 0.14090909090909093, 0.14999999999999999, 0.15909090909090909, 0.16818181818181818, 0.17727272727272725, 0.18636363636363634, 0.19545454545454544, 0.20454545454545453, 0.21363636363636362, 0.22272727272727272, 0.23181818181818181, 0.24090909090909091, 0.25000000000000000, 0.25909090909090909, 0.26818181818181819, 0.27727272727272728, 0.28636363636363638, 0.29545454545454547, 0.30454545454545451, 0.31363636363636360, 0.32272727272727270, 0.33181818181818179, 0.34090909090909088, 0.34999999999999998, 0.35909090909090907, 0.36818181818181817, 0.37727272727272726, 0.38636363636363635, 0.39545454545454545, 0.40454545454545454, 0.41363636363636364, 0.42272727272727267, 0.43181818181818177, 0.44090909090909086, 0.44999999999999996, 0.45909090909090905, 0.46818181818181814, 0.47727272727272724, 0.48636363636363633, 0.49545454545454543, 0.50454545454545452, 0.51363636363636367, 0.52272727272727271, 0.53181818181818186, 0.54090909090909089, 0.55000000000000004, 0.55909090909090908, 0.56818181818181823, 0.57727272727272727, 0.58636363636363642, 0.59545454545454546, 0.60454545454545461, 0.61363636363636365, 0.62272727272727280, 0.63181818181818183, 0.64090909090909087, 0.65000000000000002, 0.65909090909090906, 0.66818181818181821, 0.67727272727272725, 0.68636363636363640, 0.69545454545454544, 0.70454545454545459, 0.71363636363636362, 0.72272727272727277, 0.73181818181818181, 0.74090909090909096, 0.75000000000000000, 0.75909090909090915, 0.76818181818181819, 0.77727272727272734, 0.78636363636363638, 0.79545454545454541, 0.80454545454545456, 0.81363636363636360, 0.82272727272727275, 0.83181818181818179, 0.84090909090909094, 0.84999999999999998, 0.85909090909090913, 0.86818181818181817, 0.87727272727272732, 0.88636363636363635, 0.89545454545454550, 0.90454545454545454, 0.91363636363636369, 0.92272727272727273, 0.93181818181818177, 0.94090909090909092, 0.94999999999999996};
    Tensor<float> k({1});
    k = 18.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{28.86929943039263691, 28.19898681357033965, 27.61373456333228305, 27.09272205650768228, 26.62199060671595063, 26.19171355486532704, 25.79470431332882896, 25.42554366994218640, 25.08004106136359113, 24.75488710145214455, 24.44742115136037697, 24.15547098465354026, 23.87723923205936671, 23.61122110039060829, 23.35614354963803407, 23.11091953247932196, 22.87461302203507429, 22.64641190661667025, 22.42560671441038167, 22.21157372175856537, 22.00376140123695023, 21.80167944499166310, 21.60488979572816248, 21.41299925869537191, 21.22565337028217769, 21.04253127399296019, 20.86334141043289137, 20.68781786991150184, 20.51571728813332740, 20.34681618985157669, 20.18090870422280503, 20.01780459029458470, 19.85732752259438527, 19.69931359590850306, 19.54361001560003430, 19.39007394562977282, 19.23857149112945919, 19.08897679617292908, 18.94117124048167966, 18.79504272133106113, 18.65048500900196160, 18.50739716583813532, 18.36568302038956446, 18.22525068930171699, 18.08601214059240547, 17.94788279277685561, 17.81078114498458120, 17.67462843378125470, 17.53934831288261975, 17.40486655234021640, 17.27111075410049423, 17.13801008110063862, 17.00549499727171820, 16.87349701597831952, 16.74194845453875047, 16.61078219254161326, 16.47993143170690544, 16.34932945503136992, 16.21890938290848538, 16.08860392382074878, 15.95834511706265069, 15.82806406476152539, 15.69769065021359467, 15.56715323923540772, 15.43637836083429526, 15.30529036301099133, 15.17381103890465077, 15.04185921775019530, 14.90935031421049572, 14.77619582853184887, 14.64230278859999324, 14.50757312328112114, 14.37190295433305742, 14.23518179155694874, 14.09729161258313468, 13.95810580455594163, 13.81748793974280076, 13.67529035039829033, 13.53135245959111721, 13.38549881350421344, 13.23753674604349051, 13.08725358717200038, 12.93441330041857817, 12.77875239988871847, 12.61997494901510564, 12.45774637655218342, 12.29168575135420127, 12.12135602303954407, 11.94625153989723287, 11.76578186479380683, 11.57925046903780952, 11.38582619923047545, 11.18450431865975681, 10.97405212465693580, 10.75293107386104730, 10.51918189642468882, 10.27024902852354948, 10.00270068619917652, 9.71175868158389832, 9.39045508068898194};
    // run Temper chisquare::isf
    Tensor<float> result = stats::chisquare::isf(q, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.isf_random_test_dof_19
  * @brief Randomly generated chisquare isf test on 100 matrix with dof = 19.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, isf_random_test_dof_19)
{
    Tensor<float> q({100});
    q = std::vector<float>{0.05000000000000000, 0.05909090909090910, 0.06818181818181818, 0.07727272727272727, 0.08636363636363636, 0.09545454545454546, 0.10454545454545455, 0.11363636363636363, 0.12272727272727273, 0.13181818181818183, 0.14090909090909093, 0.14999999999999999, 0.15909090909090909, 0.16818181818181818, 0.17727272727272725, 0.18636363636363634, 0.19545454545454544, 0.20454545454545453, 0.21363636363636362, 0.22272727272727272, 0.23181818181818181, 0.24090909090909091, 0.25000000000000000, 0.25909090909090909, 0.26818181818181819, 0.27727272727272728, 0.28636363636363638, 0.29545454545454547, 0.30454545454545451, 0.31363636363636360, 0.32272727272727270, 0.33181818181818179, 0.34090909090909088, 0.34999999999999998, 0.35909090909090907, 0.36818181818181817, 0.37727272727272726, 0.38636363636363635, 0.39545454545454545, 0.40454545454545454, 0.41363636363636364, 0.42272727272727267, 0.43181818181818177, 0.44090909090909086, 0.44999999999999996, 0.45909090909090905, 0.46818181818181814, 0.47727272727272724, 0.48636363636363633, 0.49545454545454543, 0.50454545454545452, 0.51363636363636367, 0.52272727272727271, 0.53181818181818186, 0.54090909090909089, 0.55000000000000004, 0.55909090909090908, 0.56818181818181823, 0.57727272727272727, 0.58636363636363642, 0.59545454545454546, 0.60454545454545461, 0.61363636363636365, 0.62272727272727280, 0.63181818181818183, 0.64090909090909087, 0.65000000000000002, 0.65909090909090906, 0.66818181818181821, 0.67727272727272725, 0.68636363636363640, 0.69545454545454544, 0.70454545454545459, 0.71363636363636362, 0.72272727272727277, 0.73181818181818181, 0.74090909090909096, 0.75000000000000000, 0.75909090909090915, 0.76818181818181819, 0.77727272727272734, 0.78636363636363638, 0.79545454545454541, 0.80454545454545456, 0.81363636363636360, 0.82272727272727275, 0.83181818181818179, 0.84090909090909094, 0.84999999999999998, 0.85909090909090913, 0.86818181818181817, 0.87727272727272732, 0.88636363636363635, 0.89545454545454550, 0.90454545454545454, 0.91363636363636369, 0.92272727272727273, 0.93181818181818177, 0.94090909090909092, 0.94999999999999996};
    Tensor<float> k({1});
    k = 19.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{30.14352720564615495, 29.45962714294925888, 28.86232093656753150, 28.33042292024865816, 27.84972740153070703, 27.41023239728095717, 27.00462214070642375, 26.62737934108841742, 26.27423711018511554, 25.94182542640270128, 25.62743462639084058, 25.32885224253741896, 25.04424743564611333, 24.77208724947116281, 24.51107470079206152, 24.26010219784933497, 24.01821593822242562, 23.78458831361870907, 23.55849624863782310, 23.33930400161275998, 23.12644936522169203, 22.91943248873975492, 22.71780674419985502, 22.52117120217559076, 22.32916438698607209, 22.14145905760797106, 21.95775781743938637, 21.77778939878814413, 21.60130550038708463, 21.42807808108485901, 21.25789703206100967, 21.09056816487355590, 20.92591146439121275, 20.76375956494814545, 20.60395641545057899, 20.44635610508502310, 20.29082182604843609, 20.13722495358544506, 19.98544422676501142, 19.83536501600478275, 19.68687866546697052, 19.53988190019677873, 19.39427628931944980, 19.24996775781293579, 19.10686614037263098, 18.96488477171725862, 18.82394010838039833, 18.68395137761062941, 18.54484024948543208, 18.40653052874198536, 18.26894786315469688, 18.13201946555431832, 17.99567384679198057, 17.85984055711166363, 17.72444993350811160, 17.58943285071775264, 17.45472047351958977, 17.32024400800985475, 17.18593444945962290, 17.05172232426419043, 16.91753742334446997, 16.78330852415808039, 16.64896309821400777, 16.51442700065051028, 16.37962413801862027, 16.24447610989846069, 16.10890181934215093, 15.97281704635990174, 15.83613397771387099, 15.69876068511523570, 15.56060054248159119, 15.42155157113574582, 15.28150569962515348, 15.14034792209759850, 14.99795533573184692, 14.85419603338942451, 14.70892782215658556, 14.56199673142022810, 14.41323526507220443, 14.26246034068347690, 14.10947084308487476, 13.95404469940439007, 13.79593535534426074, 13.63486749559772981, 13.47053180079474011, 13.30257846326199278, 13.13060908515576841, 12.95416644124944661, 12.77272138291334436, 12.58565585432314649, 12.39224052842671497, 12.19160484982698378, 11.98269612140478557, 11.76422237726722386, 11.53457055377987928, 11.29168573125765107, 11.03288652682354964, 10.75457063998455709, 10.45172004879672301, 10.11701306385905141};
    // run Temper chisquare::isf
    Tensor<float> result = stats::chisquare::isf(q, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.isf_random_test_dof_20
  * @brief Randomly generated chisquare isf test on 100 matrix with dof = 20.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, isf_random_test_dof_20)
{
    Tensor<float> q({100});
    q = std::vector<float>{0.05000000000000000, 0.05909090909090910, 0.06818181818181818, 0.07727272727272727, 0.08636363636363636, 0.09545454545454546, 0.10454545454545455, 0.11363636363636363, 0.12272727272727273, 0.13181818181818183, 0.14090909090909093, 0.14999999999999999, 0.15909090909090909, 0.16818181818181818, 0.17727272727272725, 0.18636363636363634, 0.19545454545454544, 0.20454545454545453, 0.21363636363636362, 0.22272727272727272, 0.23181818181818181, 0.24090909090909091, 0.25000000000000000, 0.25909090909090909, 0.26818181818181819, 0.27727272727272728, 0.28636363636363638, 0.29545454545454547, 0.30454545454545451, 0.31363636363636360, 0.32272727272727270, 0.33181818181818179, 0.34090909090909088, 0.34999999999999998, 0.35909090909090907, 0.36818181818181817, 0.37727272727272726, 0.38636363636363635, 0.39545454545454545, 0.40454545454545454, 0.41363636363636364, 0.42272727272727267, 0.43181818181818177, 0.44090909090909086, 0.44999999999999996, 0.45909090909090905, 0.46818181818181814, 0.47727272727272724, 0.48636363636363633, 0.49545454545454543, 0.50454545454545452, 0.51363636363636367, 0.52272727272727271, 0.53181818181818186, 0.54090909090909089, 0.55000000000000004, 0.55909090909090908, 0.56818181818181823, 0.57727272727272727, 0.58636363636363642, 0.59545454545454546, 0.60454545454545461, 0.61363636363636365, 0.62272727272727280, 0.63181818181818183, 0.64090909090909087, 0.65000000000000002, 0.65909090909090906, 0.66818181818181821, 0.67727272727272725, 0.68636363636363640, 0.69545454545454544, 0.70454545454545459, 0.71363636363636362, 0.72272727272727277, 0.73181818181818181, 0.74090909090909096, 0.75000000000000000, 0.75909090909090915, 0.76818181818181819, 0.77727272727272734, 0.78636363636363638, 0.79545454545454541, 0.80454545454545456, 0.81363636363636360, 0.82272727272727275, 0.83181818181818179, 0.84090909090909094, 0.84999999999999998, 0.85909090909090913, 0.86818181818181817, 0.87727272727272732, 0.88636363636363635, 0.89545454545454550, 0.90454545454545454, 0.91363636363636369, 0.92272727272727273, 0.93181818181818177, 0.94090909090909092, 0.94999999999999996};
    Tensor<float> k({1});
    k = 20.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{31.41043284423092175, 30.71330174390681478, 30.10425865857506622, 29.56176217128016148, 29.07136588556542023, 28.62289697644156306, 28.20891380634385115, 27.82380352193402473, 27.46322487085502573, 27.12374875588810852, 26.80261775189596563, 26.49758018777918522, 26.20677261843623640, 25.92863465232728615, 25.66184598233354208, 25.40527900414072349, 25.15796260037955889, 24.91905406802180423, 24.68781708113071005, 24.46360419215919535, 24.24584279145801702, 24.03402373361500821, 23.82769204303085786, 23.62643925700919212, 23.42989707049231285, 23.23773202436139940, 23.04964103704907430, 22.86534762267085341, 22.68459867186797041, 22.50716169682636902, 22.33282246146762517, 22.16138293302481443, 21.99265950316305762, 21.82648143625096893, 21.66268950990872000, 21.50113481898144485, 21.34167771894023247, 21.18418688864483101, 21.02853849560419164, 20.87461544949136538, 20.72230673182196270, 20.57150679148215744, 20.42211499726279911, 20.27403513977738569, 20.12717497615784623, 19.98144581176926593, 19.83676211389072463, 19.69304115289818924, 19.55020266697385978, 19.40816854677112957, 19.26686253679499572, 19.12620995052546746, 18.98613739652264343, 18.84657251291216440, 18.70744370776315435, 18.56867990293960347, 18.43021027903242981, 18.29196401896249213, 18.15387004778413882, 18.01585676611158604, 17.87785177443271678, 17.73978158536117178, 17.60157132060000507, 17.46314438903955590, 17.32442214197478947, 17.18532350088765526, 17.04576455257695500, 16.90565810560551085, 16.76491320103806260, 16.62343456922120666, 16.48112202285216910, 16.33786977472647806, 16.19356566625218008, 16.04809028994938913, 15.90131598555988823, 15.75310568486105467, 15.60331157452898054, 15.45177353904772843, 15.29831733619605494, 15.14275244534722908, 14.98486951270061240, 14.82443729623090789, 14.66119898460588544, 14.49486772571906279, 14.32512114760886668, 14.15159458113955360, 13.97387259043974161, 13.79147826913581554, 13.60385954490493887, 13.41037141480837569, 13.21025254817103090, 13.00259393876176262, 12.78629608211767987, 12.56000916763310471, 12.32204738646364461, 12.07026243525530163, 11.80185007520017493, 11.51304147789291044, 11.19858435382174378, 10.85081139418258545};
    // run Temper chisquare::isf
    Tensor<float> result = stats::chisquare::isf(q, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.isf_broadcast_q_vector_k_scalar
  * @brief Verify broadcasting: isf broadcast q vector k scalar
  */
TEST(CHISQUARE, isf_broadcast_q_vector_k_scalar)
{
    Tensor<float> q({4});
    q = std::vector<float>{0.05000000000000000, 0.25000000000000000, 0.50000000000000000, 0.94999999999999996};
    Tensor<float> k({1});
    k = 3.00000000000000000;
    Tensor<float> expected_result({4});
    expected_result = std::vector<float>{7.81472790325117828, 4.10834493563231185, 2.36597388437533773, 0.35184631774927166};
    Tensor<float> result = stats::chisquare::isf(q, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
}

/**
  * @test CHISQUARE.isf_broadcast_q_scalar_k_vector
  * @brief Verify broadcasting: isf broadcast q scalar k vector
  */
TEST(CHISQUARE, isf_broadcast_q_scalar_k_vector)
{
    Tensor<float> q({1});
    q = 0.50000000000000000;
    Tensor<float> k({3});
    k = std::vector<float>{3.00000000000000000, 4.00000000000000000, 2.00000000000000000};
    Tensor<float> expected_result({3});
    expected_result = std::vector<float>{2.36597388437533773, 3.35669398003332242, 1.38629436111989102};
    Tensor<float> result = stats::chisquare::isf(q, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
}

/**
  * @test CHISQUARE.isf_broadcast_2d_q_k_vector
  * @brief Verify broadcasting: isf broadcast 2d q k vector
  */
TEST(CHISQUARE, isf_broadcast_2d_q_k_vector)
{
    Tensor<float> q({2,2});
    q = std::vector<float>{0.05000000000000000, 0.25000000000000000, 0.50000000000000000, 0.94999999999999996};
    Tensor<float> k({2});
    k = std::vector<float>{3.00000000000000000, 2.00000000000000000};
    Tensor<float> expected_result({4});
    expected_result = std::vector<float>{7.81472790325117828, 2.77258872223978159, 2.36597388437533773, 0.10258658877510116};
    Tensor<float> result = stats::chisquare::isf(q, k);
    // check values
    EXPECT_NEAR(result[0][0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[0][1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[1][0], expected_result[2], 0.0001);
    EXPECT_NEAR(result[1][1], expected_result[3], 0.0001);
}

/**
  * @test CHISQUARE.isf_broadcast_mixed_shapes_all_operands
  * @brief Verify broadcasting: isf broadcast mixed shapes all operands
  */
TEST(CHISQUARE, isf_broadcast_mixed_shapes_all_operands)
{
    Tensor<float> q({2,1});
    q = std::vector<float>{0.33000000000000002, 0.66000000000000003};
    Tensor<float> k({1,3});
    k = std::vector<float>{2.00000000000000000, 3.00000000000000000, 4.00000000000000000};
    Tensor<float> expected_result({6});
    expected_result = std::vector<float>{2.21732524904322226, 3.42966166991078092, 4.60741628266009773, 0.83103088792333124, 1.59730961606829136, 2.41454695406146280};
    Tensor<float> result = stats::chisquare::isf(q, k);
    // check values
    EXPECT_NEAR(result[0][0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[0][1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[0][2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[1][0], expected_result[3], 0.0001);
    EXPECT_NEAR(result[1][1], expected_result[4], 0.0001);
    EXPECT_NEAR(result[1][2], expected_result[5], 0.0001);
}

/**
  * @test CHISQUARE.isf_view_with_weird_strides
  * @brief Ensure chisquare::isf accepts non-contiguous/alias views for x and k
  */
TEST(CHISQUARE, isf_view_with_weird_strides)
{
    Tensor<float> q_owner({6}, MemoryLocation::DEVICE);
    std::vector<float> q_owner_vals = {
        0.05000000000000000, 99.00000000000000000, 0.50000000000000000, 99.00000000000000000, 0.94999999999999996, 99.00000000000000000
    };
    q_owner = q_owner_vals;

    Tensor<float> q_alias(
        q_owner,
        std::vector<uint64_t>{0ull},
        std::vector<uint64_t>{3ull},
        std::vector<uint64_t>{2ull}
    );

    Tensor<float> k_owner({6}, MemoryLocation::DEVICE);
    std::vector<float> k_owner_vals = {
        1.00000000000000000, 99.00000000000000000, 5.00000000000000000, 99.00000000000000000, 10.00000000000000000, 99.00000000000000000
    };
    k_owner = k_owner_vals;

    Tensor<float> k_alias(
        k_owner,
        std::vector<uint64_t>{0ull},
        std::vector<uint64_t>{3ull},
        std::vector<uint64_t>{2ull}
    );

    Tensor<float> result = stats::chisquare::isf(q_alias, k_alias);

    Tensor<float> expected_result({3});
    expected_result = std::vector<float>{3.84145882069412847, 4.35146019109552640, 3.94029913611906091};

    // compare element-wise (unroll to report precise index on failure)
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
}
