/**
  * @file chisquare_ppf.cpp
  * @brief File generated by tests/stats/chisquare_ppf.py.
  */

/**
  * @test CHISQUARE.ppf_random_test_dof_2
  * @brief Randomly generated chisquare ppf test on 100 matrix with dof = 2.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, ppf_random_test_dof_2)
{
    Tensor<float> q({100});
    q = std::vector<float>{0.05000000000000000, 0.05909090909090910, 0.06818181818181818, 0.07727272727272727, 0.08636363636363636, 0.09545454545454546, 0.10454545454545455, 0.11363636363636363, 0.12272727272727273, 0.13181818181818183, 0.14090909090909093, 0.14999999999999999, 0.15909090909090909, 0.16818181818181818, 0.17727272727272725, 0.18636363636363634, 0.19545454545454544, 0.20454545454545453, 0.21363636363636362, 0.22272727272727272, 0.23181818181818181, 0.24090909090909091, 0.25000000000000000, 0.25909090909090909, 0.26818181818181819, 0.27727272727272728, 0.28636363636363638, 0.29545454545454547, 0.30454545454545451, 0.31363636363636360, 0.32272727272727270, 0.33181818181818179, 0.34090909090909088, 0.34999999999999998, 0.35909090909090907, 0.36818181818181817, 0.37727272727272726, 0.38636363636363635, 0.39545454545454545, 0.40454545454545454, 0.41363636363636364, 0.42272727272727267, 0.43181818181818177, 0.44090909090909086, 0.44999999999999996, 0.45909090909090905, 0.46818181818181814, 0.47727272727272724, 0.48636363636363633, 0.49545454545454543, 0.50454545454545452, 0.51363636363636367, 0.52272727272727271, 0.53181818181818186, 0.54090909090909089, 0.55000000000000004, 0.55909090909090908, 0.56818181818181823, 0.57727272727272727, 0.58636363636363642, 0.59545454545454546, 0.60454545454545461, 0.61363636363636365, 0.62272727272727280, 0.63181818181818183, 0.64090909090909087, 0.65000000000000002, 0.65909090909090906, 0.66818181818181821, 0.67727272727272725, 0.68636363636363640, 0.69545454545454544, 0.70454545454545459, 0.71363636363636362, 0.72272727272727277, 0.73181818181818181, 0.74090909090909096, 0.75000000000000000, 0.75909090909090915, 0.76818181818181819, 0.77727272727272734, 0.78636363636363638, 0.79545454545454541, 0.80454545454545456, 0.81363636363636360, 0.82272727272727275, 0.83181818181818179, 0.84090909090909094, 0.84999999999999998, 0.85909090909090913, 0.86818181818181817, 0.87727272727272732, 0.88636363636363635, 0.89545454545454550, 0.90454545454545454, 0.91363636363636369, 0.92272727272727273, 0.93181818181818177, 0.94090909090909092, 0.94999999999999996};
    Tensor<float> k({1});
    k = 2.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{0.10258658877510106, 0.12181750617398496, 0.14123513442790667, 0.16084313462114841, 0.18064527658657156, 0.20064544325573838, 0.22084763522874609, 0.24125597557722941, 0.26187471489495190, 0.28270823661146338, 0.30376106258543822, 0.32503785899554982, 0.34654344254807334, 0.36828278702188122, 0.39026103017307168, 0.41248348102321292, 0.43495562755706479, 0.45768314485769507, 0.48067190370916529, 0.50392797969940351, 0.52745766285857598, 0.55126746787121284, 0.57536414490356180, 0.59975469109119839, 0.62444636273579712, 0.64944668826426022, 0.67476348200810699, 0.70040485886623016, 0.72637924991985181, 0.75269541907487436, 0.77936248081380455, 0.80638991914725067, 0.83378760786357398, 0.86156583218490868, 0.88973531194838662, 0.91830722644333962, 0.94729324104847368, 0.97670553582786390, 1.00655683626121562, 1.03686044630242002, 1.06763028398137871, 1.09888091978754088, 1.13062761810012047, 1.16288638195988758, 1.19567400151124037, 1.22900810648166448, 1.26290722310921089, 1.29739083597822269, 1.33247945528004252, 1.36819469008005523, 1.40455932824643592, 1.44159742378091127, 1.47933439238967579, 1.51779711624545177, 1.55701405902220413, 1.59701539243554347, 1.63783313569795741, 1.67950130950364129, 1.72205610639821161, 1.76553607967102333, 1.80998235324044288, 1.85543885539555475, 1.90195257972409082, 1.94957387711152763, 1.99835678335984501, 2.04835938777068005, 2.09964424899735569, 2.15227886563210191, 2.20633621040794115, 2.26189533862209213, 2.31904208351020369, 2.37786985392279071, 2.43848055291344901, 2.50098563992165746, 2.56550736435810078, 2.63218020489328497, 2.70115255703562473, 2.77258872223978114, 2.84667126560048089, 2.92360382725607071, 3.00361449648347056, 3.08695988928460618, 3.17393011316408424, 3.26485486131759828, 3.36011095929610715, 3.46013180044543045, 3.56541926741627391, 3.67655896972589602, 3.79423996977176214, 3.91928068373443095, 4.05266343273177476, 4.19558136069606569, 4.34950344296832103, 4.51626666084642459, 4.69821021725787791, 4.89837713437184430, 5.12082840459229072, 5.37115469050030203, 5.65735637778164957, 5.99146454710797904};
    // run Temper chisquare::ppf
    Tensor<float> result = stats::chisquare::ppf(q, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.ppf_random_test_dof_3
  * @brief Randomly generated chisquare ppf test on 100 matrix with dof = 3.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, ppf_random_test_dof_3)
{
    Tensor<float> q({100});
    q = std::vector<float>{0.05000000000000000, 0.05909090909090910, 0.06818181818181818, 0.07727272727272727, 0.08636363636363636, 0.09545454545454546, 0.10454545454545455, 0.11363636363636363, 0.12272727272727273, 0.13181818181818183, 0.14090909090909093, 0.14999999999999999, 0.15909090909090909, 0.16818181818181818, 0.17727272727272725, 0.18636363636363634, 0.19545454545454544, 0.20454545454545453, 0.21363636363636362, 0.22272727272727272, 0.23181818181818181, 0.24090909090909091, 0.25000000000000000, 0.25909090909090909, 0.26818181818181819, 0.27727272727272728, 0.28636363636363638, 0.29545454545454547, 0.30454545454545451, 0.31363636363636360, 0.32272727272727270, 0.33181818181818179, 0.34090909090909088, 0.34999999999999998, 0.35909090909090907, 0.36818181818181817, 0.37727272727272726, 0.38636363636363635, 0.39545454545454545, 0.40454545454545454, 0.41363636363636364, 0.42272727272727267, 0.43181818181818177, 0.44090909090909086, 0.44999999999999996, 0.45909090909090905, 0.46818181818181814, 0.47727272727272724, 0.48636363636363633, 0.49545454545454543, 0.50454545454545452, 0.51363636363636367, 0.52272727272727271, 0.53181818181818186, 0.54090909090909089, 0.55000000000000004, 0.55909090909090908, 0.56818181818181823, 0.57727272727272727, 0.58636363636363642, 0.59545454545454546, 0.60454545454545461, 0.61363636363636365, 0.62272727272727280, 0.63181818181818183, 0.64090909090909087, 0.65000000000000002, 0.65909090909090906, 0.66818181818181821, 0.67727272727272725, 0.68636363636363640, 0.69545454545454544, 0.70454545454545459, 0.71363636363636362, 0.72272727272727277, 0.73181818181818181, 0.74090909090909096, 0.75000000000000000, 0.75909090909090915, 0.76818181818181819, 0.77727272727272734, 0.78636363636363638, 0.79545454545454541, 0.80454545454545456, 0.81363636363636360, 0.82272727272727275, 0.83181818181818179, 0.84090909090909094, 0.84999999999999998, 0.85909090909090913, 0.86818181818181817, 0.87727272727272732, 0.88636363636363635, 0.89545454545454550, 0.90454545454545454, 0.91363636363636369, 0.92272727272727273, 0.93181818181818177, 0.94090909090909092, 0.94999999999999996};
    Tensor<float> k({1});
    k = 3.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{0.35184631774927144, 0.39676920043336417, 0.44020132802875539, 0.48246162059413111, 0.52378213201181834, 0.56433858609340715, 0.60426832922147400, 0.64368152648732480, 0.68266847986074664, 0.72130459858535012, 0.75965388466579031, 0.79777144424472213, 0.83570533984230444, 0.87349798455220873, 0.91118721049490015, 0.94880710088031606, 0.98638864743513655, 1.02396027676120682, 1.06154827692999798, 1.09917714718341175, 1.13686988770272146, 1.17464824220004815, 1.21253290304566863, 1.25054368641640434, 1.28869968329767359, 1.32701939093207111, 1.36552082836779598, 1.40422163904162423, 1.44313918277692244, 1.48229061914661497, 1.52169298381447127, 1.56136325920370744, 1.60131844063342799, 1.64157559889881521, 1.68215194014104474, 1.72306486375067491, 1.76433201896855096, 1.80597136078696319, 1.84800120570794202, 1.89044028788273799, 1.93330781613505898, 1.97662353235923760, 2.02040777178226882, 2.06468152558503482, 2.10946650639278621, 2.15478521716790095, 2.20066102406952346, 2.24711823388502197, 2.29418217668830149, 2.34187929444045162, 2.39023723632044849, 2.43928496165902065, 2.48905285144923516, 2.53957282952513763, 2.59087849463764197, 2.64300526481825537, 2.69599053561015056, 2.74987385396759487, 2.80469710988488252, 2.86050474812218347, 2.91734400275692352, 2.97526515771709388, 3.03432183696041635, 3.09457132856821193, 3.15607494774581854, 3.21889844458941354, 3.28311246352550024, 3.34879306259501330, 3.41602230229535309, 3.48488891557467451, 3.55548907288604799, 3.62792725906389224, 3.70231728233332857, 3.77878344019546208, 3.85746187250856165, 3.93850213914587055, 4.02206906861879609, 4.10834493563231185, 4.19753204054538376, 4.28985578332788275, 4.38556835049750582, 4.48495316803574440, 4.58833031979597550, 4.69606319433567698, 4.80856671067336183, 4.92631759605813180, 5.04986736303731565, 5.17985888473353029, 5.31704783731709529, 5.46233083387630192, 5.61678292547533875, 5.78170848399736048, 5.95871164542781084, 6.14979610217183570, 6.35751027588837747, 6.58516515814559167, 6.83717341571904846, 7.11960111186726063, 7.44111542531901016, 7.81472790325117916};
    // run Temper chisquare::ppf
    Tensor<float> result = stats::chisquare::ppf(q, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.ppf_random_test_dof_4
  * @brief Randomly generated chisquare ppf test on 100 matrix with dof = 4.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, ppf_random_test_dof_4)
{
    Tensor<float> q({100});
    q = std::vector<float>{0.05000000000000000, 0.05909090909090910, 0.06818181818181818, 0.07727272727272727, 0.08636363636363636, 0.09545454545454546, 0.10454545454545455, 0.11363636363636363, 0.12272727272727273, 0.13181818181818183, 0.14090909090909093, 0.14999999999999999, 0.15909090909090909, 0.16818181818181818, 0.17727272727272725, 0.18636363636363634, 0.19545454545454544, 0.20454545454545453, 0.21363636363636362, 0.22272727272727272, 0.23181818181818181, 0.24090909090909091, 0.25000000000000000, 0.25909090909090909, 0.26818181818181819, 0.27727272727272728, 0.28636363636363638, 0.29545454545454547, 0.30454545454545451, 0.31363636363636360, 0.32272727272727270, 0.33181818181818179, 0.34090909090909088, 0.34999999999999998, 0.35909090909090907, 0.36818181818181817, 0.37727272727272726, 0.38636363636363635, 0.39545454545454545, 0.40454545454545454, 0.41363636363636364, 0.42272727272727267, 0.43181818181818177, 0.44090909090909086, 0.44999999999999996, 0.45909090909090905, 0.46818181818181814, 0.47727272727272724, 0.48636363636363633, 0.49545454545454543, 0.50454545454545452, 0.51363636363636367, 0.52272727272727271, 0.53181818181818186, 0.54090909090909089, 0.55000000000000004, 0.55909090909090908, 0.56818181818181823, 0.57727272727272727, 0.58636363636363642, 0.59545454545454546, 0.60454545454545461, 0.61363636363636365, 0.62272727272727280, 0.63181818181818183, 0.64090909090909087, 0.65000000000000002, 0.65909090909090906, 0.66818181818181821, 0.67727272727272725, 0.68636363636363640, 0.69545454545454544, 0.70454545454545459, 0.71363636363636362, 0.72272727272727277, 0.73181818181818181, 0.74090909090909096, 0.75000000000000000, 0.75909090909090915, 0.76818181818181819, 0.77727272727272734, 0.78636363636363638, 0.79545454545454541, 0.80454545454545456, 0.81363636363636360, 0.82272727272727275, 0.83181818181818179, 0.84090909090909094, 0.84999999999999998, 0.85909090909090913, 0.86818181818181817, 0.87727272727272732, 0.88636363636363635, 0.89545454545454550, 0.90454545454545454, 0.91363636363636369, 0.92272727272727273, 0.93181818181818177, 0.94090909090909092, 0.94999999999999996};
    Tensor<float> k({1});
    k = 4.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{0.71072302139732391, 0.78151368895309836, 0.84858678862960013, 0.91273110085572962, 0.97450864039563523, 1.03433694317648506, 1.09253658501922057, 1.14936035522791702, 1.20501206065748279, 1.25965913676842001, 1.31344138938153776, 1.36647722614188094, 1.41886820648077494, 1.47070243386319666, 1.52205713169508283, 1.57300063143254532, 1.62359392955575088, 1.67389192307517520, 1.72394440179464570, 1.77379685407830623, 1.82349112792331391, 1.87306597856355705, 1.92255752622955423, 1.97199964215170831, 2.02142427680681225, 2.07086174135576906, 2.12034095091689290, 2.16988963656341971, 2.21953453158336833, 2.26930153649277067, 2.31921586647523181, 2.36930218427753925, 2.41958472108241107, 2.47008738747531043, 2.52083387630012590, 2.57184775894115658, 2.62315257636319110, 2.67477192607764902, 2.72672954607284357, 2.77904939664466077, 2.83175574098571481, 2.88487322533277224, 2.93842695943134569, 2.99244259805093149, 3.04694642427283613, 3.10196543527421120, 3.15752743134604907, 3.21366110890965873, 3.27039615833541619, 3.32776336742035506, 3.38579473144801479, 3.44452357083652450, 3.50398465748077914, 3.56421435101404072, 3.62525074635620514, 3.68713383408389417, 3.74990567535547159, 3.81361059335759789, 3.87829538351527825, 3.94400954503234402, 4.01080553671376983, 4.07873906047678947, 4.14786937649943965, 4.21825965460070851, 4.28997736721893475, 4.36309473028249073, 4.43768919938480177, 4.51384403002933698, 4.59164891235633554, 4.67120069277462502, 4.75260419739268158, 4.83597317519418546, 4.92143138269270164, 5.00911383653477404, 5.09916826647470867, 5.19175680868224898, 5.28705798895734791, 5.38526905777939024, 5.48660875512376744, 5.59132060389827856, 5.69967685845202077, 5.81198327139098847, 5.92858489148597734, 6.04987317299569849, 6.17629476995168680, 6.30836251940788006, 6.44666930296923280, 6.59190574349036051, 6.74488308721241925, 6.90656321153829111, 7.07809860308957006, 7.26088657194852782, 7.45664426423523174, 7.66751486370755497, 7.89622199050997953, 8.14630122965765935, 8.42246028375174483, 8.73116448263857947, 9.08164169156648882, 9.48772903678115398};
    // run Temper chisquare::ppf
    Tensor<float> result = stats::chisquare::ppf(q, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.ppf_random_test_dof_5
  * @brief Randomly generated chisquare ppf test on 100 matrix with dof = 5.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, ppf_random_test_dof_5)
{
    Tensor<float> q({100});
    q = std::vector<float>{0.05000000000000000, 0.05909090909090910, 0.06818181818181818, 0.07727272727272727, 0.08636363636363636, 0.09545454545454546, 0.10454545454545455, 0.11363636363636363, 0.12272727272727273, 0.13181818181818183, 0.14090909090909093, 0.14999999999999999, 0.15909090909090909, 0.16818181818181818, 0.17727272727272725, 0.18636363636363634, 0.19545454545454544, 0.20454545454545453, 0.21363636363636362, 0.22272727272727272, 0.23181818181818181, 0.24090909090909091, 0.25000000000000000, 0.25909090909090909, 0.26818181818181819, 0.27727272727272728, 0.28636363636363638, 0.29545454545454547, 0.30454545454545451, 0.31363636363636360, 0.32272727272727270, 0.33181818181818179, 0.34090909090909088, 0.34999999999999998, 0.35909090909090907, 0.36818181818181817, 0.37727272727272726, 0.38636363636363635, 0.39545454545454545, 0.40454545454545454, 0.41363636363636364, 0.42272727272727267, 0.43181818181818177, 0.44090909090909086, 0.44999999999999996, 0.45909090909090905, 0.46818181818181814, 0.47727272727272724, 0.48636363636363633, 0.49545454545454543, 0.50454545454545452, 0.51363636363636367, 0.52272727272727271, 0.53181818181818186, 0.54090909090909089, 0.55000000000000004, 0.55909090909090908, 0.56818181818181823, 0.57727272727272727, 0.58636363636363642, 0.59545454545454546, 0.60454545454545461, 0.61363636363636365, 0.62272727272727280, 0.63181818181818183, 0.64090909090909087, 0.65000000000000002, 0.65909090909090906, 0.66818181818181821, 0.67727272727272725, 0.68636363636363640, 0.69545454545454544, 0.70454545454545459, 0.71363636363636362, 0.72272727272727277, 0.73181818181818181, 0.74090909090909096, 0.75000000000000000, 0.75909090909090915, 0.76818181818181819, 0.77727272727272734, 0.78636363636363638, 0.79545454545454541, 0.80454545454545456, 0.81363636363636360, 0.82272727272727275, 0.83181818181818179, 0.84090909090909094, 0.84999999999999998, 0.85909090909090913, 0.86818181818181817, 0.87727272727272732, 0.88636363636363635, 0.89545454545454550, 0.90454545454545454, 0.91363636363636369, 0.92272727272727273, 0.93181818181818177, 0.94090909090909092, 0.94999999999999996};
    Tensor<float> k({1});
    k = 5.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{1.14547622606176924, 1.24074636059130894, 1.32996620858230452, 1.41443933080047368, 1.49508450271308968, 1.57257774680760143, 1.64743354920042995, 1.72005429461941040, 1.79076188765317079, 1.85981881442191477, 1.92744265104387602, 1.99381634645304850, 2.05909569044072427, 2.12341485362903093, 2.18689057431599432, 2.24962537526275597, 2.31171007184129884, 2.37322575377417833, 2.43424536993419149, 2.49483500977170713, 2.55505495004666239, 2.61496051798823803, 2.67460280943216366, 2.73402929135186712, 2.79328431147811429, 2.85240953269606745, 2.91144430614004079, 2.97042599404000951, 3.02939025117400940, 3.08837127207746986, 3.14740200983187801, 3.20651437121132066, 3.26573939214018027, 3.32510739675921352, 3.38464814287341520, 3.44439095613524282, 3.50436485497970951, 3.56459866805691217, 3.62512114569038424, 3.68596106671611512, 3.74714734191991861, 3.80870911518392319, 3.87067586337202929, 3.93307749592553524, 3.99594445510145002, 4.05930781776525418, 4.12319939964588755, 4.18765186297286895, 4.25269882844327185, 4.31837499251042356, 4.38471625104674700, 4.45175983051205293, 4.51954442785669830, 4.58811036050914201, 4.65749972794203249, 4.72775658648384578, 4.79892713924838787, 4.87105994329800041, 4.94420613644445073, 5.01841968643269531, 5.09375766565689059, 5.17028055503820116, 5.24805258126469543, 5.32714209227518065, 5.40762197668421329, 5.48957013382498094, 5.57307000226776417, 5.65821115610165748, 5.74508998000651960, 5.83381043626711993, 5.92448493949161747, 6.01723535801951392, 6.11219416500612667, 6.20950576717070479, 6.30932804548148773, 6.41183415000807244, 6.51721460131807451, 6.62567976382924684, 6.73746277341511135, 6.85282302362663120, 6.97205034399821688, 7.09547004268412884, 7.22344903790000004, 7.35640337381242215, 7.49480751472978302, 7.63920594884502346, 7.79022782789812496, 7.94860565078057846, 8.11519941305292924, 8.29102826493613065, 8.47731267147275069, 8.67553156267734416, 8.88750137460052692, 9.11548790409133680, 9.36236884885958887, 9.63187742073579400, 9.92898109101017035, 10.26049696558429147, 10.63614727607932942, 11.07049769351635149};
    // run Temper chisquare::ppf
    Tensor<float> result = stats::chisquare::ppf(q, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.ppf_random_test_dof_6
  * @brief Randomly generated chisquare ppf test on 100 matrix with dof = 6.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, ppf_random_test_dof_6)
{
    Tensor<float> q({100});
    q = std::vector<float>{0.05000000000000000, 0.05909090909090910, 0.06818181818181818, 0.07727272727272727, 0.08636363636363636, 0.09545454545454546, 0.10454545454545455, 0.11363636363636363, 0.12272727272727273, 0.13181818181818183, 0.14090909090909093, 0.14999999999999999, 0.15909090909090909, 0.16818181818181818, 0.17727272727272725, 0.18636363636363634, 0.19545454545454544, 0.20454545454545453, 0.21363636363636362, 0.22272727272727272, 0.23181818181818181, 0.24090909090909091, 0.25000000000000000, 0.25909090909090909, 0.26818181818181819, 0.27727272727272728, 0.28636363636363638, 0.29545454545454547, 0.30454545454545451, 0.31363636363636360, 0.32272727272727270, 0.33181818181818179, 0.34090909090909088, 0.34999999999999998, 0.35909090909090907, 0.36818181818181817, 0.37727272727272726, 0.38636363636363635, 0.39545454545454545, 0.40454545454545454, 0.41363636363636364, 0.42272727272727267, 0.43181818181818177, 0.44090909090909086, 0.44999999999999996, 0.45909090909090905, 0.46818181818181814, 0.47727272727272724, 0.48636363636363633, 0.49545454545454543, 0.50454545454545452, 0.51363636363636367, 0.52272727272727271, 0.53181818181818186, 0.54090909090909089, 0.55000000000000004, 0.55909090909090908, 0.56818181818181823, 0.57727272727272727, 0.58636363636363642, 0.59545454545454546, 0.60454545454545461, 0.61363636363636365, 0.62272727272727280, 0.63181818181818183, 0.64090909090909087, 0.65000000000000002, 0.65909090909090906, 0.66818181818181821, 0.67727272727272725, 0.68636363636363640, 0.69545454545454544, 0.70454545454545459, 0.71363636363636362, 0.72272727272727277, 0.73181818181818181, 0.74090909090909096, 0.75000000000000000, 0.75909090909090915, 0.76818181818181819, 0.77727272727272734, 0.78636363636363638, 0.79545454545454541, 0.80454545454545456, 0.81363636363636360, 0.82272727272727275, 0.83181818181818179, 0.84090909090909094, 0.84999999999999998, 0.85909090909090913, 0.86818181818181817, 0.87727272727272732, 0.88636363636363635, 0.89545454545454550, 0.90454545454545454, 0.91363636363636369, 0.92272727272727273, 0.93181818181818177, 0.94090909090909092, 0.94999999999999996};
    Tensor<float> k({1});
    k = 6.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{1.63538289432790673, 1.75359514441458963, 1.86345715501974363, 1.96679166991741017, 2.06487478132344870, 2.15863985622788279, 2.24879342478477007, 2.33588533875085602, 2.42035343358734512, 2.50255314794176842, 2.58277784724810600, 2.66127317614690506, 2.73824744736222891, 2.81387932439218824, 2.88832361064835963, 2.96171568486164816, 3.03417495010836102, 3.10580755185972412, 3.17670854605733588, 3.24696364771848334, 3.31665065564370964, 3.38584062421733067, 3.45459883572103843, 3.52298561384143083, 3.59105700969439301, 3.65886538473237088, 3.72645990967113994, 3.79388699460162737, 3.86119066240834385, 3.92841287526242722, 3.99559382212292480, 4.06277217374003019, 4.12998531051603113, 4.19726952767532779, 4.26466022147235346, 4.33219205958674447, 4.39989913838868407, 4.46781512938157377, 4.53597341682610811, 4.60440722830618654, 4.67314975980214431, 4.74223429668225549, 4.81169433190336093, 4.88156368262036544, 4.95187660633896165, 5.02266791770329135, 5.09397310698845107, 5.16582846136523255, 5.23827119002134989, 5.31133955425830528, 5.38507300373780939, 5.45951232012601029, 5.53469976948020115, 5.61067926484268931, 5.68749654065313859, 5.76519934076782370, 5.84383762208581636, 5.92346377603444463, 6.00413287046580635, 6.08590291487176938, 6.16883515224694001, 6.25299438143079644, 6.33844931435784087, 6.42527297335785619, 6.51354313450279765, 6.60334282402313111, 6.69476087605440018, 6.78789256147365982, 6.88284029940859021, 6.97971446522989236, 7.07863431157355993, 7.17972902231765531, 7.28313892363276594, 7.38901688146469660, 7.49752992139478369, 7.60886111515982311, 7.72321178874117731, 7.84080412058512177, 7.96188421619848441, 8.08672576846571012, 8.21563444350042538, 8.34895317243009849, 8.48706858416381671, 8.63041888864938045, 8.77950362285122665, 8.93489581536524646, 9.09725732958618671, 9.26735843975296447, 9.44610312678933361, 9.63456222923589145, 9.83401757803794929, 10.04602180415409940, 10.27248102705675414, 10.51577182946422084, 10.77891117321994940, 11.06581096484461391, 11.38167365751161952, 11.73363471435387062, 12.13186399957351291, 12.59158724374397664};
    // run Temper chisquare::ppf
    Tensor<float> result = stats::chisquare::ppf(q, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.ppf_random_test_dof_7
  * @brief Randomly generated chisquare ppf test on 100 matrix with dof = 7.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, ppf_random_test_dof_7)
{
    Tensor<float> q({100});
    q = std::vector<float>{0.05000000000000000, 0.05909090909090910, 0.06818181818181818, 0.07727272727272727, 0.08636363636363636, 0.09545454545454546, 0.10454545454545455, 0.11363636363636363, 0.12272727272727273, 0.13181818181818183, 0.14090909090909093, 0.14999999999999999, 0.15909090909090909, 0.16818181818181818, 0.17727272727272725, 0.18636363636363634, 0.19545454545454544, 0.20454545454545453, 0.21363636363636362, 0.22272727272727272, 0.23181818181818181, 0.24090909090909091, 0.25000000000000000, 0.25909090909090909, 0.26818181818181819, 0.27727272727272728, 0.28636363636363638, 0.29545454545454547, 0.30454545454545451, 0.31363636363636360, 0.32272727272727270, 0.33181818181818179, 0.34090909090909088, 0.34999999999999998, 0.35909090909090907, 0.36818181818181817, 0.37727272727272726, 0.38636363636363635, 0.39545454545454545, 0.40454545454545454, 0.41363636363636364, 0.42272727272727267, 0.43181818181818177, 0.44090909090909086, 0.44999999999999996, 0.45909090909090905, 0.46818181818181814, 0.47727272727272724, 0.48636363636363633, 0.49545454545454543, 0.50454545454545452, 0.51363636363636367, 0.52272727272727271, 0.53181818181818186, 0.54090909090909089, 0.55000000000000004, 0.55909090909090908, 0.56818181818181823, 0.57727272727272727, 0.58636363636363642, 0.59545454545454546, 0.60454545454545461, 0.61363636363636365, 0.62272727272727280, 0.63181818181818183, 0.64090909090909087, 0.65000000000000002, 0.65909090909090906, 0.66818181818181821, 0.67727272727272725, 0.68636363636363640, 0.69545454545454544, 0.70454545454545459, 0.71363636363636362, 0.72272727272727277, 0.73181818181818181, 0.74090909090909096, 0.75000000000000000, 0.75909090909090915, 0.76818181818181819, 0.77727272727272734, 0.78636363636363638, 0.79545454545454541, 0.80454545454545456, 0.81363636363636360, 0.82272727272727275, 0.83181818181818179, 0.84090909090909094, 0.84999999999999998, 0.85909090909090913, 0.86818181818181817, 0.87727272727272732, 0.88636363636363635, 0.89545454545454550, 0.90454545454545454, 0.91363636363636369, 0.92272727272727273, 0.93181818181818177, 0.94090909090909092, 0.94999999999999996};
    Tensor<float> k({1});
    k = 7.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{2.16734990929805704, 2.30710347496474277, 2.43628204207829313, 2.55721729814477605, 2.67153414643049381, 2.78041627355427989, 2.88475642638097174, 2.98524705139959012, 3.08243780456648153, 3.17677357819339923, 3.26862052298965677, 3.35828437920814027, 3.44602371508230076, 3.53205969585720014, 3.61658343023347317, 3.69976158816995682, 3.78174076137425219, 3.86265089357999036, 3.94260801202736477, 4.02171642672952956, 4.10007051933084377, 4.17775621190030044, 4.25485218354651451, 4.33143088648028307, 4.40755940122154399, 4.48330016178976365, 4.55871157506585778, 4.63384855346867131, 4.70876297622537887, 4.78350409153046208, 4.85811886956354133, 4.93265231451264707, 5.00714774230919257, 5.08164702963627768, 5.15619083885763541, 5.23081882278062693, 5.30556981257588056, 5.38048199169890307, 5.45559305827350549, 5.53094037808555594, 5.60656113008488877, 5.68249244609318538, 5.75877154625740850, 5.83543587166634570, 5.91252321545662607, 5.99007185367082418, 6.06812067709112579, 6.14670932525590352, 6.22587832387188200, 6.30566922686155173, 6.38612476433344867, 6.46728899783372757, 6.54920748433122046, 6.63192745050823618, 6.71549797907767765, 6.79997020902762284, 6.88539755191187197, 6.97183592656528539, 7.05934401493227881, 7.14798354206581266, 7.23781958379246149, 7.32892090606078739, 7.42136034061215710, 7.51521520235604790, 7.61056775472157021, 7.70750573032671848, 7.80612291559681015, 7.90651980952580313, 8.00880436867480405, 8.11309285282390391, 8.21951078854546324, 8.32819407148755708, 8.43929023252794686, 8.55295989841860305, 8.66937848440434067, 8.78873816498438032, 8.91125018005710068, 9.03714754790814290, 9.16668827491773008, 9.30015917591859953, 9.43788045085776162, 9.58021120566395723, 9.72755616210660712, 9.88037387891534280, 10.03918691331470470, 10.20459450160428716, 10.37728854959948599, 10.55807402991146482, 10.74789533282035414, 10.94787079149103270, 11.15933863477937926, 11.38391924201024885, 11.62360119098104860, 11.88086294952769606, 12.15884958807487592, 12.46163744009409413, 12.79464524543806903, 13.16530159580626247, 13.58418867162510324, 14.06714044934016883};
    // run Temper chisquare::ppf
    Tensor<float> result = stats::chisquare::ppf(q, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.ppf_random_test_dof_8
  * @brief Randomly generated chisquare ppf test on 100 matrix with dof = 8.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, ppf_random_test_dof_8)
{
    Tensor<float> q({100});
    q = std::vector<float>{0.05000000000000000, 0.05909090909090910, 0.06818181818181818, 0.07727272727272727, 0.08636363636363636, 0.09545454545454546, 0.10454545454545455, 0.11363636363636363, 0.12272727272727273, 0.13181818181818183, 0.14090909090909093, 0.14999999999999999, 0.15909090909090909, 0.16818181818181818, 0.17727272727272725, 0.18636363636363634, 0.19545454545454544, 0.20454545454545453, 0.21363636363636362, 0.22272727272727272, 0.23181818181818181, 0.24090909090909091, 0.25000000000000000, 0.25909090909090909, 0.26818181818181819, 0.27727272727272728, 0.28636363636363638, 0.29545454545454547, 0.30454545454545451, 0.31363636363636360, 0.32272727272727270, 0.33181818181818179, 0.34090909090909088, 0.34999999999999998, 0.35909090909090907, 0.36818181818181817, 0.37727272727272726, 0.38636363636363635, 0.39545454545454545, 0.40454545454545454, 0.41363636363636364, 0.42272727272727267, 0.43181818181818177, 0.44090909090909086, 0.44999999999999996, 0.45909090909090905, 0.46818181818181814, 0.47727272727272724, 0.48636363636363633, 0.49545454545454543, 0.50454545454545452, 0.51363636363636367, 0.52272727272727271, 0.53181818181818186, 0.54090909090909089, 0.55000000000000004, 0.55909090909090908, 0.56818181818181823, 0.57727272727272727, 0.58636363636363642, 0.59545454545454546, 0.60454545454545461, 0.61363636363636365, 0.62272727272727280, 0.63181818181818183, 0.64090909090909087, 0.65000000000000002, 0.65909090909090906, 0.66818181818181821, 0.67727272727272725, 0.68636363636363640, 0.69545454545454544, 0.70454545454545459, 0.71363636363636362, 0.72272727272727277, 0.73181818181818181, 0.74090909090909096, 0.75000000000000000, 0.75909090909090915, 0.76818181818181819, 0.77727272727272734, 0.78636363636363638, 0.79545454545454541, 0.80454545454545456, 0.81363636363636360, 0.82272727272727275, 0.83181818181818179, 0.84090909090909094, 0.84999999999999998, 0.85909090909090913, 0.86818181818181817, 0.87727272727272732, 0.88636363636363635, 0.89545454545454550, 0.90454545454545454, 0.91363636363636369, 0.92272727272727273, 0.93181818181818177, 0.94090909090909092, 0.94999999999999996};
    Tensor<float> k({1});
    k = 8.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{2.73263679349966182, 2.89270760595997123, 3.04006412027012951, 3.17753166164930390, 3.30707253015117431, 3.43011197275461166, 3.54772206811003699, 3.66073233520038199, 3.76979974417490249, 3.87545490868874598, 3.97813363320415725, 4.07819909611162945, 4.17595784312308194, 4.27167157079705007, 4.36556597487370013, 4.45783750713875282, 4.54865861306266250, 4.63818184682294543, 4.72654314395157815, 4.81386445309751476, 4.90025587406853447, 4.98581741118625121, 5.07064042380018609, 5.15480883614031082, 5.23840015427295480, 5.32148632723106907, 5.40413448136705643, 5.48640755089531140, 5.56836482293794965, 5.65006241179465185, 5.73155367436123253, 5.81288957642885595, 5.89411901786465187, 5.97528912329894446, 6.05644550384580604, 6.13763249450152681, 6.21889337115525009, 6.30027055057162055, 6.38180577624058643, 6.46354029261329099, 6.54551500993918278, 6.62777066167532602, 6.71034795624476033, 6.79328772476863829, 6.87663106628111720, 6.96041949185206388, 7.04469506898684372, 7.12950056764300566, 7.21487960919850124, 7.30087681972459013, 7.38753798895893254, 7.47491023644056263, 7.56304218636065784, 7.65198415280220257, 7.74178833719165738, 7.83250903996951919, 7.92420288870919620, 8.01692908518110769, 8.11074967417824055, 8.20572983730024141, 8.30193821534660437, 8.39944726350972637, 8.49833364420291737, 8.59867866312888829, 8.70056875511695083, 8.80409602736714092, 8.90935886907784358, 9.01646263805508319, 9.12552043687364822, 9.23665399357026651, 9.34999466480857322, 9.46568458310933813, 9.58387797427556087, 9.70474267680731550, 9.82846190222205252, 9.95523628420658646, 10.08528627601132932, 10.21885497024676148, 10.35621143434007863, 10.49765467985577239, 10.64351841677324728, 10.79417678761485355, 10.95005133528116303, 11.11161953875665098, 11.27942536161152631, 11.45409241310171744, 11.63634054148522523, 11.82700699629828556, 12.02707376213624180, 12.23770336437395123, 12.46028651617069549, 12.69650665408948775, 12.94842911776570560, 13.21862723916526861, 13.51036539310122109, 13.82787307315638969, 14.17677053347500227, 14.56475954545515883, 15.00280665843353844, 15.50731305586545083};
    // run Temper chisquare::ppf
    Tensor<float> result = stats::chisquare::ppf(q, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.ppf_random_test_dof_9
  * @brief Randomly generated chisquare ppf test on 100 matrix with dof = 9.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, ppf_random_test_dof_9)
{
    Tensor<float> q({100});
    q = std::vector<float>{0.05000000000000000, 0.05909090909090910, 0.06818181818181818, 0.07727272727272727, 0.08636363636363636, 0.09545454545454546, 0.10454545454545455, 0.11363636363636363, 0.12272727272727273, 0.13181818181818183, 0.14090909090909093, 0.14999999999999999, 0.15909090909090909, 0.16818181818181818, 0.17727272727272725, 0.18636363636363634, 0.19545454545454544, 0.20454545454545453, 0.21363636363636362, 0.22272727272727272, 0.23181818181818181, 0.24090909090909091, 0.25000000000000000, 0.25909090909090909, 0.26818181818181819, 0.27727272727272728, 0.28636363636363638, 0.29545454545454547, 0.30454545454545451, 0.31363636363636360, 0.32272727272727270, 0.33181818181818179, 0.34090909090909088, 0.34999999999999998, 0.35909090909090907, 0.36818181818181817, 0.37727272727272726, 0.38636363636363635, 0.39545454545454545, 0.40454545454545454, 0.41363636363636364, 0.42272727272727267, 0.43181818181818177, 0.44090909090909086, 0.44999999999999996, 0.45909090909090905, 0.46818181818181814, 0.47727272727272724, 0.48636363636363633, 0.49545454545454543, 0.50454545454545452, 0.51363636363636367, 0.52272727272727271, 0.53181818181818186, 0.54090909090909089, 0.55000000000000004, 0.55909090909090908, 0.56818181818181823, 0.57727272727272727, 0.58636363636363642, 0.59545454545454546, 0.60454545454545461, 0.61363636363636365, 0.62272727272727280, 0.63181818181818183, 0.64090909090909087, 0.65000000000000002, 0.65909090909090906, 0.66818181818181821, 0.67727272727272725, 0.68636363636363640, 0.69545454545454544, 0.70454545454545459, 0.71363636363636362, 0.72272727272727277, 0.73181818181818181, 0.74090909090909096, 0.75000000000000000, 0.75909090909090915, 0.76818181818181819, 0.77727272727272734, 0.78636363636363638, 0.79545454545454541, 0.80454545454545456, 0.81363636363636360, 0.82272727272727275, 0.83181818181818179, 0.84090909090909094, 0.84999999999999998, 0.85909090909090913, 0.86818181818181817, 0.87727272727272732, 0.88636363636363635, 0.89545454545454550, 0.90454545454545454, 0.91363636363636369, 0.92272727272727273, 0.93181818181818177, 0.94090909090909092, 0.94999999999999996};
    Tensor<float> k({1});
    k = 9.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{3.32511284306681487, 3.50443845761853057, 3.66899486313146195, 3.82208439983010440, 3.96599478074973044, 4.10238385147322049, 4.23249612169934597, 4.35729274055224103, 4.47753361373176251, 4.59383149336001839, 4.70668886304161926, 4.81652383831706654, 4.92368881614223852, 5.02848419887724063, 5.13116868812092797, 5.23196713702084182, 5.33107663086427230, 5.42867125970244047, 5.52490591037951795, 5.61991931312839554, 5.71383651434241369, 5.80677090256303163, 5.89882588296997223, 5.99009627270872169, 6.08066947257995594, 6.17062645815266819, 6.26004262401893019, 6.34898850782998014, 6.43753041533978987, 6.52573096350499515, 6.61364955544032007, 6.70134279848131076, 6.78886487459564325, 6.87626787078718227, 6.96360207586144764, 7.05091624889720148, 7.13825786394343975, 7.22567333479389706, 7.31320822315028618, 7.40090743304730658, 7.48881539405750107, 7.57697623550798394, 7.66543395371202685, 7.75423257403805977, 7.84341630949907387, 7.93302971744213359, 8.02311785584612203, 8.11372644069360760, 8.20490200586711893, 8.29669206703109019, 8.38914529099684891, 8.48231167213069348, 8.57624271745481259, 8.67099164220978125, 8.76661357779848061, 8.86316579421815653, 8.96070793931461118, 9.05930229746676829, 9.15901407063814155, 9.25991168512392271, 9.36206712779007333, 9.46555631615817639, 9.57045950735566819, 9.67686175174679697, 9.78485339801380327, 9.89453065760518413, 10.00599623785215719, 10.11936005473114442, 10.23474003829003465, 10.35226304624810645, 10.47206590434055329, 10.59429659575721594, 10.71911562671584939, 10.84669760106889669, 10.97723304420515866, 11.11093052582432072, 11.24801914303454353, 11.38875144047037224, 11.53340686386838421, 11.68229586931969521, 11.83576484440672161, 11.99420204269015322, 12.15804479393174908, 12.32778833539936159, 12.50399672401056606, 12.68731644902689304, 12.87849359200621890, 13.07839570815925789, 13.28804008413576376, 13.50863074764164473, 13.74160770746376770, 13.98871363397358181, 14.25208598416197070, 14.53438722753863743, 14.83899385925812808, 15.17027933528726003, 15.53405335849724622, 15.93827457736767172, 16.39427105677098595, 16.91897760462044786};
    // run Temper chisquare::ppf
    Tensor<float> result = stats::chisquare::ppf(q, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.ppf_random_test_dof_10
  * @brief Randomly generated chisquare ppf test on 100 matrix with dof = 10.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, ppf_random_test_dof_10)
{
    Tensor<float> q({100});
    q = std::vector<float>{0.05000000000000000, 0.05909090909090910, 0.06818181818181818, 0.07727272727272727, 0.08636363636363636, 0.09545454545454546, 0.10454545454545455, 0.11363636363636363, 0.12272727272727273, 0.13181818181818183, 0.14090909090909093, 0.14999999999999999, 0.15909090909090909, 0.16818181818181818, 0.17727272727272725, 0.18636363636363634, 0.19545454545454544, 0.20454545454545453, 0.21363636363636362, 0.22272727272727272, 0.23181818181818181, 0.24090909090909091, 0.25000000000000000, 0.25909090909090909, 0.26818181818181819, 0.27727272727272728, 0.28636363636363638, 0.29545454545454547, 0.30454545454545451, 0.31363636363636360, 0.32272727272727270, 0.33181818181818179, 0.34090909090909088, 0.34999999999999998, 0.35909090909090907, 0.36818181818181817, 0.37727272727272726, 0.38636363636363635, 0.39545454545454545, 0.40454545454545454, 0.41363636363636364, 0.42272727272727267, 0.43181818181818177, 0.44090909090909086, 0.44999999999999996, 0.45909090909090905, 0.46818181818181814, 0.47727272727272724, 0.48636363636363633, 0.49545454545454543, 0.50454545454545452, 0.51363636363636367, 0.52272727272727271, 0.53181818181818186, 0.54090909090909089, 0.55000000000000004, 0.55909090909090908, 0.56818181818181823, 0.57727272727272727, 0.58636363636363642, 0.59545454545454546, 0.60454545454545461, 0.61363636363636365, 0.62272727272727280, 0.63181818181818183, 0.64090909090909087, 0.65000000000000002, 0.65909090909090906, 0.66818181818181821, 0.67727272727272725, 0.68636363636363640, 0.69545454545454544, 0.70454545454545459, 0.71363636363636362, 0.72272727272727277, 0.73181818181818181, 0.74090909090909096, 0.75000000000000000, 0.75909090909090915, 0.76818181818181819, 0.77727272727272734, 0.78636363636363638, 0.79545454545454541, 0.80454545454545456, 0.81363636363636360, 0.82272727272727275, 0.83181818181818179, 0.84090909090909094, 0.84999999999999998, 0.85909090909090913, 0.86818181818181817, 0.87727272727272732, 0.88636363636363635, 0.89545454545454550, 0.90454545454545454, 0.91363636363636369, 0.92272727272727273, 0.93181818181818177, 0.94090909090909092, 0.94999999999999996};
    Tensor<float> k({1});
    k = 10.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{3.94029913611906046, 4.13795388424487420, 4.31886391170489947, 4.48679215193654901, 4.64434008866678827, 4.79338957491934181, 4.93535100801148374, 5.07131205389837980, 5.20213147223718853, 5.32850083666797847, 5.45098657274950860, 5.57005944421596411, 5.68611576274812336, 5.79949298121778778, 5.91048137913211313, 6.01933296895342451, 6.12626838732703849, 6.23148229978258428, 6.33514769175020032, 6.43741931352300156, 6.53843647433578834, 6.63832532994716118, 6.73720077195464206, 6.83516800095335686, 6.93232384652933842, 7.02875788291153114, 7.12455337849047332, 7.21978810937341819, 7.31453506100069362, 7.40886303710837169, 7.50283719163643159, 7.59651949629334400, 7.68996915420873517, 7.78324296829606332, 7.87639567150147180, 7.96948022495474806, 8.06254808910269105, 8.15564947214850733, 8.24883355950732877, 8.34214872748980873, 8.43564274402203829, 8.52936295888357243, 8.62335648568309132, 8.71767037758322161, 8.81235179862396478, 8.90744819237224661, 9.00300744953827348, 9.09907807614483666, 9.19570936381039417, 9.29295156370988806, 9.39085606580819743, 9.48947558501934552, 9.58886435603283971, 9.68907833866643919, 9.79017543575734450, 9.89221572579307917, 9.99526171271530828, 10.09937859561050111, 10.20463456133779090, 10.31110110354766540, 10.41885337202563377, 10.52797055686942862, 10.63853631269360100, 10.75063922887568069, 10.86437335284164085, 10.97983877457132884, 11.09714228193177554, 11.21639809817603073, 11.33772871504805835, 11.46126583750532113, 11.58715145922708700, 11.71553909197342414, 11.84659517669726192, 11.98050071035300235, 12.11745312993684998, 12.25766850489974402, 12.40138410131355329, 12.54886139688937696, 12.70038964629453559, 12.85629012278833194, 13.01692119722528318, 13.18268446211377309, 13.35403217119022123, 13.53147635044343211, 13.71560005438771057, 13.90707140614991744, 14.10666129373140265, 14.31526593201236075, 14.53393599523099766, 14.76391476634646338, 15.00668888533724221, 15.26405706068256762, 15.53822498363703453, 15.83193947193402806, 16.14868313076189921, 16.49296568059101986, 16.87077617078809766, 17.29031647085933798, 17.76325700806282981, 18.30703805327514644};
    // run Temper chisquare::ppf
    Tensor<float> result = stats::chisquare::ppf(q, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.ppf_random_test_dof_11
  * @brief Randomly generated chisquare ppf test on 100 matrix with dof = 11.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, ppf_random_test_dof_11)
{
    Tensor<float> q({100});
    q = std::vector<float>{0.05000000000000000, 0.05909090909090910, 0.06818181818181818, 0.07727272727272727, 0.08636363636363636, 0.09545454545454546, 0.10454545454545455, 0.11363636363636363, 0.12272727272727273, 0.13181818181818183, 0.14090909090909093, 0.14999999999999999, 0.15909090909090909, 0.16818181818181818, 0.17727272727272725, 0.18636363636363634, 0.19545454545454544, 0.20454545454545453, 0.21363636363636362, 0.22272727272727272, 0.23181818181818181, 0.24090909090909091, 0.25000000000000000, 0.25909090909090909, 0.26818181818181819, 0.27727272727272728, 0.28636363636363638, 0.29545454545454547, 0.30454545454545451, 0.31363636363636360, 0.32272727272727270, 0.33181818181818179, 0.34090909090909088, 0.34999999999999998, 0.35909090909090907, 0.36818181818181817, 0.37727272727272726, 0.38636363636363635, 0.39545454545454545, 0.40454545454545454, 0.41363636363636364, 0.42272727272727267, 0.43181818181818177, 0.44090909090909086, 0.44999999999999996, 0.45909090909090905, 0.46818181818181814, 0.47727272727272724, 0.48636363636363633, 0.49545454545454543, 0.50454545454545452, 0.51363636363636367, 0.52272727272727271, 0.53181818181818186, 0.54090909090909089, 0.55000000000000004, 0.55909090909090908, 0.56818181818181823, 0.57727272727272727, 0.58636363636363642, 0.59545454545454546, 0.60454545454545461, 0.61363636363636365, 0.62272727272727280, 0.63181818181818183, 0.64090909090909087, 0.65000000000000002, 0.65909090909090906, 0.66818181818181821, 0.67727272727272725, 0.68636363636363640, 0.69545454545454544, 0.70454545454545459, 0.71363636363636362, 0.72272727272727277, 0.73181818181818181, 0.74090909090909096, 0.75000000000000000, 0.75909090909090915, 0.76818181818181819, 0.77727272727272734, 0.78636363636363638, 0.79545454545454541, 0.80454545454545456, 0.81363636363636360, 0.82272727272727275, 0.83181818181818179, 0.84090909090909094, 0.84999999999999998, 0.85909090909090913, 0.86818181818181817, 0.87727272727272732, 0.88636363636363635, 0.89545454545454550, 0.90454545454545454, 0.91363636363636369, 0.92272727272727273, 0.93181818181818177, 0.94090909090909092, 0.94999999999999996};
    Tensor<float> k({1});
    k = 11.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{4.57481307932222414, 4.78998474365843219, 4.98650948523582649, 5.16859521130418287, 5.33914621337716344, 5.50026032769285500, 5.65350776894915974, 5.80009800379551343, 5.94098490015626446, 6.07693582263793353, 6.20857864771972512, 6.33643471156882931, 6.46094249006060384, 6.58247499464238572, 6.70135279915969484, 6.81785396170597302, 6.93222169657757004, 7.04467038750017505, 7.15539035886744301, 7.26455170395951288, 7.37230738804155727, 7.47879578745954454, 7.58414278544128528, 7.68846351613519374, 7.79186382707194625, 7.89444151442374764, 7.99628737359293407, 8.09748609869834191, 8.19811705767780019, 8.29825496444376753, 8.39797046542294012, 8.49733065459408721, 8.59639952860069734, 8.69523839150005529, 8.79390621710134823, 8.89245997555361889, 8.99095492980287503, 9.08944490669501803, 9.18798254681750670, 9.28661953661730166, 9.38540682588187636, 9.48439483330459332, 9.58363364256187289, 9.68317319109483954, 9.78306345360453555, 9.88335462212982740, 9.98409728447573741, 10.08534260269351179, 10.18714249327895338, 10.28954981075151842, 10.39261853630181776, 10.49640397325026697, 10.60096295114513865, 10.70635404044629624, 10.81263777989406449, 10.91987691885505640, 11.02813667717265922, 11.13748502533664819, 11.24799298813115200, 11.35973497533277587, 11.47278914352519941, 11.58723779368529350, 11.70316780990088290, 11.82067114542361708, 11.93984536327155865, 12.06079423981340781, 12.18362844123435629, 12.30846628456306036, 12.43543459710322452, 12.56466969075834506, 12.69631847098602506, 12.83053970412750111, 12.96750547183500402, 13.10740284753449103, 13.25043583767112843, 13.39682764036547979, 13.54682328669880675, 13.70069274601151399, 13.85873459752566461, 14.02128039792953906, 14.18869991058100055, 14.36140740994056131, 14.53986933938092285, 14.72461368838756179, 14.91624157631838798, 15.11544169923778291, 15.32300853661265272, 15.53986556116768192, 15.76709520396788733, 16.00597808876248607, 16.25804521619472709, 16.52514860897915128, 16.80955888204492865, 17.11410311705545340, 17.44236490221294034, 17.79898365384500991, 18.19011914454866385, 18.62420480359973851, 19.11323705828792185, 19.67513757268249108};
    // run Temper chisquare::ppf
    Tensor<float> result = stats::chisquare::ppf(q, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.ppf_random_test_dof_12
  * @brief Randomly generated chisquare ppf test on 100 matrix with dof = 12.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, ppf_random_test_dof_12)
{
    Tensor<float> q({100});
    q = std::vector<float>{0.05000000000000000, 0.05909090909090910, 0.06818181818181818, 0.07727272727272727, 0.08636363636363636, 0.09545454545454546, 0.10454545454545455, 0.11363636363636363, 0.12272727272727273, 0.13181818181818183, 0.14090909090909093, 0.14999999999999999, 0.15909090909090909, 0.16818181818181818, 0.17727272727272725, 0.18636363636363634, 0.19545454545454544, 0.20454545454545453, 0.21363636363636362, 0.22272727272727272, 0.23181818181818181, 0.24090909090909091, 0.25000000000000000, 0.25909090909090909, 0.26818181818181819, 0.27727272727272728, 0.28636363636363638, 0.29545454545454547, 0.30454545454545451, 0.31363636363636360, 0.32272727272727270, 0.33181818181818179, 0.34090909090909088, 0.34999999999999998, 0.35909090909090907, 0.36818181818181817, 0.37727272727272726, 0.38636363636363635, 0.39545454545454545, 0.40454545454545454, 0.41363636363636364, 0.42272727272727267, 0.43181818181818177, 0.44090909090909086, 0.44999999999999996, 0.45909090909090905, 0.46818181818181814, 0.47727272727272724, 0.48636363636363633, 0.49545454545454543, 0.50454545454545452, 0.51363636363636367, 0.52272727272727271, 0.53181818181818186, 0.54090909090909089, 0.55000000000000004, 0.55909090909090908, 0.56818181818181823, 0.57727272727272727, 0.58636363636363642, 0.59545454545454546, 0.60454545454545461, 0.61363636363636365, 0.62272727272727280, 0.63181818181818183, 0.64090909090909087, 0.65000000000000002, 0.65909090909090906, 0.66818181818181821, 0.67727272727272725, 0.68636363636363640, 0.69545454545454544, 0.70454545454545459, 0.71363636363636362, 0.72272727272727277, 0.73181818181818181, 0.74090909090909096, 0.75000000000000000, 0.75909090909090915, 0.76818181818181819, 0.77727272727272734, 0.78636363636363638, 0.79545454545454541, 0.80454545454545456, 0.81363636363636360, 0.82272727272727275, 0.83181818181818179, 0.84090909090909094, 0.84999999999999998, 0.85909090909090913, 0.86818181818181817, 0.87727272727272732, 0.88636363636363635, 0.89545454545454550, 0.90454545454545454, 0.91363636363636369, 0.92272727272727273, 0.93181818181818177, 0.94090909090909092, 0.94999999999999996};
    Tensor<float> k({1});
    k = 12.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{5.22602948839263881, 5.45799981054084693, 5.66948822462358049, 5.86513300168463481, 6.04813105484284375, 6.22078878865196216, 6.38483065179690890, 6.54158359095165398, 6.69209316261461939, 6.83719976406121877, 6.97759046167439756, 7.11383528464290293, 7.24641329167525683, 7.37573170783224885, 7.50214024639084354, 7.62594201080742540, 7.74740191993437488, 7.86675330818972185, 7.98420315985696849, 8.09993630676547305, 8.21411882921156788, 8.32690083739607978, 8.43841876613579345, 8.54879728347673051, 8.65815089033796781, 8.76658527091658968, 8.87419844055686546, 8.98108172793006254, 9.08732062084098402, 9.19299549917285042, 9.29818227397078090, 9.40295294813065574, 9.50737611137311944, 9.61151737996992317, 9.71543978992295010, 9.81920415087797060, 9.92286936691151489, 10.02649272940361236, 10.13013018645792584, 10.23383659272029433, 10.33766594295022045, 10.44167159229738218, 10.54590646591027436, 10.65042326024413200, 10.75527463823053509, 10.86051342031400324, 10.96619277324542985, 11.07236639844416359, 11.17908872169695123, 11.28641508595059584, 11.39440194897524350, 11.50310708772668100, 11.61258981131944168, 11.72291118464013238, 11.83413426478449004, 11.94632435269640069, 12.05954926262712767, 12.17387961232564031, 12.28938913722275927, 12.40615503229512306, 12.52425832580029663, 12.64378428967923185, 12.76482289214465027, 12.88746929883978254, 13.01182442998963396, 13.13799558221663588, 13.26609712519993067, 13.39625128518459540, 13.52858902956943332, 13.66325106951776291, 13.80038900087080656, 13.94016660776019201, 14.08276135842612575, 14.22836612912906595, 14.37719120006096496, 14.52946657730613467, 14.68544470782645384, 14.84540367104017555, 15.00965095204375466, 15.17852792957363306, 15.35241524877114827, 15.53173929802488828, 15.71698007538747710, 15.90868082022109675, 16.10745991002493227, 16.31402569612757247, 16.52919519839393203, 16.75391793450626921, 16.98930668116488008, 17.23667774593288726, 17.49760452460968807, 17.77398999573198068, 18.06816683089107656, 18.38303883782895554, 18.72228614560227555, 19.09067217365996783, 19.49451994226244977, 19.94248432795456694, 20.44687356367322906, 21.02606981748306936};
    // run Temper chisquare::ppf
    Tensor<float> result = stats::chisquare::ppf(q, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.ppf_random_test_dof_13
  * @brief Randomly generated chisquare ppf test on 100 matrix with dof = 13.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, ppf_random_test_dof_13)
{
    Tensor<float> q({100});
    q = std::vector<float>{0.05000000000000000, 0.05909090909090910, 0.06818181818181818, 0.07727272727272727, 0.08636363636363636, 0.09545454545454546, 0.10454545454545455, 0.11363636363636363, 0.12272727272727273, 0.13181818181818183, 0.14090909090909093, 0.14999999999999999, 0.15909090909090909, 0.16818181818181818, 0.17727272727272725, 0.18636363636363634, 0.19545454545454544, 0.20454545454545453, 0.21363636363636362, 0.22272727272727272, 0.23181818181818181, 0.24090909090909091, 0.25000000000000000, 0.25909090909090909, 0.26818181818181819, 0.27727272727272728, 0.28636363636363638, 0.29545454545454547, 0.30454545454545451, 0.31363636363636360, 0.32272727272727270, 0.33181818181818179, 0.34090909090909088, 0.34999999999999998, 0.35909090909090907, 0.36818181818181817, 0.37727272727272726, 0.38636363636363635, 0.39545454545454545, 0.40454545454545454, 0.41363636363636364, 0.42272727272727267, 0.43181818181818177, 0.44090909090909086, 0.44999999999999996, 0.45909090909090905, 0.46818181818181814, 0.47727272727272724, 0.48636363636363633, 0.49545454545454543, 0.50454545454545452, 0.51363636363636367, 0.52272727272727271, 0.53181818181818186, 0.54090909090909089, 0.55000000000000004, 0.55909090909090908, 0.56818181818181823, 0.57727272727272727, 0.58636363636363642, 0.59545454545454546, 0.60454545454545461, 0.61363636363636365, 0.62272727272727280, 0.63181818181818183, 0.64090909090909087, 0.65000000000000002, 0.65909090909090906, 0.66818181818181821, 0.67727272727272725, 0.68636363636363640, 0.69545454545454544, 0.70454545454545459, 0.71363636363636362, 0.72272727272727277, 0.73181818181818181, 0.74090909090909096, 0.75000000000000000, 0.75909090909090915, 0.76818181818181819, 0.77727272727272734, 0.78636363636363638, 0.79545454545454541, 0.80454545454545456, 0.81363636363636360, 0.82272727272727275, 0.83181818181818179, 0.84090909090909094, 0.84999999999999998, 0.85909090909090913, 0.86818181818181817, 0.87727272727272732, 0.88636363636363635, 0.89545454545454550, 0.90454545454545454, 0.91363636363636369, 0.92272727272727273, 0.93181818181818177, 0.94090909090909092, 0.94999999999999996};
    Tensor<float> k({1});
    k = 13.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{5.89186433770984852, 6.13999328623425988, 6.36586687372610172, 6.57454016777267292, 6.76949328886504453, 6.95323438388471882, 7.12763701273939976, 7.29414164937524578, 7.45388241831121334, 7.60777023815869047, 7.75654931080185062, 7.90083665392036760, 8.04115047724907939, 8.17793100357787317, 8.31155604303813789, 8.44235284267119290, 8.57060723973788541, 8.69657082908503121, 8.82046664482700926, 8.94249371490200673, 9.06283074961186941, 9.18163915705326517, 9.29906552985214141, 9.41524371262490511, 9.53029653400839649, 9.64433726816663572, 9.75747087650921863, 9.86979506963538356, 9.98140122132969942, 10.09237516012543345, 10.20279785904806324, 10.31274604031217557, 10.42229270871670010, 10.53150762507997840, 10.64045772913694066, 10.74920751978008404, 10.85781939928346596, 10.96635398714347431, 11.07487040835346548, 11.18342656026557158, 11.29207936165271242, 11.40088498714530196, 11.50989908986229082, 11.61917701477194953, 11.72877400509255708, 11.83874540386952923, 11.94914685273643862, 12.06003448977825698, 12.17146514836291438, 12.28349655878877122, 12.39618755461096455, 12.50959828555729736, 12.62379043902581799, 12.73882747227353107, 12.85477485756035776, 12.97170034270968486, 13.08967422979084994, 13.20876967492668541, 13.32906301258876525, 13.45063410817524918, 13.57356674318345036, 13.69794903790804241, 13.82387391733614024, 13.95143962679688165, 14.08075030498720537, 14.21191662327560046, 14.34505650173129787, 14.48029591419856388, 14.61776979701434165, 14.75762307875108448, 14.90001185178572207, 15.04510471071542987, 15.19308428787937437, 15.34414902278580328, 15.49851521046281810, 15.65641938414696099, 15.81812110097029844, 15.98390621631205200, 16.15409075449236553, 16.32902551222483822, 16.50910156912003757, 16.69475692994998894, 16.88648459122563139, 17.08484241699432715, 17.29046533608307712, 17.50408055095053683, 17.72652670072450931, 17.95877828495707362, 18.20197718891290606, 18.45747395122562651, 18.72688263933199337, 19.01215511919223999, 19.31568360414847874, 19.64044552405116661, 19.99021365061311428, 20.36987040961800943, 20.78589550567021860, 21.24715638163688425, 21.76626060648747796, 22.36203249482693423};
    // run Temper chisquare::ppf
    Tensor<float> result = stats::chisquare::ppf(q, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.ppf_random_test_dof_14
  * @brief Randomly generated chisquare ppf test on 100 matrix with dof = 14.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, ppf_random_test_dof_14)
{
    Tensor<float> q({100});
    q = std::vector<float>{0.05000000000000000, 0.05909090909090910, 0.06818181818181818, 0.07727272727272727, 0.08636363636363636, 0.09545454545454546, 0.10454545454545455, 0.11363636363636363, 0.12272727272727273, 0.13181818181818183, 0.14090909090909093, 0.14999999999999999, 0.15909090909090909, 0.16818181818181818, 0.17727272727272725, 0.18636363636363634, 0.19545454545454544, 0.20454545454545453, 0.21363636363636362, 0.22272727272727272, 0.23181818181818181, 0.24090909090909091, 0.25000000000000000, 0.25909090909090909, 0.26818181818181819, 0.27727272727272728, 0.28636363636363638, 0.29545454545454547, 0.30454545454545451, 0.31363636363636360, 0.32272727272727270, 0.33181818181818179, 0.34090909090909088, 0.34999999999999998, 0.35909090909090907, 0.36818181818181817, 0.37727272727272726, 0.38636363636363635, 0.39545454545454545, 0.40454545454545454, 0.41363636363636364, 0.42272727272727267, 0.43181818181818177, 0.44090909090909086, 0.44999999999999996, 0.45909090909090905, 0.46818181818181814, 0.47727272727272724, 0.48636363636363633, 0.49545454545454543, 0.50454545454545452, 0.51363636363636367, 0.52272727272727271, 0.53181818181818186, 0.54090909090909089, 0.55000000000000004, 0.55909090909090908, 0.56818181818181823, 0.57727272727272727, 0.58636363636363642, 0.59545454545454546, 0.60454545454545461, 0.61363636363636365, 0.62272727272727280, 0.63181818181818183, 0.64090909090909087, 0.65000000000000002, 0.65909090909090906, 0.66818181818181821, 0.67727272727272725, 0.68636363636363640, 0.69545454545454544, 0.70454545454545459, 0.71363636363636362, 0.72272727272727277, 0.73181818181818181, 0.74090909090909096, 0.75000000000000000, 0.75909090909090915, 0.76818181818181819, 0.77727272727272734, 0.78636363636363638, 0.79545454545454541, 0.80454545454545456, 0.81363636363636360, 0.82272727272727275, 0.83181818181818179, 0.84090909090909094, 0.84999999999999998, 0.85909090909090913, 0.86818181818181817, 0.87727272727272732, 0.88636363636363635, 0.89545454545454550, 0.90454545454545454, 0.91363636363636369, 0.92272727272727273, 0.93181818181818177, 0.94090909090909092, 0.94999999999999996};
    Tensor<float> k({1});
    k = 14.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{6.57063138378934042, 6.83434456379721844, 7.07408531372470950, 7.29531293134370085, 7.50178205578107882, 7.69619629495955326, 7.88057361794817890, 8.05646440579495859, 8.22508849857654489, 8.38742504461965765, 8.54427350955694109, 8.69629634876529067, 8.84404962202231459, 8.98800544637378174, 9.12856878366247670, 9.26609020785435966, 9.40087576336187958, 9.53319468152080773, 9.66328549530828163, 9.79136093927131768, 9.91761191636815909, 10.04221073977729972, 10.16531380537706042, 10.28706381283916826, 10.40759162568032536, 10.52701784019353504, 10.64545411789754503, 10.76300432458531731, 10.87976551022685179, 10.99582875718233765, 11.11127991889858713, 11.22620026712587205, 11.34066706243092781, 11.45475406019333953, 11.56853196220594526, 11.68206882234081334, 11.79543041340459197, 11.90868056122384644, 12.02188145112144113, 12.13509391122940251, 12.24837767650126352, 12.36179163681318194, 12.47539407215981733, 12.58924287764263639, 12.70339578070374742, 12.81791055286853620, 12.93284521811800936, 13.04825825991229671, 13.16420882882542287, 13.28075695272712764, 13.39796375145714435, 13.51589165798232628, 13.63460464810616557, 13.75416848091728816, 13.87465095231856260, 13.99612216417869348, 14.11865481189500571, 14.24232449345980633, 14.36721004348896180, 14.49339389611258788, 14.62096248115607722, 14.75000665867242056, 14.88062219764356087, 15.01291030557562323, 15.14697821680128698, 15.28293984861284116, 15.42091653593114842, 15.56103785713219523, 15.70344256598494148, 15.84827964750357054, 15.99570951901663918, 16.14590540207498748, 16.29905489618166570, 16.45536179202112947, 16.61504817027614322, 16.77835684276045924, 16.94555420615035146, 17.11693359600006659, 17.29281925124880104, 17.47357102883214353, 17.65959004676164312, 17.85132548561641030, 18.04928284779154524, 18.25403406831973996, 18.46623000130962922, 18.68661598803302581, 18.91605147083535243, 19.15553498922881204, 19.40623644084892874, 19.66953930792843863, 19.94709680188907797, 20.24090784250516961, 20.55342195507968839, 20.88768743903656144, 21.24756625126764575, 21.63805539113996801, 22.06578542386615283, 22.53982847651444033, 23.07308038389362537, 23.68479130484057649};
    // run Temper chisquare::ppf
    Tensor<float> result = stats::chisquare::ppf(q, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.ppf_random_test_dof_15
  * @brief Randomly generated chisquare ppf test on 100 matrix with dof = 15.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, ppf_random_test_dof_15)
{
    Tensor<float> q({100});
    q = std::vector<float>{0.05000000000000000, 0.05909090909090910, 0.06818181818181818, 0.07727272727272727, 0.08636363636363636, 0.09545454545454546, 0.10454545454545455, 0.11363636363636363, 0.12272727272727273, 0.13181818181818183, 0.14090909090909093, 0.14999999999999999, 0.15909090909090909, 0.16818181818181818, 0.17727272727272725, 0.18636363636363634, 0.19545454545454544, 0.20454545454545453, 0.21363636363636362, 0.22272727272727272, 0.23181818181818181, 0.24090909090909091, 0.25000000000000000, 0.25909090909090909, 0.26818181818181819, 0.27727272727272728, 0.28636363636363638, 0.29545454545454547, 0.30454545454545451, 0.31363636363636360, 0.32272727272727270, 0.33181818181818179, 0.34090909090909088, 0.34999999999999998, 0.35909090909090907, 0.36818181818181817, 0.37727272727272726, 0.38636363636363635, 0.39545454545454545, 0.40454545454545454, 0.41363636363636364, 0.42272727272727267, 0.43181818181818177, 0.44090909090909086, 0.44999999999999996, 0.45909090909090905, 0.46818181818181814, 0.47727272727272724, 0.48636363636363633, 0.49545454545454543, 0.50454545454545452, 0.51363636363636367, 0.52272727272727271, 0.53181818181818186, 0.54090909090909089, 0.55000000000000004, 0.55909090909090908, 0.56818181818181823, 0.57727272727272727, 0.58636363636363642, 0.59545454545454546, 0.60454545454545461, 0.61363636363636365, 0.62272727272727280, 0.63181818181818183, 0.64090909090909087, 0.65000000000000002, 0.65909090909090906, 0.66818181818181821, 0.67727272727272725, 0.68636363636363640, 0.69545454545454544, 0.70454545454545459, 0.71363636363636362, 0.72272727272727277, 0.73181818181818181, 0.74090909090909096, 0.75000000000000000, 0.75909090909090915, 0.76818181818181819, 0.77727272727272734, 0.78636363636363638, 0.79545454545454541, 0.80454545454545456, 0.81363636363636360, 0.82272727272727275, 0.83181818181818179, 0.84090909090909094, 0.84999999999999998, 0.85909090909090913, 0.86818181818181817, 0.87727272727272732, 0.88636363636363635, 0.89545454545454550, 0.90454545454545454, 0.91363636363636369, 0.92272727272727273, 0.93181818181818177, 0.94090909090909092, 0.94999999999999996};
    Tensor<float> k({1});
    k = 15.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{7.26094392767003249, 7.53972248554428770, 7.79286332573236429, 8.02621833885190483, 8.24380865844036315, 8.44852756594465149, 8.64253311571728311, 8.82748227263424567, 9.00467797778397205, 9.17516551158146676, 9.33979789220770229, 9.49928159654871251, 9.65420934758120453, 9.80508415089733987, 9.95233725940105352, 10.09634183093928073, 10.23742347043208056, 10.37586847885628671, 10.51193038784172629, 10.64583519442903459, 10.77778559767970101, 10.90796445989333385, 11.03653765909100848, 11.16365645897464809, 11.28945949301372131, 11.41407443744439476, 11.53761943160543879, 11.66020429166571581, 11.78193155435455708, 11.90289738003155406, 12.02319233878177407, 12.14290209879855631, 12.26210803282883965, 12.38088775568786915, 12.49931560364067806, 12.61746306467387591, 12.73539916725094301, 12.85319083398588447, 12.97090320572947775, 13.08859994079660893, 13.20634349343963621, 13.32419537516525310, 13.44221640208120938, 13.56046693112765134, 13.67900708778458529, 13.79789698764134087, 13.91719695405896573, 14.03696773404636744, 14.15727071440176843, 14.27816814014004443, 14.39972333723158471, 14.52200094171968381, 14.64506713736121668, 14.76898990405127599, 14.89383927944898822, 15.01968763642331695, 15.14660997918882757, 15.27468426130961099, 15.40399172912272618, 15.53461729458249607, 15.66664994206607808, 15.80018317432651287, 15.93531550355262993, 16.07215099442197470, 16.21079986714504884, 16.35137916983818585, 16.49401353117935187, 16.63883600625991122, 16.78598903092921191, 16.93562550284152834, 17.08791001099235984, 17.24302023994574640, 17.40114858043515866, 17.56250398486221087, 17.72731411481515096, 17.89582783860283755, 18.06831815065393343, 18.24508560241513422, 18.42646235739855243, 18.61281701307669678, 18.80456037191955687, 19.00215239657038069, 19.20611065506340154, 19.41702065850154213, 19.63554862664797795, 19.86245740278635097, 20.09862650287781705, 20.34507766417672414, 20.60300781641198142, 20.87383223395555376, 21.15924190578036956, 21.46128116515956208, 21.78245485434712236, 22.12587967925716725, 22.49550368756304408, 22.89643448425882966, 23.33544828106626312, 23.82181483073249950, 24.36870831805379467, 24.99579013972861574};
    // run Temper chisquare::ppf
    Tensor<float> result = stats::chisquare::ppf(q, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.ppf_random_test_dof_16
  * @brief Randomly generated chisquare ppf test on 100 matrix with dof = 16.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, ppf_random_test_dof_16)
{
    Tensor<float> q({100});
    q = std::vector<float>{0.05000000000000000, 0.05909090909090910, 0.06818181818181818, 0.07727272727272727, 0.08636363636363636, 0.09545454545454546, 0.10454545454545455, 0.11363636363636363, 0.12272727272727273, 0.13181818181818183, 0.14090909090909093, 0.14999999999999999, 0.15909090909090909, 0.16818181818181818, 0.17727272727272725, 0.18636363636363634, 0.19545454545454544, 0.20454545454545453, 0.21363636363636362, 0.22272727272727272, 0.23181818181818181, 0.24090909090909091, 0.25000000000000000, 0.25909090909090909, 0.26818181818181819, 0.27727272727272728, 0.28636363636363638, 0.29545454545454547, 0.30454545454545451, 0.31363636363636360, 0.32272727272727270, 0.33181818181818179, 0.34090909090909088, 0.34999999999999998, 0.35909090909090907, 0.36818181818181817, 0.37727272727272726, 0.38636363636363635, 0.39545454545454545, 0.40454545454545454, 0.41363636363636364, 0.42272727272727267, 0.43181818181818177, 0.44090909090909086, 0.44999999999999996, 0.45909090909090905, 0.46818181818181814, 0.47727272727272724, 0.48636363636363633, 0.49545454545454543, 0.50454545454545452, 0.51363636363636367, 0.52272727272727271, 0.53181818181818186, 0.54090909090909089, 0.55000000000000004, 0.55909090909090908, 0.56818181818181823, 0.57727272727272727, 0.58636363636363642, 0.59545454545454546, 0.60454545454545461, 0.61363636363636365, 0.62272727272727280, 0.63181818181818183, 0.64090909090909087, 0.65000000000000002, 0.65909090909090906, 0.66818181818181821, 0.67727272727272725, 0.68636363636363640, 0.69545454545454544, 0.70454545454545459, 0.71363636363636362, 0.72272727272727277, 0.73181818181818181, 0.74090909090909096, 0.75000000000000000, 0.75909090909090915, 0.76818181818181819, 0.77727272727272734, 0.78636363636363638, 0.79545454545454541, 0.80454545454545456, 0.81363636363636360, 0.82272727272727275, 0.83181818181818179, 0.84090909090909094, 0.84999999999999998, 0.85909090909090913, 0.86818181818181817, 0.87727272727272732, 0.88636363636363635, 0.89545454545454550, 0.90454545454545454, 0.91363636363636369, 0.92272727272727273, 0.93181818181818177, 0.94090909090909092, 0.94999999999999996};
    Tensor<float> k({1});
    k = 16.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{7.96164557237855153, 8.25501805067089656, 8.52113521177389011, 8.76623075010011377, 8.99458487060912226, 9.20927518427091485, 9.41259584451733033, 9.60630734054681490, 9.79179331037806122, 9.97016323985647546, 10.14232212954323842, 10.30901917953864633, 10.47088268887958229, 10.62844563119035435, 10.78216476325514961, 10.93243514764140656, 11.07960135909829802, 11.22396625076101628, 11.36579789651945127, 11.50533515091177250, 11.64279214766277804, 11.77836197390890938, 11.91221969741599551, 12.04452488103162189, 12.17542368715196943, 12.30505065171245072, 12.43353018980435998, 12.56097788186079534, 12.68750157931116718, 12.81320236086739861, 12.93817536459662421, 13.06251051623241644, 13.18629317046922722, 13.30960467904290034, 13.43252289705133329, 13.55512263708449971, 13.67747607921246455, 13.79965314364905637, 13.92172183190847790, 14.04374854145825147, 14.16579835820809841, 14.28793533063420007, 14.41022272890002043, 14.53272329198118129, 14.65549946551977101, 14.77861363291313346, 14.90212834197443037, 15.02610652938250091, 15.15061174506097252, 15.27570837858951514, 15.40146188975040964, 15.52793904535203673, 15.65520816454644581, 15.78333937497382067, 15.91240488222399740, 16.04247925530856733, 16.17363973109182496, 16.30596654094221876, 16.43954326324518789, 16.57445720587701032, 16.71079982328834390, 16.84866717350523047, 16.98816042114390967, 17.12938639348140413, 17.27245819775939850, 17.41749590926572111, 17.56462734138832715, 17.71398891083691396, 17.86572661366096426, 18.01999713066715003, 18.17696908449135051, 18.33682447508859781, 18.49976032599941433, 18.66599058073691708, 18.83574829741601064, 19.00928820084745041, 19.18688966546204000, 19.36886022058451218, 19.55553969307068485, 19.74730513299202173, 19.94457670846577457, 20.14782480951694410, 20.35757867322183756, 20.57443694087570663, 20.79908069368078927, 21.03228970313872992, 21.27496290135877288, 21.52814446431960960, 21.79305747032077178, 22.07114794795874246, 22.36414343193441212, 22.67413219012474102, 23.00367258282720329, 23.35594750117887486, 23.73498829263084886, 24.14600958832944499, 24.59592854208238677, 25.09420616254973169, 25.65428603432646781, 26.29622760486423161};
    // run Temper chisquare::ppf
    Tensor<float> result = stats::chisquare::ppf(q, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.ppf_random_test_dof_17
  * @brief Randomly generated chisquare ppf test on 100 matrix with dof = 17.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, ppf_random_test_dof_17)
{
    Tensor<float> q({100});
    q = std::vector<float>{0.05000000000000000, 0.05909090909090910, 0.06818181818181818, 0.07727272727272727, 0.08636363636363636, 0.09545454545454546, 0.10454545454545455, 0.11363636363636363, 0.12272727272727273, 0.13181818181818183, 0.14090909090909093, 0.14999999999999999, 0.15909090909090909, 0.16818181818181818, 0.17727272727272725, 0.18636363636363634, 0.19545454545454544, 0.20454545454545453, 0.21363636363636362, 0.22272727272727272, 0.23181818181818181, 0.24090909090909091, 0.25000000000000000, 0.25909090909090909, 0.26818181818181819, 0.27727272727272728, 0.28636363636363638, 0.29545454545454547, 0.30454545454545451, 0.31363636363636360, 0.32272727272727270, 0.33181818181818179, 0.34090909090909088, 0.34999999999999998, 0.35909090909090907, 0.36818181818181817, 0.37727272727272726, 0.38636363636363635, 0.39545454545454545, 0.40454545454545454, 0.41363636363636364, 0.42272727272727267, 0.43181818181818177, 0.44090909090909086, 0.44999999999999996, 0.45909090909090905, 0.46818181818181814, 0.47727272727272724, 0.48636363636363633, 0.49545454545454543, 0.50454545454545452, 0.51363636363636367, 0.52272727272727271, 0.53181818181818186, 0.54090909090909089, 0.55000000000000004, 0.55909090909090908, 0.56818181818181823, 0.57727272727272727, 0.58636363636363642, 0.59545454545454546, 0.60454545454545461, 0.61363636363636365, 0.62272727272727280, 0.63181818181818183, 0.64090909090909087, 0.65000000000000002, 0.65909090909090906, 0.66818181818181821, 0.67727272727272725, 0.68636363636363640, 0.69545454545454544, 0.70454545454545459, 0.71363636363636362, 0.72272727272727277, 0.73181818181818181, 0.74090909090909096, 0.75000000000000000, 0.75909090909090915, 0.76818181818181819, 0.77727272727272734, 0.78636363636363638, 0.79545454545454541, 0.80454545454545456, 0.81363636363636360, 0.82272727272727275, 0.83181818181818179, 0.84090909090909094, 0.84999999999999998, 0.85909090909090913, 0.86818181818181817, 0.87727272727272732, 0.88636363636363635, 0.89545454545454550, 0.90454545454545454, 0.91363636363636369, 0.92272727272727273, 0.93181818181818177, 0.94090909090909092, 0.94999999999999996};
    Tensor<float> k({1});
    k = 17.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{8.67176020467007724, 8.97929591784048853, 9.25800276578455517, 9.51448622611206396, 9.75327869323802865, 9.97763716060863537, 10.18998819540922618, 10.39219298579441464, 10.58571364884579324, 10.77172210001963748, 10.95117387620066651, 11.12485970592237017, 11.29344246450745715, 11.45748424760986950, 11.61746659285948624, 11.77380584407238473, 11.92686500386339432, 12.07696300295446612, 12.22438203914265387, 12.36937345338757055, 12.51216248304904255, 12.65295214322149420, 12.79192642383199185, 12.92925294455955587, 13.06508517631798760, 13.19956431340786196, 13.33282086201746885, 13.46497599682576407, 13.59614272683186442, 13.72642690335071336, 13.85592809675815218, 13.98474036359436923, 14.11295292171349303, 14.24065074805590747, 14.36791511113613495, 14.49482404834557059, 14.62145279656190944, 14.74787418325443156, 14.87415898421713223, 15.00037625319961698, 15.12659362800377139, 15.25287761704180767, 15.37929386988689906, 15.50590743497192214, 15.63278300729212056, 15.75998516873233513, 15.88757862345937788, 16.01562843069104858, 16.14420023706759721, 16.27336051080832036, 16.40317677983193789, 16.53371787605448517, 16.66505418815247808, 16.79725792519393224, 16.93040339369814262, 17.06456729089032009, 17.19982901717542845, 17.33627101117350122, 17.47397911104437185, 17.61304294629657008, 17.75355636483435262, 17.89561790066811042, 18.03933128851749856, 18.18480603250037220, 18.33215803725870074, 18.48151031126631239, 18.63299375374694122, 18.78674803867098575, 18.94292261178154746, 19.10167781963420097, 19.26318619335973992, 19.42763391445746635, 19.59522249563325857, 19.76617071682141002, 19.94071686548097588, 20.11912134157874377, 20.30166970209379684, 20.48867623839150198, 20.68048820377219243, 20.87749083977372067, 21.08011339101431858, 21.28883635320334022, 21.50420027272400247, 21.72681651660283109, 21.95738057007069699, 22.19668861228020162, 22.44565839496439352, 22.70535584410962215, 22.97702938482755641, 23.26215485799116678, 23.56249522599340906, 23.88018134889132327, 24.21782347193902041, 24.57866865474205653, 24.96682901016722411, 25.38762294472650183, 25.84810428122101911, 26.35791949749311769, 26.93077344542501450, 27.58711163827533852};
    // run Temper chisquare::ppf
    Tensor<float> result = stats::chisquare::ppf(q, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.ppf_random_test_dof_18
  * @brief Randomly generated chisquare ppf test on 100 matrix with dof = 18.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, ppf_random_test_dof_18)
{
    Tensor<float> q({100});
    q = std::vector<float>{0.05000000000000000, 0.05909090909090910, 0.06818181818181818, 0.07727272727272727, 0.08636363636363636, 0.09545454545454546, 0.10454545454545455, 0.11363636363636363, 0.12272727272727273, 0.13181818181818183, 0.14090909090909093, 0.14999999999999999, 0.15909090909090909, 0.16818181818181818, 0.17727272727272725, 0.18636363636363634, 0.19545454545454544, 0.20454545454545453, 0.21363636363636362, 0.22272727272727272, 0.23181818181818181, 0.24090909090909091, 0.25000000000000000, 0.25909090909090909, 0.26818181818181819, 0.27727272727272728, 0.28636363636363638, 0.29545454545454547, 0.30454545454545451, 0.31363636363636360, 0.32272727272727270, 0.33181818181818179, 0.34090909090909088, 0.34999999999999998, 0.35909090909090907, 0.36818181818181817, 0.37727272727272726, 0.38636363636363635, 0.39545454545454545, 0.40454545454545454, 0.41363636363636364, 0.42272727272727267, 0.43181818181818177, 0.44090909090909086, 0.44999999999999996, 0.45909090909090905, 0.46818181818181814, 0.47727272727272724, 0.48636363636363633, 0.49545454545454543, 0.50454545454545452, 0.51363636363636367, 0.52272727272727271, 0.53181818181818186, 0.54090909090909089, 0.55000000000000004, 0.55909090909090908, 0.56818181818181823, 0.57727272727272727, 0.58636363636363642, 0.59545454545454546, 0.60454545454545461, 0.61363636363636365, 0.62272727272727280, 0.63181818181818183, 0.64090909090909087, 0.65000000000000002, 0.65909090909090906, 0.66818181818181821, 0.67727272727272725, 0.68636363636363640, 0.69545454545454544, 0.70454545454545459, 0.71363636363636362, 0.72272727272727277, 0.73181818181818181, 0.74090909090909096, 0.75000000000000000, 0.75909090909090915, 0.76818181818181819, 0.77727272727272734, 0.78636363636363638, 0.79545454545454541, 0.80454545454545456, 0.81363636363636360, 0.82272727272727275, 0.83181818181818179, 0.84090909090909094, 0.84999999999999998, 0.85909090909090913, 0.86818181818181817, 0.87727272727272732, 0.88636363636363635, 0.89545454545454550, 0.90454545454545454, 0.91363636363636369, 0.92272727272727273, 0.93181818181818177, 0.94090909090909092, 0.94999999999999996};
    Tensor<float> k({1});
    k = 18.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{9.39045508068898371, 9.71175868158389832, 10.00270068619917829, 10.27024902852354948, 10.51918189642469414, 10.75293107386104730, 10.97405212465693758, 11.18450431865975681, 11.38582619923047545, 11.57925046903780775, 11.76578186479380683, 11.94625153989723287, 12.12135602303954585, 12.29168575135419950, 12.45774637655218342, 12.61997494901510564, 12.77875239988871847, 12.93441330041857817, 13.08725358717200038, 13.23753674604349051, 13.38549881350421344, 13.53135245959111721, 13.67529035039829033, 13.81748793974280254, 13.95810580455594163, 14.09729161258313646, 14.23518179155694874, 14.37190295433305920, 14.50757312328111936, 14.64230278859999324, 14.77619582853184177, 14.90935031421050105, 15.04185921775019530, 15.17381103890464722, 15.30529036301099666, 15.43637836083429526, 15.56715323923541838, 15.69769065021358756, 15.82806406476152539, 15.95834511706264891, 16.08860392382074878, 16.21890938290848183, 16.34932945503136992, 16.47993143170690544, 16.61078219254161326, 16.74194845453874692, 16.87349701597831952, 17.00549499727171465, 17.13801008110063862, 17.27111075410049423, 17.40486655234021640, 17.53934831288261975, 17.67462843378125470, 17.81078114498458120, 17.94788279277685916, 18.08601214059240547, 18.22525068930171699, 18.36568302038956446, 18.50739716583813177, 18.65048500900196160, 18.79504272133106113, 18.94117124048167966, 19.08897679617292908, 19.23857149112945564, 19.39007394562977638, 19.54361001560004141, 19.69931359590850306, 19.85732752259438527, 20.01780459029458470, 20.18090870422281213, 20.34681618985157669, 20.51571728813331674, 20.68781786991150184, 20.86334141043289137, 21.04253127399296375, 21.22565337028217769, 21.41299925869537191, 21.60488979572816248, 21.80167944499166310, 22.00376140123695379, 22.21157372175856892, 22.42560671441038167, 22.64641190661667380, 22.87461302203507429, 23.11091953247932196, 23.35614354963802697, 23.61122110039060829, 23.87723923205936671, 24.15547098465354026, 24.44742115136037697, 24.75488710145214810, 25.08004106136359468, 25.42554366994218995, 25.79470431332882896, 26.19171355486532704, 26.62199060671595419, 27.09272205650768228, 27.61373456333227949, 28.19898681357033610, 28.86929943039262270};
    // run Temper chisquare::ppf
    Tensor<float> result = stats::chisquare::ppf(q, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.ppf_random_test_dof_19
  * @brief Randomly generated chisquare ppf test on 100 matrix with dof = 19.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, ppf_random_test_dof_19)
{
    Tensor<float> q({100});
    q = std::vector<float>{0.05000000000000000, 0.05909090909090910, 0.06818181818181818, 0.07727272727272727, 0.08636363636363636, 0.09545454545454546, 0.10454545454545455, 0.11363636363636363, 0.12272727272727273, 0.13181818181818183, 0.14090909090909093, 0.14999999999999999, 0.15909090909090909, 0.16818181818181818, 0.17727272727272725, 0.18636363636363634, 0.19545454545454544, 0.20454545454545453, 0.21363636363636362, 0.22272727272727272, 0.23181818181818181, 0.24090909090909091, 0.25000000000000000, 0.25909090909090909, 0.26818181818181819, 0.27727272727272728, 0.28636363636363638, 0.29545454545454547, 0.30454545454545451, 0.31363636363636360, 0.32272727272727270, 0.33181818181818179, 0.34090909090909088, 0.34999999999999998, 0.35909090909090907, 0.36818181818181817, 0.37727272727272726, 0.38636363636363635, 0.39545454545454545, 0.40454545454545454, 0.41363636363636364, 0.42272727272727267, 0.43181818181818177, 0.44090909090909086, 0.44999999999999996, 0.45909090909090905, 0.46818181818181814, 0.47727272727272724, 0.48636363636363633, 0.49545454545454543, 0.50454545454545452, 0.51363636363636367, 0.52272727272727271, 0.53181818181818186, 0.54090909090909089, 0.55000000000000004, 0.55909090909090908, 0.56818181818181823, 0.57727272727272727, 0.58636363636363642, 0.59545454545454546, 0.60454545454545461, 0.61363636363636365, 0.62272727272727280, 0.63181818181818183, 0.64090909090909087, 0.65000000000000002, 0.65909090909090906, 0.66818181818181821, 0.67727272727272725, 0.68636363636363640, 0.69545454545454544, 0.70454545454545459, 0.71363636363636362, 0.72272727272727277, 0.73181818181818181, 0.74090909090909096, 0.75000000000000000, 0.75909090909090915, 0.76818181818181819, 0.77727272727272734, 0.78636363636363638, 0.79545454545454541, 0.80454545454545456, 0.81363636363636360, 0.82272727272727275, 0.83181818181818179, 0.84090909090909094, 0.84999999999999998, 0.85909090909090913, 0.86818181818181817, 0.87727272727272732, 0.88636363636363635, 0.89545454545454550, 0.90454545454545454, 0.91363636363636369, 0.92272727272727273, 0.93181818181818177, 0.94090909090909092, 0.94999999999999996};
    Tensor<float> k({1});
    k = 19.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{10.11701306385904431, 10.45172004879672301, 10.75457063998455176, 11.03288652682354964, 11.29168573125765462, 11.53457055377987928, 11.76422237726722564, 11.98269612140478557, 12.19160484982698556, 12.39224052842671320, 12.58565585432315004, 12.77272138291334258, 12.95416644124944661, 13.13060908515576841, 13.30257846326199100, 13.47053180079474011, 13.63486749559772981, 13.79593535534425897, 13.95404469940439007, 14.10947084308487476, 14.26246034068347690, 14.41323526507220443, 14.56199673142022810, 14.70892782215658734, 14.85419603338942451, 14.99795533573184692, 15.14034792209759850, 15.28150569962515526, 15.42155157113574937, 15.56060054248159119, 15.69876068511523393, 15.83613397771387099, 15.97281704635990707, 16.10890181934214738, 16.24447610989846069, 16.37962413801862027, 16.51442700065051383, 16.64896309821400777, 16.78330852415808039, 16.91753742334446997, 17.05172232426419043, 17.18593444945961934, 17.32024400800985475, 17.45472047351958977, 17.58943285071775264, 17.72444993350811160, 17.85984055711166718, 17.99567384679198057, 18.13201946555431476, 18.26894786315469688, 18.40653052874198536, 18.54484024948543208, 18.68395137761062941, 18.82394010838039833, 18.96488477171725862, 19.10686614037263098, 19.24996775781293223, 19.39427628931944980, 19.53988190019677873, 19.68687866546697052, 19.83536501600478275, 19.98544422676501142, 20.13722495358544506, 20.29082182604843965, 20.44635610508502310, 20.60395641545057543, 20.76375956494814545, 20.92591146439120209, 21.09056816487355590, 21.25789703206100967, 21.42807808108486256, 21.60130550038708819, 21.77778939878815123, 21.95775781743938637, 22.14145905760797461, 22.32916438698606854, 22.52117120217558721, 22.71780674419985502, 22.91943248873975492, 23.12644936522169203, 23.33930400161275998, 23.55849624863782310, 23.78458831361870551, 24.01821593822242917, 24.26010219784933497, 24.51107470079205797, 24.77208724947116281, 25.04424743564611333, 25.32885224253741541, 25.62743462639084058, 25.94182542640270128, 26.27423711018511199, 26.62737934108840676, 27.00462214070642375, 27.41023239728095717, 27.84972740153071413, 28.33042292024865816, 28.86232093656753506, 29.45962714294925888, 30.14352720564615851};
    // run Temper chisquare::ppf
    Tensor<float> result = stats::chisquare::ppf(q, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.ppf_random_test_dof_20
  * @brief Randomly generated chisquare ppf test on 100 matrix with dof = 20.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, ppf_random_test_dof_20)
{
    Tensor<float> q({100});
    q = std::vector<float>{0.05000000000000000, 0.05909090909090910, 0.06818181818181818, 0.07727272727272727, 0.08636363636363636, 0.09545454545454546, 0.10454545454545455, 0.11363636363636363, 0.12272727272727273, 0.13181818181818183, 0.14090909090909093, 0.14999999999999999, 0.15909090909090909, 0.16818181818181818, 0.17727272727272725, 0.18636363636363634, 0.19545454545454544, 0.20454545454545453, 0.21363636363636362, 0.22272727272727272, 0.23181818181818181, 0.24090909090909091, 0.25000000000000000, 0.25909090909090909, 0.26818181818181819, 0.27727272727272728, 0.28636363636363638, 0.29545454545454547, 0.30454545454545451, 0.31363636363636360, 0.32272727272727270, 0.33181818181818179, 0.34090909090909088, 0.34999999999999998, 0.35909090909090907, 0.36818181818181817, 0.37727272727272726, 0.38636363636363635, 0.39545454545454545, 0.40454545454545454, 0.41363636363636364, 0.42272727272727267, 0.43181818181818177, 0.44090909090909086, 0.44999999999999996, 0.45909090909090905, 0.46818181818181814, 0.47727272727272724, 0.48636363636363633, 0.49545454545454543, 0.50454545454545452, 0.51363636363636367, 0.52272727272727271, 0.53181818181818186, 0.54090909090909089, 0.55000000000000004, 0.55909090909090908, 0.56818181818181823, 0.57727272727272727, 0.58636363636363642, 0.59545454545454546, 0.60454545454545461, 0.61363636363636365, 0.62272727272727280, 0.63181818181818183, 0.64090909090909087, 0.65000000000000002, 0.65909090909090906, 0.66818181818181821, 0.67727272727272725, 0.68636363636363640, 0.69545454545454544, 0.70454545454545459, 0.71363636363636362, 0.72272727272727277, 0.73181818181818181, 0.74090909090909096, 0.75000000000000000, 0.75909090909090915, 0.76818181818181819, 0.77727272727272734, 0.78636363636363638, 0.79545454545454541, 0.80454545454545456, 0.81363636363636360, 0.82272727272727275, 0.83181818181818179, 0.84090909090909094, 0.84999999999999998, 0.85909090909090913, 0.86818181818181817, 0.87727272727272732, 0.88636363636363635, 0.89545454545454550, 0.90454545454545454, 0.91363636363636369, 0.92272727272727273, 0.93181818181818177, 0.94090909090909092, 0.94999999999999996};
    Tensor<float> k({1});
    k = 20.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{10.85081139418259077, 11.19858435382174200, 11.51304147789290688, 11.80185007520017493, 12.07026243525530340, 12.32204738646364461, 12.56000916763310826, 12.78629608211767987, 13.00259393876176439, 13.21025254817102912, 13.41037141480837747, 13.60385954490493710, 13.79147826913581554, 13.97387259043974161, 14.15159458113955360, 14.32512114760886490, 14.49486772571906279, 14.66119898460588367, 14.82443729623090967, 14.98486951270061240, 15.14275244534722908, 15.29831733619605494, 15.45177353904772843, 15.60331157452897521, 15.75310568486105467, 15.90131598555988290, 16.04809028994938913, 16.19356566625218008, 16.33786977472647806, 16.48112202285216910, 16.62343456922120311, 16.76491320103806260, 16.90565810560550730, 17.04576455257695500, 17.18532350088765170, 17.32442214197478947, 17.46314438903955946, 17.60157132060000507, 17.73978158536117178, 17.87785177443271678, 18.01585676611158604, 18.15387004778413882, 18.29196401896249213, 18.43021027903242981, 18.56867990293960347, 18.70744370776315435, 18.84657251291216085, 18.98613739652263988, 19.12620995052546746, 19.26686253679499572, 19.40816854677112602, 19.55020266697385978, 19.69304115289818569, 19.83676211389072463, 19.98144581176926593, 20.12717497615784623, 20.27403513977738569, 20.42211499726280266, 20.57150679148215389, 20.72230673182196270, 20.87461544949136538, 21.02853849560418453, 21.18418688864483101, 21.34167771894023247, 21.50113481898144485, 21.66268950990872000, 21.82648143625096893, 21.99265950316305762, 22.16138293302481443, 22.33282246146762162, 22.50716169682636902, 22.68459867186796686, 22.86534762267085341, 23.04964103704907430, 23.23773202436140295, 23.42989707049231285, 23.62643925700919567, 23.82769204303085786, 24.03402373361500466, 24.24584279145801702, 24.46360419215919890, 24.68781708113071360, 24.91905406802180423, 25.15796260037955889, 25.40527900414071993, 25.66184598233354208, 25.92863465232728970, 26.20677261843623640, 26.49758018777918167, 26.80261775189596563, 27.12374875588810852, 27.46322487085502928, 27.82380352193402473, 28.20891380634386891, 28.62289697644156306, 29.07136588556541668, 29.56176217128016148, 30.10425865857505912, 30.71330174390681833, 31.41043284423091819};
    // run Temper chisquare::ppf
    Tensor<float> result = stats::chisquare::ppf(q, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.ppf_broadcast_q_vector_k_scalar
  * @brief Verify broadcasting: ppf broadcast q vector k scalar
  */
TEST(CHISQUARE, ppf_broadcast_q_vector_k_scalar)
{
    Tensor<float> q({4});
    q = std::vector<float>{0.05000000000000000, 0.25000000000000000, 0.50000000000000000, 0.94999999999999996};
    Tensor<float> k({1});
    k = 3.00000000000000000;
    Tensor<float> expected_result({4});
    expected_result = std::vector<float>{0.35184631774927144, 1.21253290304566863, 2.36597388437533773, 7.81472790325117916};
    Tensor<float> result = stats::chisquare::ppf(q, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
}

/**
  * @test CHISQUARE.ppf_broadcast_q_scalar_k_vector
  * @brief Verify broadcasting: ppf broadcast q scalar k vector
  */
TEST(CHISQUARE, ppf_broadcast_q_scalar_k_vector)
{
    Tensor<float> q({1});
    q = 0.50000000000000000;
    Tensor<float> k({3});
    k = std::vector<float>{3.00000000000000000, 4.00000000000000000, 2.00000000000000000};
    Tensor<float> expected_result({3});
    expected_result = std::vector<float>{2.36597388437533773, 3.35669398003332242, 1.38629436111989102};
    Tensor<float> result = stats::chisquare::ppf(q, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
}

/**
  * @test CHISQUARE.ppf_broadcast_2d_q_k_vector
  * @brief Verify broadcasting: ppf broadcast 2d q k vector
  */
TEST(CHISQUARE, ppf_broadcast_2d_q_k_vector)
{
    Tensor<float> q({2,2});
    q = std::vector<float>{0.05000000000000000, 0.25000000000000000, 0.50000000000000000, 0.94999999999999996};
    Tensor<float> k({2});
    k = std::vector<float>{3.00000000000000000, 2.00000000000000000};
    Tensor<float> expected_result({4});
    expected_result = std::vector<float>{0.35184631774927144, 0.57536414490356180, 2.36597388437533773, 5.99146454710797904};
    Tensor<float> result = stats::chisquare::ppf(q, k);
    // check values
    EXPECT_NEAR(result[0][0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[0][1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[1][0], expected_result[2], 0.0001);
    EXPECT_NEAR(result[1][1], expected_result[3], 0.0001);
}

/**
  * @test CHISQUARE.ppf_broadcast_mixed_shapes_all_operands
  * @brief Verify broadcasting: ppf broadcast mixed shapes all operands
  */
TEST(CHISQUARE, ppf_broadcast_mixed_shapes_all_operands)
{
    Tensor<float> q({2,1});
    q = std::vector<float>{0.33000000000000002, 0.66000000000000003};
    Tensor<float> k({1,3});
    k = std::vector<float>{2.00000000000000000, 3.00000000000000000, 4.00000000000000000};
    Tensor<float> expected_result({6});
    expected_result = std::vector<float>{0.80095513319425060, 1.55340695619226454, 2.35926999330126064, 2.15761932274385959, 3.35544488829474030, 4.52154872659490703};
    Tensor<float> result = stats::chisquare::ppf(q, k);
    // check values
    EXPECT_NEAR(result[0][0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[0][1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[0][2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[1][0], expected_result[3], 0.0001);
    EXPECT_NEAR(result[1][1], expected_result[4], 0.0001);
    EXPECT_NEAR(result[1][2], expected_result[5], 0.0001);
}

/**
  * @test CHISQUARE.ppf_view_with_weird_strides
  * @brief Ensure chisquare::ppf accepts non-contiguous/alias views for x and k
  */
TEST(CHISQUARE, ppf_view_with_weird_strides)
{
    Tensor<float> q_owner({6}, MemoryLocation::DEVICE);
    std::vector<float> q_owner_vals = {
        0.05000000000000000, 99.00000000000000000, 0.50000000000000000, 99.00000000000000000, 0.94999999999999996, 99.00000000000000000
    };
    q_owner = q_owner_vals;

    Tensor<float> q_alias(
        q_owner,
        std::vector<uint64_t>{0ull},
        std::vector<uint64_t>{3ull},
        std::vector<uint64_t>{2ull}
    );

    Tensor<float> k_owner({6}, MemoryLocation::DEVICE);
    std::vector<float> k_owner_vals = {
        1.00000000000000000, 99.00000000000000000, 5.00000000000000000, 99.00000000000000000, 10.00000000000000000, 99.00000000000000000
    };
    k_owner = k_owner_vals;

    Tensor<float> k_alias(
        k_owner,
        std::vector<uint64_t>{0ull},
        std::vector<uint64_t>{3ull},
        std::vector<uint64_t>{2ull}
    );

    Tensor<float> result = stats::chisquare::ppf(q_alias, k_alias);

    Tensor<float> expected_result({3});
    expected_result = std::vector<float>{0.00393214000001952, 4.35146019109552640, 18.30703805327514644};

    // compare element-wise (unroll to report precise index on failure)
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
}
