/**
  * @file chisquare_cdf.cpp
  * @brief File generated by tests/stats/chisquare_cdf.py.
  */

/**
  * @test CHISQUARE.cdf_random_test_dof_1
  * @brief Randomly generated chisquare cdf test on 100 matrix with dof = 1.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, cdf_random_test_dof_1)
{
    Tensor<float> x({100});
    x = std::vector<float>{0.00000000000000000, 0.00015393023155371, 0.00061581572616902, 0.00138594107353674, 0.00246478122336133, 0.00385300243846904, 0.00555146363473633, 0.00756121811346388, 0.00988351569349687, 0.01251980525212174, 0.01547173768556352, 0.01874116930178157, 0.02233016566022906, 0.02624100587531811, 0.03047618740253525, 0.03503843132849890, 0.03993068818876300, 0.04515614433986745, 0.05071822891504592, 0.05662062139614699, 0.06286725983773764, 0.06946234978307120, 0.07641037391565467, 0.08371610249457924, 0.09138460462663275, 0.09942126043355393, 0.10783177417865296, 0.11662218842351108, 0.12579889929262719, 0.13536867293181279, 0.14533866325493394, 0.15571643108338054, 0.16650996479352770, 0.17772770259960560, 0.18937855661296488, 0.20147193883392078, 0.21401778924940545, 0.22702660622880247, 0.24050947943190459, 0.25447812546723997, 0.26894492656649932, 0.28392297257190363, 0.29942610656865548, 0.31546897453475736, 0.33206707942620561, 0.34923684016780626, 0.36699565607962076, 0.38536197733763128, 0.40435538214606886, 0.42399666138977737, 0.44430791164005062, 0.46531263750919732, 0.48703586449062702, 0.50950426358622458, 0.53274628921566591, 0.55679233212848511, 0.58167488930581834, 0.60742875315283307, 0.63409122265496676, 0.66170233961348657, 0.69030515360389422, 0.71994601993339369, 0.75067493563496979, 0.78254591945573237, 0.81561744291435667, 0.84995292086533736, 0.88562127167907490, 0.92269755920690522, 0.96126373125438869, 1.00140947247110446, 1.04323319356236399, 1.08684318377754208, 1.13235896005358860, 1.17991285442600291, 1.22965189195762958, 1.28174002529724440, 1.33636081020676056, 1.39372063059705686, 1.45405261408392095, 1.51762142313727000, 1.58472916741789294, 1.65572276712905331, 1.73100321614073738, 1.81103736421750949, 1.89637308656238202, 1.98765907897131688, 2.08567107885846603, 2.19134718591313371, 2.30583634989915387, 2.43056638368620170, 2.56734175295873568, 2.71848827288344808, 2.88707455538683666, 3.07726482868255458, 3.29490921673990123, 3.54859313156096334, 3.85165365806142379, 4.22647645276348438, 4.71509060897525778, 5.41189443105434176};
    Tensor<float> k({1});
    k = 1.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{0.00000000000000000, 0.00989898989898990, 0.01979797979797979, 0.02969696969696970, 0.03959595959595959, 0.04949494949494949, 0.05939393939393937, 0.06929292929292928, 0.07919191919191919, 0.08909090909090910, 0.09898989898989899, 0.10888888888888891, 0.11878787878787878, 0.12868686868686871, 0.13858585858585859, 0.14848484848484847, 0.15838383838383832, 0.16828282828282828, 0.17818181818181819, 0.18808080808080810, 0.19797979797979795, 0.20787878787878789, 0.21777777777777774, 0.22767676767676767, 0.23757575757575752, 0.24747474747474749, 0.25737373737373737, 0.26727272727272716, 0.27717171717171718, 0.28707070707070703, 0.29696969696969688, 0.30686868686868685, 0.31676767676767681, 0.32666666666666661, 0.33656565656565668, 0.34646464646464642, 0.35636363636363633, 0.36626262626262623, 0.37616161616161603, 0.38606060606060605, 0.39595959595959601, 0.40585858585858586, 0.41575757575757560, 0.42565656565656562, 0.43555555555555553, 0.44545454545454544, 0.45535353535353529, 0.46525252525252553, 0.47515151515151510, 0.48505050505050507, 0.49494949494949492, 0.50484848484848488, 0.51474747474747473, 0.52464646464646458, 0.53454545454545455, 0.54444444444444451, 0.55434343434343447, 0.56424242424242421, 0.57414141414141395, 0.58404040404040380, 0.59393939393939388, 0.60383838383838373, 0.61373737373737369, 0.62363636363636354, 0.63353535353535340, 0.64343434343434336, 0.65333333333333365, 0.66323232323232317, 0.67313131313131314, 0.68303030303030299, 0.69292929292929295, 0.70282828282828280, 0.71272727272727276, 0.72262626262626262, 0.73252525252525247, 0.74242424242424243, 0.75232323232323239, 0.76222222222222213, 0.77212121212121199, 0.78202020202020206, 0.79191919191919191, 0.80181818181818176, 0.81171717171717173, 0.82161616161616147, 0.83151515151515143, 0.84141414141414150, 0.85131313131313124, 0.86121212121212121, 0.87111111111111028, 0.88101010101010135, 0.89090909090909165, 0.90080808080808095, 0.91070707070707035, 0.92060606060606021, 0.93050505050505117, 0.94040404040404046, 0.95030303030303009, 0.96020202020202017, 0.97010101010100991, 0.97999999999999998};
    // run Temper chisquare::cdf
    Tensor<float> result = stats::chisquare::cdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.cdf_random_test_dof_2
  * @brief Randomly generated chisquare cdf test on 100 matrix with dof = 2.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, cdf_random_test_dof_2)
{
    Tensor<float> x({100});
    x = std::vector<float>{0.00000000000000000, 0.01989662130637697, 0.03999317099759047, 0.06029370779582321, 0.08080241528519350, 0.10152360708651195, 0.12246173230292445, 0.14362138125363802, 0.16500729151421276, 0.18662435428330360, 0.20847762109725246, 0.23057231091559249, 0.25291381760232323, 0.27550771782978578, 0.29835977943411096, 0.32147597025356023, 0.34486246748363730, 0.36852566758566269, 0.39247219678857065, 0.41670892222706962, 0.44124296376299960, 0.46608170654080860, 0.49123281433253668, 0.51670424373264634, 0.54250425926848100, 0.56864144949815210, 0.59512474417431660, 0.62196343255966724, 0.64916718298814291, 0.67674606377493185, 0.70471056558843181, 0.73307162540857251, 0.76184065220842068, 0.79102955450999246, 0.82065076998083442, 0.85071729725547007, 0.88124273018548394, 0.91224129474411542, 0.94372788883613812, 0.97571812529188562, 1.00822837835600776, 1.04127583401748192, 1.07487854456816145, 1.10905548782347285, 1.14382663149165764, 1.17921300323821021, 1.21523676706107664, 1.25192130667127000, 1.28929131666438201, 1.32737290237324124, 1.36619368941288744, 1.40578294406924731, 1.44617170584561383, 1.48739293367074676, 1.52948166749390824, 1.57247520725191392, 1.61641331149857659, 1.66133841834715867, 1.70729589180296570, 1.75433429706989319, 1.80250570901922891, 1.85186605873277865, 1.90247552390277885, 1.95439896992229456, 2.00770644977530788, 2.06247377239067786, 2.11878315102965686, 2.17672394562388316, 2.23639351588859814, 2.29789820565940728, 2.36135448344482812, 2.42689026992259693, 2.49464649039909903, 2.56477889958952909, 2.63746023813156372, 2.71288279594041892, 2.79126147813315839, 2.87283749660491772, 2.95788284700946313, 3.04670578060920194, 3.13965754867810887, 3.23714079199474547, 3.33962008175428959, 3.44763530991755163, 3.56181890640797727, 3.68291827556065465, 3.81182547366771862, 3.94961712668077336, 4.09760914443589108, 4.25743334382229843, 4.43114743200883154, 4.62139745553642900, 4.83166594697007579, 5.06666648738694825, 5.33300239637867524, 5.64033499844583019, 6.00362263926074213, 6.44787825364949274, 7.01986116359723678, 7.82404601085629192};
    Tensor<float> k({1});
    k = 2.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{0.00000000000000000, 0.00989898989898990, 0.01979797979797980, 0.02969696969696970, 0.03959595959595959, 0.04949494949494950, 0.05939393939393938, 0.06929292929292930, 0.07919191919191917, 0.08909090909090908, 0.09898989898989899, 0.10888888888888885, 0.11878787878787876, 0.12868686868686871, 0.13858585858585862, 0.14848484848484847, 0.15838383838383838, 0.16828282828282831, 0.17818181818181816, 0.18808080808080802, 0.19797979797979795, 0.20787878787878786, 0.21777777777777782, 0.22767676767676767, 0.23757575757575758, 0.24747474747474743, 0.25737373737373737, 0.26727272727272733, 0.27717171717171712, 0.28707070707070703, 0.29696969696969694, 0.30686868686868685, 0.31676767676767675, 0.32666666666666661, 0.33656565656565651, 0.34646464646464648, 0.35636363636363627, 0.36626262626262623, 0.37616161616161609, 0.38606060606060605, 0.39595959595959601, 0.40585858585858586, 0.41575757575757571, 0.42565656565656579, 0.43555555555555553, 0.44545454545454544, 0.45535353535353534, 0.46525252525252531, 0.47515151515151510, 0.48505050505050501, 0.49494949494949492, 0.50484848484848477, 0.51474747474747462, 0.52464646464646458, 0.53454545454545455, 0.54444444444444440, 0.55434343434343436, 0.56424242424242421, 0.57414141414141406, 0.58404040404040414, 0.59393939393939388, 0.60383838383838373, 0.61373737373737369, 0.62363636363636354, 0.63353535353535351, 0.64343434343434347, 0.65333333333333332, 0.66323232323232317, 0.67313131313131314, 0.68303030303030299, 0.69292929292929295, 0.70282828282828280, 0.71272727272727265, 0.72262626262626251, 0.73252525252525236, 0.74242424242424243, 0.75232323232323228, 0.76222222222222213, 0.77212121212121210, 0.78202020202020195, 0.79191919191919191, 0.80181818181818176, 0.81171717171717173, 0.82161616161616158, 0.83151515151515143, 0.84141414141414139, 0.85131313131313124, 0.86121212121212121, 0.87111111111111106, 0.88101010101010102, 0.89090909090909087, 0.90080808080808072, 0.91070707070707069, 0.92060606060606054, 0.93050505050505050, 0.94040404040404035, 0.95030303030303021, 0.96020202020202017, 0.97010101010101002, 0.97999999999999998};
    // run Temper chisquare::cdf
    Tensor<float> result = stats::chisquare::cdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.cdf_random_test_dof_3
  * @brief Randomly generated chisquare cdf test on 100 matrix with dof = 3.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, cdf_random_test_dof_3)
{
    Tensor<float> x({100});
    x = std::vector<float>{0.00000000000000000, 0.11403925691577653, 0.18353806049803470, 0.24336206620389833, 0.29800077849478812, 0.34929853684312723, 0.39823887855056633, 0.44542401525448178, 0.49125648967497998, 0.53602242244174403, 0.57993471809431640, 0.62315757238028391, 0.66582133617909323, 0.70803201660415716, 0.74987761312058854, 0.79143249361853196, 0.83276050728666495, 0.87391725560503608, 0.91495178595615667, 0.95590787935216559, 0.99682504663776417, 1.03773931132785791, 1.07868383367548115, 1.11968941485705664, 1.16078490946453305, 1.20199756706853833, 1.24335331837338847, 1.28487701772443685, 1.32659265099349155, 1.36852351585386933, 1.41069237995631980, 1.45312162138814660, 1.49583335494096548, 1.53884954705723898, 1.58219212182173252, 1.62588305997487348, 1.66994449262396172, 1.71439879109591331, 1.75926865419692868, 1.80457719400963024, 1.85034802125858855, 1.89660533120500707, 1.94337399098607921, 1.99067962929128162, 2.03854872926435027, 2.08700872553469097, 2.13608810631486756, 2.18581652155168893, 2.23622489818782055, 2.28734556368017827, 2.33921237903222634, 2.39186088273250608, 2.44532844715426778, 2.49965444916539292, 2.55488045692875554, 2.61105043514761981, 2.66821097133623297, 2.72641152608252657, 2.78570471072995529, 2.84614659645412083, 2.90779705936577004, 2.97072016705868691, 3.03498461296832867, 3.10066420605208082, 3.16783842469203680, 3.23659304541624371, 3.30702085911104282, 3.37922248995638563, 3.45330733548427382, 3.52939465010938580, 3.60761479942997676, 3.68811071884347053, 3.77103961795782094, 3.85657498244128849, 3.94490893806486076, 4.03625505875651136, 4.13085172289387437, 4.22896615177645341, 4.33089930403063583, 4.43699185364831639, 4.54763155335014613, 4.66326238779125823, 4.78439606608382739, 4.91162661068035344, 5.04564910202314554, 5.18728408720172851, 5.33750984120135019, 5.49750572487208355, 5.66871156472171744, 5.85291073668278283, 6.05234931231107964, 6.26991186959771607, 6.50938977049577350, 6.77590725681635409, 7.07663192705973376, 7.42203320019101476, 7.82829070052924525, 8.32240334534804838, 8.95472119085918550, 9.83740931119259265};
    Tensor<float> k({1});
    k = 3.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{0.00000000000000000, 0.00989898989898989, 0.01979797979797980, 0.02969696969696969, 0.03959595959595960, 0.04949494949494949, 0.05939393939393936, 0.06929292929292925, 0.07919191919191922, 0.08909090909090907, 0.09898989898989900, 0.10888888888888888, 0.11878787878787873, 0.12868686868686871, 0.13858585858585859, 0.14848484848484847, 0.15838383838383838, 0.16828282828282828, 0.17818181818181819, 0.18808080808080804, 0.19797979797979801, 0.20787878787878780, 0.21777777777777785, 0.22767676767676767, 0.23757575757575758, 0.24747474747474743, 0.25737373737373737, 0.26727272727272738, 0.27717171717171718, 0.28707070707070709, 0.29696969696969694, 0.30686868686868685, 0.31676767676767675, 0.32666666666666666, 0.33656565656565651, 0.34646464646464636, 0.35636363636363638, 0.36626262626262629, 0.37616161616161614, 0.38606060606060594, 0.39595959595959590, 0.40585858585858592, 0.41575757575757583, 0.42565656565656562, 0.43555555555555553, 0.44545454545454549, 0.45535353535353534, 0.46525252525252542, 0.47515151515151527, 0.48505050505050501, 0.49494949494949475, 0.50484848484848499, 0.51474747474747462, 0.52464646464646458, 0.53454545454545455, 0.54444444444444429, 0.55434343434343425, 0.56424242424242421, 0.57414141414141395, 0.58404040404040403, 0.59393939393939388, 0.60383838383838395, 0.61373737373737447, 0.62363636363636521, 0.63353535353535140, 0.64343434343434502, 0.65333333333333155, 0.66323232323232351, 0.67313131313131214, 0.68303030303030299, 0.69292929292929295, 0.70282828282828302, 0.71272727272727299, 0.72262626262626295, 0.73252525252525236, 0.74242424242424288, 0.75232323232323162, 0.76222222222222280, 0.77212121212121188, 0.78202020202020206, 0.79191919191919191, 0.80181818181818154, 0.81171717171717173, 0.82161616161616191, 0.83151515151515165, 0.84141414141414173, 0.85131313131313191, 0.86121212121212132, 0.87111111111111106, 0.88101010101010091, 0.89090909090909109, 0.90080808080808050, 0.91070707070707058, 0.92060606060606054, 0.93050505050505050, 0.94040404040404035, 0.95030303030303021, 0.96020202020202017, 0.97010101010101002, 0.97999999999999998};
    // run Temper chisquare::cdf
    Tensor<float> result = stats::chisquare::cdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.cdf_random_test_dof_4
  * @brief Randomly generated chisquare cdf test on 100 matrix with dof = 4.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, cdf_random_test_dof_4)
{
    Tensor<float> x({100});
    x = std::vector<float>{0.00000000000000000, 0.29552819425471188, 0.42706060533358059, 0.53208735423589026, 0.62361217987635942, 0.70666019481673870, 0.78380416541123843, 0.85657076344192551, 0.92595429419322850, 0.99264565317440945, 1.05714849279263490, 1.11984386331619179, 1.18102877157839536, 1.24094046769100341, 1.29977242820050831, 1.35768526207559126, 1.41481438197045972, 1.47127554200458177, 1.52716892616769262, 1.58258222662835268, 1.63759300223305271, 1.69227051391760974, 1.74667717334887351, 1.80086970115401601, 1.85490006407545427, 1.90881624175957687, 1.96266286081356411, 2.01648172444205054, 2.07031225923066042, 2.12419189569894451, 2.17815639557675222, 2.23224013600634885, 2.28647635878823463, 2.34089739119571760, 2.39553484365657887, 2.45041978864929844, 2.50558292442028785, 2.56105472654920741, 2.61686558993556728, 2.67304596342490575, 2.72962647901656918, 2.78663807738249769, 2.84411213126607221, 2.90208056821337612, 2.96057599401000893, 3.01963181815020087, 3.07928238264840326, 3.13956309551472579, 3.20051057025383034, 3.26216277281207034, 3.32455917749091512, 3.38774093346776262, 3.45175104372108654, 3.51663455834931549, 3.58243878450702846, 3.64921351546461681, 3.71701128163658412, 3.78588762682956004, 3.85590141344675574, 3.92711516096687285, 3.99959542271275259, 4.07341320676275043, 4.14864444786831132, 4.22537053846317523, 4.30367892833440724, 4.38366380433636849, 4.46542686374857745, 4.54907819761287779, 4.63473730377243687, 4.72253425355435219, 4.81261104132650086, 4.90512315283184019, 5.00024139668088274, 5.09815405423346402, 5.19906941709903769, 5.30321879969628185, 5.41086013822132639, 5.52228231906678868, 5.63781042218493678, 5.75781212239109674, 5.88270557044405606, 6.01296918526681168, 6.14915394301702367, 6.29189896964505824, 6.44195156527096469, 6.60019326604699330, 6.76767427240024588, 6.94565969412795070, 7.13569284810630755, 7.33968377106141201, 7.56003607129796951, 7.79983398483712964, 8.06312760976261522, 8.35538558844168833, 8.68424929154092062, 9.06086749386200907, 9.50244805169039353, 10.03766483320888270, 10.71990260448197496, 11.66784340383477847};
    Tensor<float> k({1});
    k = 4.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{0.00000000000000000, 0.00989898989898990, 0.01979797979797980, 0.02969696969696970, 0.03959595959595962, 0.04949494949494949, 0.05939393939393939, 0.06929292929292930, 0.07919191919191915, 0.08909090909090910, 0.09898989898989898, 0.10888888888888890, 0.11878787878787878, 0.12868686868686874, 0.13858585858585853, 0.14848484848484847, 0.15838383838383838, 0.16828282828282831, 0.17818181818181811, 0.18808080808080807, 0.19797979797979798, 0.20787878787878786, 0.21777777777777779, 0.22767676767676776, 0.23757575757575755, 0.24747474747474749, 0.25737373737373737, 0.26727272727272727, 0.27717171717171718, 0.28707070707070714, 0.29696969696969694, 0.30686868686868685, 0.31676767676767686, 0.32666666666666666, 0.33656565656565657, 0.34646464646464642, 0.35636363636363627, 0.36626262626262623, 0.37616161616161625, 0.38606060606060605, 0.39595959595959590, 0.40585858585858592, 0.41575757575757560, 0.42565656565656540, 0.43555555555555536, 0.44545454545454544, 0.45535353535353534, 0.46525252525252514, 0.47515151515151505, 0.48505050505050490, 0.49494949494949492, 0.50484848484848488, 0.51474747474747484, 0.52464646464646458, 0.53454545454545443, 0.54444444444444440, 0.55434343434343436, 0.56424242424242410, 0.57414141414141406, 0.58404040404040414, 0.59393939393939377, 0.60383838383838384, 0.61373737373737347, 0.62363636363636354, 0.63353535353535362, 0.64343434343434325, 0.65333333333333332, 0.66323232323232317, 0.67313131313131314, 0.68303030303030310, 0.69292929292929295, 0.70282828282828280, 0.71272727272727265, 0.72262626262626262, 0.73252525252525258, 0.74242424242424243, 0.75232323232323228, 0.76222222222222213, 0.77212121212121199, 0.78202020202020217, 0.79191919191919202, 0.80181818181818176, 0.81171717171717161, 0.82161616161616158, 0.83151515151515132, 0.84141414141414139, 0.85131313131313124, 0.86121212121212110, 0.87111111111111106, 0.88101010101010102, 0.89090909090909087, 0.90080808080808072, 0.91070707070707069, 0.92060606060606054, 0.93050505050505050, 0.94040404040404035, 0.95030303030303021, 0.96020202020202017, 0.97010101010101002, 0.97999999999999998};
    // run Temper chisquare::cdf
    Tensor<float> result = stats::chisquare::cdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.cdf_random_test_dof_5
  * @brief Randomly generated chisquare cdf test on 100 matrix with dof = 5.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, cdf_random_test_dof_5)
{
    Tensor<float> x({100});
    x = std::vector<float>{0.00000000000000000, 0.55186310854507192, 0.74848679423507847, 0.89887501629367117, 1.02645324874084065, 1.13997101795761857, 1.24380921563290814, 1.34052399548961865, 1.43175747867063596, 1.51863742790772727, 1.60197751240471042, 1.68238757735865696, 1.76033882376497219, 1.83620453430701080, 1.91028668308415606, 1.98283397444214082, 2.05405445564997269, 2.12412457126294907, 2.19319581284345189, 2.26139970091205100, 2.32885158368283696, 2.39565357944947666, 2.46189688814733332, 2.52766363085568191, 2.59302833104157804, 2.65805912045963977, 2.72281873102132232, 2.78736531859437520, 2.85175315361914583, 2.91603320533268429, 2.98025364040022289, 3.04446025226961758, 3.10869683417410148, 3.17300550612158494, 3.23742700421812035, 3.30200093913015680, 3.36676602928680913, 3.43176031348009269, 3.49702134677901899, 3.56258638308887132, 3.62849254722676173, 3.69477699902381662, 3.76147709168442335, 3.82863052641928547, 3.89627550521125210, 3.96445088346272634, 4.03319632420525487, 4.10255245552174586, 4.17256103283694113, 4.24326510777131727, 4.31470920532741964, 4.38693951128692117, 4.46000407184391179, 4.53395300768851950, 4.60883874499000790, 4.68471626601654823, 4.76164338247841634, 4.83968103510270886, 4.91889362345489278, 4.99934937063158547, 5.08112072818156157, 5.16428482749398743, 5.24892398495791923, 5.33512626948636104, 5.42298614256568445, 5.51260518290373458, 5.60409291009468014, 5.69756772460784067, 5.79315798498594248, 5.89100324759566885, 5.99125569986052842, 6.09408182495355533, 6.19966434488016560, 6.30820450033859537, 6.41992474052221329, 6.53507191525048636, 6.65392108704355678, 6.77678011419177206, 6.90399520064632899, 7.03595766919245769, 7.17311229748121626, 7.31596767192896991, 7.46510917711754285, 7.62121547103944863, 7.78507963528039948, 7.95763669171750898, 8.13999993839821734, 8.33350973715470822, 8.53980026294839867, 8.76089280154396555, 8.99932939565081114, 9.25836982154679511, 9.54229179040919639, 9.85686711053001829, 10.21015449623208760, 10.61390164128321878, 11.08622371693549091, 11.65727415059275884, 12.38312186494354705, 13.38822259903633949};
    Tensor<float> k({1});
    k = 5.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{0.00000000000000000, 0.00989898989898990, 0.01979797979797979, 0.02969696969696969, 0.03959595959595960, 0.04949494949494952, 0.05939393939393937, 0.06929292929292927, 0.07919191919191919, 0.08909090909090907, 0.09898989898989899, 0.10888888888888890, 0.11878787878787880, 0.12868686868686868, 0.13858585858585859, 0.14848484848484847, 0.15838383838383843, 0.16828282828282828, 0.17818181818181819, 0.18808080808080807, 0.19797979797979798, 0.20787878787878783, 0.21777777777777776, 0.22767676767676764, 0.23757575757575755, 0.24747474747474749, 0.25737373737373737, 0.26727272727272727, 0.27717171717171718, 0.28707070707070703, 0.29696969696969694, 0.30686868686868685, 0.31676767676767670, 0.32666666666666655, 0.33656565656565657, 0.34646464646464648, 0.35636363636363633, 0.36626262626262623, 0.37616161616161625, 0.38606060606060610, 0.39595959595959596, 0.40585858585858581, 0.41575757575757555, 0.42565656565656551, 0.43555555555555553, 0.44545454545454544, 0.45535353535353540, 0.46525252525252520, 0.47515151515151494, 0.48505050505050501, 0.49494949494949508, 0.50484848484848477, 0.51474747474747473, 0.52464646464646436, 0.53454545454545455, 0.54444444444444440, 0.55434343434343458, 0.56424242424242421, 0.57414141414141395, 0.58404040404040392, 0.59393939393939243, 0.60383838383838440, 0.61373737373737414, 0.62363636363636343, 0.63353535353535340, 0.64343434343434291, 0.65333333333333377, 0.66323232323232317, 0.67313131313131380, 0.68303030303030354, 0.69292929292929273, 0.70282828282828280, 0.71272727272727199, 0.72262626262626306, 0.73252525252525247, 0.74242424242424199, 0.75232323232323228, 0.76222222222222213, 0.77212121212121132, 0.78202020202020162, 0.79191919191919169, 0.80181818181818187, 0.81171717171717184, 0.82161616161616147, 0.83151515151515143, 0.84141414141414173, 0.85131313131313147, 0.86121212121212132, 0.87111111111111095, 0.88101010101010102, 0.89090909090909109, 0.90080808080808072, 0.91070707070707069, 0.92060606060606054, 0.93050505050505050, 0.94040404040404035, 0.95030303030303021, 0.96020202020202017, 0.97010101010101002, 0.97999999999999998};
    // run Temper chisquare::cdf
    Tensor<float> result = stats::chisquare::cdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.cdf_random_test_dof_6
  * @brief Randomly generated chisquare cdf test on 100 matrix with dof = 6.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, cdf_random_test_dof_6)
{
    Tensor<float> x({100});
    x = std::vector<float>{0.00000000000000000, 0.86879408951155790, 1.12997780764232170, 1.32426199303138481, 1.48622938728260778, 1.62852147378981016, 1.75737965667918350, 1.87640737382559109, 1.98789982852127789, 2.09342192099229552, 2.19409556248720783, 2.29075683031048305, 2.38404833060000865, 2.47447661812414132, 2.56244954451690354, 2.64830147340976874, 2.73231084479619479, 2.81471274042802699, 2.89570808221325748, 2.97547050251676870, 3.05415156741807792, 3.13188481102278837, 3.20878889604259410, 3.28497012198078897, 3.36052443919229571, 3.43553908386348716, 3.51009391879522603, 3.58426254347899631, 3.65811322155460328, 3.73170966249886238, 3.80511168609089756, 3.87837579199430271, 3.95155565211091053, 4.02470253978934345, 4.09786570722559862, 4.17109272026556432, 4.24442975816011892, 4.31792188452201664, 4.39161329470846695, 4.46554754404313847, 4.53976776065068144, 4.61431684617104398, 4.68923766722365354, 4.76457324018315642, 4.84036691159351662, 4.91666253637479844, 4.99350465585822256, 5.07093867761420203, 5.14901105901080491, 5.22776949645424605, 5.30726312231742625, 5.38754271165788357, 5.46866090096460233, 5.55067242135708927, 5.63363434889524495, 5.71760637495042090, 5.80265109994677353, 5.88883435421654777, 5.97622555023926072, 6.06489807116830093, 6.15492970131288608, 6.24640310516485364, 6.33940636267366209, 6.43403356982321295, 6.53038551520562915, 6.62857044529152795, 6.72870493355388000, 6.83091487163100108, 6.93533660446523292, 7.04211823602651688, 7.15142113808637792, 7.26342170189444580, 7.37831338199218667, 7.49630909340342466, 7.61764403892339370, 7.74257906336334223, 7.87140465803107858, 8.00444577374042154, 8.14206764752002776, 8.28468291166258908, 8.43276034073816305, 8.58683571297517112, 8.74752543253262793, 8.91554380256833845, 9.09172519320521211, 9.27705287376955567, 9.47269707407087402, 9.68006607223714788, 9.90087606760837247, 10.13724880975434139, 10.39185139690329507, 10.66810223849811301, 10.97048481847819801, 11.30504514171963315, 11.68021957105611719, 12.10829805184961039, 12.60821774031041720, 13.21147346145442292, 13.97656981548098898, 15.03320775121896169};
    Tensor<float> k({1});
    k = 6.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{0.00000000000000000, 0.00989898989898990, 0.01979797979797978, 0.02969696969696969, 0.03959595959595960, 0.04949494949494950, 0.05939393939393939, 0.06929292929292928, 0.07919191919191922, 0.08909090909090910, 0.09898989898989902, 0.10888888888888885, 0.11878787878787882, 0.12868686868686868, 0.13858585858585865, 0.14848484848484844, 0.15838383838383846, 0.16828282828282826, 0.17818181818181819, 0.18808080808080807, 0.19797979797979801, 0.20787878787878786, 0.21777777777777782, 0.22767676767676767, 0.23757575757575755, 0.24747474747474749, 0.25737373737373742, 0.26727272727272727, 0.27717171717171718, 0.28707070707070703, 0.29696969696969694, 0.30686868686868690, 0.31676767676767675, 0.32666666666666666, 0.33656565656565651, 0.34646464646464653, 0.35636363636363644, 0.36626262626262623, 0.37616161616161620, 0.38606060606060599, 0.39595959595959590, 0.40585858585858575, 0.41575757575757583, 0.42565656565656562, 0.43555555555555547, 0.44545454545454538, 0.45535353535353534, 0.46525252525252525, 0.47515151515151510, 0.48505050505050495, 0.49494949494949497, 0.50484848484848466, 0.51474747474747484, 0.52464646464646447, 0.53454545454545499, 0.54444444444444418, 0.55434343434343436, 0.56424242424242421, 0.57414141414141395, 0.58404040404040403, 0.59393939393939377, 0.60383838383838384, 0.61373737373737369, 0.62363636363636366, 0.63353535353535340, 0.64343434343434347, 0.65333333333333354, 0.66323232323232295, 0.67313131313131325, 0.68303030303030288, 0.69292929292929295, 0.70282828282828280, 0.71272727272727265, 0.72262626262626262, 0.73252525252525247, 0.74242424242424232, 0.75232323232323228, 0.76222222222222213, 0.77212121212121210, 0.78202020202020195, 0.79191919191919191, 0.80181818181818187, 0.81171717171717173, 0.82161616161616158, 0.83151515151515154, 0.84141414141414139, 0.85131313131313124, 0.86121212121212121, 0.87111111111111106, 0.88101010101010091, 0.89090909090909087, 0.90080808080808072, 0.91070707070707069, 0.92060606060606054, 0.93050505050505050, 0.94040404040404035, 0.95030303030303021, 0.96020202020202017, 0.97010101010101002, 0.97999999999999998};
    // run Temper chisquare::cdf
    Tensor<float> result = stats::chisquare::cdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.cdf_random_test_dof_7
  * @brief Randomly generated chisquare cdf test on 100 matrix with dof = 7.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, cdf_random_test_dof_7)
{
    Tensor<float> x({100});
    x = std::vector<float>{0.00000000000000000, 1.23489990815570305, 1.55885096190195527, 1.79516913147750778, 1.98977659531372808, 2.15921253626545084, 2.31156430791247613, 2.45146731507275195, 2.58185680279673058, 2.70472416341425648, 2.82149090064840191, 2.93321225040940270, 3.04069638168946366, 3.14457824412869691, 3.24536745261268278, 3.34348052508970994, 3.43926328106328416, 3.53300682718785897, 3.62495923342199111, 3.71533423571976096, 3.80431783920570687, 3.89207340850992800, 3.97874564820336429, 4.06446375577302010, 4.14934394876233714, 4.23349151240475141, 4.31700247555013839, 4.39996499539496266, 4.48246051190784200, 4.56456471854327983, 4.64634838528399996, 4.72787806217509399, 4.80921668557108983, 4.89042410479112810, 4.97155754340036182, 5.05267200664282434, 5.13382064445132968, 5.21505507781253108, 5.29642569496653604, 5.37798192289296484, 5.45977247872061966, 5.54184560505247159, 5.62424929268758778, 5.70703149382197328, 5.79024032850135573, 5.87392428686647428, 5.95813242956385025, 6.04291458858520159, 6.12832157073985595, 6.21440536595422621, 6.30121936262787852, 6.38881857235746775, 6.47725986646873420, 6.56660222697595852, 6.65690701482261460, 6.74823825855257997, 6.84066296692713127, 6.93425146945014959, 7.02907778930689453, 7.12522005387802793, 7.22276094878383468, 7.32178822237105020, 7.42239524871399947, 7.52468165860726401, 7.62875404973695392, 7.73472678930635826, 7.84272292495292422, 7.95287522294996840, 8.06532735659648914, 8.18023527256888805, 8.29776876911239647, 8.41811332764829956, 8.54147224915125136, 8.66806915915963572, 8.79815096141306618, 8.93199134108690984, 9.06989494611618596, 9.21220241156567887, 9.35929644081565115, 9.51160922341395221, 9.66963155998966073, 9.83392419032794685, 10.00513199772967532, 10.18400201599058263, 10.37140653376609123, 10.56837313735722894, 10.77612435996939411, 10.99613088696297680, 11.23018430463403128, 11.48049871800276200, 11.74985621623354781, 12.04182111435220293, 12.36106621513185111, 12.71388987666204784, 13.10907615085874234, 13.55941441937972591, 14.08459927172182269, 14.71736225929973507, 15.51845507766587318, 16.62242187111087333};
    Tensor<float> k({1});
    k = 7.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{0.00000000000000000, 0.00989898989898990, 0.01979797979797979, 0.02969696969696969, 0.03959595959595959, 0.04949494949494949, 0.05939393939393938, 0.06929292929292931, 0.07919191919191915, 0.08909090909090908, 0.09898989898989899, 0.10888888888888885, 0.11878787878787878, 0.12868686868686868, 0.13858585858585867, 0.14848484848484847, 0.15838383838383838, 0.16828282828282837, 0.17818181818181816, 0.18808080808080821, 0.19797979797979798, 0.20787878787878786, 0.21777777777777768, 0.22767676767676776, 0.23757575757575758, 0.24747474747474749, 0.25737373737373731, 0.26727272727272722, 0.27717171717171718, 0.28707070707070709, 0.29696969696969694, 0.30686868686868690, 0.31676767676767698, 0.32666666666666666, 0.33656565656565657, 0.34646464646464653, 0.35636363636363627, 0.36626262626262640, 0.37616161616161597, 0.38606060606060622, 0.39595959595959590, 0.40585858585858575, 0.41575757575757571, 0.42565656565656551, 0.43555555555555553, 0.44545454545454560, 0.45535353535353512, 0.46525252525252508, 0.47515151515151482, 0.48505050505050479, 0.49494949494949519, 0.50484848484848488, 0.51474747474747462, 0.52464646464646447, 0.53454545454545455, 0.54444444444444418, 0.55434343434343447, 0.56424242424242410, 0.57414141414141451, 0.58404040404040414, 0.59393939393939266, 0.60383838383838406, 0.61373737373737369, 0.62363636363636354, 0.63353535353535340, 0.64343434343434347, 0.65333333333333332, 0.66323232323232317, 0.67313131313131325, 0.68303030303030232, 0.69292929292929351, 0.70282828282828236, 0.71272727272727243, 0.72262626262626262, 0.73252525252525236, 0.74242424242424276, 0.75232323232323262, 0.76222222222222247, 0.77212121212121210, 0.78202020202020195, 0.79191919191919191, 0.80181818181818165, 0.81171717171717173, 0.82161616161616136, 0.83151515151515143, 0.84141414141414161, 0.85131313131313124, 0.86121212121212132, 0.87111111111111095, 0.88101010101010102, 0.89090909090909098, 0.90080808080808072, 0.91070707070707069, 0.92060606060606054, 0.93050505050505050, 0.94040404040404035, 0.95030303030303021, 0.96020202020202017, 0.97010101010101002, 0.97999999999999998};
    // run Temper chisquare::cdf
    Tensor<float> result = stats::chisquare::cdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.cdf_random_test_dof_8
  * @brief Randomly generated chisquare cdf test on 100 matrix with dof = 8.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, cdf_random_test_dof_8)
{
    Tensor<float> x({100});
    x = std::vector<float>{0.00000000000000000, 1.64153245796714509, 2.02607523516304644, 2.30256180082275241, 2.52817712995495603, 2.72329436782594492, 2.89780552736534691, 3.05735035483619466, 3.20548478675363313, 3.34461259966456215, 3.47644425776080501, 3.60224592117250664, 3.72298479745748123, 3.83941896152189077, 3.95215546484353997, 4.06168937645872230, 4.16843085716397077, 4.27272444850687005, 4.37486313893342871, 4.47509883181917445, 4.57365027656372103, 4.67070917408224417, 4.76644494458577306, 4.86100849919812994, 4.95453525893354829, 5.04714759756569720, 5.13895683829303529, 5.23006490111607913, 5.32056567414794923, 5.41054616482669637, 5.50008747427659550, 5.58926562857688847, 5.67815229354364792, 5.76681539418625455, 5.85531965581905478, 5.94372708057263566, 6.03209737052585471, 6.12048830670034150, 6.20895609159788187, 6.29755566172499748, 6.38634097556751623, 6.47536528169842107, 6.56468137108415650, 6.65434181716734940, 6.74439920692412809, 6.83490636580406452, 6.92591657924673321, 7.01748381332130933, 7.10966293694691931, 7.20250994811739442, 7.29608220657152096, 7.39043867541820987, 7.48564017434613049, 7.58174964722176004, 7.67883244711302559, 7.77695664207451731, 7.87619334540284655, 7.97661707452914559, 8.07830614327415297, 8.18134309286878114, 8.28581516796260154, 8.39181484483429685, 8.49944042021872193, 8.60879667062256715, 8.71999559377414002, 8.83315724601951047, 8.94841069213510387, 9.06589508730244376, 9.18576091504854375, 9.30817141001009496, 9.43330420071414011, 9.56135321555682616, 9.69253090530768624, 9.82707084844583179, 9.96523082236929092, 10.10729644527763682, 10.25358552207512375, 10.40445326545777149, 10.56029861396473102, 10.72157193728765634, 10.88878451299660810, 11.06252028913512220, 11.24345063059736560, 11.43235300957592848, 11.63013498207195440, 11.83786535830982167, 12.05681533140561612, 12.28851365555299324, 12.53482207487169653, 12.79804065898415466, 13.08105855136649787, 13.38757593060595852, 13.72244192846747879, 14.09219000022721779, 14.50592820179241826, 14.97691147431692293, 15.52554071642336453, 16.18570121444046350, 17.02024203249162326, 18.16823076482635813};
    Tensor<float> k({1});
    k = 8.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{0.00000000000000000, 0.00989898989898990, 0.01979797979797980, 0.02969696969696970, 0.03959595959595959, 0.04949494949494950, 0.05939393939393939, 0.06929292929292930, 0.07919191919191920, 0.08909090909090908, 0.09898989898989900, 0.10888888888888885, 0.11878787878787878, 0.12868686868686868, 0.13858585858585856, 0.14848484848484847, 0.15838383838383838, 0.16828282828282831, 0.17818181818181814, 0.18808080808080813, 0.19797979797979798, 0.20787878787878789, 0.21777777777777776, 0.22767676767676773, 0.23757575757575758, 0.24747474747474746, 0.25737373737373731, 0.26727272727272727, 0.27717171717171718, 0.28707070707070703, 0.29696969696969688, 0.30686868686868690, 0.31676767676767675, 0.32666666666666683, 0.33656565656565646, 0.34646464646464648, 0.35636363636363649, 0.36626262626262635, 0.37616161616161603, 0.38606060606060610, 0.39595959595959590, 0.40585858585858586, 0.41575757575757571, 0.42565656565656573, 0.43555555555555553, 0.44545454545454538, 0.45535353535353557, 0.46525252525252520, 0.47515151515151510, 0.48505050505050495, 0.49494949494949514, 0.50484848484848499, 0.51474747474747473, 0.52464646464646458, 0.53454545454545455, 0.54444444444444440, 0.55434343434343425, 0.56424242424242421, 0.57414141414141429, 0.58404040404040414, 0.59393939393939377, 0.60383838383838406, 0.61373737373737369, 0.62363636363636354, 0.63353535353535351, 0.64343434343434347, 0.65333333333333332, 0.66323232323232317, 0.67313131313131347, 0.68303030303030310, 0.69292929292929295, 0.70282828282828258, 0.71272727272727265, 0.72262626262626262, 0.73252525252525247, 0.74242424242424243, 0.75232323232323239, 0.76222222222222213, 0.77212121212121221, 0.78202020202020195, 0.79191919191919191, 0.80181818181818165, 0.81171717171717173, 0.82161616161616147, 0.83151515151515132, 0.84141414141414150, 0.85131313131313124, 0.86121212121212121, 0.87111111111111106, 0.88101010101010102, 0.89090909090909087, 0.90080808080808072, 0.91070707070707069, 0.92060606060606054, 0.93050505050505050, 0.94040404040404046, 0.95030303030303021, 0.96020202020202017, 0.97010101010101002, 0.97999999999999998};
    // run Temper chisquare::cdf
    Tensor<float> result = stats::chisquare::cdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.cdf_random_test_dof_9
  * @brief Randomly generated chisquare cdf test on 100 matrix with dof = 9.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, cdf_random_test_dof_9)
{
    Tensor<float> x({100});
    x = std::vector<float>{0.00000000000000000, 2.08213951965213395, 2.52505671751447514, 2.83996591565451828, 3.09511792528457041, 3.31462730105759285, 3.51013961461541912, 3.68826744247801441, 3.85316644307197365, 4.00763802784925183, 4.15367080133963640, 4.29273364319543482, 4.42594640957515573, 4.55418521302068857, 4.67815041505185469, 4.79841223535767902, 4.91544233529999364, 5.02963628955922637, 5.14132995281073057, 5.25081162557171588, 5.35833126141478555, 5.46410754729577786, 5.56833342688339439, 5.67118046544713650, 5.77280234021008987, 5.87333766178763472, 5.97291227789507939, 6.07164117202112763, 6.16963004214313226, 6.26697662446218295, 6.36377181232709255, 6.46010060947686515, 6.55604294841474911, 6.65167439839946439, 6.74706678268271620, 6.84228872086372508, 6.93740610930188861, 7.03248255023045044, 7.12757973840105397, 7.22275781265274386, 7.31807567865776853, 7.41359130818834711, 7.50936201952708604, 7.60544474307254781, 7.70189627574384250, 7.79877352744275143, 7.89613376257327992, 7.99403483943484705, 8.09253545018788856, 8.19169536403380327, 8.29157567625122383, 8.39223906578610190, 8.49375006420459222, 8.59617533898721753, 8.69958399437527063, 8.80404789328138726, 8.90964200415551488, 9.01644477716601145, 9.12453855462876895, 9.23401002131427795, 9.34495070110683379, 9.45745750751348702, 9.57163335676009197, 9.68758785371731257, 9.80543806273312768, 9.92530937768810340, 10.04733650833857972, 10.17166460340023804, 10.29845053502140040, 10.42786437452296866, 10.56009109583331096, 10.69533255130803084, 10.83380977511655452, 10.97576568279769482, 11.12146825288919594, 11.27121429903116123, 11.42533397045345467, 11.58419615784445611, 11.74821503391166821, 11.91785802874521139, 12.09365563708214530, 12.27621358918028349, 12.46622810652378988, 12.66450523457888444, 12.87198563900576076, 13.08977683600529929, 13.31919571173336614, 13.56182555539517587, 13.81959400814278816, 14.09488189492200050, 14.39067894168132256, 14.71081299834237832, 15.06029892355519451, 15.44589117824335744, 15.87700246930209680, 16.36732559837376044, 16.93792594021300957, 17.62377454645662667, 18.48969509090484564, 19.67901609485454628};
    Tensor<float> k({1});
    k = 9.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{0.00000000000000000, 0.00989898989898990, 0.01979797979797980, 0.02969696969696968, 0.03959595959595959, 0.04949494949494950, 0.05939393939393936, 0.06929292929292930, 0.07919191919191919, 0.08909090909090908, 0.09898989898989899, 0.10888888888888891, 0.11878787878787876, 0.12868686868686868, 0.13858585858585856, 0.14848484848484850, 0.15838383838383838, 0.16828282828282828, 0.17818181818181814, 0.18808080808080796, 0.19797979797979789, 0.20787878787878789, 0.21777777777777779, 0.22767676767676756, 0.23757575757575747, 0.24747474747474760, 0.25737373737373759, 0.26727272727272727, 0.27717171717171718, 0.28707070707070687, 0.29696969696969694, 0.30686868686868690, 0.31676767676767659, 0.32666666666666694, 0.33656565656565679, 0.34646464646464648, 0.35636363636363633, 0.36626262626262623, 0.37616161616161625, 0.38606060606060610, 0.39595959595959612, 0.40585858585858575, 0.41575757575757549, 0.42565656565656557, 0.43555555555555542, 0.44545454545454544, 0.45535353535353540, 0.46525252525252536, 0.47515151515151505, 0.48505050505050512, 0.49494949494949503, 0.50484848484848466, 0.51474747474747484, 0.52464646464646469, 0.53454545454545466, 0.54444444444444440, 0.55434343434343414, 0.56424242424242421, 0.57414141414141384, 0.58404040404040347, 0.59393939393939355, 0.60383838383838351, 0.61373737373737414, 0.62363636363636377, 0.63353535353535384, 0.64343434343434325, 0.65333333333333332, 0.66323232323232328, 0.67313131313131302, 0.68303030303030332, 0.69292929292929295, 0.70282828282828269, 0.71272727272727243, 0.72262626262626228, 0.73252525252525247, 0.74242424242424243, 0.75232323232323228, 0.76222222222222225, 0.77212121212121221, 0.78202020202020195, 0.79191919191919169, 0.80181818181818165, 0.81171717171717173, 0.82161616161616169, 0.83151515151515143, 0.84141414141414139, 0.85131313131313124, 0.86121212121212098, 0.87111111111111139, 0.88101010101010091, 0.89090909090909087, 0.90080808080808072, 0.91070707070707058, 0.92060606060606054, 0.93050505050505050, 0.94040404040404046, 0.95030303030303009, 0.96020202020202017, 0.97010101010101002, 0.97999999999999998};
    // run Temper chisquare::cdf
    Tensor<float> result = stats::chisquare::cdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.cdf_random_test_dof_10
  * @brief Randomly generated chisquare cdf test on 100 matrix with dof = 10.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, cdf_random_test_dof_10)
{
    Tensor<float> x({100});
    x = std::vector<float>{0.00000000000000000, 2.55168088545301064, 3.05084574587740498, 3.40258252948178175, 3.68595775922736513, 3.92872467023333982, 4.14422889682911766, 4.34002399172920050, 4.52084464079898840, 4.68987559214950966, 4.84937324692587435, 5.00100144925688639, 5.14602672095021152, 5.28543848681003947, 5.42002661231730265, 5.55043335062798704, 5.67718927373043325, 5.80073881041704187, 5.92145882791526290, 6.03967243137991261, 6.15565939828365050, 6.26966419568718969, 6.38190222937980245, 6.49256477841423596, 6.60182293785941976, 6.70983080341312821, 6.81672806954404287, 6.92264216904786522, 7.02769005049739448, 7.13197966722837773, 7.23561123468358058, 7.33867830040611491, 7.44126866153627464, 7.54346515748970514, 7.64534635998823564, 7.74698717835463402, 7.84845939466238374, 7.94983214072708577, 8.05117232687141815, 8.15254503076700487, 8.25401385336192916, 8.35564124787121365, 8.45748882698658022, 8.55961765281035269, 8.66208851350539177, 8.76496219025487910, 8.86829971782409743, 8.97216264179823675, 9.07661327542514940, 9.18171495891325051, 9.28753232401809292, 9.39413156679428241, 9.50158073149250271, 9.60995000874632765, 9.71931205142462140, 9.82974231182893554, 9.94131940430025196, 10.05412549777764575, 10.16824674343857460, 10.28377374326549898, 10.40080206625184367, 10.51943282001328406, 10.63977328684696033, 10.76193763483300891, 10.88604771646229707, 11.01223396958411804, 11.14063643830173511, 11.27140593493710519, 11.40470536851449523, 11.54071127060394808, 11.67961555612191660, 11.82162756520652458, 11.96697644310405906, 12.11591392884157692, 12.26871764130073750, 12.42569497449974136, 12.58718774431186027, 12.75357776914019325, 12.92529362098666823, 13.10281885631998655, 13.28670213608983630, 13.47756978293340424, 13.67614151886627560, 13.88325040590984116, 14.09986841812033198, 14.32713967520623832, 14.56642427846047205, 14.81935709992823824, 15.08792811731859729, 15.37459455652091833, 15.68244131444124712, 16.01541705984531916, 16.37869350652620781, 16.77923432428442396, 17.22674066177024343, 17.73531996901333940, 18.32666701848274471, 19.03678159051249352, 19.93235886385798494, 21.16076754130468629};
    Tensor<float> k({1});
    k = 10.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{0.00000000000000000, 0.00989898989898990, 0.01979797979797980, 0.02969696969696969, 0.03959595959595961, 0.04949494949494949, 0.05939393939393940, 0.06929292929292931, 0.07919191919191917, 0.08909090909090910, 0.09898989898989899, 0.10888888888888885, 0.11878787878787875, 0.12868686868686871, 0.13858585858585842, 0.14848484848484850, 0.15838383838383824, 0.16828282828282845, 0.17818181818181816, 0.18808080808080790, 0.19797979797979798, 0.20787878787878791, 0.21777777777777779, 0.22767676767676762, 0.23757575757575761, 0.24747474747474749, 0.25737373737373737, 0.26727272727272722, 0.27717171717171712, 0.28707070707070709, 0.29696969696969705, 0.30686868686868679, 0.31676767676767692, 0.32666666666666683, 0.33656565656565657, 0.34646464646464642, 0.35636363636363638, 0.36626262626262607, 0.37616161616161603, 0.38606060606060605, 0.39595959595959612, 0.40585858585858575, 0.41575757575757571, 0.42565656565656551, 0.43555555555555553, 0.44545454545454516, 0.45535353535353551, 0.46525252525252520, 0.47515151515151510, 0.48505050505050484, 0.49494949494949492, 0.50484848484848510, 0.51474747474747473, 0.52464646464646447, 0.53454545454545488, 0.54444444444444406, 0.55434343434343447, 0.56424242424242399, 0.57414141414141384, 0.58404040404040425, 0.59393939393939377, 0.60383838383838373, 0.61373737373737369, 0.62363636363636377, 0.63353535353535384, 0.64343434343434336, 0.65333333333333332, 0.66323232323232317, 0.67313131313131302, 0.68303030303030332, 0.69292929292929328, 0.70282828282828280, 0.71272727272727265, 0.72262626262626262, 0.73252525252525236, 0.74242424242424254, 0.75232323232323217, 0.76222222222222213, 0.77212121212121221, 0.78202020202020195, 0.79191919191919180, 0.80181818181818165, 0.81171717171717161, 0.82161616161616158, 0.83151515151515132, 0.84141414141414139, 0.85131313131313113, 0.86121212121212110, 0.87111111111111117, 0.88101010101010102, 0.89090909090909098, 0.90080808080808084, 0.91070707070707080, 0.92060606060606065, 0.93050505050505061, 0.94040404040404035, 0.95030303030303021, 0.96020202020202017, 0.97010101010101002, 0.97999999999999998};
    // run Temper chisquare::cdf
    Tensor<float> result = stats::chisquare::cdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.cdf_random_test_dof_11
  * @brief Randomly generated chisquare cdf test on 100 matrix with dof = 11.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, cdf_random_test_dof_11)
{
    Tensor<float> x({100});
    x = std::vector<float>{0.00000000000000000, 3.04620796521546211, 3.59963102159875126, 3.98674938780773447, 4.29717558044311065, 4.56219738281466469, 4.79680790387196865, 5.00947096639697342, 5.20548061253743644, 5.38839148070942286, 5.56071812421705225, 5.72431217183963703, 5.88058130488397879, 6.03062393397643515, 6.17531595948121037, 6.31536883817619898, 6.45136970988405434, 6.58380989279927764, 6.71310560026922332, 6.83961331432763053, 6.96364140196813786, 7.08545903440428404, 7.20530313467464723, 7.32338386016272480, 7.43988898039606461, 7.55498741078760361, 7.66883209373680774, 7.78156236961104852, 7.89330594507296279, 8.00418054073930918, 8.11429528139968959, 8.22375187805398866, 8.33264564051149570, 8.44106635130058081, 8.54909902550524414, 8.65682457640180480, 8.76432040307313542, 8.87166091327837769, 8.97891799256893819, 9.08616142882828903, 9.19345929997055045, 9.30087833138315467, 9.40848422878223900, 9.51634199142053205, 9.62451621001206448, 9.73307135328882822, 9.84207204676198266, 9.95158334700858305, 10.06167101463311297, 10.17240178895367286, 10.28384366742935541, 10.39606619287703282, 10.50914075162053329, 10.62314088587549499, 10.73814262390336260, 10.85422483177340958, 10.97146959096239627, 11.08996260650879329, 11.20979365103856829, 11.33105705071205804, 11.45385222003219639, 11.57828425353551616, 11.70446458369941212, 11.83251171599406248, 11.96255205395113030, 12.09472082949691618, 12.22916315671353082, 12.36603523078585631, 12.50550569834552128, 12.64775723097017845, 12.79298834054779732, 12.94141548398175345, 13.09327551584314797, 13.24882856181274171, 13.40836140410687172, 13.57219149393645097, 13.74067173733780223, 13.91419624215058271, 14.09320726936551793, 14.27820370709254050, 14.46975148815767476, 14.66849651492732676, 14.87518085566347459, 15.09066326364735566, 15.31594548758356922, 15.55220646013638053, 15.80084738702491620, 16.06355220788932670, 16.34237020276570007, 16.63983128675141288, 16.95911091358806644, 17.30427272636594438, 17.68063772478904383, 18.09536871907044286, 18.55844145956747226, 19.08435821633148777, 19.69541317905514077, 20.42858607942682170, 21.35235536100861609, 22.61794080556594366};
    Tensor<float> k({1});
    k = 11.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{0.00000000000000000, 0.00989898989898990, 0.01979797979797979, 0.02969696969696971, 0.03959595959595958, 0.04949494949494948, 0.05939393939393944, 0.06929292929292930, 0.07919191919191917, 0.08909090909090908, 0.09898989898989900, 0.10888888888888894, 0.11878787878787880, 0.12868686868686877, 0.13858585858585870, 0.14848484848484841, 0.15838383838383838, 0.16828282828282856, 0.17818181818181825, 0.18808080808080821, 0.19797979797979784, 0.20787878787878800, 0.21777777777777779, 0.22767676767676762, 0.23757575757575752, 0.24747474747474749, 0.25737373737373742, 0.26727272727272705, 0.27717171717171701, 0.28707070707070703, 0.29696969696969683, 0.30686868686868701, 0.31676767676767675, 0.32666666666666661, 0.33656565656565662, 0.34646464646464620, 0.35636363636363627, 0.36626262626262635, 0.37616161616161620, 0.38606060606060572, 0.39595959595959601, 0.40585858585858592, 0.41575757575757577, 0.42565656565656557, 0.43555555555555547, 0.44545454545454533, 0.45535353535353523, 0.46525252525252553, 0.47515151515151488, 0.48505050505050495, 0.49494949494949514, 0.50484848484848477, 0.51474747474747495, 0.52464646464646436, 0.53454545454545455, 0.54444444444444440, 0.55434343434343436, 0.56424242424242421, 0.57414141414141406, 0.58404040404040392, 0.59393939393939355, 0.60383838383838317, 0.61373737373737369, 0.62363636363636399, 0.63353535353535406, 0.64343434343434303, 0.65333333333333332, 0.66323232323232317, 0.67313131313131347, 0.68303030303030288, 0.69292929292929295, 0.70282828282828280, 0.71272727272727321, 0.72262626262626273, 0.73252525252525280, 0.74242424242424243, 0.75232323232323250, 0.76222222222222191, 0.77212121212121210, 0.78202020202020195, 0.79191919191919202, 0.80181818181818165, 0.81171717171717173, 0.82161616161616147, 0.83151515151515143, 0.84141414141414117, 0.85131313131313124, 0.86121212121212121, 0.87111111111111139, 0.88101010101010113, 0.89090909090909087, 0.90080808080808072, 0.91070707070707080, 0.92060606060606076, 0.93050505050505050, 0.94040404040404035, 0.95030303030303032, 0.96020202020202017, 0.97010101010101013, 0.97999999999999998};
    // run Temper chisquare::cdf
    Tensor<float> result = stats::chisquare::cdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.cdf_random_test_dof_12
  * @brief Randomly generated chisquare cdf test on 100 matrix with dof = 12.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, cdf_random_test_dof_12)
{
    Tensor<float> x({100});
    x = std::vector<float>{0.00000000000000000, 3.56257168724462669, 4.16841149143036649, 4.58960199074295350, 4.92602946227092797, 5.21241483098881897, 5.46534843109101143, 5.69417538049724037, 5.90473068521034783, 6.10092639117950597, 6.28552630221406083, 6.46056323681519729, 6.62758099897699005, 6.78778304161277912, 6.94212814785803989, 7.09139441403351256, 7.23622343038601645, 7.37715163288433651, 7.51463308148805176, 7.64905635285600294, 7.78075729691316376, 7.91002882607963542, 8.03712853634110580, 8.16228471798948618, 8.28570115266437135, 8.40756098345376834, 8.52802986853845191, 8.64725857502736162, 8.76538513105146855, 8.88253662615129613, 8.99883072936547812, 9.11437697906991673, 9.22927788705998431, 9.34362989058484494, 9.45752417930671641, 9.57104741894907818, 9.68428238933914187, 9.79730855136678613, 9.91020255487027590, 10.02303869746794796, 10.13588934277026077, 10.24882530514248735, 10.36191620717970530, 10.47523081525247157, 10.58883735784546865, 10.70280383091358090, 10.81719829409724909, 10.93208916135564479, 11.04754548937870062, 11.16363726701923476, 11.28043570893790459, 11.39801355667346350, 11.51644539043784654, 11.63580795509173349, 11.75618050398478154, 11.87764516465234799, 12.00028733075660270, 12.12419608515568470, 12.24946465959713393, 12.37619093728118536, 12.50447800545138399, 12.63443476627828765, 12.76617661564769790, 12.89982620110142975, 13.03551427217353442, 13.17338063880380261, 13.31357525650392581, 13.45625946064273215, 13.60160737678931753, 13.74980753974941194, 13.90106476106793210, 14.05560229377198667, 14.21366435455692923, 14.37551907823446484, 14.54146199810260676, 14.71182017038665002, 14.88695709301916992, 15.06727861155954962, 15.25324006196247772, 15.44535497690464609, 15.64420578782821813, 15.85045710117235096, 16.06487233318965480, 16.28833478211469554, 16.52187464449777465, 16.76670411675417682, 17.02426368250423749, 17.29628417198558665, 17.58487154084486193, 17.89262517946245978, 18.22280710219312638, 18.57959086330865617, 18.96844018932132059, 19.39670830336456575, 19.87463355663732401, 20.41709583916821558, 21.04696273988814070, 21.80215158935611441, 22.75284743011208732, 24.05395669017599758};
    Tensor<float> k({1});
    k = 12.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{0.00000000000000000, 0.00989898989898990, 0.01979797979797981, 0.02969696969696971, 0.03959595959595959, 0.04949494949494950, 0.05939393939393934, 0.06929292929292928, 0.07919191919191917, 0.08909090909090901, 0.09898989898989892, 0.10888888888888887, 0.11878787878787879, 0.12868686868686871, 0.13858585858585856, 0.14848484848484850, 0.15838383838383838, 0.16828282828282828, 0.17818181818181814, 0.18808080808080793, 0.19797979797979801, 0.20787878787878802, 0.21777777777777782, 0.22767676767676762, 0.23757575757575758, 0.24747474747474738, 0.25737373737373753, 0.26727272727272738, 0.27717171717171712, 0.28707070707070709, 0.29696969696969694, 0.30686868686868690, 0.31676767676767675, 0.32666666666666666, 0.33656565656565629, 0.34646464646464681, 0.35636363636363638, 0.36626262626262623, 0.37616161616161620, 0.38606060606060605, 0.39595959595959601, 0.40585858585858570, 0.41575757575757555, 0.42565656565656562, 0.43555555555555547, 0.44545454545454555, 0.45535353535353523, 0.46525252525252497, 0.47515151515151494, 0.48505050505050495, 0.49494949494949508, 0.50484848484848477, 0.51474747474747484, 0.52464646464646403, 0.53454545454545466, 0.54444444444444440, 0.55434343434343436, 0.56424242424242410, 0.57414141414141429, 0.58404040404040392, 0.59393939393939399, 0.60383838383838340, 0.61373737373737403, 0.62363636363636399, 0.63353535353535351, 0.64343434343434336, 0.65333333333333332, 0.66323232323232317, 0.67313131313131280, 0.68303030303030288, 0.69292929292929317, 0.70282828282828280, 0.71272727272727265, 0.72262626262626251, 0.73252525252525258, 0.74242424242424243, 0.75232323232323228, 0.76222222222222202, 0.77212121212121210, 0.78202020202020184, 0.79191919191919191, 0.80181818181818187, 0.81171717171717195, 0.82161616161616147, 0.83151515151515143, 0.84141414141414139, 0.85131313131313113, 0.86121212121212087, 0.87111111111111117, 0.88101010101010102, 0.89090909090909087, 0.90080808080808095, 0.91070707070707069, 0.92060606060606054, 0.93050505050505039, 0.94040404040404046, 0.95030303030302998, 0.96020202020202006, 0.97010101010100991, 0.97999999999999998};
    // run Temper chisquare::cdf
    Tensor<float> result = stats::chisquare::cdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.cdf_random_test_dof_13
  * @brief Randomly generated chisquare cdf test on 100 matrix with dof = 13.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, cdf_random_test_dof_13)
{
    Tensor<float> x({100});
    x = std::vector<float>{0.00000000000000000, 4.09821919291634629, 4.75477793955479644, 5.20885254788682506, 5.57033697008680306, 5.87728844975760900, 6.14784718277555964, 6.39221250826195764, 6.61674332132058307, 6.82569754586895794, 7.02208004849175715, 7.20809879259750552, 7.38542910204353475, 7.55537587771357710, 7.71897791918872223, 7.87707763555685236, 8.03036914964119042, 8.17943241326832648, 8.32475797927095762, 8.46676536300527616, 8.60581690110178776, 8.74222838137106528, 8.87627731450562685, 9.00820945501507353, 9.13824400311496987, 9.26657779957084671, 9.39338874242185540, 9.51883859589131731, 9.64307531980033517, 9.76623501730050769, 9.88844357630411075, 10.00981806329037660, 10.13046791560236137, 10.25049596880283076, 10.36999934833781545, 10.48907024909732932, 10.60779662205406204, 10.72626278370292674, 10.84454996129615623, 10.96273678470518753, 11.08089973401856909, 11.19911355061060831, 11.31745161831790902, 11.43598632048586339, 11.55478937795269978, 11.67393217249346904, 11.79348605982565878, 11.91352267596364456, 12.03411424048707978, 12.15533386014887540, 12.27725583618492777, 12.39995597869634381, 12.52351193155420717, 12.64800351142906898, 12.77351306477423876, 12.90012584690179054, 13.02793042769101106, 13.15701912897338488, 13.28748849926221531, 13.41943983226080661, 13.55297973651510546, 13.68822076471114890, 13.82528211249529093, 13.96429039837225439, 14.10538053827942306, 14.24869673093579969, 14.39439357313238155, 14.54263732791390140, 14.69360737328931954, 14.84749786494751511, 15.00451965377173913, 15.16490250817269470, 15.32889770297456344, 15.49678105156977637, 15.66885647736803300, 15.84546024566374633, 16.02696600996062060, 16.21379087037658095, 16.40640270006408485, 16.60532907447322870, 16.81116824631828521, 17.02460275899435516, 17.24641650212822697, 17.47751631445694542, 17.71895967761530599, 17.97199069391399107, 18.23808752371174080, 18.51902597914299875, 18.81696638806992894, 19.13457479730429966, 19.47519627611950810, 19.84310984733853900, 20.24391620764416189, 20.68515133132022044, 21.17730563186971793, 21.73562151008683330, 22.38351709017437940, 23.15981006655752950, 24.13632464172059855, 25.47150914468225125};
    Tensor<float> k({1});
    k = 13.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{0.00000000000000000, 0.00989898989898990, 0.01979797979797980, 0.02969696969696970, 0.03959595959595958, 0.04949494949494947, 0.05939393939393935, 0.06929292929292927, 0.07919191919191917, 0.08909090909090905, 0.09898989898989881, 0.10888888888888872, 0.11878787878787882, 0.12868686868686857, 0.13858585858585842, 0.14848484848484850, 0.15838383838383838, 0.16828282828282815, 0.17818181818181836, 0.18808080808080813, 0.19797979797979798, 0.20787878787878783, 0.21777777777777782, 0.22767676767676770, 0.23757575757575761, 0.24747474747474765, 0.25737373737373742, 0.26727272727272749, 0.27717171717171696, 0.28707070707070720, 0.29696969696969688, 0.30686868686868701, 0.31676767676767675, 0.32666666666666649, 0.33656565656565657, 0.34646464646464636, 0.35636363636363644, 0.36626262626262618, 0.37616161616161609, 0.38606060606060588, 0.39595959595959590, 0.40585858585858581, 0.41575757575757571, 0.42565656565656557, 0.43555555555555531, 0.44545454545454533, 0.45535353535353540, 0.46525252525252514, 0.47515151515151521, 0.48505050505050507, 0.49494949494949458, 0.50484848484848488, 0.51474747474747473, 0.52464646464646481, 0.53454545454545432, 0.54444444444444440, 0.55434343434343369, 0.56424242424242443, 0.57414141414141462, 0.58404040404040458, 0.59393939393939332, 0.60383838383838362, 0.61373737373737436, 0.62363636363636399, 0.63353535353535362, 0.64343434343434369, 0.65333333333333332, 0.66323232323232362, 0.67313131313131302, 0.68303030303030288, 0.69292929292929295, 0.70282828282828325, 0.71272727272727254, 0.72262626262626295, 0.73252525252525258, 0.74242424242424243, 0.75232323232323239, 0.76222222222222213, 0.77212121212121210, 0.78202020202020184, 0.79191919191919180, 0.80181818181818187, 0.81171717171717184, 0.82161616161616158, 0.83151515151515132, 0.84141414141414139, 0.85131313131313102, 0.86121212121212087, 0.87111111111111106, 0.88101010101010124, 0.89090909090909087, 0.90080808080808072, 0.91070707070707069, 0.92060606060606043, 0.93050505050505050, 0.94040404040404035, 0.95030303030303032, 0.96020202020202017, 0.97010101010101002, 0.97999999999999998};
    // run Temper chisquare::cdf
    Tensor<float> result = stats::chisquare::cdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.cdf_random_test_dof_14
  * @brief Randomly generated chisquare cdf test on 100 matrix with dof = 14.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, cdf_random_test_dof_14)
{
    Tensor<float> x({100});
    x = std::vector<float>{0.00000000000000000, 4.65105038631829437, 5.35676362655709681, 5.84264103497881138, 6.22832853649370044, 6.55512817201229403, 6.84268564468137175, 7.10202932275163867, 7.34002617873136121, 7.56126937844616620, 7.76899732170070934, 7.96558757261559958, 8.15284276290945087, 8.33216595887954270, 8.50467336348336822, 8.67126958075902721, 8.83269952300891248, 8.98958520388138105, 9.14245244180182759, 9.29175064405216666, 9.43786773276095126, 9.58114158866013632, 9.72186895253170036, 9.86031243986651518, 9.99670613446108725, 10.13126009741228195, 10.26416403829804125, 10.39559033208208128, 10.52569651998398470, 10.65462739966448424, 10.78251678588529927, 10.90948900480281303, 11.03566017151593748, 11.16113929020358597, 11.28602920830254597, 11.41042745008143733, 11.53442695021886344, 11.65811670427007485, 11.78158234996875642, 11.90490669098061183, 12.02817017287034140, 12.15145131956244207, 12.27482713739276221, 12.39837349290281843, 12.52216546977829914, 12.64627770974207621, 12.77078474175420730, 12.89576130352719652, 13.02128265911859373, 13.14742491620458331, 13.27426534656037305, 13.40188271327053471, 13.53035760826514533, 13.65977280392436022, 13.79021362272099083, 13.92176832918125662, 14.05452854885001024, 14.18858971945872938, 14.32405158013048840, 14.46101870523660615, 14.59960109047189292, 14.73991479987452102, 14.88208268392549272, 15.02623518057757224, 15.17251121315493023, 15.32105920162277357, 15.47203820686651632, 15.62561923149229060, 15.78198670545845772, 15.94134019082444453, 16.10389634739254205, 16.26989121046179321, 16.43958284390275182, 16.61325444709451560, 16.79121801402748915, 16.97381866855943500, 17.16143983349410362, 17.35450943574850413, 17.55350740953757693, 17.75897484022015149, 17.97152520197098369, 18.19185829577092051, 18.42077770997133257, 18.65921293407304304, 18.90824770470830885, 19.16915682701517554, 19.44345471926445157, 19.73296048390621493, 20.03988677933039853, 20.36696380979245902, 20.71761659104314290, 21.09622567449358854, 21.50852362063033496, 21.96222235702219194, 22.46805500680870082, 23.04161306864439496, 23.70684489821756458, 24.50343547526221855, 25.50478822269595724, 26.87276464231431206};
    Tensor<float> k({1});
    k = 14.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{0.00000000000000000, 0.00989898989898990, 0.01979797979797979, 0.02969696969696970, 0.03959595959595963, 0.04949494949494948, 0.05939393939393944, 0.06929292929292931, 0.07919191919191913, 0.08909090909090907, 0.09898989898989899, 0.10888888888888879, 0.11878787878787873, 0.12868686868686866, 0.13858585858585856, 0.14848484848484847, 0.15838383838383832, 0.16828282828282817, 0.17818181818181836, 0.18808080808080815, 0.19797979797979792, 0.20787878787878783, 0.21777777777777763, 0.22767676767676784, 0.23757575757575750, 0.24747474747474749, 0.25737373737373742, 0.26727272727272727, 0.27717171717171712, 0.28707070707070687, 0.29696969696969672, 0.30686868686868707, 0.31676767676767698, 0.32666666666666661, 0.33656565656565673, 0.34646464646464653, 0.35636363636363638, 0.36626262626262623, 0.37616161616161614, 0.38606060606060622, 0.39595959595959596, 0.40585858585858564, 0.41575757575757571, 0.42565656565656568, 0.43555555555555520, 0.44545454545454549, 0.45535353535353573, 0.46525252525252492, 0.47515151515151544, 0.48505050505050512, 0.49494949494949514, 0.50484848484848477, 0.51474747474747518, 0.52464646464646481, 0.53454545454545477, 0.54444444444444495, 0.55434343434343480, 0.56424242424242421, 0.57414141414141384, 0.58404040404040403, 0.59393939393939399, 0.60383838383838384, 0.61373737373737358, 0.62363636363636354, 0.63353535353535362, 0.64343434343434347, 0.65333333333333332, 0.66323232323232295, 0.67313131313131314, 0.68303030303030310, 0.69292929292929295, 0.70282828282828269, 0.71272727272727288, 0.72262626262626273, 0.73252525252525280, 0.74242424242424254, 0.75232323232323228, 0.76222222222222236, 0.77212121212121210, 0.78202020202020184, 0.79191919191919213, 0.80181818181818199, 0.81171717171717195, 0.82161616161616169, 0.83151515151515143, 0.84141414141414139, 0.85131313131313124, 0.86121212121212098, 0.87111111111111139, 0.88101010101010135, 0.89090909090909087, 0.90080808080808061, 0.91070707070707080, 0.92060606060606043, 0.93050505050505061, 0.94040404040404035, 0.95030303030303021, 0.96020202020202017, 0.97010101010101013, 0.97999999999999998};
    // run Temper chisquare::cdf
    Tensor<float> result = stats::chisquare::cdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.cdf_random_test_dof_15
  * @brief Randomly generated chisquare cdf test on 100 matrix with dof = 15.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, cdf_random_test_dof_15)
{
    Tensor<float> x({100});
    x = std::vector<float>{0.00000000000000000, 5.21931494813667385, 5.97273950917435315, 6.48943186924162685, 6.89854646404861693, 7.24454405361274478, 7.54853442514112949, 7.82235156365700135, 8.07335587875961558, 8.30646595914407015, 8.52514680362914667, 8.73194048178499571, 8.92877306917518432, 9.11714279088323032, 9.29824086317353604, 9.47303215038849800, 9.64231076379171981, 9.80673945348018350, 9.96687818586677921, 10.12320530778299066, 10.27613350759994049, 10.42602204821212908, 10.57318627907419284, 10.71790512949133856, 10.86042708189432737, 11.00097498529412654, 11.13974997303748360, 11.27693468123679921, 11.41269591574372200, 11.54718688032314411, 11.68054905279308286, 11.81291377663482756, 11.94440362109247999, 12.07513355177992942, 12.20521194538067355, 12.33474147550808375, 12.46381989171734794, 12.59254070967903516, 12.72099382738325168, 12.84926607975191182, 12.97744174205281631, 13.10560299092461101, 13.23383033055462832, 13.36220299053962890, 13.49079930115380499, 13.61969705111320117, 13.74897383243203208, 13.87870737659280529, 14.00897588598313703, 14.13985836437519517, 14.27143495013151053, 14.40378725580838370, 14.53699871789279108, 14.67115496055215829, 14.80634417750155585, 14.94265753640540773, 15.08018961064140306, 15.21903884377411309, 15.35930805273238953, 15.50110497648041452, 15.64454287794294096, 15.78974120812894100, 15.93682634283623045, 16.08593240407212122, 16.23720218046189956, 16.39078816353123003, 16.54685371995862297, 16.70557442385190683, 16.86713957800737518, 17.03175395921938673, 17.19963983036426924, 17.37103927163490980, 17.54621689555829889, 17.72546302609957536, 17.90909744235463563, 18.09747381358336327, 18.29098498675713103, 18.49006933336878333, 18.69521842322024341, 18.90698637537748183, 19.12600134940594288, 19.35297979664924028, 19.58874431173837394, 19.83424623954187282, 20.09059465073340789, 20.35909397755062145, 20.64129362738004048, 20.93905448008929326, 21.25463969832892275, 21.59084140815932429, 21.95116179050872773, 22.34007939947065680, 22.76345408876121112, 23.22916765340613665, 23.74818755125673775, 24.33644236506387770, 25.01839249084059347, 25.83456054672488378, 26.85987543230275421, 28.25949633743300282};
    Tensor<float> k({1});
    k = 15.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{0.00000000000000000, 0.00989898989898990, 0.01979797979797980, 0.02969696969696971, 0.03959595959595954, 0.04949494949494952, 0.05939393939393942, 0.06929292929292928, 0.07919191919191919, 0.08909090909090911, 0.09898989898989902, 0.10888888888888880, 0.11878787878787876, 0.12868686868686857, 0.13858585858585848, 0.14848484848484844, 0.15838383838383843, 0.16828282828282828, 0.17818181818181825, 0.18808080808080824, 0.19797979797979803, 0.20787878787878783, 0.21777777777777771, 0.22767676767676764, 0.23757575757575752, 0.24747474747474721, 0.25737373737373737, 0.26727272727272749, 0.27717171717171696, 0.28707070707070731, 0.29696969696969688, 0.30686868686868679, 0.31676767676767670, 0.32666666666666661, 0.33656565656565657, 0.34646464646464653, 0.35636363636363622, 0.36626262626262601, 0.37616161616161603, 0.38606060606060605, 0.39595959595959590, 0.40585858585858614, 0.41575757575757577, 0.42565656565656568, 0.43555555555555564, 0.44545454545454521, 0.45535353535353579, 0.46525252525252525, 0.47515151515151482, 0.48505050505050479, 0.49494949494949514, 0.50484848484848510, 0.51474747474747495, 0.52464646464646436, 0.53454545454545399, 0.54444444444444473, 0.55434343434343436, 0.56424242424242443, 0.57414141414141429, 0.58404040404040458, 0.59393939393939366, 0.60383838383838384, 0.61373737373737391, 0.62363636363636421, 0.63353535353535395, 0.64343434343434325, 0.65333333333333354, 0.66323232323232317, 0.67313131313131325, 0.68303030303030310, 0.69292929292929295, 0.70282828282828269, 0.71272727272727243, 0.72262626262626262, 0.73252525252525258, 0.74242424242424254, 0.75232323232323228, 0.76222222222222236, 0.77212121212121210, 0.78202020202020195, 0.79191919191919191, 0.80181818181818176, 0.81171717171717195, 0.82161616161616169, 0.83151515151515143, 0.84141414141414139, 0.85131313131313124, 0.86121212121212121, 0.87111111111111106, 0.88101010101010091, 0.89090909090909098, 0.90080808080808072, 0.91070707070707069, 0.92060606060606065, 0.93050505050505061, 0.94040404040404035, 0.95030303030303021, 0.96020202020202017, 0.97010101010101002, 0.97999999999999987};
    // run Temper chisquare::cdf
    Tensor<float> result = stats::chisquare::cdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.cdf_random_test_dof_16
  * @brief Randomly generated chisquare cdf test on 100 matrix with dof = 16.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, cdf_random_test_dof_16)
{
    Tensor<float> x({100});
    x = std::vector<float>{0.00000000000000000, 5.80153706605191033, 6.60133900562132858, 7.14794036509763764, 7.57977343802297021, 7.94437692179751842, 8.26428602713742855, 8.55211858908972467, 8.81571488301250028, 9.06030983979152360, 9.28958865699648761, 9.50625321453146199, 9.71234947636546053, 9.90946806335235664, 10.09887301112966007, 10.28158767026780218, 10.45845389383119795, 10.63017395514828500, 10.79734094638888386, 10.96046128346515935, 11.11997167270192932, 11.27625211037928565, 11.42963598773930833, 11.58041804903480809, 11.72886073343135749, 11.87519928402512548, 12.01964590494081087, 12.16239317535457154, 12.30361687766476209, 12.44347835956528669, 12.58212652223246941, 12.71969950634939295, 12.85632613228795584, 12.99212713907128602, 13.12721625777454193, 13.26170114809383094, 13.39568422141705994, 13.52926336949944464, 13.66253261450768619, 13.79558269354900268, 13.92850158869190835, 14.06137501180091753, 14.19428685215904018, 14.32731959377463227, 14.46055470841043622, 14.59407302969439080, 14.72795511314318340, 14.86228158652790832, 14.99713349471946167, 15.13259264295669482, 15.26874194237438509, 15.40566576160520285, 15.54345028832787179, 15.68218390477288082, 15.82195758142135844, 15.96286529344651051, 16.10500446486248904, 16.24847644587221751, 16.39338702956352378, 16.53984701491234688, 16.68797282404156235, 16.83788718289005715, 16.98971987591501076, 17.14360858723755143, 17.29969984282382356, 17.45815007096192772, 17.61912680157211497, 17.78281002892932960, 17.94939376738393833, 18.11908783590523697, 18.29211991508825719, 18.46873793012062492, 18.64921282571831895, 18.83384181503932453, 19.02295220520440466, 19.21690592885175519, 19.41610494629034633, 19.62099772933700592, 19.83208710015163234, 20.04993978256226939, 20.27519813862021891, 20.50859472299027431, 20.75097051271664128, 21.00329799135340991, 21.26671073372398268, 21.54254182971208564, 21.83237453225315505, 22.13811013490517965, 22.46206065818521580, 22.80707813425453523, 23.17673940118733000, 23.57561783580376513, 24.00969646224883647, 24.48702145240654460, 25.01878704151346255, 25.62124805303474417, 26.31936050006389394, 27.15445786530639083, 28.20294597145290894, 29.63317731405268773};
    Tensor<float> k({1});
    k = 16.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{0.00000000000000000, 0.00989898989898990, 0.01979797979797980, 0.02969696969696973, 0.03959595959595959, 0.04949494949494942, 0.05939393939393940, 0.06929292929292931, 0.07919191919191917, 0.08909090909090905, 0.09898989898989896, 0.10888888888888890, 0.11878787878787880, 0.12868686868686871, 0.13858585858585859, 0.14848484848484847, 0.15838383838383840, 0.16828282828282831, 0.17818181818181814, 0.18808080808080810, 0.19797979797979801, 0.20787878787878780, 0.21777777777777801, 0.22767676767676759, 0.23757575757575772, 0.24747474747474751, 0.25737373737373737, 0.26727272727272761, 0.27717171717171690, 0.28707070707070670, 0.29696969696969694, 0.30686868686868690, 0.31676767676767675, 0.32666666666666688, 0.33656565656565668, 0.34646464646464664, 0.35636363636363655, 0.36626262626262673, 0.37616161616161631, 0.38606060606060649, 0.39595959595959596, 0.40585858585858592, 0.41575757575757566, 0.42565656565656523, 0.43555555555555558, 0.44545454545454544, 0.45535353535353551, 0.46525252525252497, 0.47515151515151538, 0.48505050505050501, 0.49494949494949503, 0.50484848484848488, 0.51474747474747462, 0.52464646464646447, 0.53454545454545399, 0.54444444444444406, 0.55434343434343436, 0.56424242424242466, 0.57414141414141395, 0.58404040404040425, 0.59393939393939443, 0.60383838383838384, 0.61373737373737358, 0.62363636363636377, 0.63353535353535317, 0.64343434343434347, 0.65333333333333310, 0.66323232323232317, 0.67313131313131325, 0.68303030303030299, 0.69292929292929295, 0.70282828282828280, 0.71272727272727288, 0.72262626262626262, 0.73252525252525247, 0.74242424242424243, 0.75232323232323239, 0.76222222222222202, 0.77212121212121210, 0.78202020202020184, 0.79191919191919191, 0.80181818181818176, 0.81171717171717173, 0.82161616161616169, 0.83151515151515154, 0.84141414141414161, 0.85131313131313102, 0.86121212121212132, 0.87111111111111117, 0.88101010101010069, 0.89090909090909109, 0.90080808080808072, 0.91070707070707069, 0.92060606060606065, 0.93050505050505050, 0.94040404040404046, 0.95030303030303009, 0.96020202020202017, 0.97010101010100991, 0.97999999999999998};
    // run Temper chisquare::cdf
    Tensor<float> result = stats::chisquare::cdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.cdf_random_test_dof_17
  * @brief Randomly generated chisquare cdf test on 100 matrix with dof = 17.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, cdf_random_test_dof_17)
{
    Tensor<float> x({100});
    x = std::vector<float>{0.00000000000000000, 6.39645946742910354, 7.24140283292948528, 7.81707918680163516, 8.27098071068577134, 8.65364827095121569, 8.98900640068694123, 9.29043652246915030, 9.56624617405960720, 9.82197821169457264, 10.06153210877633697, 10.28776521650417841, 10.50284010533744805, 10.70843724410321229, 10.90589146665139708, 11.09628297678496445, 11.28050002911197680, 11.45928330508981752, 11.63325808369242687, 11.80295805083919625, 11.96884324428061319, 12.13131379876753790, 12.29072062776716656, 12.44737383347425741, 12.60154940715295346, 12.75349462552060231, 12.90343244052754201, 13.05156508351248945, 13.19807705005611531, 13.34313759219281437, 13.48690281548819314, 13.62951745681076687, 13.77111640232809897, 13.91182599288335986, 14.05176515442565588, 14.19104638383982930, 14.32977661481517728, 14.46805798391795150, 14.60598851350188632, 14.74366272529085187, 14.88117219623676490, 15.01860606647322527, 15.15605150775889065, 15.29359415966303537, 15.43131853983583390, 15.56930843398563269, 15.70764727062314847, 15.84641848520303142, 15.98570587798037934, 16.12559396968721614, 16.26616835901467084, 16.40751608585429011, 16.54972600430249230, 16.69288916956802282, 16.83709924314473483, 16.98245292092803282, 17.12905038937228852, 17.27699581532091599, 17.42639787580889532, 17.57737033496015400, 17.73003267611082023, 17.88451079851702374, 18.04093778950290883, 18.19945478472636680, 18.36021193146443409, 18.52336947254191557, 18.68909897186876634, 18.85758470667360243, 19.02902525662830158, 19.20363532642100779, 19.38164784630747661, 19.56331640522319404, 19.74891808380035840, 19.93875677095154586, 20.13316706871225747, 20.33251891736216876, 20.53722310867795287, 20.74773790260796602, 20.96457702611226637, 21.18831941874037383, 21.41962120702183014, 21.65923055272841680, 21.90800624937615382, 22.16694126901576922, 22.43719293766408640, 22.72012212319433999, 23.01734488635200648, 23.33080169673705484, 23.66285193839162915, 24.01640571982438388, 24.39511225931032001, 24.80363686904959053, 25.24808199963263888, 25.73665321289331231, 26.28076465617854041, 26.89698754125740265, 27.61075857250251175, 28.46419775788854878, 29.53514368989205963, 30.99504720616068099};
    Tensor<float> k({1});
    k = 17.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{0.00000000000000000, 0.00989898989898990, 0.01979797979797980, 0.02969696969696965, 0.03959595959595959, 0.04949494949494949, 0.05939393939393939, 0.06929292929292948, 0.07919191919191922, 0.08909090909090908, 0.09898989898989929, 0.10888888888888885, 0.11878787878787893, 0.12868686868686866, 0.13858585858585859, 0.14848484848484864, 0.15838383838383840, 0.16828282828282826, 0.17818181818181819, 0.18808080808080810, 0.19797979797979809, 0.20787878787878777, 0.21777777777777779, 0.22767676767676770, 0.23757575757575755, 0.24747474747474740, 0.25737373737373742, 0.26727272727272733, 0.27717171717171712, 0.28707070707070731, 0.29696969696969672, 0.30686868686868685, 0.31676767676767681, 0.32666666666666672, 0.33656565656565673, 0.34646464646464664, 0.35636363636363672, 0.36626262626262601, 0.37616161616161636, 0.38606060606060605, 0.39595959595959618, 0.40585858585858586, 0.41575757575757599, 0.42565656565656584, 0.43555555555555564, 0.44545454545454488, 0.45535353535353557, 0.46525252525252575, 0.47515151515151516, 0.48505050505050551, 0.49494949494949458, 0.50484848484848488, 0.51474747474747462, 0.52464646464646447, 0.53454545454545455, 0.54444444444444462, 0.55434343434343458, 0.56424242424242366, 0.57414141414141451, 0.58404040404040347, 0.59393939393939388, 0.60383838383838384, 0.61373737373737369, 0.62363636363636399, 0.63353535353535384, 0.64343434343434336, 0.65333333333333377, 0.66323232323232328, 0.67313131313131269, 0.68303030303030265, 0.69292929292929295, 0.70282828282828269, 0.71272727272727299, 0.72262626262626273, 0.73252525252525214, 0.74242424242424243, 0.75232323232323228, 0.76222222222222213, 0.77212121212121199, 0.78202020202020195, 0.79191919191919169, 0.80181818181818176, 0.81171717171717184, 0.82161616161616147, 0.83151515151515143, 0.84141414141414139, 0.85131313131313135, 0.86121212121212121, 0.87111111111111106, 0.88101010101010080, 0.89090909090909076, 0.90080808080808061, 0.91070707070707069, 0.92060606060606054, 0.93050505050505061, 0.94040404040404024, 0.95030303030303021, 0.96020202020202017, 0.97010101010100991, 0.97999999999999998};
    // run Temper chisquare::cdf
    Tensor<float> result = stats::chisquare::cdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.cdf_random_test_dof_18
  * @brief Randomly generated chisquare cdf test on 100 matrix with dof = 18.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, cdf_random_test_dof_18)
{
    Tensor<float> x({100});
    x = std::vector<float>{0.00000000000000000, 7.00300112948873732, 7.89193779507974558, 8.49591857145606433, 8.97128975291158781, 9.37152328042493465, 9.72189925796451071, 10.03654380048550010, 10.32421997843973216, 10.59077075246129951, 10.84030437548531189, 11.07582964806056935, 11.29962270805865465, 11.51345151505427289, 11.71871983258445837, 11.91656320907236832, 12.10791506329171163, 12.29355345592823134, 12.47413498686344191, 12.65021987549641125, 12.82229085851148653, 12.99076766128496097, 13.15601824125559105, 13.31836763805742230, 13.47810502287845225, 13.63548937463147581, 13.79075409626016402, 13.94411080398204206, 14.09575246465599818, 14.24585601466026752, 14.39458456294786970, 14.54208925810502429, 14.68851088206950095, 14.83398122013139542, 14.97862424685239269, 15.12255715982252191, 15.26589128716512000, 15.40873288998881918, 15.55118387726814611, 15.69334244768551478, 15.83530367061812072, 15.97716001657546059, 16.11900184588989760, 16.26091786325957145, 16.40299554478238520, 16.54532154335913319, 16.68798207774801767, 16.83106331009757639, 16.97465171644948256, 17.11883445447447016, 17.26369973257186174, 17.40933718442087752, 17.55583825311656199, 17.70329658915457216, 17.85180846675074662, 18.00147322329869581, 18.15239372719178590, 18.30467687977725078, 18.45843415788791475, 18.61378220423405594, 18.77084347396213104, 18.92974694693871740, 19.09062891684028074, 19.25363386998641602, 19.41891546911959665, 19.58663766010733198, 19.75697592294816118, 19.93011869266299385, 20.10626898085759251, 20.28564623522571964, 20.46848848238671792, 20.65505480969424923, 20.84562825465714653, 21.04051918724006498, 21.24006929173934566, 21.44465628277306024, 21.65469952643194418, 21.87066678596614011, 22.09308237602537517, 22.32253709690282051, 22.55970043992649465, 22.80533572115465901, 23.06031903409182249, 23.32566324587589435, 23.60254874646400935, 23.89236337875839311, 24.19675506397509324, 24.51770231782051468, 24.85761052344199484, 25.21944619485276107, 25.60692885110033856, 26.02481310256613511, 26.47931740621497809, 26.97880215770419809, 27.53489514324177279, 28.16447495846901461, 28.89344535501585653, 29.76469061152981865, 30.85744170663226171, 32.34616093033883999};
    Tensor<float> k({1});
    k = 18.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{0.00000000000000000, 0.00989898989898989, 0.01979797979797983, 0.02969696969696974, 0.03959595959595960, 0.04949494949494950, 0.05939393939393933, 0.06929292929292928, 0.07919191919191920, 0.08909090909090901, 0.09898989898989899, 0.10888888888888888, 0.11878787878787876, 0.12868686868686871, 0.13858585858585862, 0.14848484848484833, 0.15838383838383840, 0.16828282828282828, 0.17818181818181814, 0.18808080808080788, 0.19797979797979795, 0.20787878787878789, 0.21777777777777776, 0.22767676767676764, 0.23757575757575758, 0.24747474747474746, 0.25737373737373737, 0.26727272727272733, 0.27717171717171724, 0.28707070707070720, 0.29696969696969688, 0.30686868686868690, 0.31676767676767670, 0.32666666666666644, 0.33656565656565640, 0.34646464646464675, 0.35636363636363610, 0.36626262626262635, 0.37616161616161603, 0.38606060606060671, 0.39595959595959629, 0.40585858585858614, 0.41575757575757583, 0.42565656565656546, 0.43555555555555486, 0.44545454545454533, 0.45535353535353551, 0.46525252525252525, 0.47515151515151527, 0.48505050505050495, 0.49494949494949492, 0.50484848484848477, 0.51474747474747484, 0.52464646464646469, 0.53454545454545543, 0.54444444444444440, 0.55434343434343436, 0.56424242424242488, 0.57414141414141406, 0.58404040404040392, 0.59393939393939399, 0.60383838383838384, 0.61373737373737391, 0.62363636363636366, 0.63353535353535340, 0.64343434343434336, 0.65333333333333332, 0.66323232323232295, 0.67313131313131325, 0.68303030303030299, 0.69292929292929273, 0.70282828282828280, 0.71272727272727276, 0.72262626262626273, 0.73252525252525225, 0.74242424242424243, 0.75232323232323228, 0.76222222222222191, 0.77212121212121199, 0.78202020202020173, 0.79191919191919213, 0.80181818181818165, 0.81171717171717173, 0.82161616161616158, 0.83151515151515143, 0.84141414141414139, 0.85131313131313124, 0.86121212121212132, 0.87111111111111106, 0.88101010101010102, 0.89090909090909109, 0.90080808080808072, 0.91070707070707080, 0.92060606060606076, 0.93050505050505072, 0.94040404040404046, 0.95030303030303032, 0.96020202020202017, 0.97010101010101002, 0.97999999999999998};
    // run Temper chisquare::cdf
    Tensor<float> result = stats::chisquare::cdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.cdf_random_test_dof_19
  * @brief Randomly generated chisquare cdf test on 100 matrix with dof = 19.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, cdf_random_test_dof_19)
{
    Tensor<float> x({100});
    x = std::vector<float>{0.00000000000000000, 7.62022484663930921, 8.55208547109560335, 9.18365625064357083, 9.67994334563641701, 10.09728299863491685, 10.46227928016769226, 10.78978534244449428, 11.08900884680362608, 11.36608557243437545, 11.62532743728591278, 11.86989095226157254, 12.10216299972748999, 12.32399684205767443, 12.53686343927873637, 12.74195228591837825, 12.94024081846495022, 13.13254352401658842, 13.31954752186813806, 13.50183888344507110, 13.67992245940496687, 13.85423705926670479, 14.02516724245405477, 14.19305259755766357, 14.35819513196626040, 14.52086522079390285, 14.68130644400398666, 14.83973955606314554, 14.99636577195908593, 15.15136950952805783, 15.30492069579029213, 15.45717672101695328, 15.60828410623408935, 15.75837993619134458, 15.90759309934460042, 16.05604536830606577, 16.20385234791116247, 16.35112431310944103, 16.49796695498681842, 16.64448205013307103, 16.79076806610361672, 16.93692071375427943, 17.08303345564968367, 17.22919797848217982, 17.37550463642903509, 17.52204287157484330, 17.66890161689852690, 17.81616968684252456, 17.96393616012616334, 18.11229075921973930, 18.26132423075096511, 18.41112873106339265, 18.56179822118476253, 18.71342887559094947, 18.86611950937134452, 19.01997202872092885, 19.17509191011061986, 19.33158871403605161, 19.48957663993277478, 19.64917512969459779, 19.81050952827476053, 19.97371181112083605, 20.13892138974372159, 20.30628600861139077, 20.47596274886288015, 20.64811915716165558, 20.82293452147430202, 21.00060131983640233, 21.18132687346656695, 21.36533524219096591, 21.55286940841215326, 21.74419380628507881, 21.93959726600252580, 22.13939646002019401, 22.34393995986557613, 22.55361304052079419, 22.76884340653305472, 22.99010806320216815, 23.21794162199384459, 23.45294641832162696, 23.69580494166425311, 23.94729524694722755, 24.20831025381159662, 24.47988218001988514, 24.76321384886174215, 25.05971934143737556, 25.37107757004803332, 25.69930405946600871, 26.04684893958762260, 26.41673359617542260, 26.81274594003925671, 27.23972745840808329, 27.70400947412058201, 28.21410303241698969, 28.78184379631631984, 29.42440947329401624, 30.16815832560358857, 31.05671844965423745, 32.17067608584372351, 33.68742507128534669};
    Tensor<float> k({1});
    k = 19.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{0.00000000000000000, 0.00989898989898989, 0.01979797979797978, 0.02969696969696974, 0.03959595959595963, 0.04949494949494940, 0.05939393939393945, 0.06929292929292920, 0.07919191919191895, 0.08909090909090914, 0.09898989898989900, 0.10888888888888887, 0.11878787878787860, 0.12868686868686871, 0.13858585858585859, 0.14848484848484841, 0.15838383838383835, 0.16828282828282828, 0.17818181818181816, 0.18808080808080815, 0.19797979797979784, 0.20787878787878808, 0.21777777777777785, 0.22767676767676773, 0.23757575757575761, 0.24747474747474740, 0.25737373737373731, 0.26727272727272727, 0.27717171717171712, 0.28707070707070675, 0.29696969696969727, 0.30686868686868701, 0.31676767676767636, 0.32666666666666688, 0.33656565656565651, 0.34646464646464592, 0.35636363636363627, 0.36626262626262612, 0.37616161616161609, 0.38606060606060622, 0.39595959595959596, 0.40585858585858581, 0.41575757575757577, 0.42565656565656562, 0.43555555555555558, 0.44545454545454477, 0.45535353535353545, 0.46525252525252453, 0.47515151515151449, 0.48505050505050495, 0.49494949494949492, 0.50484848484848499, 0.51474747474747484, 0.52464646464646458, 0.53454545454545477, 0.54444444444444429, 0.55434343434343436, 0.56424242424242421, 0.57414141414141406, 0.58404040404040458, 0.59393939393939355, 0.60383838383838384, 0.61373737373737380, 0.62363636363636332, 0.63353535353535362, 0.64343434343434325, 0.65333333333333332, 0.66323232323232317, 0.67313131313131325, 0.68303030303030288, 0.69292929292929295, 0.70282828282828325, 0.71272727272727265, 0.72262626262626262, 0.73252525252525236, 0.74242424242424243, 0.75232323232323228, 0.76222222222222225, 0.77212121212121176, 0.78202020202020195, 0.79191919191919191, 0.80181818181818176, 0.81171717171717206, 0.82161616161616169, 0.83151515151515154, 0.84141414141414139, 0.85131313131313124, 0.86121212121212143, 0.87111111111111117, 0.88101010101010102, 0.89090909090909121, 0.90080808080808061, 0.91070707070707058, 0.92060606060606054, 0.93050505050505050, 0.94040404040404058, 0.95030303030303032, 0.96020202020202006, 0.97010101010101002, 0.97999999999999998};
    // run Temper chisquare::cdf
    Tensor<float> result = stats::chisquare::cdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.cdf_random_test_dof_20
  * @brief Randomly generated chisquare cdf test on 100 matrix with dof = 20.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, cdf_random_test_dof_20)
{
    Tensor<float> x({100});
    x = std::vector<float>{0.00000000000000000, 8.24731201652810952, 9.22109806220700179, 9.87959434195320974, 10.39628342822933327, 10.83030306942364618, 11.20955165662948261, 11.54959284832731115, 11.86006866604599352, 12.14740090296484354, 12.41610036993663613, 12.66946780239861958, 12.90999819731835352, 13.13962808281671180, 13.35989400265997418, 13.57203809682117956, 13.77708075377064034, 13.97587200166939958, 14.16912873478014667, 14.35746224384106817, 14.54139895054947118, 14.72139627862667055, 14.89785497951119808, 15.07112883051417818, 15.24153235658340044, 15.40934704544443257, 15.57482640023211395, 15.73820008520593206, 15.89967735682576588, 16.05944992653873982, 16.21769436788748564, 16.37457415546893102, 16.53024140442500567, 16.68483836484099925, 16.83849871446838975, 16.99134868472270909, 17.14350804831567388, 17.29509099171225017, 17.44620689152606730, 17.59696101073179975, 17.74745512799541913, 17.89778811136251591, 18.04805644589374580, 18.19835472351399375, 18.34877610228466338, 18.49941274146904746, 18.65035621810170596, 18.80169793026576386, 18.95352949190593961, 19.10594312374370674, 19.25903204470367669, 19.41289086819915966, 19.56761600765667097, 19.72330609578339278, 19.88006242230076026, 20.03798939518749833, 20.19719503090659174, 20.35779147964519709, 20.51989559229337345, 20.68362953675046967, 20.84912147220552470, 21.01650629133105497, 21.18592644190507102, 21.35753284129737395, 21.53148589960159143, 21.70795667006587237, 21.88712814900249626, 22.06919675170617623, 22.25437399630244784, 22.44288843416346069, 22.63498787394312828, 22.83094195689469075, 23.03104515460153934, 23.23562027747367154, 23.44502260455312737, 23.65964477400622101, 23.87992261148382767, 24.10634212357138395, 24.33944795047730736, 24.57985366262297688, 24.82825440969930852, 25.08544260258821623, 25.35232755027308471, 25.62996031922942564, 25.91956558471930805, 26.22258298670908516, 26.54072162698734871, 26.87603308314069750, 27.23101107692954770, 27.60873045136273518, 28.01304574826952987, 28.44888309822815131, 28.92268379276043433, 29.44310566616019287, 30.02218694127625653, 30.67739680317648876, 31.43553645271548191, 32.34095892103542980, 33.47557142696057753, 35.01962554059927868};
    Tensor<float> k({1});
    k = 20.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{0.00000000000000000, 0.00989898989898990, 0.01979797979797978, 0.02969696969696968, 0.03959595959595968, 0.04949494949494965, 0.05939393939393937, 0.06929292929292927, 0.07919191919191929, 0.08909090909090910, 0.09898989898989896, 0.10888888888888890, 0.11878787878787878, 0.12868686868686874, 0.13858585858585865, 0.14848484848484850, 0.15838383838383829, 0.16828282828282815, 0.17818181818181814, 0.18808080808080807, 0.19797979797979787, 0.20787878787878783, 0.21777777777777779, 0.22767676767676770, 0.23757575757575786, 0.24747474747474749, 0.25737373737373670, 0.26727272727272727, 0.27717171717171751, 0.28707070707070720, 0.29696969696969683, 0.30686868686868701, 0.31676767676767686, 0.32666666666666655, 0.33656565656565657, 0.34646464646464636, 0.35636363636363627, 0.36626262626262618, 0.37616161616161609, 0.38606060606060610, 0.39595959595959518, 0.40585858585858592, 0.41575757575757566, 0.42565656565656551, 0.43555555555555553, 0.44545454545454544, 0.45535353535353529, 0.46525252525252520, 0.47515151515151521, 0.48505050505050507, 0.49494949494949420, 0.50484848484848399, 0.51474747474747384, 0.52464646464646447, 0.53454545454545455, 0.54444444444444440, 0.55434343434343414, 0.56424242424242455, 0.57414141414141384, 0.58404040404040392, 0.59393939393939377, 0.60383838383838362, 0.61373737373737369, 0.62363636363636321, 0.63353535353535340, 0.64343434343434336, 0.65333333333333332, 0.66323232323232351, 0.67313131313131291, 0.68303030303030299, 0.69292929292929306, 0.70282828282828280, 0.71272727272727265, 0.72262626262626295, 0.73252525252525247, 0.74242424242424243, 0.75232323232323228, 0.76222222222222213, 0.77212121212121221, 0.78202020202020206, 0.79191919191919202, 0.80181818181818176, 0.81171717171717173, 0.82161616161616169, 0.83151515151515154, 0.84141414141414128, 0.85131313131313124, 0.86121212121212121, 0.87111111111111106, 0.88101010101010102, 0.89090909090909087, 0.90080808080808061, 0.91070707070707058, 0.92060606060606054, 0.93050505050505061, 0.94040404040404035, 0.95030303030303009, 0.96020202020202028, 0.97010101010101002, 0.97999999999999987};
    // run Temper chisquare::cdf
    Tensor<float> result = stats::chisquare::cdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.cdf_broadcast_x_vector_k_scalar
  * @brief Verify broadcasting: cdf broadcast x vector k scalar
  */
TEST(CHISQUARE, cdf_broadcast_x_vector_k_scalar)
{
    Tensor<float> x({4});
    x = std::vector<float>{0.00000000000000000, 0.00000000000000000, 0.50000000000000000, 2.00000000000000000};
    Tensor<float> k({1});
    k = 1.00000000000000000;
    Tensor<float> expected_result({4});
    expected_result = std::vector<float>{0.00000000000000000, 0.00000000000000000, 0.52049987781304663, 0.84270079294971512};
    Tensor<float> result = stats::chisquare::cdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
}

/**
  * @test CHISQUARE.cdf_broadcast_x_scalar_k_vector
  * @brief Verify broadcasting: cdf broadcast x scalar k vector
  */
TEST(CHISQUARE, cdf_broadcast_x_scalar_k_vector)
{
    Tensor<float> x({1});
    x = 1.00000000000000000;
    Tensor<float> k({3});
    k = std::vector<float>{1.00000000000000000, 0.50000000000000000, 2.00000000000000000};
    Tensor<float> expected_result({3});
    expected_result = std::vector<float>{0.68268949213708585, 0.84648640419167742, 0.39346934028736652};
    Tensor<float> result = stats::chisquare::cdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
}

/**
  * @test CHISQUARE.cdf_broadcast_2d_x_k_vector
  * @brief Verify broadcasting: cdf broadcast 2d x k vector
  */
TEST(CHISQUARE, cdf_broadcast_2d_x_k_vector)
{
    Tensor<float> x({2,2});
    x = std::vector<float>{0.00000000000000000, 1.00000000000000000, 2.00000000000000000, 3.00000000000000000};
    Tensor<float> k({2});
    k = std::vector<float>{1.00000000000000000, 2.00000000000000000};
    Tensor<float> expected_result({4});
    expected_result = std::vector<float>{0.00000000000000000, 0.39346934028736652, 0.84270079294971512, 0.77686983985157021};
    Tensor<float> result = stats::chisquare::cdf(x, k);
    // check values
    EXPECT_NEAR(result[0][0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[0][1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[1][0], expected_result[2], 0.0001);
    EXPECT_NEAR(result[1][1], expected_result[3], 0.0001);
}

/**
  * @test CHISQUARE.cdf_broadcast_mixed_shapes_all_operands
  * @brief Verify broadcasting: cdf broadcast mixed shapes all operands
  */
TEST(CHISQUARE, cdf_broadcast_mixed_shapes_all_operands)
{
    Tensor<float> x({2,1});
    x = std::vector<float>{0.00000000000000000, 1.00000000000000000};
    Tensor<float> k({1,3});
    k = std::vector<float>{1.00000000000000000, 0.50000000000000000, 2.00000000000000000};
    Tensor<float> expected_result({6});
    expected_result = std::vector<float>{0.00000000000000000, 0.00000000000000000, 0.00000000000000000, 0.68268949213708585, 0.84648640419167742, 0.39346934028736652};
    Tensor<float> result = stats::chisquare::cdf(x, k);
    // check values
    EXPECT_NEAR(result[0][0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[0][1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[0][2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[1][0], expected_result[3], 0.0001);
    EXPECT_NEAR(result[1][1], expected_result[4], 0.0001);
    EXPECT_NEAR(result[1][2], expected_result[5], 0.0001);
}

/**
  * @test CHISQUARE.cdf_view_with_weird_strides
  * @brief Ensure chisquare::cdf accepts non-contiguous/alias views for x and k
  */
TEST(CHISQUARE, cdf_view_with_weird_strides)
{
    Tensor<float> x_owner({6}, MemoryLocation::DEVICE);
    std::vector<float> x_owner_vals = {
        2.00000000000000000, 99.00000000000000000, 1.00000000000000000, 99.00000000000000000, 5.00000000000000000, 99.00000000000000000
    };
    x_owner = x_owner_vals;

    Tensor<float> x_alias(
        x_owner,
        std::vector<uint64_t>{0ull},
        std::vector<uint64_t>{3ull},
        std::vector<uint64_t>{2ull}
    );

    Tensor<float> k_owner({6}, MemoryLocation::DEVICE);
    std::vector<float> k_owner_vals = {
        1.00000000000000000, 99.00000000000000000, 5.00000000000000000, 99.00000000000000000, 10.00000000000000000, 99.00000000000000000
    };
    k_owner = k_owner_vals;

    Tensor<float> k_alias(
        k_owner,
        std::vector<uint64_t>{0ull},
        std::vector<uint64_t>{3ull},
        std::vector<uint64_t>{2ull}
    );

    Tensor<float> result = stats::chisquare::cdf(x_alias, k_alias);

    Tensor<float> expected_result({3});
    expected_result = std::vector<float>{0.84270079294971512, 0.03743422675270361, 0.10882198108584877};

    // compare element-wise (unroll to report precise index on failure)
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
}
