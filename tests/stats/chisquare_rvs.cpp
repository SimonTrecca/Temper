/**
  * @file chisquare_rvs.cpp
  * @brief File generated by tests/stats/chisquare_rvs.py (rvs(k, out_shape, ...)).
  */

/**
  * @test CHISQUARE.rvs_random_test_dof_2
  * @brief Deterministic chisquare::rvs test on 100 outputs with k = 2 and seed = 123456789.
  *
  * The test is generated from the script, expecting values from numpy (reproducing C++ RNG).
  */
TEST(CHISQUARE, rvs_random_test_dof_2)
{
    Tensor<float> k({1});
    k = 2.00000000000000000;
    std::vector<uint64_t> out_shape = {100ull};
    uint64_t seed = 123456789ull;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{0.75150911531704179, 1.80312039695514525, 4.15727133442876973, 2.83202147937707016, 2.74839547826890840, 2.66812624408429633, 2.59095466154306386, 1.68920492631267827, 3.80905326657167453, 1.59500399452148911, 3.54841589897864340, 6.17374200232053916, 5.76456181588695582, 1.45144631407160940, 1.40907654513484437, 5.37934904883104803, 0.47888129475267649, 1.36151673379345439, 2.97977610901164836, 0.35503648025961770, 0.33043798165441690, 0.30613835395006389, 0.28213042169873126, 0.30256643433427122, 1.09370313845802025, 0.25491950840850974, 1.02333931103520515, 0.92709892815966466, 0.89442125655154370, 5.39490910484715869, 5.10879344125986012, 0.40644937880755755, 1.25000607409393205, 2.73750030656641208, 0.05353062755069585, 1.73144205731998935, 1.68278219561810727, 1.63527815948994015, 1.58887631150699793, 0.99583187399690676, 2.23582891015030372, 0.92877275578353369, 2.11291324835915217, 1.38558341048838485, 1.34457223965688177, 0.12692850255421340, 0.10496698009718886, 1.29850461335561418, 2.84093366881628873, 0.08004847404044223, 0.77152761097532363, 0.07685805068987439, 0.05543661725290348, 0.03424219343267365, 0.01327001825508870, 0.03112395408713770, 0.70273969664823877, 10.48647690049346437, 0.64469039380879578, 1.71405297248215982, 1.66580931233184315, 0.29525568912734163, 0.27137726261675882, 0.98377815686784142, 2.21347963193201602, 5.99947708785895273, 0.52541955170775356, 0.24084799320613492, 0.21760668690336291, 0.19463236025186392, 0.17191894910043437, 5.21842651503397814, 0.46447613966329032, 4.72218650575332166, 0.41286294761762282, 2.10727767119275189, 2.04870414561118475, 0.47906270905279513, 0.45290073907723283, 1.98350981164564510, 4.81388931487995286, 0.42328221592658366, 1.27572759802222202, 3.92697731795933525, 3.78452775406556663, 3.65155302445091756, 3.52687094170583748, 3.63260003605830573, 0.25159973626615995, 3.39270598237289622, 0.20513785639973253, 2.59721790795162866, 2.52268498446065648, 0.68148772327347618, 0.65255925637966750, 1.55323534689965714, 3.43935322366513008, 0.21452683873148737, 0.96430152757534038, 5.47869991355502073};
    // run Temper chisquare::rvs (k, out_shape, memloc, seed)
    Tensor<float> result = stats::chisquare::rvs(k, out_shape, MemoryLocation::DEVICE, seed);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.rvs_random_test_dof_3
  * @brief Deterministic chisquare::rvs test on 100 outputs with k = 3 and seed = 123456789.
  *
  * The test is generated from the script, expecting values from numpy (reproducing C++ RNG).
  */
TEST(CHISQUARE, rvs_random_test_dof_3)
{
    Tensor<float> k({1});
    k = 3.00000000000000000;
    std::vector<uint64_t> out_shape = {100ull};
    uint64_t seed = 123456789ull;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{1.48053153965876416, 2.90858217339976211, 5.73755501170590243, 4.17991777862517999, 4.07915670958865739, 3.98208773770528746, 3.88842360562422806, 2.76239309283047207, 5.33428483263550390, 2.64038898267024313, 5.02994180113941969, 8.01783458644122327, 7.56119074260523139, 2.45229343399494493, 2.39623012043181927, 7.12882658649843126, 1.05863485840083160, 2.33297650746848895, 4.35708349809213491, 0.85053357678934649, 0.80735071504082079, 0.76394357594597029, 0.72024256881363458, 0.75749522159548532, 1.96946177554634572, 0.66960475157843513, 1.87153212670290947, 1.73560643566656592, 1.68887835414163079, 7.14634125995425595, 6.82356487873618356, 0.93863843709638539, 2.18322638408184799, 4.06600188021857978, 0.22420863978917732, 2.81676169319793113, 2.75410793896325679, 2.69267987301638234, 2.63241541672313639, 1.83292687452193714, 3.45260758304984927, 1.73799170994024799, 3.29969130954135981, 2.36502841591371160, 2.31035489617511480, 0.40837194221183604, 0.35752532535340731, 2.24861531507661017, 4.19063470657489212, 0.29606867571101309, 1.51014393291685645, 0.28783452449924496, 0.22967471804223683, 0.16504461129776896, 0.08667590791381433, 0.15462700040214675, 1.40773147754101968, 12.71993593262945943, 1.31975254030565425, 2.79440226436921435, 2.73219046853971204, 0.74424009165729499, 0.70038048848413670, 1.81595007382795148, 3.42488960418100019, 7.82366643692622432, 1.13361943600530024, 0.64290197893284895, 0.59792696602397544, 0.55225922232983837, 0.50572703343888570, 6.94742840058194044, 1.03510939302049665, 6.38482568467242029, 0.94944545372309397, 3.29265173100799924, 3.21933085357639470, 1.05893013724329643, 1.01608924219568464, 3.13737905187117461, 6.48918165075643127, 0.96692217288844806, 2.21795719302568939, 5.47125766096112365, 5.30574273196214996, 5.15064838933435443, 5.00467930860447208, 5.12849442680663792, 0.66333852588875386, 4.84698154730584374, 0.57330284810649024, 3.89603823430926610, 3.80527221796898107, 1.37569778637969731, 1.33176905452441074, 2.58594377516024210, 4.90188690329335053, 0.59187870764581307, 1.78843899917010929, 7.24058320587654514};
    // run Temper chisquare::rvs (k, out_shape, memloc, seed)
    Tensor<float> result = stats::chisquare::rvs(k, out_shape, MemoryLocation::DEVICE, seed);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.rvs_random_test_dof_4
  * @brief Deterministic chisquare::rvs test on 100 outputs with k = 4 and seed = 123456789.
  *
  * The test is generated from the script, expecting values from numpy (reproducing C++ RNG).
  */
TEST(CHISQUARE, rvs_random_test_dof_4)
{
    Tensor<float> k({1});
    k = 4.00000000000000000;
    std::vector<uint64_t> out_shape = {100ull};
    uint64_t seed = 123456789ull;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{2.26706919494045156, 4.00051745028123484, 7.21198842397519790, 5.46660901660162768, 5.35206303485876589, 5.24148427424619179, 5.13456203259756006, 3.82839330977291903, 6.76408259827629532, 3.68403094083498273, 6.42438170983664492, 9.70799080878500398, 9.21228811470049713, 3.46007816362481080, 3.39297745638208381, 8.74123479605445652, 1.72007411841746238, 3.31706546717164663, 5.66744991855739944, 1.43924753357839075, 1.37974290872203564, 1.31943039174437571, 1.25816336208806545, 1.31042558883853322, 2.87610036854780038, 1.18642324000200539, 2.75575651376938380, 2.58745566517268255, 2.52923141411545815, 8.76035111517307463, 8.40756496443199453, 1.55926076209905617, 3.13642719012719384, 5.33709076703082541, 0.49908798531707516, 3.89251272787831359, 3.81861097170352748, 3.74598729848595813, 3.67457236202487758, 2.70811107805619322, 4.63392903590688565, 2.59042255351101769, 4.45692541113869289, 3.35555935609859235, 3.28986231464553969, 0.79955532700475052, 0.71975962673557792, 3.21546784323581036, 5.47877817337288331, 0.62043407914920823, 2.30460315018940021, 0.60684519465001185, 0.50856011245634314, 0.39326449621647064, 0.23932143945712772, 0.37388690538640201, 2.17437428683839240, 14.73521261858810760, 2.06150149674896976, 3.86615863955385830, 3.79271826604459106, 1.29187742205031775, 1.23012388099110415, 2.68712076475920414, 4.60190034946120097, 9.49742974699506171, 1.81921499753422555, 1.14824209787901554, 1.08333765425203055, 1.01659625472303472, 0.94762223374139243, 8.54306962731483210, 1.68876544977566723, 7.92625960670278396, 1.57386244071538783, 4.44875860638980836, 4.36359751264416484, 1.72046644643542579, 1.66337739018235720, 4.26819106324401165, 8.04093553519841642, 1.59742382514352377, 3.17844153495243731, 6.91648703444108470, 6.73228830287061175, 6.55929410904426380, 6.39611470899275414, 6.53455122312588088, 1.17748603057631529, 6.21940799375250908, 1.04746118943795041, 5.14326285604347611, 5.03945098839191097, 2.13338835160795570, 2.07697594020220055, 3.61938568376411052, 6.28098197803851210, 1.07454878621344130, 2.65305526781729428, 8.86316005995150924};
    // run Temper chisquare::rvs (k, out_shape, memloc, seed)
    Tensor<float> result = stats::chisquare::rvs(k, out_shape, MemoryLocation::DEVICE, seed);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.rvs_random_test_dof_5
  * @brief Deterministic chisquare::rvs test on 100 outputs with k = 5 and seed = 123456789.
  *
  * The test is generated from the script, expecting values from numpy (reproducing C++ RNG).
  */
TEST(CHISQUARE, rvs_random_test_dof_5)
{
    Tensor<float> k({1});
    k = 5.00000000000000000;
    std::vector<uint64_t> out_shape = {100ull};
    uint64_t seed = 123456789ull;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{3.08572832122757790, 5.08216021337934709, 8.62253365927855242, 6.71541287697858014, 6.58902160394483705, 6.46683698348706582, 6.34852778332819412, 4.88778483226872584, 8.13609193890945015, 4.72423606412861297, 7.76590466483796238, 11.30570603507497118, 10.77598938710210597, 4.46950091639577352, 4.39292097670943260, 10.27130113215915053, 2.42953383706360837, 4.30613480452363451, 6.93660562757968879, 2.08441449818612501, 2.01037181953897504, 1.93495298261862270, 1.85793335349035993, 1.92365928426631272, 3.79854853019130978, 1.76718809011909661, 3.65888779598159131, 3.46264765068673341, 3.39449018386261425, 10.29180876204652861, 9.91296930077757565, 2.23272749928914749, 4.09894724166076507, 6.57248785938243252, 0.85213240008572977, 4.96027050870135611, 4.87671784252892682, 4.79448725681199850, 4.71350297201492285, 3.60344559340468340, 5.79225660246515694, 3.46611690067866496, 5.59458603997059090, 4.35016307407910308, 4.27499507220590313, 1.26484020174151102, 1.15770585986805141, 4.18972476545687389, 6.72883011551438948, 1.02206941510613669, 3.13013312448209380, 1.00328968504202320, 0.86559367624783357, 0.69897948750580285, 0.46385836891817678, 0.67030664515662042, 2.97575786629469485, 16.61851056992683695, 2.84122596373185932, 4.93048905568215012, 4.84741412125031879, 1.90036815199624365, 1.82254005541214581, 3.57899265411090406, 5.75652906303857481, 11.08086221607979205, 2.54987988943616539, 1.71862938991421599, 1.63563497703454575, 1.54965827989221316, 1.46006822696341043, 10.05857649602245374, 2.39137827990102814, 9.39476418176480443, 2.25068472702319200, 5.58545215351834390, 5.49013328832151970, 2.43001149305628461, 2.36038281014479612, 5.38318454895207665, 9.51838055132542138, 2.27962249288291741, 4.14722409008551995, 8.30181262007918441, 8.10149211203521880, 7.91306164521297806, 7.73504862151555361, 7.88608686462986075, 1.75583864621769958, 7.54196677016818384, 1.58950201461670537, 6.35816140900332094, 6.24314708695116849, 2.92698866098136135, 2.85971202871858265, 4.65083610052853302, 7.60928438239190719, 1.62435097868666989, 3.53927081116387132, 10.40206125095606637};
    // run Temper chisquare::rvs (k, out_shape, memloc, seed)
    Tensor<float> result = stats::chisquare::rvs(k, out_shape, MemoryLocation::DEVICE, seed);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.rvs_random_test_dof_6
  * @brief Deterministic chisquare::rvs test on 100 outputs with k = 6 and seed = 123456789.
  *
  * The test is generated from the script, expecting values from numpy (reproducing C++ RNG).
  */
TEST(CHISQUARE, rvs_random_test_dof_6)
{
    Tensor<float> k({1});
    k = 6.00000000000000000;
    std::vector<uint64_t> out_shape = {100ull};
    uint64_t seed = 123456789ull;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{3.92540274857940297, 6.15607361194021241, 9.98936079928071763, 7.93800905815843993, 7.80107305520189076, 7.66855869336407814, 7.54011624470253317, 5.94191543975112690, 9.46850673479181282, 5.76130747319576564, 9.07111857567155866, 12.84022344860237830, 12.27995880550107621, 5.47919811564401371, 5.39418681106605113, 11.74509684952476896, 3.17123937310944726, 5.29772731062361668, 8.17732390465538117, 2.76804381454297177, 2.68081547198725190, 2.59167178637256557, 2.50031260269737388, 2.57829629994665854, 4.73083754054158057, 2.39222687038588067, 4.57396475693176541, 4.35281183502149638, 4.27579140164730465, 11.76685196325124849, 11.36466159557782341, 2.94196473551712012, 5.06691577352208800, 7.78314942181136527, 1.26430009359721085, 6.02183938026010956, 5.92970627483099477, 5.83893405208799532, 5.74944111008605141, 4.51157262482382926, 6.93435241481978437, 4.35672923491051289, 6.71830406752078080, 5.34667896219136551, 5.26308536822913187, 1.78334027664040184, 1.65061299970915454, 5.16813820977798599, 7.95253746028956332, 1.48070175753333766, 3.97595064800848341, 1.45699309200191185, 1.28160517789884576, 1.06507554965643192, 0.74837611275205518, 1.02724232716180519, 3.79997717280264746, 18.41100094748924221, 3.64604795760952527, 5.98901075257795856, 5.89736981450001707, 2.55068945112864665, 2.45821498871421618, 4.48403261001900155, 6.89533552386489568, 12.60254798466478299, 3.31066737228323138, 2.33417985488488666, 2.23460996588672556, 2.13095525306719757, 2.02235232606896176, 11.51932114987354794, 3.12691542356759467, 10.81341636516942550, 2.96295347568103562, 6.70831027744598529, 6.60395965689206221, 3.17179387899125853, 3.09086551049820280, 6.48674862175336919, 10.94503464166800200, 2.99674640542614767, 5.12076603439552436, 9.64611490695710394, 9.43140289520634134, 9.22919818423484806, 9.03795340317690510, 9.20023223734700579, 2.37867317505294773, 8.83026990405115875, 2.17905795167393013, 7.55057991150793750, 7.42559790515038021, 3.74424022796893929, 3.66723260321946176, 5.68012280788460355, 8.90270848668911974, 2.22103602028178004, 4.43926715829284202, 11.88377946695893250};
    // run Temper chisquare::rvs (k, out_shape, memloc, seed)
    Tensor<float> result = stats::chisquare::rvs(k, out_shape, MemoryLocation::DEVICE, seed);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.rvs_random_test_dof_7
  * @brief Deterministic chisquare::rvs test on 100 outputs with k = 7 and seed = 123456789.
  *
  * The test is generated from the script, expecting values from numpy (reproducing C++ RNG).
  */
TEST(CHISQUARE, rvs_random_test_dof_7)
{
    Tensor<float> k({1});
    k = 7.00000000000000000;
    std::vector<uint64_t> out_shape = {100ull};
    uint64_t seed = 123456789ull;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{4.78015901510358532, 7.22399979076846144, 11.32391602561624033, 9.14115199248750443, 8.99462026577044327, 8.85270703761015021, 8.71504560895568758, 6.99185739046067312, 10.77167660499572932, 6.79574073984671845, 10.34949530957704766, 14.32807611786544300, 13.73983700778292594, 6.48874305101044069, 6.39606521674306006, 13.17736554493456858, 3.93644465746484551, 6.29080925733286023, 9.39696112681784257, 3.47993906313919510, 3.38057695668628222, 3.27878984706441745, 3.17420533897775670, 3.26349534856706880, 5.66997066213002388, 3.05010373606807272, 5.49743070425349156, 5.25359119453579115, 5.16849657977307508, 13.20026170315008152, 12.77671876966336306, 3.67739147830120361, 6.03851174655764389, 8.97543192622627473, 1.72259560978024151, 7.07854336734859668, 6.97860988170794538, 6.88007243858091044, 6.78284408170709874, 5.42871093279833605, 8.06426786876299317, 5.25791681260007948, 7.83150922045044506, 6.34423808529894195, 6.25298238881357360, 2.34214287462746595, 2.18540188013307946, 6.14923448749374835, 9.15669163171498290, 1.98316699120843754, 4.83631030504997117, 1.95479304642627483, 1.74357176339833453, 1.47909324567582035, 1.08243361528675797, 1.43238953675816161, 4.64063087678206632, 20.13608614745350422, 4.46899036395508897, 7.04294459697666575, 6.94351636820868023, 3.23190914658202288, 3.12591858931454691, 5.39835995801946478, 8.02225993869665821, 14.07864721089583604, 4.09334747819268330, 2.98328197086664693, 2.86836287235630438, 2.74830768838196793, 2.62202823378461014, 12.93965450661519334, 3.88646784039416726, 12.19528193077712963, 3.70116317212097812, 7.82073359292826087, 7.70817136614003573, 3.93706957780526778, 3.84578438362437058, 7.58163032061211339, 12.33421004170736524, 3.73941203273343481, 6.09743151883763623, 10.96012412534946989, 10.73228986168240873, 10.51752917343696581, 10.31422598534123836, 10.48674844152073327, 3.03451228750468438, 10.09323901134082568, 2.80407653465955597, 8.72626438744608812, 8.59221494282825304, 4.57853337130304805, 4.49263984696292429, 6.70747864787700188, 10.17034288954970300, 2.85266627852677557, 5.34900159970332822, 13.32329530739986723};
    // run Temper chisquare::rvs (k, out_shape, memloc, seed)
    Tensor<float> result = stats::chisquare::rvs(k, out_shape, MemoryLocation::DEVICE, seed);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.rvs_random_test_dof_8
  * @brief Deterministic chisquare::rvs test on 100 outputs with k = 8 and seed = 123456789.
  *
  * The test is generated from the script, expecting values from numpy (reproducing C++ RNG).
  */
TEST(CHISQUARE, rvs_random_test_dof_8)
{
    Tensor<float> k({1});
    k = 8.00000000000000000;
    std::vector<uint64_t> out_shape = {100ull};
    uint64_t seed = 123456789ull;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{5.64640746874320865, 8.28714163347489929, 12.63340994812541496, 10.32914058694419168, 10.17374476154633456, 10.02315013435996072, 9.87697423321220747, 8.03839950168262263, 12.05212944958823762, 7.82796795239051857, 11.60701736564137043, 15.77966634574002569, 15.16546299326522274, 7.49799659776401484, 7.39824155908505432, 14.57738155649672684, 4.71973569592582276, 7.28486495909522080, 10.60018859948393199, 4.21370526247056976, 4.10305204198065709, 3.98949111936506684, 3.87258114641134332, 3.97240881353685982, 6.61420973355840669, 3.73353912877045868, 6.42719699713075165, 6.16239435306310490, 6.06983695833222203, 14.60133582432095167, 14.15799646326655115, 4.43303406237160313, 7.01273015772390362, 10.15338820983881973, 2.21796622251436615, 8.13132694240774434, 8.02419358386702086, 7.91848868037727183, 7.81412029358997895, 6.35263105375085946, 9.18463191005621837, 6.16709724853492069, 8.93644662118372146, 7.34242704137194657, 7.24409774898983283, 2.93273290836608735, 2.75335317454231454, 7.13222461597537283, 10.34561441478528465, 2.52054196101657180, 5.70774219598938171, 2.48774422580400412, 2.24244434107056634, 1.93204876087401978, 1.45778020498629868, 1.87680494561251665, 5.49383043203756216, 21.80856539688920748, 5.30579472655775142, 8.09317128914872441, 7.98655525951529910, 3.93711465266263305, 3.81852276686567116, 6.31968282014242355, 9.13986260348641366, 15.51932662305497068, 4.89284693172406016, 3.65852480785679379, 3.52926219759365045, 3.39386213929855618, 3.25102026296468294, 14.32860419129258744, 4.66451318602987541, 13.54858294249305040, 4.45939125311512008, 8.92494924833228964, 8.80480671342336763, 4.72042595087553973, 4.61952898585104510, 8.66965323988767267, 13.69428308945485817, 4.50177916859360217, 7.07633074100069326, 12.25060496239035679, 12.01063090991267046, 11.78425670477128406, 11.56980234572044530, 11.75179759540881363, 3.71604558495496651, 11.33651512670230943, 3.45680623953273924, 9.88889039070337716, 9.74646707870952511, 5.42584597141066727, 5.33172639672608639, 7.73317308547740367, 11.41793221473854913, 3.51158071072203315, 6.26608047464068552, 14.73003215036806424};
    // run Temper chisquare::rvs (k, out_shape, memloc, seed)
    Tensor<float> result = stats::chisquare::rvs(k, out_shape, MemoryLocation::DEVICE, seed);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.rvs_random_test_dof_9
  * @brief Deterministic chisquare::rvs test on 100 outputs with k = 9 and seed = 123456789.
  *
  * The test is generated from the script, expecting values from numpy (reproducing C++ RNG).
  */
TEST(CHISQUARE, rvs_random_test_dof_9)
{
    Tensor<float> k({1});
    k = 9.00000000000000000;
    std::vector<uint64_t> out_shape = {100ull};
    uint64_t seed = 123456789ull;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{6.52178637384625048, 9.34635894258263278, 13.92272358241861241, 11.50490287597755668, 11.34122920153900616, 11.18252796477151101, 11.02840189426681228, 9.08212495897923056, 13.31428720592636594, 8.85833388373371378, 12.84774050292750047, 17.20203434725034697, 16.56349413159789918, 8.50692149626359573, 8.40056111013930717, 15.95141930088703397, 5.51749512774788009, 8.27960506603733393, 11.79018350909626101, 4.96503271256938472, 4.84378085385109269, 4.71916254602534035, 4.59067055231566190, 4.70040069404377014, 7.56244505798747646, 4.43757972280128676, 7.36191800900991211, 7.07753649971513532, 6.97800780428640177, 15.97636466845710856, 15.51448563311014084, 5.20488222482739804, 7.98895370783796555, 11.31978174904191192, 2.74389091916033134, 9.18087728880613163, 9.06702459933992522, 8.95463060412928868, 8.84359868745547040, 7.28189244761536703, 10.29725663998701535, 7.08259180662680432, 10.03467206595241201, 8.34102497696719247, 8.23609340318225591, 3.54918388625083958, 3.34835625102077206, 8.11663613464173395, 11.52224914638721742, 3.08650740119769429, 6.58796607398777123, 3.04950128474447268, 2.77171462955998260, 2.41733236307642629, 1.86800721669265446, 2.35387657567974529, 6.35701031151253915, 23.43849997647263450, 6.15364242684041862, 9.14033540639664999, 9.02701131178129401, 4.66162265647488283, 4.53118625710125666, 7.24651856641675352, 10.24990977518045909, 16.93146622791222811, 5.70578539650250427, 4.35485704594618905, 4.21209014183695185, 4.06223028417238918, 3.90376543733216641, 15.69227754478568215, 5.45735840627250912, 14.87888218925634831, 5.23366354155391189, 10.02250103791774549, 9.89528339088308684, 5.51824658344075658, 5.40834459340310136, 9.75209170647660351, 15.03092074944573397, 5.27993169660749473, 8.05692365415363376, 13.52213848581190270, 13.27081438638179200, 13.03358391316423770, 12.80870703091051155, 12.99955600069100647, 4.41829680739672703, 12.56392498597942264, 4.13193747314772697, 11.04096919116549103, 10.89072746925367419, 6.28352122952270342, 6.18170865451648499, 8.75744216806763909, 12.64937265821295931, 4.19253900801512724, 7.18895248304025447, 16.11036541459134952};
    // run Temper chisquare::rvs (k, out_shape, memloc, seed)
    Tensor<float> result = stats::chisquare::rvs(k, out_shape, MemoryLocation::DEVICE, seed);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.rvs_random_test_dof_10
  * @brief Deterministic chisquare::rvs test on 100 outputs with k = 10 and seed = 123456789.
  *
  * The test is generated from the script, expecting values from numpy (reproducing C++ RNG).
  */
TEST(CHISQUARE, rvs_random_test_dof_10)
{
    Tensor<float> k({1});
    k = 10.00000000000000000;
    std::vector<uint64_t> out_shape = {100ull};
    uint64_t seed = 123456789ull;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{7.40464554056565039, 10.40228726785287350, 15.19533925761637683, 12.67053615737658845, 12.49906803415042766, 12.33273406051200993, 12.17112297798482601, 10.12347385408584088, 14.56130596293959911, 9.88711012080148599, 14.07456091379308560, 18.60020431661979501, 17.93868021837737459, 9.51551919912163413, 9.40294222169746696, 17.30395456457650383, 6.32716754592437880, 9.27485266661106600, 12.96921948566127369, 5.73085850960892884, 5.59958921040621238, 5.46451588178475500, 5.32506818719634989, 5.44416560800031402, 8.51391836883748887, 5.15868150690576677, 8.30066792249376029, 7.99785056957875362, 7.89175663836155916, 17.32983540765647135, 16.85045953163557897, 5.99009355538464483, 8.96677327229139465, 12.47659342292964979, 3.29551893034677157, 10.22770798832846495, 10.10753173577027830, 9.98884263871993205, 9.87153965931747379, 8.21550183563053515, 11.40345039522429360, 8.00323774697210943, 11.12731280463289885, 9.33990345495386087, 9.22875797313216673, 4.18718895591073359, 3.96594945970744783, 9.10216250297274776, 12.68870395191978240, 3.67641634933580175, 7.47539004680555319, 3.63539289618651829, 3.32654638808066538, 2.92995717349599527, 2.30810445773927464, 2.85859972251855998, 7.22837433705070875, 25.03309845988416882, 7.01055555388710250, 10.18492042376065143, 10.06528337187133459, 5.40209239202660640, 5.26044968675679314, 8.17784399083755709, 11.35367739827809608, 18.31997533455134430, 6.52977956605113885, 5.06866028746838815, 4.91310102985914643, 4.74953469902304004, 4.57624961543869979, 17.03503094811733476, 6.26239298024615643, 16.19014743170145820, 6.02116408811281190, 11.11450773234211020, 10.98063108166919832, 6.32797675678907634, 6.20957572320878715, 10.82987412253103621, 16.34816506331081953, 6.07109619631191144, 9.03885585460548846, 14.77799381573962201, 14.51597252721840547, 14.26851155882982702, 14.03381409250011913, 14.23300537532336563, 5.13770456692864208, 13.77820236528349973, 4.82565382987450597, 12.18430330130751749, 12.02670097714998221, 7.14969748732063159, 7.04063388651256439, 9.78048062040608279, 13.86744724470765355, 4.89177818993998592, 8.11654557701158907, 17.46884311121541700};
    // run Temper chisquare::rvs (k, out_shape, memloc, seed)
    Tensor<float> result = stats::chisquare::rvs(k, out_shape, MemoryLocation::DEVICE, seed);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.rvs_random_test_dof_11
  * @brief Deterministic chisquare::rvs test on 100 outputs with k = 11 and seed = 123456789.
  *
  * The test is generated from the script, expecting values from numpy (reproducing C++ RNG).
  */
TEST(CHISQUARE, rvs_random_test_dof_11)
{
    Tensor<float> k({1});
    k = 11.00000000000000000;
    std::vector<uint64_t> out_shape = {100ull};
    uint64_t seed = 123456789ull;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{8.29377871164287583, 11.45541032647805046, 16.45384303477905519, 13.82760211800139771, 13.64874703154076130, 13.47517972070840564, 13.30647563086080609, 11.16278581021527039, 15.79553008538497139, 10.91451204365122152, 15.28963061556945213, 19.97790916469793387, 19.29454944613558709, 10.52380584880069669, 10.40533972529244089, 18.63831139760654665, 7.14686971211105604, 10.27049229387212392, 14.13898840911238075, 6.50891537918118868, 6.36812499303099955, 6.22311174667769151, 6.07324472347380073, 6.20125103765252828, 9.46808475074067779, 5.89420817047551715, 9.24277786426110382, 8.92248901261522320, 8.81017258607241693, 18.66508056900099177, 18.16909149151326019, 6.78656816428443310, 9.94590195015081235, 13.62529898913777338, 3.86913913655545372, 11.27221284413641911, 11.14604629697275051, 11.02139387535195958, 10.89815033701263403, 9.15274040498244901, 12.50419285744444942, 8.92819072506636147, 12.21521501358387418, 10.33898278151944261, 10.22195055351056325, 4.84350789221002653, 4.60276467089612851, 10.08859256820958272, 13.84654851122094676, 4.28674275474697897, 8.36885121579956426, 4.24187169338330783, 3.90324237263971074, 3.46606933921834148, 2.77410232751984775, 3.38709791254269055, 8.10660756887335943, 26.59773528070270388, 7.87508364581346942, 11.22729794882510745, 11.10168065406213422, 6.15604419068826569, 6.00374212594246437, 9.11291812047018546, 12.45212127213100395, 19.68850110670846121, 7.36307556473402869, 5.79724056533863585, 5.62950177150781350, 5.45287897241441843, 5.26546825353105241, 18.36009957727882380, 7.07769216014476754, 17.48532493452239933, 6.81981303166972097, 12.20180925710109854, 12.06162403774681735, 7.14773375070811756, 7.02126373217555422, 11.90370008033491978, 17.64901747926349174, 6.87322497289363632, 10.02188085039069776, 16.02059902394716318, 15.74843203687042248, 15.49126902896163038, 15.24725916918083790, 15.45436101515031879, 5.87161910133351661, 14.98137916068219511, 5.53510684888392213, 13.32023686319350553, 13.15565970670411211, 8.02301100587575888, 7.90707042227560830, 10.80244714155667474, 15.07422428769640987, 5.60649163911438553, 9.04808260968335354, 18.80884307231151809};
    // run Temper chisquare::rvs (k, out_shape, memloc, seed)
    Tensor<float> result = stats::chisquare::rvs(k, out_shape, MemoryLocation::DEVICE, seed);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.rvs_random_test_dof_12
  * @brief Deterministic chisquare::rvs test on 100 outputs with k = 12 and seed = 123456789.
  *
  * The test is generated from the script, expecting values from numpy (reproducing C++ RNG).
  */
TEST(CHISQUARE, rvs_random_test_dof_12)
{
    Tensor<float> k({1});
    k = 12.00000000000000000;
    std::vector<uint64_t> out_shape = {100ull};
    uint64_t seed = 123456789ull;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{9.18827265426019757, 12.50610554104977901, 17.70021701646450651, 14.97729997432850091, 14.79140749040147540, 14.61094943208563990, 14.43548854575063167, 12.20032843859251059, 17.01875669553366421, 11.94071257048596202, 16.49459964583035188, 21.33801165488531382, 20.63380697782092099, 11.53180248069219616, 11.40772790685192817, 19.95703798935052120, 7.97516691981686154, 11.26644462341554132, 15.30078885359335317, 7.29747019400138619, 7.14758877909226786, 6.99308236628630020, 6.83326173419575333, 6.96977890197208971, 10.42453712639060370, 6.64213696224051553, 10.18774604572185716, 9.85081340779444403, 9.73256876624915712, 19.98465485668005570, 19.47281392159202085, 7.59270329770782570, 10.92612963754783983, 14.76703210446350134, 4.46184336790327585, 12.31470075802579167, 12.18282955381062038, 12.05249817009918978, 11.92359734879313216, 10.09306819309591674, 13.60023942071982894, 9.85681477243026904, 13.29903233318612088, 11.33821091432751693, 11.21557241806268657, 5.51563322613865026, 5.25618875282535036, 11.07577401949301432, 14.99698813970066702, 4.91474042157875157, 9.26746960874684333, 4.86617322761378990, 4.49890689875877925, 4.02262615431972836, 3.26280872238329556, 3.93630539753057374, 8.99071334310606396, 28.13654463477962508, 8.74612587169471745, 12.26775996830694915, 12.13644759417625885, 6.92157865779404524, 6.75909239619873770, 10.05118405002655102, 13.54597858744957151, 21.03984027316353078, 8.20433871086244082, 6.53852953792451608, 6.35914537955135639, 6.17003373634257901, 5.96910525288054039, 19.66996333768370775, 7.90178909663654849, 18.76667284468286567, 7.62802318475228347, 13.28505448865081995, 13.13886108553341892, 7.97608325977097898, 7.84191550597448295, 12.97411151011749020, 18.93577847618953314, 7.68475582473430929, 11.00581936985913778, 17.25181527630739353, 16.96997652856785166, 16.70356551168610437, 16.45067977892400890, 16.66532133396682980, 6.61800703240372101, 16.17501360755766626, 6.25810544957260539, 14.44980314221516160, 14.27858198705656712, 8.90242763036165030, 8.77993188406912850, 11.82347144537540551, 16.27128985035091091, 6.33452160740941572, 9.98297901398048992, 20.13295482519693635};
    // run Temper chisquare::rvs (k, out_shape, memloc, seed)
    Tensor<float> result = stats::chisquare::rvs(k, out_shape, MemoryLocation::DEVICE, seed);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.rvs_random_test_dof_13
  * @brief Deterministic chisquare::rvs test on 100 outputs with k = 13 and seed = 123456789.
  *
  * The test is generated from the script, expecting values from numpy (reproducing C++ RNG).
  */
TEST(CHISQUARE, rvs_random_test_dof_13)
{
    Tensor<float> k({1});
    k = 13.00000000000000000;
    std::vector<uint64_t> out_shape = {100ull};
    uint64_t seed = 123456789ull;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{10.08741632436563940, 13.55467367919469091, 18.93601968468304264, 16.12057392112948051, 15.92794822516310482, 15.74089750496653828, 15.55897233087862652, 13.23631656017346891, 18.23239895639228791, 12.96585240335198641, 17.69076570373643520, 22.68276407243132908, 21.95858067063326402, 12.53953089567757573, 12.41009196316898411, 21.26213838706649994, 8.81093658655648859, 12.26265287133300141, 16.45564287827909311, 8.09516326896980587, 7.93656798714136524, 7.77296052011345751, 7.60359540138012591, 7.74827373199110614, 11.38296190723022150, 7.40087633861552163, 11.13518460411910560, 10.78232867416831198, 10.65841204801982478, 21.29056745402288087, 20.76353962466349756, 8.40724304109446408, 11.90729711579121819, 15.90268559797893388, 5.07130559231192102, 13.35541886856733562, 13.21809136464377410, 13.08232826902957768, 12.94801647313507864, 11.03606739003743265, 14.69218669579480441, 10.78861673347930328, 14.37928172229196555, 12.33755243393025047, 12.20955158849773881, 6.20157882541460381, 5.92414775756450318, 12.06359291011165880, 16.14097181108408563, 5.55822328535471666, 10.17056034589204394, 5.50609588649389448, 5.11122491447572092, 4.59717992984665269, 3.77161957468688103, 4.50375274916580803, 9.87991494820015248, 29.65278786403731814, 9.62282345043904996, 13.30654038164895425, 13.16978087368963557, 7.69720325855896270, 7.52495039885223171, 10.99221067607559910, 14.63583170483934737, 22.37619296832009752, 9.05252559090096653, 7.29089895760047302, 7.10034012927097002, 6.89924053082741029, 6.68533158587161136, 20.96657245574509076, 8.73353573755675683, 20.03596674680188272, 8.44455100233784606, 14.36475665689976111, 14.21281627940548375, 8.81190301919954067, 8.67036216920888059, 14.04153793380586634, 20.21025695966550018, 8.50446505291263932, 11.99053634766304377, 18.47310603401275131, 18.18200855748773392, 17.90674513172881177, 17.64536379604609806, 17.86722199919426401, 7.37526826675428993, 17.36033137391199332, 6.99292222098821004, 15.57381632794879600, 15.39623898240921207, 9.78714112231160271, 9.65837088372312458, 12.84366041417870363, 17.45989143259522791, 7.07416766770594219, 10.92078197977479448, 21.44321501006591291};
    // run Temper chisquare::rvs (k, out_shape, memloc, seed)
    Tensor<float> result = stats::chisquare::rvs(k, out_shape, MemoryLocation::DEVICE, seed);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.rvs_random_test_dof_14
  * @brief Deterministic chisquare::rvs test on 100 outputs with k = 14 and seed = 123456789.
  *
  * The test is generated from the script, expecting values from numpy (reproducing C++ RNG).
  */
TEST(CHISQUARE, rvs_random_test_dof_14)
{
    Tensor<float> k({1});
    k = 14.00000000000000000;
    std::vector<uint64_t> out_shape = {100ull};
    uint64_t seed = 123456789ull;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{10.99064327636957117, 14.60135878105575458, 20.16250252412677213, 17.25818291830255902, 17.05909185635017167, 16.86571092683022144, 16.67757898702620167, 14.27092545750592478, 19.43759171714697587, 13.99004752675000773, 18.87917102375533318, 24.01397612209214572, 23.27057993164168792, 13.54701194182318424, 13.41242345036921613, 22.55522228390973183, 9.65328086376026917, 13.25907499634842068, 17.60437180688935399, 8.90090479823357583, 8.73392984398917349, 8.56156898706357872, 8.38302238688391554, 8.53555159053028767, 12.34311143462129401, 8.16914766487734845, 12.08478636994282063, 11.71664169166309932, 11.58727879464303889, 22.58443218902544203, 22.04280485969713155, 9.22918171943135057, 12.88928034866855299, 17.03297729765734303, 5.69563252396958486, 14.39456831273701098, 14.25200304185206335, 14.11102579357657660, 13.97151975534574930, 11.98140682496150333, 15.78051541325978668, 11.72320503210194786, 15.45638017952530241, 13.33698239756705561, 13.20383386254004421, 6.89974051464581173, 6.60496392412041278, 13.05196144529267777, 17.27926231242079069, 6.21541868612494230, 11.07757799711621871, 6.15985374619129544, 5.73831271201184467, 5.18772926783728394, 4.29838208054755011, 5.08741872572633991, 10.77359317003168115, 31.14909171916982800, 10.50449116718371201, 14.34382973443568510, 14.20184126317188777, 8.48172015514607303, 8.30007135327760537, 11.93565617229375242, 15.72214995239287383, 23.69932684895954011, 9.90680225749744636, 8.05304016572318027, 7.85172533569516506, 7.63908381994329666, 7.41267352067778695, 22.25149330400175174, 9.57201365801202897, 21.29463254492194935, 9.26840082481655969, 15.44132977698518516, 15.28387229130391844, 9.65429543703290705, 9.50566846730703041, 15.10632639558057733, 21.47390562294735616, 9.33137306144220879, 12.97592708363433367, 19.68564650678951011, 19.38565446208382426, 19.10188735604926435, 18.83234557665099373, 19.06113569459983381, 8.14211717958126968, 18.53831694151326204, 7.73816716785918768, 16.69293128815795768, 16.50925111907967491, 10.67650852888328039, 10.54171137231736388, 13.86310297391225888, 18.64103101858072620, 7.82406199172644889, 11.86113227978870199, 22.74125956169450191};
    // run Temper chisquare::rvs (k, out_shape, memloc, seed)
    Tensor<float> result = stats::chisquare::rvs(k, out_shape, MemoryLocation::DEVICE, seed);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.rvs_random_test_dof_15
  * @brief Deterministic chisquare::rvs test on 100 outputs with k = 15 and seed = 123456789.
  *
  * The test is generated from the script, expecting values from numpy (reproducing C++ RNG).
  */
TEST(CHISQUARE, rvs_random_test_dof_15)
{
    Tensor<float> k({1});
    k = 15.00000000000000000;
    std::vector<uint64_t> out_shape = {100ull};
    uint64_t seed = 123456789ull;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{11.89749357361313642, 15.64636195293215692, 21.38068841581930357, 18.39074775398749040, 18.18542953759000724, 17.98595179613796091, 17.79184208753669694, 15.30430021453425837, 20.63526255227895234, 15.01339470823703870, 20.06066754360438509, 25.33312779616124644, 24.57120248963656550, 14.55426486227368876, 14.41471773980458337, 23.83760568510669842, 10.50146835047471505, 14.25567898736193762, 18.74764729346889780, 9.71380545820427521, 9.53874958203644852, 9.35794629105472886, 9.17054307723878637, 9.33064545080830676, 13.30478605341006038, 8.94590552472089939, 13.03630314029162562, 12.65343411148681163, 12.51882574259919778, 23.86756845457509968, 23.31186548395738711, 10.05769930219518749, 13.87198048751468882, 18.15849444909439825, 6.33325966754144432, 15.43231524027749479, 15.28470643452545019, 15.13870840068586077, 14.99420075321840429, 12.92881871072224875, 16.86561954391506291, 12.66026257990294823, 16.53066973968103426, 14.33648272998573248, 14.19837731711846907, 7.60880099525366038, 7.29725774877041999, 14.04081032030032006, 18.41248355307539342, 6.88486627900175474, 11.98807980428087205, 6.82597509580353279, 6.37861413932655896, 5.79261423959793120, 4.84129488431341404, 5.68562555531157798, 11.67124492198982111, 32.62760897885556233, 11.39057193042953564, 15.37978554672963405, 15.23276202231328114, 9.27415082866595775, 9.08343789496925602, 12.88124405615705292, 16.80531800848417134, 25.01068741220726110, 10.76648975234079586, 8.82388283986924016, 8.61218745089829518, 8.38840438163309798, 8.14992324722307337, 23.52600640120290976, 10.41647455810508660, 22.54383576405450285, 10.09876086201817458, 16.51511345253785024, 16.35234318465850123, 10.50252932302621289, 10.34707227374646621, 16.16876192840350868, 22.72791191360288821, 10.16468127318077030, 13.96190849222355190, 20.89039724212645055, 20.58183486479246582, 20.28987452525190349, 20.01247062593511217, 20.24793922143132718, 8.91750255842791439, 19.70977509972890829, 8.49270234946580693, 17.80768393356688151, 17.61812622973128484, 11.57000734398997110, 11.42940376082110276, 14.88187384379374301, 19.81552768499254569, 8.58308508951236071, 12.80373923027449301, 24.02842598668057761};
    // run Temper chisquare::rvs (k, out_shape, memloc, seed)
    Tensor<float> result = stats::chisquare::rvs(k, out_shape, MemoryLocation::DEVICE, seed);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.rvs_random_test_dof_16
  * @brief Deterministic chisquare::rvs test on 100 outputs with k = 16 and seed = 123456789.
  *
  * The test is generated from the script, expecting values from numpy (reproducing C++ RNG).
  */
TEST(CHISQUARE, rvs_random_test_dof_16)
{
    Tensor<float> k({1});
    k = 16.00000000000000000;
    std::vector<uint64_t> out_shape = {100ull};
    uint64_t seed = 123456789ull;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{12.80758769662278063, 16.68985116461956508, 22.59142606525855257, 19.51878380197144125, 19.30745209972330301, 19.10208688303990243, 18.90220478301869278, 16.33656244084246723, 21.82618109593208189, 16.03597557327823608, 21.23596217552508847, 26.64144775497718953, 25.86160852985015168, 15.56130712304480745, 15.41697253947438817, 25.11038079499832776, 11.35489389056909282, 15.25243988742478507, 19.88602684465412906, 10.53312835876574383, 10.35026067963934260, 10.16129519219421340, 9.96532828400526327, 10.13275342524491585, 14.26782200226766406, 9.73028230874687772, 13.98953093904031775, 13.59244383172794457, 13.45277013807279864, 25.14107127214408877, 24.57176369559157791, 10.89211675554840753, 14.85531724576490653, 19.27972464673753095, 6.98287714553479866, 16.46879869341193370, 16.31632047528804463, 16.16547500295461859, 16.01613843593172248, 13.87808284542357384, 17.94782667060071546, 13.59952831962127107, 17.60243500012628459, 15.33604000936938760, 15.19314879059670709, 8.32766306263489398, 7.99987898634524441, 15.03008370703606289, 19.54115349194901086, 7.56534646941415545, 12.90170050161828108, 7.50323054544538159, 7.03082660020313188, 6.41044084924189583, 5.39883422111506128, 6.29696330060390785, 12.57245487049799948, 34.09013027941461615, 12.28060555908483131, 16.41453971942400258, 16.26265497567678864, 10.07368376660891052, 9.87420595218833697, 13.82874692094231861, 17.88565576467431839, 26.31147459941468369, 11.63102657685408658, 9.60253845326319855, 9.38080159907862843, 9.14623886239695594, 8.89607639179974541, 24.79117444599004472, 11.26629920516869632, 23.78454354263930881, 10.93495895443148136, 17.58639026883104250, 17.41849040742883759, 11.35599969653845953, 11.19394283525865319, 17.22908195514416008, 23.97326118174127174, 11.00372854880498430, 14.94841333692738949, 22.08815522531658360, 21.77131363368140882, 21.47143876014480313, 21.18644052312613013, 21.42836010723478068, 9.70055192765637209, 20.87537367552733159, 9.25558234993236972, 18.91851935011742825, 18.72328615278173203, 12.46720611066072593, 12.32099410014950891, 15.90003640268594864, 20.98406110179396578, 9.35030708366223529, 13.74836365680586781, 25.30582437084938974};
    // run Temper chisquare::rvs (k, out_shape, memloc, seed)
    Tensor<float> result = stats::chisquare::rvs(k, out_shape, MemoryLocation::DEVICE, seed);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.rvs_random_test_dof_17
  * @brief Deterministic chisquare::rvs test on 100 outputs with k = 17 and seed = 123456789.
  *
  * The test is generated from the script, expecting values from numpy (reproducing C++ RNG).
  */
TEST(CHISQUARE, rvs_random_test_dof_17)
{
    Tensor<float> k({1});
    k = 17.00000000000000000;
    std::vector<uint64_t> out_shape = {100ull};
    uint64_t seed = 123456789ull;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{13.72060813317272476, 17.73196836866226889, 23.79542884332587960, 20.64272444382620009, 20.42557232669360090, 20.21450878041489574, 20.00903984714415174, 17.36781520934393086, 23.01099425429696055, 17.05785966195532311, 22.40564912642851070, 27.93996927787942042, 27.14277360550403628, 16.56815445382272856, 16.41918700693785027, 26.37446589082068016, 12.21305004299577845, 16.24933784289920169, 21.01997920666355313, 11.35825483816090475, 11.16781941149582558, 10.97094596153383783, 10.76668120872176360, 10.94120184856968159, 15.23208296981572296, 10.52154862911402233, 14.94429970120310713, 14.53345198634416136, 14.38887577154517849, 26.40586129184578468, 25.82337566045815080, 11.73186430312382278, 15.83922435485257019, 20.39707795853558991, 7.64337558844297771, 17.50413636481452073, 17.34694599203328025, 17.19140963848629866, 17.03740011582853597, 14.82901554309849068, 19.02741261395747685, 14.54078426244403133, 18.67191572655058707, 16.33564405779126716, 16.18812154704665218, 9.05540150176148906, 8.71185682378538573, 16.01973585560058666, 20.66570768028049088, 8.25582853403268224, 13.81813455735075635, 8.19058087847003513, 7.69384710159325369, 7.04002549049128845, 5.96969847010847143, 6.92023414104590451, 13.47687539335779583, 35.53816413374369176, 13.17420670938196103, 17.44820395617347231, 17.29161499000165492, 10.87963715024861244, 10.67166610701687723, 14.77797503204719298, 18.96343259016514793, 27.60269747491737391, 12.49994208681615504, 10.38825985773666716, 10.15678973670092766, 9.91177646508952570, 9.65028717772567290, 26.04789086612630555, 12.12096828773164603, 25.01756886784436418, 11.77643112990802443, 18.65539830393738185, 18.48253430936577502, 12.21419926448940529, 12.04575112300780582, 18.28748667581605147, 25.21078174021773322, 11.84796021911915886, 15.93538629732135625, 23.27959034926747250, 22.95473282944670146, 22.64719544572187004, 22.35484499517544066, 22.60300987791286786, 10.49053176880923388, 22.03567404552599385, 10.02601164785919607, 20.02581193536454052, 19.82508578012107137, 13.36774364746468535, 13.21610228952495447, 16.91764488773560515, 22.14720259258569612, 10.12494567605098794, 14.69480594490422121, 26.57438805399014470};
    // run Temper chisquare::rvs (k, out_shape, memloc, seed)
    Tensor<float> result = stats::chisquare::rvs(k, out_shape, MemoryLocation::DEVICE, seed);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.rvs_random_test_dof_18
  * @brief Deterministic chisquare::rvs test on 100 outputs with k = 18 and seed = 123456789.
  *
  * The test is generated from the script, expecting values from numpy (reproducing C++ RNG).
  */
TEST(CHISQUARE, rvs_random_test_dof_18)
{
    Tensor<float> k({1});
    k = 18.00000000000000000;
    std::vector<uint64_t> out_shape = {100ull};
    uint64_t seed = 123456789ull;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{14.63628605583169495, 18.77283477896726893, 24.99330316575903765, 21.76293820921145894, 21.54014126137534291, 21.32355139090671514, 21.11266435926020080, 18.39814674802059713, 24.19025193734855250, 18.07910675236172082, 23.57023352052489784, 29.22957115906194048, 28.41552730602607468, 17.57482097703007184, 17.42136120313991299, 27.63064176644644476, 13.07550633584860655, 17.24635678308321474, 22.14990293630094698, 12.18865952427297650, 11.99087898631790239, 11.78632957008127491, 11.57400965554684014, 11.75541832412563359, 16.19745404578392467, 11.31908437313691884, 15.90046585980157623, 15.47627356616031591, 15.32694290229414591, 27.66272132860655120, 27.06744631168343673, 12.57645831253672597, 16.82364635597769364, 21.51090312167179519, 8.31380587590038012, 18.53842888603671213, 18.37666930803965926, 18.21658438583609652, 18.05804368092422862, 15.78146167103842501, 20.10461217129555678, 15.48384614426508143, 19.73931612237281996, 17.33528701480748424, 17.18327367572637243, 9.79122766881060613, 9.43236311693491913, 17.00972872017955595, 21.78651648980055811, 8.95543222110826775, 14.73712332762551291, 8.88713843368971190, 8.36673213073181898, 7.68035335346760828, 6.55276593550546771, 7.55441058677730926, 14.38421206357962845, 36.97299554814000544, 14.07104887108265423, 18.48087380738109076, 18.31972333104082296, 11.69143160612732224, 11.47521535697749862, 15.72876812048776252, 20.03887780782405770, 28.88521418922723072, 13.37283716234241204, 11.18041171381650045, 10.93949001275846022, 10.68432719729658409, 10.41183551427711151, 27.29691529289078389, 12.98004121557563550, 26.24360289523267298, 12.62269870882140665, 19.72234032932656689, 19.54466261964189755, 13.07669768108595321, 12.90204826205484245, 19.34414672324067297, 26.44117778727573409, 12.69690554146689543, 16.92278120579294765, 24.46527206355935036, 24.13263824357362353, 23.81766770236003694, 23.51818535971880308, 23.77240837439233445, 11.28681842866349783, 23.19115344066325690, 10.80331338026930688, 21.12988014702380468, 20.92382701336848072, 14.27131399655419663, 14.11440627889239785, 17.93474609350403881, 23.30543783890897913, 10.90633536231938194, 15.64289743553581147, 27.83491065993186808};
    // run Temper chisquare::rvs (k, out_shape, memloc, seed)
    Tensor<float> result = stats::chisquare::rvs(k, out_shape, MemoryLocation::DEVICE, seed);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.rvs_random_test_dof_19
  * @brief Deterministic chisquare::rvs test on 100 outputs with k = 19 and seed = 123456789.
  *
  * The test is generated from the script, expecting values from numpy (reproducing C++ RNG).
  */
TEST(CHISQUARE, rvs_random_test_dof_19)
{
    Tensor<float> k({1});
    k = 19.00000000000000000;
    std::vector<uint64_t> out_shape = {100ull};
    uint64_t seed = 123456789ull;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{15.55439146802688377, 19.81255485542605044, 26.18556965846439510, 22.87974157511769846, 22.65146038437020692, 22.42950149700595830, 22.21335067650184669, 19.42763324560856830, 25.36442625139130058, 19.09976864964040644, 24.73014902133075665, 30.51100821949190589, 29.68058210263155416, 18.58131936630766390, 18.42349574906183562, 28.87957891530901477, 13.94189385808425286, 18.24348350142837205, 23.27614026413342074, 13.02389177065021109, 12.81897028506069880, 12.60695770908941427, 12.38680531120916228, 12.57491163604365347, 17.16383728598864167, 12.12235710225993834, 16.85790689556048605, 16.42075050479998666, 16.26680082546269546, 28.91232361415090679, 28.30461530446498841, 13.42548410736807085, 17.80853627786219207, 22.62149963950795595, 8.99334865354963853, 19.57176307649603331, 19.40556497958472448, 19.24106159256679760, 19.07811931641468561, 16.73528879040986794, 21.17962715787945172, 16.42855653788045700, 20.80481177822128913, 18.33496271150337620, 18.17858696406003105, 10.53446290677960029, 10.16068474813344125, 18.00003025695120940, 22.90389797729783083, 9.66339880051725153, 15.65844555803245264, 9.59213797884436836, 9.04866728692395483, 8.33054676185910736, 7.14706226495368124, 8.19860362987426150, 15.29421290433615610, 38.39572984499113772, 14.97085251097604974, 19.51263173758429659, 19.34705022042929201, 12.50856989477653514, 12.28433605245585625, 16.68098934198133421, 21.11218854016950885, 30.15976179312826844, 14.24936986171334219, 11.97844841471186861, 11.72833387581184361, 11.46329812632571254, 11.18010235937416219, 28.53890001987013392, 13.84314037056396174, 27.46323905244063113, 13.47335128063555132, 20.78739070822274826, 20.60503680807920901, 13.94312614379838777, 13.76244950379099485, 20.39920891361047239, 27.66505396018791174, 13.55016094060126974, 17.91055905613266930, 25.64568925031509750, 25.30549844670346005, 24.98330463961656278, 24.67689201332854410, 24.93700189135909540, 12.08887640740015179, 24.34222158717056317, 11.58690599309351121, 22.23099752409526175, 22.01976919609913352, 15.17765527843979356, 15.01563036655106487, 18.95138069716060514, 24.45918381865805102, 11.69390442738907865, 16.59249408784855007, 29.08807371759235139};
    // run Temper chisquare::rvs (k, out_shape, memloc, seed)
    Tensor<float> result = stats::chisquare::rvs(k, out_shape, MemoryLocation::DEVICE, seed);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.rvs_random_test_dof_20
  * @brief Deterministic chisquare::rvs test on 100 outputs with k = 20 and seed = 123456789.
  *
  * The test is generated from the script, expecting values from numpy (reproducing C++ RNG).
  */
TEST(CHISQUARE, rvs_random_test_dof_20)
{
    Tensor<float> k({1});
    k = 20.00000000000000000;
    std::vector<uint64_t> out_shape = {100ull};
    uint64_t seed = 123456789ull;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{16.47472577516187542, 20.85121936023310241, 27.37267922898019989, 23.99340869466418269, 23.75979087290627234, 23.53260755898516976, 23.31133477894435657, 20.45634101571081231, 26.53392607359498712, 20.11989058067124958, 25.88577121511125867, 31.78493448494068119, 30.93855525741563639, 19.58766100701820889, 19.42559160633626902, 30.12185817426479773, 14.81189360174827385, 19.24070700051473537, 24.39898762919465369, 13.86356158400572269, 13.65168725276425832, 13.43240762999205096, 13.20462801489651561, 13.39925650599242424, 18.13114839415635515, 12.93090564224748995, 17.81651724928354952, 17.36674648120977693, 17.20830228100543025, 30.15525049339920471, 29.53543672592509850, 14.27858294896208058, 18.79385391902357583, 23.72912697849639585, 9.68129088734259824, 20.60421444307945293, 20.43369790854068313, 20.26489560258072231, 20.09767084825354289, 17.69038275852451747, 22.25263253338205161, 17.37477967543248170, 21.86855497203750076, 19.33466623716356736, 19.17404608495299101, 11.28451824963851635, 10.89620249098173055, 18.99061317597526966, 24.01812766289265610, 10.37906887860607164, 16.58191022471411813, 10.30491438224359158, 9.73894393201013031, 8.98984070964622362, 7.75173498774481029, 8.85203811202914004, 16.20666028294188266, 39.80732601526087677, 15.87337612167318568, 20.54354948762265565, 20.37365681148981622, 13.33062149547280661, 13.09857990250536375, 17.63452074158806582, 22.18353568800434772, 31.42697888419225549, 15.12924457400312050, 12.78189730935468660, 12.52282866429838570, 12.24817530769057150, 11.95455095253696420, 29.77441009604908473, 14.70993918854228610, 28.67699134205913225, 14.32803381165498813, 21.85070065701665953, 21.66379694004927714, 14.81316573883493604, 14.62662209515559653, 21.45280063923697966, 28.88293398004700308, 14.40737731863364601, 18.89868653634322015, 26.82126531713739936, 26.47371925380241819, 26.14449521875691573, 25.83133771354041031, 26.09717695252845360, 12.89624186319118593, 25.48923334625769144, 12.37628547711398497, 23.32940106912551315, 23.11313705022985587, 16.08654128174390507, 15.91953636520044491, 19.96758430210219615, 25.60880167124538431, 12.48715744926305504, 17.54347171911940961, 30.33446763815445024};
    // run Temper chisquare::rvs (k, out_shape, memloc, seed)
    Tensor<float> result = stats::chisquare::rvs(k, out_shape, MemoryLocation::DEVICE, seed);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.rvs_k_scalar_out_vec
  * @brief Verify rvs broadcasting: rvs k scalar out vec (seed=11111)
  */
TEST(CHISQUARE, rvs_k_scalar_out_vec)
{
    Tensor<float> k({1});
    k = 3.00000000000000000;
    std::vector<uint64_t> out_shape = {4ull};
    uint64_t seed = 11111ull;
    Tensor<float> expected_result({4});
    expected_result = std::vector<float>{0.43401299416812483, 4.48129281355700737, 2.39374496440946816, 3.09492015573262691};
    Tensor<float> result = stats::chisquare::rvs(k, out_shape, MemoryLocation::DEVICE, seed);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
}

/**
  * @test CHISQUARE.rvs_k_vector_out_vec
  * @brief Verify rvs broadcasting: rvs k vector out vec (seed=22222)
  */
TEST(CHISQUARE, rvs_k_vector_out_vec)
{
    Tensor<float> k({3});
    k = std::vector<float>{2.00000000000000000, 3.00000000000000000, 4.00000000000000000};
    std::vector<uint64_t> out_shape = {3ull};
    uint64_t seed = 22222ull;
    Tensor<float> expected_result({3});
    expected_result = std::vector<float>{2.71065561836134528, 3.75681233108024815, 5.08599253520421346};
    Tensor<float> result = stats::chisquare::rvs(k, out_shape, MemoryLocation::DEVICE, seed);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
}

/**
  * @test CHISQUARE.rvs_k_vector_broadcast_to_2d
  * @brief Verify rvs broadcasting: rvs k vector broadcast to 2d (seed=33333)
  */
TEST(CHISQUARE, rvs_k_vector_broadcast_to_2d)
{
    Tensor<float> k({2});
    k = std::vector<float>{3.00000000000000000, 2.00000000000000000};
    std::vector<uint64_t> out_shape = {2ull, 2ull};
    uint64_t seed = 33333ull;
    Tensor<float> expected_result({4});
    expected_result = std::vector<float>{1.01616765460435010, 1.40324496076613814, 1.10190053343775896, 14.05847258174145153};
    Tensor<float> result = stats::chisquare::rvs(k, out_shape, MemoryLocation::DEVICE, seed);
    // check values
    EXPECT_NEAR(result[0][0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[0][1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[1][0], expected_result[2], 0.0001);
    EXPECT_NEAR(result[1][1], expected_result[3], 0.0001);
}

/**
  * @test CHISQUARE.rvs_k_row_broadcast
  * @brief Verify rvs broadcasting: rvs k row broadcast (seed=44444)
  */
TEST(CHISQUARE, rvs_k_row_broadcast)
{
    Tensor<float> k({1,3});
    k = std::vector<float>{2.00000000000000000, 3.00000000000000000, 4.00000000000000000};
    std::vector<uint64_t> out_shape = {2ull, 3ull};
    uint64_t seed = 44444ull;
    Tensor<float> expected_result({6});
    expected_result = std::vector<float>{0.32376021543881134, 2.01302307197412933, 4.98467967382388366, 1.43347274200672681, 2.37286518059005580, 3.29914292693563294};
    Tensor<float> result = stats::chisquare::rvs(k, out_shape, MemoryLocation::DEVICE, seed);
    // check values
    EXPECT_NEAR(result[0][0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[0][1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[0][2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[1][0], expected_result[3], 0.0001);
    EXPECT_NEAR(result[1][1], expected_result[4], 0.0001);
    EXPECT_NEAR(result[1][2], expected_result[5], 0.0001);
}

/**
  * @test CHISQUARE.rvs_k_view_with_weird_strides
  * @brief Ensure chisquare::rvs accepts non-contiguous/alias views for k (and produces correct ppf output)
  */
TEST(CHISQUARE, rvs_k_view_with_weird_strides)
{
    Tensor<float> k_owner({6}, MemoryLocation::DEVICE);
    std::vector<float> k_owner_vals = {
        1.00000000000000000, 99.00000000000000000, 5.00000000000000000, 99.00000000000000000, 10.00000000000000000, 99.00000000000000000
    };
    k_owner = k_owner_vals;

    Tensor<float> k_alias(
        k_owner,
        std::vector<uint64_t>{0ull},
        std::vector<uint64_t>{3ull},
        std::vector<uint64_t>{2ull}
    );

    std::vector<uint64_t> out_shape = {3ull};
    uint64_t seed = 55555ull;

    Tensor<float> result = stats::chisquare::rvs(k_alias, out_shape, MemoryLocation::DEVICE, seed);

    Tensor<float> expected_result({3});
    expected_result = std::vector<float>{0.04379147443867865, 8.39430945951464480, 5.50540327503375160};

    // compare element-wise (unroll to report precise index on failure)
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
}
