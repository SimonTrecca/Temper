/**
  * @file chisquare_pdf.cpp
  * @brief File generated by tests/stats/chisquare_pdf.py.
  */

/**
  * @test CHISQUARE.pdf_random_test_dof_2
  * @brief Randomly generated chisquare pdf test on 100 matrix with dof = 2.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, pdf_random_test_dof_2)
{
    Tensor<float> x({100});
    x = std::vector<float>{0.00000000000000000, 0.16161616161616163, 0.32323232323232326, 0.48484848484848486, 0.64646464646464652, 0.80808080808080818, 0.96969696969696972, 1.13131313131313149, 1.29292929292929304, 1.45454545454545459, 1.61616161616161635, 1.77777777777777790, 1.93939393939393945, 2.10101010101010122, 2.26262626262626299, 2.42424242424242431, 2.58585858585858608, 2.74747474747474785, 2.90909090909090917, 3.07070707070707094, 3.23232323232323271, 3.39393939393939403, 3.55555555555555580, 3.71717171717171757, 3.87878787878787890, 4.04040404040404066, 4.20202020202020243, 4.36363636363636420, 4.52525252525252597, 4.68686868686868685, 4.84848484848484862, 5.01010101010101039, 5.17171717171717216, 5.33333333333333393, 5.49494949494949569, 5.65656565656565746, 5.81818181818181834, 5.97979797979798011, 6.14141414141414188, 6.30303030303030365, 6.46464646464646542, 6.62626262626262719, 6.78787878787878807, 6.94949494949494984, 7.11111111111111160, 7.27272727272727337, 7.43434343434343514, 7.59595959595959691, 7.75757575757575779, 7.91919191919191956, 8.08080808080808133, 8.24242424242424399, 8.40404040404040487, 8.56565656565656575, 8.72727272727272840, 8.88888888888888928, 9.05050505050505194, 9.21212121212121282, 9.37373737373737370, 9.53535353535353636, 9.69696969696969724, 9.85858585858585990, 10.02020202020202078, 10.18181818181818343, 10.34343434343434431, 10.50505050505050519, 10.66666666666666785, 10.82828282828282873, 10.98989898989899139, 11.15151515151515227, 11.31313131313131493, 11.47474747474747581, 11.63636363636363669, 11.79797979797979934, 11.95959595959596022, 12.12121212121212288, 12.28282828282828376, 12.44444444444444464, 12.60606060606060730, 12.76767676767676818, 12.92929292929293084, 13.09090909090909172, 13.25252525252525437, 13.41414141414141525, 13.57575757575757613, 13.73737373737373879, 13.89898989898989967, 14.06060606060606233, 14.22222222222222321, 14.38383838383838587, 14.54545454545454675, 14.70707070707070763, 14.86868686868687028, 15.03030303030303116, 15.19191919191919382, 15.35353535353535470, 15.51515151515151558, 15.67676767676767824, 15.83838383838383912, 16.00000000000000000};
    Tensor<float> k({1});
    k = 2.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{0.50000000000000000, 0.46118534754865942, 0.42538384958715553, 0.39236159702687795, 0.36190283897917552, 0.33380857314691514, 0.30789524564296428, 0.28399355174086066, 0.26194732972237406, 0.24161254059491274, 0.22285632701275881, 0.20555614525359370, 0.18959896457908265, 0.17488052874854038, 0.16130467486077782, 0.14878270507378269, 0.13723280709736432, 0.12657951967255218, 0.11675323954545667, 0.10768976671440664, 0.09932988497923535, 0.09161897505223407, 0.08450665770303303, 0.07794646460589777, 0.07189553473892048, 0.06631433435153150, 0.06116639867073811, 0.05641809365852843, 0.05203839626388249, 0.04799869173366703, 0.04427258665814439, 0.04083573652962891, 0.03766568668764479, 0.03474172561140076, 0.03204474960106803, 0.02955713796375665, 0.02726263788871758, 0.02514625825960293, 0.02319417171000665, 0.02139362428236540, 0.01973285209997625, 0.01820100450770769, 0.01678807317924378, 0.01548482672768373, 0.01428275039227519, 0.01317399040722436, 0.01215130268911695, 0.01120800550769871, 0.01033793583079064, 0.00953540905811785, 0.00879518188097342, 0.00811241802506080, 0.00748265665269535, 0.00690178321792119, 0.00636600258412497, 0.00587181422851068, 0.00541598937143372, 0.00499554988116901, 0.00460774881628719, 0.00425005247851266, 0.00392012385880581, 0.00361580736851430, 0.00333511475583454, 0.00307621211556843, 0.00283740790730365, 0.00261714190373429, 0.00241397499691572, 0.00222657979585270, 0.00205373195399030, 0.00189430216994561, 0.00174724880921709, 0.00161161109866553, 0.00148650284930268, 0.00137110666637546, 0.00126466860891730, 0.00116649326387481, 0.00107593920262655, 0.00099241479020910, 0.00091537431987003, 0.00084431444769275, 0.00077877090399907, 0.00071831546004319, 0.00066255313017919, 0.00061111959122228, 0.00056367880214329, 0.00051992080854453, 0.00047955971757278, 0.00044233183003828, 0.00040799391753607, 0.00037632163331323, 0.00034710804649928, 0.00032016229012341, 0.00029530831408508, 0.00027238373493067, 0.00025123877492121, 0.00023173528345948, 0.00021374583448309, 0.00019715289392632, 0.00018184805181127, 0.00016773131395126};
    // run Temper chisquare::pdf
    Tensor<float> result = stats::chisquare::pdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.pdf_random_test_dof_3
  * @brief Randomly generated chisquare pdf test on 100 matrix with dof = 3.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, pdf_random_test_dof_3)
{
    Tensor<float> x({100});
    x = std::vector<float>{0.00000000000000000, 0.19191919191919191, 0.38383838383838381, 0.57575757575757569, 0.76767676767676762, 0.95959595959595956, 1.15151515151515138, 1.34343434343434343, 1.53535353535353525, 1.72727272727272707, 1.91919191919191912, 2.11111111111111116, 2.30303030303030276, 2.49494949494949481, 2.68686868686868685, 2.87878787878787845, 3.07070707070707050, 3.26262626262626254, 3.45454545454545414, 3.64646464646464619, 3.83838383838383823, 4.03030303030303028, 4.22222222222222232, 4.41414141414141348, 4.60606060606060552, 4.79797979797979757, 4.98989898989898961, 5.18181818181818166, 5.37373737373737370, 5.56565656565656486, 5.75757575757575690, 5.94949494949494895, 6.14141414141414099, 6.33333333333333304, 6.52525252525252508, 6.71717171717171713, 6.90909090909090828, 7.10101010101010033, 7.29292929292929237, 7.48484848484848442, 7.67676767676767646, 7.86868686868686851, 8.06060606060606055, 8.25252525252525260, 8.44444444444444464, 8.63636363636363491, 8.82828282828282696, 9.02020202020201900, 9.21212121212121104, 9.40404040404040309, 9.59595959595959513, 9.78787878787878718, 9.97979797979797922, 10.17171717171717127, 10.36363636363636331, 10.55555555555555536, 10.74747474747474740, 10.93939393939393945, 11.13131313131312972, 11.32323232323232176, 11.51515151515151381, 11.70707070707070585, 11.89898989898989790, 12.09090909090908994, 12.28282828282828198, 12.47474747474747403, 12.66666666666666607, 12.85858585858585812, 13.05050505050505016, 13.24242424242424221, 13.43434343434343425, 13.62626262626262452, 13.81818181818181657, 14.01010101010100861, 14.20202020202020066, 14.39393939393939270, 14.58585858585858475, 14.77777777777777679, 14.96969696969696884, 15.16161616161616088, 15.35353535353535293, 15.54545454545454497, 15.73737373737373701, 15.92929292929292906, 16.12121212121212110, 16.31313131313131137, 16.50505050505050519, 16.69696969696969546, 16.88888888888888928, 17.08080808080807955, 17.27272727272726982, 17.46464646464646364, 17.65656565656565391, 17.84848484848484773, 18.04040404040403800, 18.23232323232323182, 18.42424242424242209, 18.61616161616161591, 18.80808080808080618, 19.00000000000000000};
    Tensor<float> k({1});
    k = 3.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{0.00000000000000000, 0.15877954240254669, 0.20400218583294100, 0.22698947862750518, 0.23812246663350645, 0.24186924898918144, 0.24071134310091430, 0.23620834021349557, 0.22941218347335698, 0.22106399623552145, 0.21170057562443681, 0.20171753780628288, 0.19140937972048089, 0.18099623710044380, 0.17064248411049215, 0.16047007417555553, 0.15056835032267926, 0.14100140445585255, 0.13181368680947070, 0.12303433670826983, 0.11468056042685228, 0.10676028712791109, 0.09927427021668252, 0.09221775764343237, 0.08558182385318752, 0.07935443394519261, 0.07352129442710065, 0.06806653293785217, 0.06297324026841876, 0.05822390111177513, 0.05380073465310002, 0.04968596196582228, 0.04586201391991650, 0.04231169072564030, 0.03901828217373918, 0.03596565597639761, 0.03313832027464730, 0.03052146529104067, 0.02810098821997428, 0.02586350472235451, 0.02379634979522485, 0.02188757029598081, 0.02012591099539509, 0.01850079569828671, 0.01700230469276906, 0.01562114955847967, 0.01434864617280564, 0.01317668659516366, 0.01209771037737108, 0.01110467573853558, 0.01019103095195968, 0.00935068621621571, 0.00857798622022974, 0.00786768356078565, 0.00721491312854284, 0.00661516754396374, 0.00606427369622686, 0.00555837041521151, 0.00509388728810598, 0.00466752461737637, 0.00427623450511747, 0.00391720303967078, 0.00358783355339931, 0.00328573091528463, 0.00300868681824910, 0.00275466601854393, 0.00252179348296174, 0.00230834239884705, 0.00211272300173420, 0.00193347217581014, 0.00176924378317179, 0.00161879967893236, 0.00148100137055483, 0.00135480228128949, 0.00123924057921620, 0.00113343253509758, 0.00103656637400205, 0.00094789658742821, 0.00086673867443091, 0.00079246428199743, 0.00072449671663434, 0.00066230680079196, 0.00060540904936475, 0.00055335814305701, 0.00050574567688936, 0.00046219716354034, 0.00042236927256734, 0.00038594728783163, 0.00035264276666408, 0.00032219138545205, 0.00029435095740518, 0.00026889960927135, 0.00024563410472450, 0.00022436830303733, 0.00020493174248552, 0.00018716833870955, 0.00017093518898711, 0.00015610147404756, 0.00014254744969095, 0.00013016352106202};
    // run Temper chisquare::pdf
    Tensor<float> result = stats::chisquare::pdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.pdf_random_test_dof_4
  * @brief Randomly generated chisquare pdf test on 100 matrix with dof = 4.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, pdf_random_test_dof_4)
{
    Tensor<float> x({100});
    x = std::vector<float>{0.00000000000000000, 0.22222222222222221, 0.44444444444444442, 0.66666666666666663, 0.88888888888888884, 1.11111111111111116, 1.33333333333333326, 1.55555555555555536, 1.77777777777777768, 2.00000000000000000, 2.22222222222222232, 2.44444444444444420, 2.66666666666666652, 2.88888888888888884, 3.11111111111111072, 3.33333333333333304, 3.55555555555555536, 3.77777777777777768, 4.00000000000000000, 4.22222222222222232, 4.44444444444444464, 4.66666666666666607, 4.88888888888888840, 5.11111111111111072, 5.33333333333333304, 5.55555555555555536, 5.77777777777777768, 6.00000000000000000, 6.22222222222222143, 6.44444444444444375, 6.66666666666666607, 6.88888888888888840, 7.11111111111111072, 7.33333333333333304, 7.55555555555555536, 7.77777777777777768, 8.00000000000000000, 8.22222222222222143, 8.44444444444444464, 8.66666666666666607, 8.88888888888888928, 9.11111111111111072, 9.33333333333333215, 9.55555555555555536, 9.77777777777777679, 10.00000000000000000, 10.22222222222222143, 10.44444444444444464, 10.66666666666666607, 10.88888888888888751, 11.11111111111111072, 11.33333333333333215, 11.55555555555555536, 11.77777777777777679, 12.00000000000000000, 12.22222222222222143, 12.44444444444444287, 12.66666666666666607, 12.88888888888888751, 13.11111111111111072, 13.33333333333333215, 13.55555555555555536, 13.77777777777777679, 14.00000000000000000, 14.22222222222222143, 14.44444444444444287, 14.66666666666666607, 14.88888888888888751, 15.11111111111111072, 15.33333333333333215, 15.55555555555555536, 15.77777777777777679, 16.00000000000000000, 16.22222222222222143, 16.44444444444444287, 16.66666666666666430, 16.88888888888888928, 17.11111111111111072, 17.33333333333333215, 17.55555555555555358, 17.77777777777777857, 18.00000000000000000, 18.22222222222222143, 18.44444444444444287, 18.66666666666666430, 18.88888888888888928, 19.11111111111111072, 19.33333333333333215, 19.55555555555555358, 19.77777777777777501, 20.00000000000000000, 20.22222222222222143, 20.44444444444444287, 20.66666666666666430, 20.88888888888888928, 21.11111111111111072, 21.33333333333333215, 21.55555555555555358, 21.77777777777777501, 22.00000000000000000};
    Tensor<float> k({1});
    k = 4.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{0.00000000000000000, 0.04971329537857608, 0.08897082254631201, 0.11942188509563154, 0.14248453076221215, 0.15937595020484246, 0.17113903967753069, 0.17866559823619368, 0.18271657355874998, 0.18393972058572114, 0.18288499322661420, 0.18001795063395457, 0.17573142541048453, 0.17035567104522778, 0.16416717939307018, 0.15739633569796821, 0.15023405813872542, 0.14283755081880156, 0.13533528323661270, 0.12783129530301471, 0.12040891469099541, 0.11313396250847257, 0.10605751380146911, 0.09921827106555255, 0.09264460163040208, 0.08635628336405043, 0.08036599751243964, 0.07468060255179593, 0.06930221860253952, 0.06422914816044574, 0.05945665557875400, 0.05497762482676483, 0.05078311250586733, 0.04686281087859692, 0.04320543372122907, 0.03979903611123705, 0.03663127777746836, 0.03368963834655017, 0.03096159169044610, 0.02843474559670543, 0.02609695212671413, 0.02393639328230636, 0.02194164595348883, 0.02010172955753611, 0.01840613929158895, 0.01684486749771367, 0.01540841527289342, 0.01408779613937908, 0.01287453331688384, 0.01176065190170052, 0.01073866705409113, 0.00980156911998349, 0.00894280646238847, 0.00815626664876850, 0.00743625652999908, 0.00677748165208967, 0.00617502536130108, 0.00562432789482554, 0.00512116569113771, 0.00466163110504657, 0.00424211267113270, 0.00385927602456073, 0.00351004555926872, 0.00319158687944081, 0.00290129008025653, 0.00263675387756733, 0.00239577059284706, 0.00217631198904036, 0.00197651594439478, 0.00179467394466898, 0.00162921936896594, 0.00147871654059574, 0.00134185051161005, 0.00121741754778554, 0.00110431627970725, 0.00100153948508131, 0.00090816646737401, 0.00082335599623472, 0.00074633977583018, 0.00067641640812956, 0.00061294581927361, 0.00055534411839006, 0.00050307885954021, 0.00045566467886465, 0.00041265928041279, 0.00037365974556837, 0.00033829914240362, 0.00030624341269370, 0.00027718851569022, 0.00025085780907731, 0.00022699964881242, 0.00020538519077886, 0.00018580637834760, 0.00016807410105880, 0.00015201651068786, 0.00013747748195745, 0.00012431520609566, 0.00011240090632241, 0.00010161766517361, 0.00009185935434635};
    // run Temper chisquare::pdf
    Tensor<float> result = stats::chisquare::pdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.pdf_random_test_dof_5
  * @brief Randomly generated chisquare pdf test on 100 matrix with dof = 5.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, pdf_random_test_dof_5)
{
    Tensor<float> x({100});
    x = std::vector<float>{0.00000000000000000, 0.25252525252525254, 0.50505050505050508, 0.75757575757575757, 1.01010101010101017, 1.26262626262626276, 1.51515151515151514, 1.76767676767676774, 2.02020202020202033, 2.27272727272727293, 2.52525252525252553, 2.77777777777777812, 3.03030303030303028, 3.28282828282828287, 3.53535353535353547, 3.78787878787878807, 4.04040404040404066, 4.29292929292929326, 4.54545454545454586, 4.79797979797979846, 5.05050505050505105, 5.30303030303030365, 5.55555555555555625, 5.80808080808080884, 6.06060606060606055, 6.31313131313131315, 6.56565656565656575, 6.81818181818181834, 7.07070707070707094, 7.32323232323232354, 7.57575757575757613, 7.82828282828282873, 8.08080808080808133, 8.33333333333333393, 8.58585858585858652, 8.83838383838383912, 9.09090909090909172, 9.34343434343434431, 9.59595959595959691, 9.84848484848484951, 10.10101010101010210, 10.35353535353535470, 10.60606060606060730, 10.85858585858585990, 11.11111111111111249, 11.36363636363636509, 11.61616161616161769, 11.86868686868687028, 12.12121212121212110, 12.37373737373737370, 12.62626262626262630, 12.87878787878787890, 13.13131313131313149, 13.38383838383838409, 13.63636363636363669, 13.88888888888888928, 14.14141414141414188, 14.39393939393939448, 14.64646464646464707, 14.89898989898989967, 15.15151515151515227, 15.40404040404040487, 15.65656565656565746, 15.90909090909091006, 16.16161616161616266, 16.41414141414141525, 16.66666666666666785, 16.91919191919192045, 17.17171717171717304, 17.42424242424242564, 17.67676767676767824, 17.92929292929293084, 18.18181818181818343, 18.43434343434343603, 18.68686868686868863, 18.93939393939394122, 19.19191919191919382, 19.44444444444444642, 19.69696969696969902, 19.94949494949495161, 20.20202020202020421, 20.45454545454545681, 20.70707070707070940, 20.95959595959596200, 21.21212121212121460, 21.46464646464646719, 21.71717171717171979, 21.96969696969697239, 22.22222222222222499, 22.47474747474747758, 22.72727272727273018, 22.97979797979798278, 23.23232323232323537, 23.48484848484848797, 23.73737373737374057, 23.98989898989899316, 24.24242424242424221, 24.49494949494949481, 24.74747474747474740, 25.00000000000000000};
    Tensor<float> k({1});
    k = 5.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{0.00000000000000000, 0.01487342097635720, 0.03707837581390958, 0.06003747637123274, 0.08146956018674061, 0.10035181447540518, 0.11626846440848240, 0.12913588976598558, 0.13905919720304710, 0.14624914630299693, 0.15097130657475374, 0.15351410307522945, 0.15416861079087388, 0.15321594231303484, 0.15091966056013992, 0.14752155886910137, 0.14323970453015994, 0.13826799419096572, 0.13277670179050832, 0.12691365698305213, 0.12080580080880486, 0.11456094180935476, 0.10826959010643476, 0.10200678585515427, 0.09583386644217180, 0.08980013691262025, 0.08394442253806467, 0.07829649271842219, 0.07287835265129389, 0.06770540420943597, 0.06278748083399631, 0.05812976341619557, 0.05373358542927983, 0.04959713622886875, 0.04571607164477098, 0.04208404087645864, 0.03869313837868594, 0.03553428895816298, 0.03259757375205956, 0.02987250416482557, 0.02734825023053362, 0.02501382926431991, 0.02285826008275490, 0.02087068751854590, 0.01904048143569267, 0.01735731397028574, 0.01581121828081425, 0.01439263169001428, 0.01309242573685410, 0.01190192533047072, 0.01081291890558603, 0.00981766121873525, 0.00890887019402571, 0.00807971902357842, 0.00732382454881238, 0.00663523279192984, 0.00600840237009593, 0.00543818640577122, 0.00491981344349788, 0.00444886779436584, 0.00402126965275831, 0.00363325526431200, 0.00328135736798666, 0.00296238608751906, 0.00267341040726159, 0.00241174033351795, 0.00217490981413638, 0.00196066046555163, 0.00176692613701717, 0.00159181832585395, 0.00143361244465026, 0.00129073493103045, 0.00116175118247833, 0.00104535429241468, 0.00094035455899310, 0.00084566973463947, 0.00076031598199894, 0.00068339950048195, 0.00061410878685504, 0.00055170749316668, 0.00049552784561428, 0.00044496458864793, 0.00039946941958394, 0.00035854588019820, 0.00032174467312537, 0.00028865937235706, 0.00025892249867006, 0.00023220193239072, 0.00020819763748831, 0.00018663867256565, 0.00016728046586383, 0.00014990233290580, 0.00013430521686055, 0.00012030963310945, 0.00010775380083258, 0.00009649194570293, 0.00008639275897875, 0.00007733799941742, 0.00006922122549925, 0.00006194664644726};
    // run Temper chisquare::pdf
    Tensor<float> result = stats::chisquare::pdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.pdf_random_test_dof_6
  * @brief Randomly generated chisquare pdf test on 100 matrix with dof = 6.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, pdf_random_test_dof_6)
{
    Tensor<float> x({100});
    x = std::vector<float>{0.00000000000000000, 0.28282828282828282, 0.56565656565656564, 0.84848484848484840, 1.13131313131313127, 1.41414141414141414, 1.69696969696969679, 1.97979797979797967, 2.26262626262626254, 2.54545454545454541, 2.82828282828282829, 3.11111111111111116, 3.39393939393939359, 3.67676767676767646, 3.95959595959595934, 4.24242424242424221, 4.52525252525252508, 4.80808080808080796, 5.09090909090909083, 5.37373737373737370, 5.65656565656565657, 5.93939393939393945, 6.22222222222222232, 6.50505050505050519, 6.78787878787878718, 7.07070707070707005, 7.35353535353535293, 7.63636363636363580, 7.91919191919191867, 8.20202020202020243, 8.48484848484848442, 8.76767676767676818, 9.05050505050505016, 9.33333333333333215, 9.61616161616161591, 9.89898989898989790, 10.18181818181818166, 10.46464646464646364, 10.74747474747474740, 11.03030303030302939, 11.31313131313131315, 11.59595959595959513, 11.87878787878787890, 12.16161616161616088, 12.44444444444444464, 12.72727272727272663, 13.01010101010101039, 13.29292929292929237, 13.57575757575757436, 13.85858585858585812, 14.14141414141414010, 14.42424242424242387, 14.70707070707070585, 14.98989898989898961, 15.27272727272727160, 15.55555555555555536, 15.83838383838383734, 16.12121212121212110, 16.40404040404040487, 16.68686868686868507, 16.96969696969696884, 17.25252525252525260, 17.53535353535353636, 17.81818181818181657, 18.10101010101010033, 18.38383838383838409, 18.66666666666666430, 18.94949494949494806, 19.23232323232323182, 19.51515151515151558, 19.79797979797979579, 20.08080808080807955, 20.36363636363636331, 20.64646464646464707, 20.92929292929292728, 21.21212121212121104, 21.49494949494949481, 21.77777777777777857, 22.06060606060605878, 22.34343434343434254, 22.62626262626262630, 22.90909090909090651, 23.19191919191919027, 23.47474747474747403, 23.75757575757575779, 24.04040404040403800, 24.32323232323232176, 24.60606060606060552, 24.88888888888888928, 25.17171717171716949, 25.45454545454545325, 25.73737373737373701, 26.02020202020202078, 26.30303030303030098, 26.58585858585858475, 26.86868686868686851, 27.15151515151514872, 27.43434343434343248, 27.71717171717171624, 28.00000000000000000};
    Tensor<float> k({1});
    k = 6.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{0.00000000000000000, 0.00434020566574247, 0.01507144592248677, 0.02943893240886699, 0.04543433212219871, 0.06162952111500061, 0.07704348223315195, 0.09103619594186897, 0.10322445880285672, 0.11341546512612230, 0.12155473421042629, 0.12768558397238791, 0.13191786306878145, 0.13440407577859392, 0.13532138194139423, 0.13485824069661956, 0.13320470211899649, 0.13054554384977848, 0.12705560777981501, 0.12289682082899049, 0.11821648894799118, 0.11314653885032405, 0.10780345115950593, 0.10228868452711505, 0.09668943524354176, 0.09107961291181635, 0.08552094152753842, 0.08006411815901704, 0.07474997946671874, 0.06961064045711993, 0.06467058088569616, 0.05994766322343756, 0.05545407258464619, 0.05119717389147395, 0.04718028515657274, 0.04340336837003442, 0.03986364129926693, 0.03655611472675711, 0.03347406040213129, 0.03060941538439820, 0.02795312858741352, 0.02549545528728116, 0.02322620516017791, 0.02113494913622940, 0.01921119001293669, 0.01744450139569031, 0.01582463914222468, 0.01434162909656249, 0.01298583451622666, 0.01174800623132334, 0.01061931823019337, 0.00959139104651907, 0.00865630502850560, 0.00780660530242395, 0.00703530000005719, 0.00633585310153421, 0.00570217305040858, 0.00512859812515128, 0.00460987939884966, 0.00414116198516299, 0.00371796515179565, 0.00333616178127808, 0.00299195757112215, 0.00268187028996677, 0.00240270934176926, 0.00215155583515977, 0.00192574330859301, 0.00172283922284872, 0.00154062729979320, 0.00137709075926503, 0.00123039648372258, 0.00109888012221223, 0.00098103213068383, 0.00087548473416591, 0.00078099978735553, 0.00069645750337243, 0.00062084601542281, 0.00055325173261189, 0.00049285044887341, 0.00043889916272374, 0.00039072856510600, 0.00034773615280170, 0.00030937992561457, 0.00027517262665770, 0.00024467648650120, 0.00021749843358273, 0.00019328573507961, 0.00017172203433222, 0.00015252375285085, 0.00013543682689285, 0.00012023375053797, 0.00010671089909146, 0.00009468610849211, 0.00008399648818073, 0.00007449644658605, 0.00006605591000195, 0.00005855871715950, 0.00005190117323710, 0.00004599074840178, 0.00004074490723607};
    // run Temper chisquare::pdf
    Tensor<float> result = stats::chisquare::pdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.pdf_random_test_dof_7
  * @brief Randomly generated chisquare pdf test on 100 matrix with dof = 7.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, pdf_random_test_dof_7)
{
    Tensor<float> x({100});
    x = std::vector<float>{0.00000000000000000, 0.31313131313131315, 0.62626262626262630, 0.93939393939393945, 1.25252525252525260, 1.56565656565656575, 1.87878787878787890, 2.19191919191919204, 2.50505050505050519, 2.81818181818181834, 3.13131313131313149, 3.44444444444444464, 3.75757575757575779, 4.07070707070707094, 4.38383838383838409, 4.69696969696969724, 5.01010101010101039, 5.32323232323232354, 5.63636363636363669, 5.94949494949494984, 6.26262626262626299, 6.57575757575757613, 6.88888888888888928, 7.20202020202020243, 7.51515151515151558, 7.82828282828282873, 8.14141414141414188, 8.45454545454545503, 8.76767676767676818, 9.08080808080808133, 9.39393939393939448, 9.70707070707070763, 10.02020202020202078, 10.33333333333333393, 10.64646464646464707, 10.95959595959596022, 11.27272727272727337, 11.58585858585858652, 11.89898989898989967, 12.21212121212121282, 12.52525252525252597, 12.83838383838383912, 13.15151515151515227, 13.46464646464646542, 13.77777777777777857, 14.09090909090909172, 14.40404040404040487, 14.71717171717171802, 15.03030303030303116, 15.34343434343434431, 15.65656565656565746, 15.96969696969697061, 16.28282828282828376, 16.59595959595959869, 16.90909090909091006, 17.22222222222222143, 17.53535353535353636, 17.84848484848485128, 18.16161616161616266, 18.47474747474747403, 18.78787878787878896, 19.10101010101010388, 19.41414141414141525, 19.72727272727272663, 20.04040404040404155, 20.35353535353535648, 20.66666666666666785, 20.97979797979797922, 21.29292929292929415, 21.60606060606060908, 21.91919191919192045, 22.23232323232323182, 22.54545454545454675, 22.85858585858586167, 23.17171717171717304, 23.48484848484848442, 23.79797979797979934, 24.11111111111111427, 24.42424242424242564, 24.73737373737373701, 25.05050505050505194, 25.36363636363636687, 25.67676767676767824, 25.98989898989898961, 26.30303030303030454, 26.61616161616161946, 26.92929292929293084, 27.24242424242424221, 27.55555555555555713, 27.86868686868687206, 28.18181818181818343, 28.49494949494949481, 28.80808080808080973, 29.12121212121212466, 29.43434343434343603, 29.74747474747474740, 30.06060606060606233, 30.37373737373737725, 30.68686868686868863, 31.00000000000000000};
    Tensor<float> k({1});
    k = 7.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{0.00000000000000000, 0.00124778411971411, 0.00603557766326855, 0.01422169595201697, 0.02496333646612151, 0.03728911379943139, 0.05029670983985473, 0.06322821916223346, 0.07549100667148216, 0.08665246510969171, 0.09642264661131252, 0.10463215256805858, 0.11120926272496336, 0.11615840139099833, 0.11954095862791647, 0.12145885759547492, 0.12204089959092483, 0.12143171994795091, 0.11978308800101492, 0.11724724423456806, 0.11397196340726090, 0.11009704861668980, 0.10575198828541714, 0.10105453982524561, 0.09611003652282167, 0.09101124575262945, 0.08583863571931140, 0.08066093395500593, 0.07553588354981446, 0.07051112262564099, 0.06562512907305361, 0.06090818633312494, 0.05638333733042375, 0.05206730286345358, 0.04797134813643920, 0.04410208695065496, 0.04046221761626984, 0.03705118811958467, 0.03386579067928691, 0.03090068771531678, 0.02814887257635792, 0.02560206924547938, 0.02325107576679400, 0.02108605639052463, 0.01909678748604506, 0.01727286217603125, 0.01560385844286696, 0.01407947518497655, 0.01268964038246942, 0.01142459518892587, 0.01027495741490773, 0.00923176752037886, 0.00828651989599002, 0.00743118189287015, 0.00665820276091935, 0.00596051437880444, 0.00533152540591975, 0.00476511025760725, 0.00425559409939995, 0.00379773487297122, 0.00338670320454456, 0.00301806090425959, 0.00268773864081431, 0.00239201326799610, 0.00212748518687203, 0.00189105604788978, 0.00167990702947284, 0.00149147787250491, 0.00132344680211613, 0.00117371142824407, 0.00104037068348784, 0.00092170782985249, 0.00081617454424119, 0.00072237607523712, 0.00063905745015728, 0.00056509070096865, 0.00049946306991923, 0.00044126615020657, 0.00038968591329790, 0.00034399357229658, 0.00030353722973482, 0.00026773425811996, 0.00023606436226614, 0.00020806327373189, 0.00018331702941256, 0.00016145678838456, 0.00014215414336672, 0.00012511688557188, 0.00011008518420389, 0.00009682814435771, 0.00008514070956400, 0.00007484087764973, 0.00006576720094116, 0.00005777654409509, 0.00005074207499718, 0.00004455146620387, 0.00003910528632187, 0.00003431556251541, 0.00003010449700563, 0.00002640332198154};
    // run Temper chisquare::pdf
    Tensor<float> result = stats::chisquare::pdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.pdf_random_test_dof_8
  * @brief Randomly generated chisquare pdf test on 100 matrix with dof = 8.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, pdf_random_test_dof_8)
{
    Tensor<float> x({100});
    x = std::vector<float>{0.00000000000000000, 0.34343434343434343, 0.68686868686868685, 1.03030303030303028, 1.37373737373737370, 1.71717171717171713, 2.06060606060606055, 2.40404040404040398, 2.74747474747474740, 3.09090909090909083, 3.43434343434343425, 3.77777777777777768, 4.12121212121212110, 4.46464646464646453, 4.80808080808080796, 5.15151515151515138, 5.49494949494949481, 5.83838383838383823, 6.18181818181818166, 6.52525252525252508, 6.86868686868686851, 7.21212121212121193, 7.55555555555555536, 7.89898989898989878, 8.24242424242424221, 8.58585858585858475, 8.92929292929292906, 9.27272727272727337, 9.61616161616161591, 9.95959595959595845, 10.30303030303030276, 10.64646464646464707, 10.98989898989898961, 11.33333333333333215, 11.67676767676767646, 12.02020202020202078, 12.36363636363636331, 12.70707070707070585, 13.05050505050505016, 13.39393939393939448, 13.73737373737373701, 14.08080808080807955, 14.42424242424242387, 14.76767676767676818, 15.11111111111111072, 15.45454545454545325, 15.79797979797979757, 16.14141414141414188, 16.48484848484848442, 16.82828282828282696, 17.17171717171716949, 17.51515151515151558, 17.85858585858585812, 18.20202020202020066, 18.54545454545454675, 18.88888888888888928, 19.23232323232323182, 19.57575757575757436, 19.91919191919191690, 20.26262626262626299, 20.60606060606060552, 20.94949494949494806, 21.29292929292929415, 21.63636363636363669, 21.97979797979797922, 22.32323232323232176, 22.66666666666666430, 23.01010101010101039, 23.35353535353535293, 23.69696969696969546, 24.04040404040404155, 24.38383838383838409, 24.72727272727272663, 25.07070707070706916, 25.41414141414141170, 25.75757575757575779, 26.10101010101010033, 26.44444444444444287, 26.78787878787878896, 27.13131313131313149, 27.47474747474747403, 27.81818181818181657, 28.16161616161615910, 28.50505050505050519, 28.84848484848484773, 29.19191919191919027, 29.53535353535353636, 29.87878787878787890, 30.22222222222222143, 30.56565656565656397, 30.90909090909090651, 31.25252525252525260, 31.59595959595959513, 31.93939393939393767, 32.28282828282828376, 32.62626262626262275, 32.96969696969696884, 33.31313131313131493, 33.65656565656565391, 34.00000000000000000};
    Tensor<float> k({1});
    k = 8.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{0.00000000000000000, 0.00035537274275501, 0.00239440869563413, 0.00680606728263215, 0.01358740835265789, 0.02235068545407583, 0.03252810511291072, 0.04350341131719260, 0.05469194070374862, 0.06558508435849943, 0.07577077564828773, 0.08493837898484291, 0.09287393163521000, 0.09944989515195021, 0.10461225399409860, 0.10836684003898550, 0.11076607334784332, 0.11189682304943833, 0.11186975510336655, 0.11081030615558120, 0.10885127459709569, 0.10612692867354456, 0.10276848020934318, 0.09890074873743383, 0.09463983543259664, 0.09009163262315832, 0.08535100808645761, 0.08050152051315955, 0.07561554119369905, 0.07075467563973779, 0.06597039655976236, 0.06130481580926812, 0.05679153735560279, 0.05245654584583756, 0.04831909607641095, 0.04439257764589734, 0.04068533648101010, 0.03720144093557959, 0.03394138495265683, 0.03090272452597073, 0.02808064656225783, 0.02546847137917440, 0.02305809160678321, 0.02084035130942966, 0.01880536980839810, 0.01694281504819339, 0.01524213148099280, 0.01369272740290793, 0.01228412650963497, 0.01100608818605941, 0.00984870073477596, 0.00880245140601354, 0.00785827673435463, 0.00700759632960054, 0.00624233292018016, 0.00555492111467389, 0.00493830703502736, 0.00438594068671683, 0.00389176266793343, 0.00345018658214839, 0.00305607830577972, 0.00270473307412216, 0.00239185118286017, 0.00211351295775412, 0.00186615351973496, 0.00164653776487896, 0.00145173588678652, 0.00127909969104392, 0.00112623988607179, 0.00099100448023996, 0.00087145837024731, 0.00076586416914899, 0.00067266429290251, 0.00059046430086362, 0.00051801746737026, 0.00045421054759609, 0.00039805069052202, 0.00034865344454407, 0.00030523179637289, 0.00026708618102277, 0.00023359539944164, 0.00020420838036373, 0.00017843672399047, 0.00015584796688648, 0.00013605950981912, 0.00011873315300901, 0.00010357018626295, 0.00009030698462186, 0.00007871106338797, 0.00006857754963062, 0.00005972603045474, 0.00005199774141073, 0.00004525306140011, 0.00003936928326576, 0.00003423863193606, 0.00002976650451013, 0.00002586990902309, 0.00002247608081565, 0.00001952125745419, 0.00001694959501033};
    // run Temper chisquare::pdf
    Tensor<float> result = stats::chisquare::pdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.pdf_random_test_dof_9
  * @brief Randomly generated chisquare pdf test on 100 matrix with dof = 9.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, pdf_random_test_dof_9)
{
    Tensor<float> x({100});
    x = std::vector<float>{0.00000000000000000, 0.37373737373737376, 0.74747474747474751, 1.12121212121212133, 1.49494949494949503, 1.86868686868686873, 2.24242424242424265, 2.61616161616161635, 2.98989898989899006, 3.36363636363636376, 3.73737373737373746, 4.11111111111111160, 4.48484848484848531, 4.85858585858585901, 5.23232323232323271, 5.60606060606060641, 5.97979797979798011, 6.35353535353535381, 6.72727272727272751, 7.10101010101010122, 7.47474747474747492, 7.84848484848484862, 8.22222222222222321, 8.59595959595959691, 8.96969696969697061, 9.34343434343434431, 9.71717171717171802, 10.09090909090909172, 10.46464646464646542, 10.83838383838383912, 11.21212121212121282, 11.58585858585858652, 11.95959595959596022, 12.33333333333333393, 12.70707070707070763, 13.08080808080808133, 13.45454545454545503, 13.82828282828282873, 14.20202020202020243, 14.57575757575757613, 14.94949494949494984, 15.32323232323232354, 15.69696969696969724, 16.07070707070707272, 16.44444444444444642, 16.81818181818182012, 17.19191919191919382, 17.56565656565656752, 17.93939393939394122, 18.31313131313131493, 18.68686868686868863, 19.06060606060606233, 19.43434343434343603, 19.80808080808080973, 20.18181818181818343, 20.55555555555555713, 20.92929292929293084, 21.30303030303030454, 21.67676767676767824, 22.05050505050505194, 22.42424242424242564, 22.79797979797979934, 23.17171717171717304, 23.54545454545454675, 23.91919191919192045, 24.29292929292929415, 24.66666666666666785, 25.04040404040404155, 25.41414141414141525, 25.78787878787878896, 26.16161616161616266, 26.53535353535353636, 26.90909090909091006, 27.28282828282828376, 27.65656565656565746, 28.03030303030303116, 28.40404040404040487, 28.77777777777777857, 29.15151515151515227, 29.52525252525252597, 29.89898989898989967, 30.27272727272727337, 30.64646464646464707, 31.02020202020202078, 31.39393939393939448, 31.76767676767676818, 32.14141414141414543, 32.51515151515151558, 32.88888888888889284, 33.26262626262626299, 33.63636363636364024, 34.01010101010101039, 34.38383838383838764, 34.75757575757575779, 35.13131313131313505, 35.50505050505050519, 35.87878787878788245, 36.25252525252525260, 36.62626262626262985, 37.00000000000000000};
    Tensor<float> k({1});
    k = 9.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{0.00000000000000000, 0.00010058832593187, 0.00094405332378282, 0.00323712815275083, 0.00735003540962013, 0.01331430303542841, 0.02090724261387179, 0.02974777466497115, 0.03937950547389361, 0.04933419510372807, 0.05917567553357859, 0.06852697844491491, 0.07708422430719256, 0.08462074389212086, 0.09098445355758121, 0.09609093812566823, 0.09991413352195852, 0.10247600174335007, 0.10383617361303095, 0.10408220202063381, 0.10332081274324283, 0.10167035054922244, 0.09925448327133111, 0.09619713467797929, 0.09261855835502150, 0.08863243106338481, 0.08434382832794413, 0.07984794191698756, 0.07522940418990078, 0.07056209484924775, 0.06590931909363268, 0.06132426085593599, 0.05685062957222103, 0.05252343299980552, 0.04836982152421865, 0.04440996091515620, 0.04065790051521811, 0.03712241238094150, 0.03380778402038506, 0.03071455320328640, 0.02784017799807971, 0.02517963886187374, 0.02272597242007917, 0.02047073865903790, 0.01840442474349487, 0.01651678967336429, 0.01479715460926724, 0.01323464400818966, 0.01181838279075630, 0.01053765466947709, 0.00938202655167514, 0.00834144363102092, 0.00740629942897038, 0.00656748466633795, 0.00581641845437496, 0.00514506490794678, 0.00454593791070081, 0.00401209641035988, 0.00353713229585565, 0.00311515260940029, 0.00274075757677901, 0.00240901569802892, 0.00211543692736046, 0.00185594478423252, 0.00162684807511595, 0.00142481276566739, 0.00124683442369032, 0.00109021155228045, 0.00095252004788863, 0.00083158894773768, 0.00072547757327437, 0.00063245412944402, 0.00055097578201248, 0.00047967020555091, 0.00041731857181563, 0.00036283993101129, 0.00031527692587136, 0.00027378276979629, 0.00023760941474279, 0.00020609683154553, 0.00017866332435321, 0.00015479680143471, 0.00013404692638890, 0.00011601807646641, 0.00010036303803044, 0.00008677737293957, 0.00007499439366178, 0.00006478068909171, 0.00005593214723763, 0.00004827042508983, 0.00004163982001620, 0.00003590450090896, 0.00003094606099682, 0.00002666135771863, 0.00002296060831542, 0.00001976571283192, 0.00001700877902727, 0.00001463082627969, 0.00001258064794115, 0.00001081381376178};
    // run Temper chisquare::pdf
    Tensor<float> result = stats::chisquare::pdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.pdf_random_test_dof_10
  * @brief Randomly generated chisquare pdf test on 100 matrix with dof = 10.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, pdf_random_test_dof_10)
{
    Tensor<float> x({100});
    x = std::vector<float>{0.00000000000000000, 0.40404040404040403, 0.80808080808080807, 1.21212121212121215, 1.61616161616161613, 2.02020202020202033, 2.42424242424242431, 2.82828282828282829, 3.23232323232323226, 3.63636363636363624, 4.04040404040404066, 4.44444444444444464, 4.84848484848484862, 5.25252525252525260, 5.65656565656565657, 6.06060606060606055, 6.46464646464646453, 6.86868686868686851, 7.27272727272727249, 7.67676767676767646, 8.08080808080808133, 8.48484848484848442, 8.88888888888888928, 9.29292929292929237, 9.69696969696969724, 10.10101010101010033, 10.50505050505050519, 10.90909090909090828, 11.31313131313131315, 11.71717171717171624, 12.12121212121212110, 12.52525252525252419, 12.92929292929292906, 13.33333333333333393, 13.73737373737373701, 14.14141414141414188, 14.54545454545454497, 14.94949494949494984, 15.35353535353535293, 15.75757575757575779, 16.16161616161616266, 16.56565656565656397, 16.96969696969696884, 17.37373737373737370, 17.77777777777777857, 18.18181818181817988, 18.58585858585858475, 18.98989898989898961, 19.39393939393939448, 19.79797979797979934, 20.20202020202020066, 20.60606060606060552, 21.01010101010101039, 21.41414141414141525, 21.81818181818181657, 22.22222222222222143, 22.62626262626262630, 23.03030303030303116, 23.43434343434343248, 23.83838383838383734, 24.24242424242424221, 24.64646464646464707, 25.05050505050504839, 25.45454545454545325, 25.85858585858585812, 26.26262626262626299, 26.66666666666666785, 27.07070707070706916, 27.47474747474747403, 27.87878787878787890, 28.28282828282828376, 28.68686868686868507, 29.09090909090908994, 29.49494949494949481, 29.89898989898989967, 30.30303030303030098, 30.70707070707070585, 31.11111111111111072, 31.51515151515151558, 31.91919191919191690, 32.32323232323232531, 32.72727272727272663, 33.13131313131312794, 33.53535353535353636, 33.93939393939393767, 34.34343434343434609, 34.74747474747474740, 35.15151515151514872, 35.55555555555555713, 35.95959595959595845, 36.36363636363635976, 36.76767676767676818, 37.17171717171716949, 37.57575757575757791, 37.97979797979797922, 38.38383838383838054, 38.78787878787878896, 39.19191919191919027, 39.59595959595959869, 40.00000000000000000};
    Tensor<float> k({1});
    k = 10.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{0.00000000000000000, 0.00002835317561995, 0.00037066828751805, 0.00153325436185672, 0.00395943206935079, 0.00789835572226349, 0.01338213524161403, 0.02025705532194294, 0.02823630361702544, 0.03695572050676142, 0.04602304795577315, 0.05505665966666456, 0.06371296898913710, 0.07170344295388717, 0.07880295151449268, 0.08485142075534920, 0.08975068129657299, 0.09345816505811241, 0.09597880222916909, 0.09735616324987534, 0.09766360928050266, 0.09699597378019932, 0.09546210197243390, 0.09317842271962956, 0.09026361410621567, 0.08683434392241829, 0.08300201306623395, 0.07887039780659870, 0.07453407071568272, 0.07007747551745193, 0.06557453455302155, 0.06108867621875374, 0.05667318143671617, 0.05237176137200857, 0.04821929207660433, 0.04424264473688692, 0.04046156223564670, 0.03688954352495671, 0.03353470671550786, 0.03040060980185559, 0.02748701461677905, 0.02479058504331021, 0.02230551483783126, 0.02002408377113870, 0.01793714331664880, 0.01603453494009415, 0.01430544529693118, 0.01273870343335294, 0.01132302551167412, 0.01004721272461281, 0.00890030799620372, 0.00787171684822050, 0.00695129748767814, 0.00612942478130145, 0.00539703235663143, 0.00474563662957293, 0.00416734612173053, 0.00365485901013236, 0.00320145145534832, 0.00280095888695718, 0.00244775209081041, 0.00213670964176505, 0.00186318795834816, 0.00162299002103595, 0.00141233359167920, 0.00122781959585666, 0.00106640118012353, 0.00092535382968046, 0.00080224682636521, 0.00069491623959193, 0.00060143957159529, 0.00052011212090836, 0.00044942508242958, 0.00038804536692512, 0.00033479709577004, 0.00028864470674360, 0.00024867759252635, 0.00021409618412918, 0.00018419938589579, 0.00015837326617777, 0.00013608090761931, 0.00011685332265391, 0.00010028134284286, 0.00008600839469684, 0.00007372407930649, 0.00006315847821544, 0.00005407711330157, 0.00004627649383364, 0.00003958018922035, 0.00003383537117809, 0.00002890977404635, 0.00002468902672965, 0.00002107431421345, 0.00001798033077076, 0.00001533349083958, 0.00001307036710984, 0.00001113632861790, 0.00000948435461894, 0.00000807400270484, 0.00000687051207480};
    // run Temper chisquare::pdf
    Tensor<float> result = stats::chisquare::pdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.pdf_random_test_dof_11
  * @brief Randomly generated chisquare pdf test on 100 matrix with dof = 11.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, pdf_random_test_dof_11)
{
    Tensor<float> x({100});
    x = std::vector<float>{0.00000000000000000, 0.43434343434343436, 0.86868686868686873, 1.30303030303030321, 1.73737373737373746, 2.17171717171717171, 2.60606060606060641, 3.04040404040404066, 3.47474747474747492, 3.90909090909090917, 4.34343434343434343, 4.77777777777777768, 5.21212121212121282, 5.64646464646464707, 6.08080808080808133, 6.51515151515151558, 6.94949494949494984, 7.38383838383838409, 7.81818181818181834, 8.25252525252525260, 8.68686868686868685, 9.12121212121212110, 9.55555555555555536, 9.98989898989898961, 10.42424242424242564, 10.85858585858585990, 11.29292929292929415, 11.72727272727272840, 12.16161616161616266, 12.59595959595959691, 13.03030303030303116, 13.46464646464646542, 13.89898989898989967, 14.33333333333333393, 14.76767676767676818, 15.20202020202020243, 15.63636363636363669, 16.07070707070707272, 16.50505050505050519, 16.93939393939394122, 17.37373737373737370, 17.80808080808080973, 18.24242424242424221, 18.67676767676767824, 19.11111111111111072, 19.54545454545454675, 19.97979797979797922, 20.41414141414141525, 20.84848484848485128, 21.28282828282828376, 21.71717171717171979, 22.15151515151515227, 22.58585858585858830, 23.02020202020202078, 23.45454545454545681, 23.88888888888888928, 24.32323232323232531, 24.75757575757575779, 25.19191919191919382, 25.62626262626262630, 26.06060606060606233, 26.49494949494949481, 26.92929292929293084, 27.36363636363636331, 27.79797979797979934, 28.23232323232323537, 28.66666666666666785, 29.10101010101010388, 29.53535353535353636, 29.96969696969697239, 30.40404040404040487, 30.83838383838384090, 31.27272727272727337, 31.70707070707070940, 32.14141414141414543, 32.57575757575757791, 33.01010101010101039, 33.44444444444444287, 33.87878787878788245, 34.31313131313131493, 34.74747474747474740, 35.18181818181818699, 35.61616161616161946, 36.05050505050505194, 36.48484848484848442, 36.91919191919192400, 37.35353535353535648, 37.78787878787878896, 38.22222222222222143, 38.65656565656566102, 39.09090909090909349, 39.52525252525252597, 39.95959595959595845, 40.39393939393939803, 40.82828282828283051, 41.26262626262626299, 41.69696969696970257, 42.13131313131313505, 42.56565656565656752, 43.00000000000000000};
    Tensor<float> k({1});
    k = 11.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{0.00000000000000000, 0.00000796913994240, 0.00014512089743802, 0.00072414267636463, 0.00212682608962347, 0.00467208310565861, 0.00854101900230299, 0.01375478362825411, 0.02018836025820777, 0.02760393007938496, 0.03569136418899002, 0.04410763302766166, 0.05251045702984833, 0.06058411915867726, 0.06805709302149406, 0.07471218221351607, 0.08039040181359905, 0.08499002270273094, 0.08846217103856521, 0.09080422299538116, 0.09205202449435511, 0.09227174030777738, 0.09155192298338093, 0.08999620385310786, 0.08771685215357537, 0.08482932493347153, 0.08144783776602642, 0.07768192048300922, 0.07363387870221740, 0.06939705630498194, 0.06505478204476686, 0.06067988147257883, 0.05633464029016216, 0.05207111462530663, 0.04793169565257024, 0.04394984902586385, 0.04015096271928861, 0.03655324939004410, 0.03316866084081205, 0.03000378232411429, 0.02706068319786943, 0.02433770781222277, 0.02183019655384503, 0.01953113180894385, 0.01743170736682486, 0.01552182261724779, 0.01379050494106879, 0.01222626509088298, 0.01081739123085780, 0.00955218776295451, 0.00841916520584248, 0.00740718729406509, 0.00650558119581375, 0.00570421636293035, 0.00499355707036127, 0.00436469320850352, 0.00380935338682411, 0.00331990391009373, 0.00288933671325544, 0.00251124889654824, 0.00217981609466164, 0.00188976154530057, 0.00163632239439605, 0.00141521448659823, 0.00122259663885132, 0.00105503517928703, 0.00090946935046525, 0.00078317802200840, 0.00067374802973806, 0.00057904435341568, 0.00049718226014421, 0.00042650147264030, 0.00036554236840112, 0.00031302417497945, 0.00026782509610749, 0.00022896428147931, 0.00019558553805032, 0.00016694267139158, 0.00014238634079454, 0.00012135231048286, 0.00010335098063581, 0.00008795808528219, 0.00007480644892879, 0.00006357869958808, 0.00005400084230330, 0.00004583660404580, 0.00003888246775545, 0.00003296332013725, 0.00002792864448847, 0.00002364919621768, 0.00002001410476645, 0.00001692835131559, 0.00001431057692837, 0.00001209118064463, 0.00001021067149476, 0.00000861824246202, 0.00000727053810065, 0.00000613059083752, 0.00000516690396789, 0.00000435266202581};
    // run Temper chisquare::pdf
    Tensor<float> result = stats::chisquare::pdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.pdf_random_test_dof_12
  * @brief Randomly generated chisquare pdf test on 100 matrix with dof = 12.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, pdf_random_test_dof_12)
{
    Tensor<float> x({100});
    x = std::vector<float>{0.00000000000000000, 0.46464646464646464, 0.92929292929292928, 1.39393939393939403, 1.85858585858585856, 2.32323232323232309, 2.78787878787878807, 3.25252525252525260, 3.71717171717171713, 4.18181818181818166, 4.64646464646464619, 5.11111111111111072, 5.57575757575757613, 6.04040404040404066, 6.50505050505050519, 6.96969696969696972, 7.43434343434343425, 7.89898989898989878, 8.36363636363636331, 8.82828282828282873, 9.29292929292929237, 9.75757575757575779, 10.22222222222222143, 10.68686868686868685, 11.15151515151515227, 11.61616161616161591, 12.08080808080808133, 12.54545454545454497, 13.01010101010101039, 13.47474747474747403, 13.93939393939393945, 14.40404040404040309, 14.86868686868686851, 15.33333333333333393, 15.79797979797979757, 16.26262626262626299, 16.72727272727272663, 17.19191919191919027, 17.65656565656565746, 18.12121212121212110, 18.58585858585858475, 19.05050505050505194, 19.51515151515151558, 19.97979797979797922, 20.44444444444444287, 20.90909090909091006, 21.37373737373737370, 21.83838383838383734, 22.30303030303030454, 22.76767676767676818, 23.23232323232323182, 23.69696969696969546, 24.16161616161616266, 24.62626262626262630, 25.09090909090908994, 25.55555555555555358, 26.02020202020202078, 26.48484848484848442, 26.94949494949494806, 27.41414141414141525, 27.87878787878787890, 28.34343434343434254, 28.80808080808080618, 29.27272727272727337, 29.73737373737373701, 30.20202020202020066, 30.66666666666666785, 31.13131313131313149, 31.59595959595959513, 32.06060606060606233, 32.52525252525252597, 32.98989898989898961, 33.45454545454545325, 33.91919191919191690, 34.38383838383838054, 34.84848484848485128, 35.31313131313131493, 35.77777777777777857, 36.24242424242424221, 36.70707070707070585, 37.17171717171716949, 37.63636363636363313, 38.10101010101010388, 38.56565656565656752, 39.03030303030303116, 39.49494949494949481, 39.95959595959595845, 40.42424242424242209, 40.88888888888888573, 41.35353535353535648, 41.81818181818182012, 42.28282828282828376, 42.74747474747474740, 43.21212121212121104, 43.67676767676767469, 44.14141414141413833, 44.60606060606060908, 45.07070707070707272, 45.53535353535353636, 46.00000000000000000};
    Tensor<float> k({1});
    k = 12.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{0.00000000000000000, 0.00000223540010798, 0.00005670332787819, 0.00034132503665664, 0.00114015824128647, 0.00275815391668053, 0.00544036490538416, 0.00932105951056062, 0.01440549937079772, 0.02057757684723474, 0.02762389962183588, 0.03526563556527876, 0.04319145374378532, 0.05108714764195142, 0.05865950236672795, 0.06565348640474940, 0.07186289579751469, 0.07713521767027666, 0.08137180135376723, 0.08452451970578395, 0.08659004939601948, 0.08760275913683707, 0.08762701495466678, 0.08674952304958415, 0.08507215345582915, 0.08270553271942123, 0.07976356604265526, 0.07635894952650610, 0.07259965940571861, 0.06858635424073807, 0.06441059403478208, 0.06015376325797522, 0.05588657913293259, 0.05166906906894161, 0.04755090915101852, 0.04357202695045299, 0.03976338497127960, 0.03614787456068469, 0.03274126323241346, 0.02955315051716554, 0.02658789832964990, 0.02384551126926814, 0.02132245021719985, 0.01901236911072630, 0.01690676997552686, 0.01499557531997465, 0.01326761999804598, 0.01171106678698490, 0.01031375135317266, 0.00906346313344453, 0.00794816906293104, 0.00695618714157783, 0.00607631664063153, 0.00529793138282709, 0.00461104204677195, 0.00400633289542102, 0.00347517774791476, 0.00300963943142603, 0.00260245638530370, 0.00224701955767570, 0.00193734224371084, 0.00166802506993779, 0.00143421793239038, 0.00123158034768650, 0.00105624137367865, 0.00090475999719831, 0.00077408666715824, 0.00066152646802982, 0.00056470427751538, 0.00048153212917874, 0.00041017890214240, 0.00034904238221898, 0.00029672367882303, 0.00025200393683262, 0.00021382324968487, 0.00018126165716037, 0.00015352209660036, 0.00012991516804821, 0.00010984557060779, 0.00009280006798555, 0.00007833684475304, 0.00006607612052819, 0.00005569189637757, 0.00004690471576462, 0.00003947533090130, 0.00003319917408224, 0.00002790154224965, 0.00002343341147422, 0.00001966780611365, 0.00001649665503970, 0.00001382807445148, 0.00001158402338953, 0.00000969828412084, 0.00000811472508740, 0.00000678580911386, 0.00000567131407922, 0.00000473723730104, 0.00000395485849081, 0.00000329993934919, 0.00000275204071393};
    // run Temper chisquare::pdf
    Tensor<float> result = stats::chisquare::pdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.pdf_random_test_dof_13
  * @brief Randomly generated chisquare pdf test on 100 matrix with dof = 13.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, pdf_random_test_dof_13)
{
    Tensor<float> x({100});
    x = std::vector<float>{0.00000000000000000, 0.49494949494949497, 0.98989898989898994, 1.48484848484848486, 1.97979797979797989, 2.47474747474747492, 2.96969696969696972, 3.46464646464646497, 3.95959595959595978, 4.45454545454545503, 4.94949494949494984, 5.44444444444444464, 5.93939393939393945, 6.43434343434343425, 6.92929292929292995, 7.42424242424242475, 7.91919191919191956, 8.41414141414141525, 8.90909090909091006, 9.40404040404040487, 9.89898989898989967, 10.39393939393939448, 10.88888888888888928, 11.38383838383838409, 11.87878787878787890, 12.37373737373737370, 12.86868686868686851, 13.36363636363636509, 13.85858585858585990, 14.35353535353535470, 14.84848484848484951, 15.34343434343434431, 15.83838383838383912, 16.33333333333333570, 16.82828282828283051, 17.32323232323232531, 17.81818181818182012, 18.31313131313131493, 18.80808080808080973, 19.30303030303030454, 19.79797979797979934, 20.29292929292929415, 20.78787878787878896, 21.28282828282828376, 21.77777777777777857, 22.27272727272727337, 22.76767676767676818, 23.26262626262626299, 23.75757575757575779, 24.25252525252525260, 24.74747474747474740, 25.24242424242424221, 25.73737373737373701, 26.23232323232323182, 26.72727272727273018, 27.22222222222222499, 27.71717171717171979, 28.21212121212121460, 28.70707070707070940, 29.20202020202020421, 29.69696969696969902, 30.19191919191919382, 30.68686868686868863, 31.18181818181818343, 31.67676767676767824, 32.17171717171717660, 32.66666666666667140, 33.16161616161616621, 33.65656565656566102, 34.15151515151515582, 34.64646464646465063, 35.14141414141414543, 35.63636363636364024, 36.13131313131313505, 36.62626262626262985, 37.12121212121212466, 37.61616161616161946, 38.11111111111111427, 38.60606060606060908, 39.10101010101010388, 39.59595959595959869, 40.09090909090909349, 40.58585858585858830, 41.08080808080808310, 41.57575757575757791, 42.07070707070707272, 42.56565656565656752, 43.06060606060606233, 43.55555555555555713, 44.05050505050505194, 44.54545454545454675, 45.04040404040404155, 45.53535353535353636, 46.03030303030303116, 46.52525252525252597, 47.02020202020202078, 47.51515151515151558, 48.01010101010101039, 48.50505050505050519, 49.00000000000000000};
    Tensor<float> k({1});
    k = 13.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{0.00000000000000000, 0.00000062617182849, 0.00002212491361470, 0.00016065956667492, 0.00061036936151258, 0.00162600126704758, 0.00346051563443448, 0.00630770307513303, 0.01026478914185924, 0.01531835001942017, 0.02135016666726271, 0.02815685347131376, 0.03547678764605765, 0.04301886576601039, 0.05048911949843992, 0.05761275034113678, 0.06415044462613670, 0.06990881112541272, 0.07474544120874375, 0.07856946930552354, 0.08133867123463295, 0.08305414295320294, 0.08375350816622763, 0.08350345473265366, 0.08239223004288956, 0.08052255723409109, 0.07800528135900858, 0.07495392493525822, 0.07148022843136127, 0.06769067277364195, 0.06368392552919826, 0.05954911667182752, 0.05536483005241367, 0.05119868923058052, 0.04710741787222104, 0.04313726263677699, 0.03932467804073606, 0.03569718636345753, 0.03227433988861442, 0.02906872667411610, 0.02608697396617908, 0.02333071492915764, 0.02079749435965182, 0.01848159744402677, 0.01637479245627600, 0.01446698369684626, 0.01274677509907103, 0.01120194795179899, 0.00981985828067496, 0.00858776076469244, 0.00749306679356515, 0.00652354453218256, 0.00566746876912888, 0.00491372798632487, 0.00425189557786416, 0.00367227153337201, 0.00316590023569492, 0.00272456934306359, 0.00234079406032066, 0.00200779047210734, 0.00171944102594437, 0.00147025472243477, 0.00125532409675064, 0.00107028066048488, 0.00091125011400393, 0.00077480833330570, 0.00065793887781215, 0.00055799255175222, 0.00047264937688231, 0.00039988319336008, 0.00033792899396085, 0.00028525301014893, 0.00024052550281680, 0.00020259616222116, 0.00017047198763459, 0.00014329749475747, 0.00012033708564568, 0.00010095940980799, 0.00008462354453578, 0.00007086682605728, 0.00005929416961761, 0.00004956872515268, 0.00004140372511306, 0.00003455539162335, 0.00002881678108733, 0.00002401245523076, 0.00001999387816407, 0.00001663544917040, 0.00001383109046258, 0.00001149131803316, 0.00000954073190792, 0.00000791586959476, 0.00000656337330708, 0.00000543842765742, 0.00000450342999793, 0.00000372686046947, 0.00000308232315519, 0.00000254773356280, 0.00000210463102871, 0.00000173759759050};
    // run Temper chisquare::pdf
    Tensor<float> result = stats::chisquare::pdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.pdf_random_test_dof_14
  * @brief Randomly generated chisquare pdf test on 100 matrix with dof = 14.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, pdf_random_test_dof_14)
{
    Tensor<float> x({100});
    x = std::vector<float>{0.00000000000000000, 0.52525252525252530, 1.05050505050505061, 1.57575757575757591, 2.10101010101010122, 2.62626262626262630, 3.15151515151515182, 3.67676767676767735, 4.20202020202020243, 4.72727272727272751, 5.25252525252525260, 5.77777777777777857, 6.30303030303030365, 6.82828282828282873, 7.35353535353535470, 7.87878787878787978, 8.40404040404040487, 8.92929292929293084, 9.45454545454545503, 9.97979797979798100, 10.50505050505050519, 11.03030303030303116, 11.55555555555555713, 12.08080808080808133, 12.60606060606060730, 13.13131313131313327, 13.65656565656565746, 14.18181818181818343, 14.70707070707070940, 15.23232323232323360, 15.75757575757575957, 16.28282828282828376, 16.80808080808080973, 17.33333333333333570, 17.85858585858586167, 18.38383838383838409, 18.90909090909091006, 19.43434343434343603, 19.95959595959596200, 20.48484848484848797, 21.01010101010101039, 21.53535353535353636, 22.06060606060606233, 22.58585858585858830, 23.11111111111111427, 23.63636363636364024, 24.16161616161616266, 24.68686868686868863, 25.21212121212121460, 25.73737373737374057, 26.26262626262626654, 26.78787878787878896, 27.31313131313131493, 27.83838383838384090, 28.36363636363636687, 28.88888888888889284, 29.41414141414141881, 29.93939393939394122, 30.46464646464646719, 30.98989898989899316, 31.51515151515151913, 32.04040404040404155, 32.56565656565656752, 33.09090909090909349, 33.61616161616161946, 34.14141414141414543, 34.66666666666667140, 35.19191919191919737, 35.71717171717172334, 36.24242424242424931, 36.76767676767676818, 37.29292929292929415, 37.81818181818182012, 38.34343434343434609, 38.86868686868687206, 39.39393939393939803, 39.91919191919192400, 40.44444444444444997, 40.96969696969697594, 41.49494949494950191, 42.02020202020202078, 42.54545454545454675, 43.07070707070707272, 43.59595959595959869, 44.12121212121212466, 44.64646464646465063, 45.17171717171717660, 45.69696969696970257, 46.22222222222222854, 46.74747474747475451, 47.27272727272728048, 47.79797979797979934, 48.32323232323232531, 48.84848484848485128, 49.37373737373737725, 49.89898989898990322, 50.42424242424242919, 50.94949494949495516, 51.47474747474748114, 52.00000000000000000};
    Tensor<float> k({1});
    k = 14.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{0.00000000000000000, 0.00000017523033510, 0.00000862446429982, 0.00007554792603944, 0.00032643583606526, 0.00095763667672979, 0.00219902977855732, 0.00426436835224513, 0.00730717076653628, 0.01139219092519480, 0.01648523192763587, 0.02245918723951391, 0.02911174674522947, 0.03618959853879760, 0.04341449253131349, 0.05050762328124071, 0.05721002499342354, 0.06329780253269686, 0.06859192619381892, 0.07296295881176386, 0.07633147751287171, 0.07866514122190083, 0.07997339014104463, 0.08030069443351499, 0.07971913882506394, 0.07832097110069937, 0.07621157953732038, 0.07350321294864051, 0.07030962630603187, 0.06674172886652759, 0.06290423087252647, 0.05889322739433161, 0.05479462068709214, 0.05068326189068387, 0.04662268532079707, 0.04266531054951889, 0.03885299595987454, 0.03521784000106219, 0.03178314101027822, 0.02856444172854331, 0.02557059947172964, 0.02280483662827576, 0.02026573832921504, 0.01794817457838495, 0.01584413280382036, 0.01394345376782712, 0.01223446919561495, 0.01070454353266541, 0.00934052511777503, 0.00812911396081003, 0.00705715442981248, 0.00611186165201940, 0.00528099046744214, 0.00455295546960860, 0.00391691013180056, 0.00336279233418606, 0.00288134284491015, 0.00246410251777047, 0.00210339318832878, 0.00179228650575752, 0.00152456424689999, 0.00129467303231275, 0.00109767580637089, 0.00092920195570229, 0.00078539752022036, 0.00066287659482948, 0.00055867472223264, 0.00047020483226826, 0.00039521608469567, 0.00033175581425988, 0.00027813465340035, 0.00023289481374937, 0.00019478143771309, 0.00016271688159684, 0.00013577775811741, 0.00011317454544956, 0.00009423355938111, 0.00007838108234466, 0.00006512944610078, 0.00005406487206319, 0.00004483688338995, 0.00003714911498086, 0.00003075136061597, 0.00002543271001812, 0.00002101564215912, 0.00001735095431150, 0.00001431341893585, 0.00001179807232877, 0.00000971704994178, 0.00000799689336888, 0.00000657626318060, 0.00000540400006879, 0.00000443748419628, 0.00000364124926484, 0.00000298581368046, 0.00000244669636660, 0.00000200358931463, 0.00000163966292797, 0.00000134098367083, 0.00000109602652900};
    // run Temper chisquare::pdf
    Tensor<float> result = stats::chisquare::pdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.pdf_random_test_dof_15
  * @brief Randomly generated chisquare pdf test on 100 matrix with dof = 15.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, pdf_random_test_dof_15)
{
    Tensor<float> x({100});
    x = std::vector<float>{0.00000000000000000, 0.55555555555555558, 1.11111111111111116, 1.66666666666666674, 2.22222222222222232, 2.77777777777777768, 3.33333333333333348, 3.88888888888888928, 4.44444444444444464, 5.00000000000000000, 5.55555555555555536, 6.11111111111111160, 6.66666666666666696, 7.22222222222222232, 7.77777777777777857, 8.33333333333333393, 8.88888888888888928, 9.44444444444444464, 10.00000000000000000, 10.55555555555555536, 11.11111111111111072, 11.66666666666666785, 12.22222222222222321, 12.77777777777777857, 13.33333333333333393, 13.88888888888888928, 14.44444444444444464, 15.00000000000000000, 15.55555555555555713, 16.11111111111111072, 16.66666666666666785, 17.22222222222222143, 17.77777777777777857, 18.33333333333333570, 18.88888888888888928, 19.44444444444444642, 20.00000000000000000, 20.55555555555555713, 21.11111111111111072, 21.66666666666666785, 22.22222222222222143, 22.77777777777777857, 23.33333333333333570, 23.88888888888888928, 24.44444444444444642, 25.00000000000000000, 25.55555555555555713, 26.11111111111111072, 26.66666666666666785, 27.22222222222222499, 27.77777777777777857, 28.33333333333333570, 28.88888888888888928, 29.44444444444444642, 30.00000000000000000, 30.55555555555555713, 31.11111111111111427, 31.66666666666666785, 32.22222222222222143, 32.77777777777777857, 33.33333333333333570, 33.88888888888889284, 34.44444444444444287, 35.00000000000000000, 35.55555555555555713, 36.11111111111111427, 36.66666666666667140, 37.22222222222222143, 37.77777777777777857, 38.33333333333333570, 38.88888888888889284, 39.44444444444444287, 40.00000000000000000, 40.55555555555555713, 41.11111111111111427, 41.66666666666667140, 42.22222222222222143, 42.77777777777777857, 43.33333333333333570, 43.88888888888889284, 44.44444444444444287, 45.00000000000000000, 45.55555555555555713, 46.11111111111111427, 46.66666666666667140, 47.22222222222222143, 47.77777777777777857, 48.33333333333333570, 48.88888888888889284, 49.44444444444444997, 50.00000000000000000, 50.55555555555555713, 51.11111111111111427, 51.66666666666667140, 52.22222222222222143, 52.77777777777777857, 53.33333333333333570, 53.88888888888889284, 54.44444444444444997, 55.00000000000000000};
    Tensor<float> k({1});
    k = 15.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{0.00000000000000000, 0.00000004900423125, 0.00000335962803247, 0.00003550152623710, 0.00017446626188396, 0.00056362361930852, 0.00139646458949989, 0.00288102285930666, 0.00519824809937816, 0.00846663901025275, 0.01272030063988253, 0.01790245015762848, 0.02387265726315390, 0.03042405500429784, 0.03730612863682964, 0.04424903249334541, 0.05098625651317330, 0.05727351957285197, 0.06290277576142639, 0.06771105448763265, 0.07158446554073519, 0.07445808711622479, 0.07631264881005896, 0.07716896595525150, 0.07708102156410780, 0.07612846813065667, 0.07440916658798423, 0.07203221829070330, 0.06911179456243216, 0.06576193697411224, 0.06209239474906591, 0.05820548441325483, 0.05419389943004405, 0.05013936103472007, 0.04611198210409922, 0.04217020983256097, 0.03836121664925469, 0.03472161905834607, 0.03127841830888795, 0.02805007294974964, 0.02504762986256283, 0.02227585621159577, 0.01973432920336624, 0.01741845321273204, 0.01532038453826710, 0.01342985279634910, 0.01173487486165946, 0.01022236249258995, 0.00887862856082276, 0.00768979936475334, 0.00664214207123958, 0.00572231710814257, 0.00491756550750518, 0.00421584093664099, 0.00360589558634410, 0.00307732832127135, 0.00262060262373189, 0.00222704094483156, 0.00188880116503390, 0.00159883999416773, 0.00135086733150403, 0.00113929487329846, 0.00095918160463855, 0.00080617824579599, 0.00067647223808625, 0.00056673444548801, 0.00047406840943342, 0.00039596271788698, 0.00033024682845788, 0.00027505051132839, 0.00022876694410866, 0.00019001939077974, 0.00015763132474512, 0.00013059980644920, 0.00010807189449437, 0.00008932385181359, 0.00007374290195368, 0.00006081129217577, 0.00005009242765006, 0.00004121885270966, 0.00003388186949971, 0.00002782260029049, 0.00002282431635814, 0.00001870587302882, 0.00001531610676324, 0.00001252906570168, 0.00001023995967793, 0.00000836172921603, 0.00000682214538389, 0.00000556136357880, 0.00000452986438649, 0.00000368672363458, 0.00000299816171866, 0.00000243632929018, 0.00000197829253932, 0.00000160518666445, 0.00000130151077329, 0.00000105454148488, 0.00000085384596892, 0.00000069087813647};
    // run Temper chisquare::pdf
    Tensor<float> result = stats::chisquare::pdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.pdf_random_test_dof_16
  * @brief Randomly generated chisquare pdf test on 100 matrix with dof = 16.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, pdf_random_test_dof_16)
{
    Tensor<float> x({100});
    x = std::vector<float>{0.00000000000000000, 0.58585858585858586, 1.17171717171717171, 1.75757575757575757, 2.34343434343434343, 2.92929292929292906, 3.51515151515151514, 4.10101010101010122, 4.68686868686868685, 5.27272727272727249, 5.85858585858585812, 6.44444444444444464, 7.03030303030303028, 7.61616161616161591, 8.20202020202020243, 8.78787878787878718, 9.37373737373737370, 9.95959595959596022, 10.54545454545454497, 11.13131313131313149, 11.71717171717171624, 12.30303030303030276, 12.88888888888888928, 13.47474747474747403, 14.06060606060606055, 14.64646464646464707, 15.23232323232323182, 15.81818181818181834, 16.40404040404040487, 16.98989898989898961, 17.57575757575757436, 18.16161616161616266, 18.74747474747474740, 19.33333333333333215, 19.91919191919192045, 20.50505050505050519, 21.09090909090908994, 21.67676767676767824, 22.26262626262626299, 22.84848484848484773, 23.43434343434343248, 24.02020202020202078, 24.60606060606060552, 25.19191919191919027, 25.77777777777777857, 26.36363636363636331, 26.94949494949494806, 27.53535353535353636, 28.12121212121212110, 28.70707070707070585, 29.29292929292929415, 29.87878787878787890, 30.46464646464646364, 31.05050505050505194, 31.63636363636363669, 32.22222222222222143, 32.80808080808080973, 33.39393939393939092, 33.97979797979797922, 34.56565656565656752, 35.15151515151514872, 35.73737373737373701, 36.32323232323232531, 36.90909090909090651, 37.49494949494949481, 38.08080808080808310, 38.66666666666666430, 39.25252525252525260, 39.83838383838384090, 40.42424242424242209, 41.01010101010101039, 41.59595959595959869, 42.18181818181817988, 42.76767676767676818, 43.35353535353535648, 43.93939393939393767, 44.52525252525252597, 45.11111111111111427, 45.69696969696969546, 46.28282828282828376, 46.86868686868686495, 47.45454545454545325, 48.04040404040404155, 48.62626262626262275, 49.21212121212121104, 49.79797979797979934, 50.38383838383838054, 50.96969696969696884, 51.55555555555555713, 52.14141414141413833, 52.72727272727272663, 53.31313131313131493, 53.89898989898989612, 54.48484848484848442, 55.07070707070707272, 55.65656565656565391, 56.24242424242424221, 56.82828282828283051, 57.41414141414141170, 58.00000000000000000};
    Tensor<float> k({1});
    k = 16.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{0.00000000000000000, 0.00000001369813732, 0.00000130813904822, 0.00001667535727219, 0.00009320275034766, 0.00033157459193552, 0.00088640539493907, 0.00194554975827668, 0.00369631007364316, 0.00628953412071228, 0.00981077545629065, 0.01426377752791706, 0.01956757050158680, 0.02556548732308840, 0.03204271327542422, 0.03874844438522244, 0.04541902023087260, 0.05179916476540698, 0.05765941975048106, 0.06280878076686319, 0.06710232227955384, 0.07044417194950078, 0.07278656018991646, 0.07412585341585101, 0.07449651743489467, 0.07396389340466215, 0.07261654194135897, 0.07055875374929775, 0.06790366201103570, 0.06476723943713478, 0.06126333132800024, 0.05749976994897483, 0.05357553579666621, 0.04957887619832635, 0.04558625788985737, 0.04166201382590729, 0.03785854144422381, 0.03421691616349504, 0.03076779675480488, 0.02753251569155001, 0.02452426554842213, 0.02174931044054468, 0.01920816830803858, 0.01689672489942477, 0.01480725324528454, 0.01292932313364274, 0.01125059365955251, 0.00975748849143537, 0.00843575830744459, 0.00727093816688695, 0.00624870965886697, 0.00535517876411101, 0.00457708070418442, 0.00390192283376285, 0.00331807602394809, 0.00281482412498264, 0.00238238009388755, 0.00201187630997486, 0.00169533554051313, 0.00142562800347456, 0.00119641903289348, 0.00100211100187993, 0.00083778240679411, 0.00069912636494196, 0.00058239022418506, 0.00048431751975235, 0.00040209313309557, 0.00033329220069212, 0.00027583307784554, 0.00022793447455841, 0.00018807673878978, 0.00015496715893194, 0.00012750908506930, 0.00010477462131149, 0.00008598061389040, 0.00007046764725882, 0.00005768175936509, 0.00004715859451397, 0.00003850972526361, 0.00003141089166738, 0.00002559192529779, 0.00002082814570145, 0.00001693303734182, 0.00001375203504931, 0.00001115726506595, 0.00000904310665365, 0.00000732245575347, 0.00000592358725749, 0.00000478752606497, 0.00000386584927507, 0.00000311885268173, 0.00000251402427074, 0.00000202477577321, 0.00000162939060826, 0.00000131015285792, 0.00000105262736194, 0.00000084506569792, 0.00000067791681567, 0.00000054342450839, 0.00000043529680346};
    // run Temper chisquare::pdf
    Tensor<float> result = stats::chisquare::pdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.pdf_random_test_dof_17
  * @brief Randomly generated chisquare pdf test on 100 matrix with dof = 17.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, pdf_random_test_dof_17)
{
    Tensor<float> x({100});
    x = std::vector<float>{0.00000000000000000, 0.61616161616161613, 1.23232323232323226, 1.84848484848484840, 2.46464646464646453, 3.08080808080808044, 3.69696969696969679, 4.31313131313131315, 4.92929292929292906, 5.54545454545454497, 6.16161616161616088, 6.77777777777777768, 7.39393939393939359, 8.01010101010101039, 8.62626262626262630, 9.24242424242424221, 9.85858585858585812, 10.47474747474747403, 11.09090909090908994, 11.70707070707070585, 12.32323232323232176, 12.93939393939393945, 13.55555555555555536, 14.17171717171717127, 14.78787878787878718, 15.40404040404040309, 16.02020202020202078, 16.63636363636363669, 17.25252525252525260, 17.86868686868686851, 18.48484848484848442, 19.10101010101010033, 19.71717171717171624, 20.33333333333333215, 20.94949494949494806, 21.56565656565656397, 22.18181818181817988, 22.79797979797979579, 23.41414141414141170, 24.03030303030302761, 24.64646464646464352, 25.26262626262626299, 25.87878787878787890, 26.49494949494949481, 27.11111111111111072, 27.72727272727272663, 28.34343434343434254, 28.95959595959595845, 29.57575757575757436, 30.19191919191919027, 30.80808080808080618, 31.42424242424242209, 32.04040404040404155, 32.65656565656565391, 33.27272727272727337, 33.88888888888888573, 34.50505050505050519, 35.12121212121211755, 35.73737373737373701, 36.35353535353534937, 36.96969696969696884, 37.58585858585858119, 38.20202020202020066, 38.81818181818181301, 39.43434343434343248, 40.05050505050505194, 40.66666666666666430, 41.28282828282828376, 41.89898989898989612, 42.51515151515151558, 43.13131313131312794, 43.74747474747474740, 44.36363636363635976, 44.97979797979797922, 45.59595959595959158, 46.21212121212121104, 46.82828282828282340, 47.44444444444444287, 48.06060606060605522, 48.67676767676767469, 49.29292929292928704, 49.90909090909090651, 50.52525252525252597, 51.14141414141413833, 51.75757575757575779, 52.37373737373737015, 52.98989898989898961, 53.60606060606060197, 54.22222222222222143, 54.83838383838383379, 55.45454545454545325, 56.07070707070706561, 56.68686868686868507, 57.30303030303029743, 57.91919191919191690, 58.53535353535352925, 59.15151515151514872, 59.76767676767676818, 60.38383838383838054, 61.00000000000000000};
    Tensor<float> k({1});
    k = 17.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{0.00000000000000000, 0.00000000382792102, 0.00000050920204777, 0.00000783027093803, 0.00004977594560058, 0.00019500548259609, 0.00056248166720940, 0.00131344381416094, 0.00262756402348379, 0.00467088774781337, 0.00756454506682702, 0.01136135573805591, 0.01603417318467531, 0.02147655270405688, 0.02751388403303584, 0.03392175263546412, 0.04044789407463538, 0.04683442152569744, 0.05283774120827132, 0.05824446592918609, 0.06288250481997229, 0.06662723350429416, 0.06940318186229291, 0.07118201056016833, 0.07197770554676097, 0.07183993913066750, 0.07084646829597165, 0.06909530400534840, 0.06669722129198270, 0.06376901300363413, 0.06042773644823125, 0.05678607148638465, 0.05294880506841897, 0.04901038118276078, 0.04505340446844756, 0.04114795668292866, 0.03735157351935736, 0.03370973061798826, 0.03025669804946561, 0.02701663866442679, 0.02400484475659769, 0.02122902737972400, 0.01869059189318606, 0.01638585089986588, 0.01430714111148421, 0.01244382358039355, 0.01078315715542443, 0.00931104309450905, 0.00801264473827092, 0.00687289030740119, 0.00587686953940719, 0.00501013632609136, 0.00425893002703457, 0.00361032795893957, 0.00305234090197850, 0.00257396249152616, 0.00216518221135217, 0.00181697047571793, 0.00152124305901408, 0.00127081095602578, 0.00105932066863716, 0.00088118893628314, 0.00073153506716716, 0.00060611328651373, 0.00050124689255998, 0.00041376549252478, 0.00034094616913881, 0.00028045909212826, 0.00023031782676050, 0.00018883439199222, 0.00015457897347304, 0.00012634409219311, 0.00010311295955380, 0.00008403170683200, 0.00006838515522812, 0.00005557578677004, 0.00004510558204281, 0.00003656040458575, 0.00002959663111183, 0.00002392974932003, 0.00001932466935807, 0.00001558751972889, 0.00001255872273819, 0.00001010716783691, 0.00000812532301998, 0.00000652514456163, 0.00000523466368207, 0.00000419514522567, 0.00000335872812696, 0.00000268647043202, 0.00000214673304252, 0.00000171384628602, 0.00000136701202676, 0.00000108940145148, 0.00000086741502888, 0.00000069007657487, 0.00000054853797436, 0.00000043567502290, 0.00000034575815210, 0.00000027418457917};
    // run Temper chisquare::pdf
    Tensor<float> result = stats::chisquare::pdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.pdf_random_test_dof_18
  * @brief Randomly generated chisquare pdf test on 100 matrix with dof = 18.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, pdf_random_test_dof_18)
{
    Tensor<float> x({100});
    x = std::vector<float>{0.00000000000000000, 0.64646464646464652, 1.29292929292929304, 1.93939393939393945, 2.58585858585858608, 3.23232323232323271, 3.87878787878787890, 4.52525252525252597, 5.17171717171717216, 5.81818181818181834, 6.46464646464646542, 7.11111111111111160, 7.75757575757575779, 8.40404040404040487, 9.05050505050505194, 9.69696969696969724, 10.34343434343434431, 10.98989898989899139, 11.63636363636363669, 12.28282828282828376, 12.92929292929293084, 13.57575757575757613, 14.22222222222222321, 14.86868686868687028, 15.51515151515151558, 16.16161616161616266, 16.80808080808080973, 17.45454545454545681, 18.10101010101010388, 18.74747474747474740, 19.39393939393939448, 20.04040404040404155, 20.68686868686868863, 21.33333333333333570, 21.97979797979798278, 22.62626262626262985, 23.27272727272727337, 23.91919191919192045, 24.56565656565656752, 25.21212121212121460, 25.85858585858586167, 26.50505050505050875, 27.15151515151515227, 27.79797979797979934, 28.44444444444444642, 29.09090909090909349, 29.73737373737374057, 30.38383838383838764, 31.03030303030303116, 31.67676767676767824, 32.32323232323232531, 32.96969696969697594, 33.61616161616161946, 34.26262626262626299, 34.90909090909091361, 35.55555555555555713, 36.20202020202020776, 36.84848484848485128, 37.49494949494949481, 38.14141414141414543, 38.78787878787878896, 39.43434343434343958, 40.08080808080808310, 40.72727272727273373, 41.37373737373737725, 42.02020202020202078, 42.66666666666667140, 43.31313131313131493, 43.95959595959596555, 44.60606060606060908, 45.25252525252525970, 45.89898989898990322, 46.54545454545454675, 47.19191919191919737, 47.83838383838384090, 48.48484848484849152, 49.13131313131313505, 49.77777777777777857, 50.42424242424242919, 51.07070707070707272, 51.71717171717172334, 52.36363636363636687, 53.01010101010101749, 53.65656565656566102, 54.30303030303030454, 54.94949494949495516, 55.59595959595959869, 56.24242424242424931, 56.88888888888889284, 57.53535353535354346, 58.18181818181818699, 58.82828282828283051, 59.47474747474748114, 60.12121212121212466, 60.76767676767677528, 61.41414141414141881, 62.06060606060606233, 62.70707070707071296, 63.35353535353535648, 64.00000000000000000};
    Tensor<float> k({1});
    k = 18.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{0.00000000000000000, 0.00000000106952203, 0.00000019817628700, 0.00000367623906222, 0.00002657881558770, 0.00011466680548062, 0.00035686969330835, 0.00088655558554273, 0.00186751256188054, 0.00346821248281842, 0.00583159838685509, 0.00904796837743663, 0.01313655676544928, 0.01803849841353999, 0.02362108460566050, 0.02969119025306149, 0.03601466523700898, 0.04233824753250290, 0.04841094197258702, 0.05400255222727330, 0.05891792305882701, 0.06300627539697494, 0.06616569543276872, 0.06834332573772070, 0.06953209900992176, 0.06976497793970973, 0.06910765576125930, 0.06765057253405636, 0.06550095010098893, 0.06277537527690183, 0.05959328937337263, 0.05607158806739668, 0.05232040751226018, 0.04844007379250194, 0.04451912285872735, 0.04063325401563710, 0.03684505762799478, 0.03320435222867436, 0.02974897304740396, 0.02650586899484580, 0.02349238487156257, 0.02071762729629743, 0.01818383454375777, 0.01588769076301013, 0.01382154305849037, 0.01197449522138777, 0.01033336437891783, 0.00888349658221160, 0.00760944462143313, 0.00649551645991378, 0.00552620597060041, 0.00468651948997437, 0.00396221240570944, 0.00333994985733471, 0.00280740490410728, 0.00235330640721919, 0.00196744754825039, 0.00164066448807812, 0.00136479325263568, 0.00113261157844680, 0.00093777120356954, 0.00077472497251386, 0.00063865214743107, 0.00052538448318356, 0.00043133492478206, 0.00035343021174638, 0.00028904821232659, 0.00023596044724075, 0.00019227998357261, 0.00015641467126094, 0.00012702554476473, 0.00010299010985723, 0.00008337017032165, 0.00006738381322493, 0.00005438115739367, 0.00004382347189443, 0.00003526528501126, 0.00002833912565812, 0.00002274256542257, 0.00001822725826238, 0.00001458970458833, 0.00001166349584937, 0.00000931282394409, 0.00000742706625941, 0.00000591628155129, 0.00000470747406931, 0.00000374150324572, 0.00000297053396843, 0.00000235593804172, 0.00000186657105301, 0.00000147736067450, 0.00000116815260866, 0.00000092276911226, 0.00000072824247266, 0.00000057419212295, 0.00000045231941504, 0.00000035599855662, 0.00000027994597817, 0.00000021995353677, 0.00000017267357735};
    // run Temper chisquare::pdf
    Tensor<float> result = stats::chisquare::pdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.pdf_random_test_dof_19
  * @brief Randomly generated chisquare pdf test on 100 matrix with dof = 19.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, pdf_random_test_dof_19)
{
    Tensor<float> x({100});
    x = std::vector<float>{0.00000000000000000, 0.67676767676767680, 1.35353535353535359, 2.03030303030303028, 2.70707070707070718, 3.38383838383838409, 4.06060606060606055, 4.73737373737373790, 5.41414141414141437, 6.09090909090909083, 6.76767676767676818, 7.44444444444444464, 8.12121212121212110, 8.79797979797979757, 9.47474747474747581, 10.15151515151515227, 10.82828282828282873, 11.50505050505050519, 12.18181818181818166, 12.85858585858585990, 13.53535353535353636, 14.21212121212121282, 14.88888888888888928, 15.56565656565656575, 16.24242424242424221, 16.91919191919192045, 17.59595959595959513, 18.27272727272727337, 18.94949494949495161, 19.62626262626262630, 20.30303030303030454, 20.97979797979797922, 21.65656565656565746, 22.33333333333333570, 23.01010101010101039, 23.68686868686868863, 24.36363636363636331, 25.04040404040404155, 25.71717171717171979, 26.39393939393939448, 27.07070707070707272, 27.74747474747474740, 28.42424242424242564, 29.10101010101010388, 29.77777777777777857, 30.45454545454545681, 31.13131313131313149, 31.80808080808080973, 32.48484848484848442, 33.16161616161616621, 33.83838383838384090, 34.51515151515151558, 35.19191919191919027, 35.86868686868687206, 36.54545454545454675, 37.22222222222222143, 37.89898989898990322, 38.57575757575757791, 39.25252525252525260, 39.92929292929293439, 40.60606060606060908, 41.28282828282828376, 41.95959595959595845, 42.63636363636364024, 43.31313131313131493, 43.98989898989898961, 44.66666666666667140, 45.34343434343434609, 46.02020202020202078, 46.69696969696969546, 47.37373737373737725, 48.05050505050505194, 48.72727272727272663, 49.40404040404040842, 50.08080808080808310, 50.75757575757575779, 51.43434343434343958, 52.11111111111111427, 52.78787878787878896, 53.46464646464646364, 54.14141414141414543, 54.81818181818182012, 55.49494949494949481, 56.17171717171717660, 56.84848484848485128, 57.52525252525252597, 58.20202020202020776, 58.87878787878788245, 59.55555555555555713, 60.23232323232323182, 60.90909090909091361, 61.58585858585858830, 62.26262626262626299, 62.93939393939394478, 63.61616161616161946, 64.29292929292930125, 64.96969696969696884, 65.64646464646465063, 66.32323232323233242, 67.00000000000000000};
    Tensor<float> k({1});
    k = 19.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{0.00000000000000000, 0.00000000029879992, 0.00000007712180827, 0.00000172581671957, 0.00001419108820668, 0.00006742059427563, 0.00022639922397755, 0.00059836256056968, 0.00132720413935530, 0.00257499229904195, 0.00449527609242162, 0.00720503277314842, 0.01076169041474471, 0.01514956503493302, 0.02027737527222765, 0.02598608792885356, 0.03206467338245864, 0.03827053785263878, 0.04435134488967174, 0.05006542124901425, 0.05519871859068522, 0.05957716101200132, 0.06307399687066416, 0.06561240207575611, 0.06716401535320718, 0.06774432777172849, 0.06740592733770061, 0.06623055459385425, 0.06432079875745304, 0.06179209374176040, 0.05876548978321962, 0.05536150129829773, 0.05169517896947391, 0.04787243108886955, 0.04398752784778024, 0.04012166090916081, 0.03634239538045053, 0.03270383727305934, 0.02924734149925931, 0.02600259853488535, 0.02298895782679018, 0.02021686940186964, 0.01768934931468811, 0.01540339769199472, 0.01335131899328530, 0.01152191204149588, 0.00990151213162750, 0.00847487913696441, 0.00722593423728234, 0.00613835404071602, 0.00519603486363271, 0.00438344218236301, 0.00368586116676885, 0.00308956409813612, 0.00258190966305285, 0.00215138784869845, 0.00178762264049287, 0.00148134309113063, 0.00122433170100070, 0.00100935750028206, 0.00083009980154244, 0.00068106732592287, 0.00055751630726834, 0.00045537024652193, 0.00037114321505206, 0.00030186797704534, 0.00024502970164919, 0.00019850564810120, 0.00016051091466844, 0.00012955012878707, 0.00010437480668793, 0.00008394601302390, 0.00006740189333361, 0.00005402962505535, 0.00004324132833535, 0.00003455348960819, 0.00002756947371449, 0.00002196473012429, 0.00001747433256087, 0.00001388252665497, 0.00001101399552509, 0.00000872658720495, 0.00000690527985107, 0.00000545719019469, 0.00000430745751548, 0.00000339585944118, 0.00000267403716616, 0.00000210322636433, 0.00000165240632750, 0.00000129679389941, 0.00000101662081790, 0.00000079614334554, 0.00000062284177456, 0.00000048677473598, 0.00000038005940928, 0.00000029645388396, 0.00000023102221671, 0.00000017986628857, 0.00000013991150934, 0.00000010873584120};
    // run Temper chisquare::pdf
    Tensor<float> result = stats::chisquare::pdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.pdf_random_test_dof_20
  * @brief Randomly generated chisquare pdf test on 100 matrix with dof = 20.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, pdf_random_test_dof_20)
{
    Tensor<float> x({100});
    x = std::vector<float>{0.00000000000000000, 0.70707070707070707, 1.41414141414141414, 2.12121212121212110, 2.82828282828282829, 3.53535353535353547, 4.24242424242424221, 4.94949494949494984, 5.65656565656565657, 6.36363636363636331, 7.07070707070707094, 7.77777777777777768, 8.48484848484848442, 9.19191919191919204, 9.89898989898989967, 10.60606060606060552, 11.31313131313131315, 12.02020202020202078, 12.72727272727272663, 13.43434343434343425, 14.14141414141414188, 14.84848484848484773, 15.55555555555555536, 16.26262626262626299, 16.96969696969696884, 17.67676767676767824, 18.38383838383838409, 19.09090909090908994, 19.79797979797979934, 20.50505050505050519, 21.21212121212121104, 21.91919191919192045, 22.62626262626262630, 23.33333333333333215, 24.04040404040404155, 24.74747474747474740, 25.45454545454545325, 26.16161616161616266, 26.86868686868686851, 27.57575757575757436, 28.28282828282828376, 28.98989898989898961, 29.69696969696969546, 30.40404040404040487, 31.11111111111111072, 31.81818181818181657, 32.52525252525252597, 33.23232323232323182, 33.93939393939393767, 34.64646464646464352, 35.35353535353535648, 36.06060606060606233, 36.76767676767676818, 37.47474747474747403, 38.18181818181817988, 38.88888888888888573, 39.59595959595959869, 40.30303030303030454, 41.01010101010101039, 41.71717171717171624, 42.42424242424242209, 43.13131313131312794, 43.83838383838384090, 44.54545454545454675, 45.25252525252525260, 45.95959595959595845, 46.66666666666666430, 47.37373737373737725, 48.08080808080808310, 48.78787878787878896, 49.49494949494949481, 50.20202020202020066, 50.90909090909090651, 51.61616161616161946, 52.32323232323232531, 53.03030303030303116, 53.73737373737373701, 54.44444444444444287, 55.15151515151514872, 55.85858585858586167, 56.56565656565656752, 57.27272727272727337, 57.97979797979797922, 58.68686868686868507, 59.39393939393939092, 60.10101010101010388, 60.80808080808080973, 61.51515151515151558, 62.22222222222222143, 62.92929292929292728, 63.63636363636363313, 64.34343434343433898, 65.05050505050505194, 65.75757575757575069, 66.46464646464646364, 67.17171717171717660, 67.87878787878787534, 68.58585858585858830, 69.29292929292928704, 70.00000000000000000};
    Tensor<float> k({1});
    k = 20.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{0.00000000000000000, 0.00000000008347649, 0.00000003001205086, 0.00000081017446706, 0.00000757685067778, 0.00003964061578383, 0.00014362602910377, 0.00040384601982680, 0.00094320235529483, 0.00191178533290714, 0.00346511846859121, 0.00573738244811373, 0.00881601651935992, 0.01272309876353359, 0.01740670605753904, 0.02274296865292276, 0.02854744283462607, 0.03459307809316244, 0.04063151422557770, 0.04641457915749685, 0.05171345048580123, 0.05633376200614355, 0.06012578731529054, 0.06298958105172309, 0.06487552985776927, 0.06578113571487006, 0.06574503604598160, 0.06483929144863119, 0.06316088574522685, 0.06082322692950168, 0.05794824875701527, 0.05465952013128447, 0.05107659315096948, 0.04731067263105135, 0.04346157532531225, 0.03961586622251452, 0.03584600912485122, 0.03221034433256950, 0.02875370198726064, 0.02550846984559521, 0.02249595389488143, 0.01972789503748333, 0.01720803174249418, 0.01493362467062248, 0.01289688320607940, 0.01108625463036818, 0.00948755392319421, 0.00808492583448437, 0.00686164115815554, 0.00580073643067010, 0.00488551103253412, 0.00409989836652279, 0.00342872888122432, 0.00285790261708630, 0.00237448803182943, 0.00196676240817583, 0.00162420739386981, 0.00133747135071164, 0.00109830832579272, 0.00089950169348242, 0.00073477890717289, 0.00059872237592552, 0.00048668025444169, 0.00039467990303654, 0.00031934592623231, 0.00025782401732171, 0.00020771130199948, 0.00016699346621099, 0.00013398865145059, 0.00010729788592279, 0.00008576167518044, 0.00006842228610971, 0.00005449121064613, 0.00004332127967603, 0.00003438290443447, 0.00002724394531624, 0.00002155274083554, 0.00001702386824867, 0.00001342624889952, 0.00001057325333926, 0.00000831450208035, 0.00000652909638834, 0.00000512004913147, 0.00000400971804649, 0.00000313607272358, 0.00000244965220521, 0.00000191109248795, 0.00000148912263333, 0.00000115894489590, 0.00000090092853897, 0.00000069955910968, 0.00000054259515200, 0.00000042039289853, 0.00000032536662976, 0.00000025155832887, 0.00000019429517378, 0.00000014991745795, 0.00000011556285627, 0.00000008899567207, 0.00000006847191969};
    // run Temper chisquare::pdf
    Tensor<float> result = stats::chisquare::pdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.pdf_broadcast_x_vector_k_scalar
  * @brief Verify broadcasting: pdf broadcast x vector k scalar
  */
TEST(CHISQUARE, pdf_broadcast_x_vector_k_scalar)
{
    Tensor<float> x({4});
    x = std::vector<float>{0.00000000000000000, 0.00000000000000000, 0.50000000000000000, 2.00000000000000000};
    Tensor<float> k({1});
    k = 3.00000000000000000;
    Tensor<float> expected_result({4});
    expected_result = std::vector<float>{0.00000000000000000, 0.00000000000000000, 0.21969564473386122, 0.20755374871029739};
    Tensor<float> result = stats::chisquare::pdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
}

/**
  * @test CHISQUARE.pdf_broadcast_x_scalar_k_vector
  * @brief Verify broadcasting: pdf broadcast x scalar k vector
  */
TEST(CHISQUARE, pdf_broadcast_x_scalar_k_vector)
{
    Tensor<float> x({1});
    x = 1.00000000000000000;
    Tensor<float> k({3});
    k = std::vector<float>{3.00000000000000000, 4.00000000000000000, 2.00000000000000000};
    Tensor<float> expected_result({3});
    expected_result = std::vector<float>{0.24197072451914337, 0.15163266492815836, 0.30326532985631671};
    Tensor<float> result = stats::chisquare::pdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
}

/**
  * @test CHISQUARE.pdf_broadcast_2d_x_k_vector
  * @brief Verify broadcasting: pdf broadcast 2d x k vector
  */
TEST(CHISQUARE, pdf_broadcast_2d_x_k_vector)
{
    Tensor<float> x({2,2});
    x = std::vector<float>{0.00000000000000000, 1.00000000000000000, 2.00000000000000000, 3.00000000000000000};
    Tensor<float> k({2});
    k = std::vector<float>{3.00000000000000000, 2.00000000000000000};
    Tensor<float> expected_result({4});
    expected_result = std::vector<float>{0.00000000000000000, 0.30326532985631671, 0.20755374871029739, 0.11156508007421491};
    Tensor<float> result = stats::chisquare::pdf(x, k);
    // check values
    EXPECT_NEAR(result[0][0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[0][1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[1][0], expected_result[2], 0.0001);
    EXPECT_NEAR(result[1][1], expected_result[3], 0.0001);
}

/**
  * @test CHISQUARE.pdf_broadcast_mixed_shapes_all_operands
  * @brief Verify broadcasting: pdf broadcast mixed shapes all operands
  */
TEST(CHISQUARE, pdf_broadcast_mixed_shapes_all_operands)
{
    Tensor<float> x({2,1});
    x = std::vector<float>{0.00000000000000000, 1.00000000000000000};
    Tensor<float> k({1,3});
    k = std::vector<float>{2.00000000000000000, 3.00000000000000000, 4.00000000000000000};
    Tensor<float> expected_result({6});
    expected_result = std::vector<float>{0.50000000000000000, 0.00000000000000000, 0.00000000000000000, 0.30326532985631671, 0.24197072451914337, 0.15163266492815836};
    Tensor<float> result = stats::chisquare::pdf(x, k);
    // check values
    EXPECT_NEAR(result[0][0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[0][1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[0][2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[1][0], expected_result[3], 0.0001);
    EXPECT_NEAR(result[1][1], expected_result[4], 0.0001);
    EXPECT_NEAR(result[1][2], expected_result[5], 0.0001);
}

/**
  * @test CHISQUARE.pdf_view_with_weird_strides
  * @brief Ensure chisquare::pdf accepts non-contiguous/alias views for x and k
  */
TEST(CHISQUARE, pdf_view_with_weird_strides)
{
    Tensor<float> x_owner({6}, MemoryLocation::DEVICE);
    std::vector<float> x_owner_vals = {
        2.00000000000000000, 99.00000000000000000, 1.00000000000000000, 99.00000000000000000, 5.00000000000000000, 99.00000000000000000
    };
    x_owner = x_owner_vals;

    Tensor<float> x_alias(
        x_owner,
        std::vector<uint64_t>{0ull},
        std::vector<uint64_t>{3ull},
        std::vector<uint64_t>{2ull}
    );

    Tensor<float> k_owner({6}, MemoryLocation::DEVICE);
    std::vector<float> k_owner_vals = {
        1.00000000000000000, 99.00000000000000000, 5.00000000000000000, 99.00000000000000000, 10.00000000000000000, 99.00000000000000000
    };
    k_owner = k_owner_vals;

    Tensor<float> k_alias(
        k_owner,
        std::vector<uint64_t>{0ull},
        std::vector<uint64_t>{3ull},
        std::vector<uint64_t>{2ull}
    );

    Tensor<float> result = stats::chisquare::pdf(x_alias, k_alias);

    Tensor<float> expected_result({3});
    expected_result = std::vector<float>{0.10377687435514868, 0.08065690817304780, 0.06680094289054260};

    // compare element-wise (unroll to report precise index on failure)
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
}
