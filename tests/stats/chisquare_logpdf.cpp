/**
  * @file chisquare_logpdf.cpp
  * @brief File generated by tests/stats/chisquare_logpdf.py.
  */

/**
  * @test CHISQUARE.logpdf_random_test_dof_2
  * @brief Randomly generated chisquare logpdf test on 100 matrix with dof = 2.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, logpdf_random_test_dof_2)
{
    Tensor<float> x({100});
    x = std::vector<float>{0.00000100000000000, 0.16161715151515152, 0.32323330303030301, 0.48484945454545453, 0.64646560606060610, 0.80808175757575762, 0.96969790909090914, 1.13131406060606055, 1.29293021212121206, 1.45454636363636358, 1.61616251515151510, 1.77777866666666662, 1.93939481818181814, 2.10101096969696988, 2.26262712121212139, 2.42424327272727291, 2.58585942424242443, 2.74747557575757595, 2.90909172727272747, 3.07070787878787899, 3.23232403030303050, 3.39394018181818202, 3.55555633333333354, 3.71717248484848506, 3.87878863636363658, 4.04040478787878765, 4.20202093939393961, 4.36363709090909158, 4.52525324242424265, 4.68686939393939372, 4.84848554545454569, 5.01010169696969765, 5.17171784848484872, 5.33333399999999980, 5.49495015151515176, 5.65656630303030372, 5.81818245454545480, 5.97979860606060587, 6.14141475757575783, 6.30303090909090979, 6.46464706060606087, 6.62626321212121194, 6.78787936363636391, 6.94949551515151587, 7.11111166666666694, 7.27272781818181802, 7.43434396969696998, 7.59596012121212194, 7.75757627272727301, 7.91919242424242409, 8.08080857575757427, 8.24242472727272713, 8.40404087878787820, 8.56565703030302927, 8.72727318181818212, 8.88888933333333320, 9.05050548484848427, 9.21212163636363535, 9.37373778787878642, 9.53535393939393927, 9.69697009090909035, 9.85858624242424142, 10.02020239393939427, 10.18181854545454534, 10.34343469696969642, 10.50505084848484749, 10.66666699999999857, 10.82828315151515142, 10.98989930303030249, 11.15151545454545357, 11.31313160606060642, 11.47474775757575749, 11.63636390909090856, 11.79798006060605964, 11.95959621212121071, 12.12121236363636356, 12.28282851515151464, 12.44444466666666571, 12.60606081818181856, 12.76767696969696964, 12.92929312121212071, 13.09090927272727178, 13.25252542424242286, 13.41414157575757571, 13.57575772727272678, 13.73737387878787786, 13.89899003030303071, 14.06060618181818178, 14.22222233333333286, 14.38383848484848393, 14.54545463636363500, 14.70707078787878785, 14.86868693939393893, 15.03030309090909000, 15.19191924242424285, 15.35353539393939393, 15.51515154545454500, 15.67676769696969608, 15.83838384848484715, 16.00000000000000000};
    Tensor<float> k({1});
    k = 2.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{-0.69314768055994525, -0.77395575631752100, -0.85476383207509676, -0.93557190783267252, -1.01637998359024828, -1.09718805934782404, -1.17799613510539980, -1.25880421086297556, -1.33961228662055132, -1.42042036237812708, -1.50122843813570284, -1.58203651389327860, -1.66284458965085435, -1.74365266540843011, -1.82446074116600609, -1.90526881692358163, -1.98607689268115761, -2.06688496843873315, -2.14769304419630913, -2.22850111995388467, -2.30930919571146065, -2.39011727146903619, -2.47092534722661217, -2.55173342298418770, -2.63254149874176369, -2.71334957449933922, -2.79415765025691520, -2.87496572601449119, -2.95577380177206672, -3.03658187752964226, -3.11738995328721824, -3.19819802904479422, -3.27900610480236976, -3.35981418055994530, -3.44062225631752128, -3.52143033207509726, -3.60223840783267280, -3.68304648359024833, -3.76385455934782431, -3.84466263510540029, -3.92547071086297583, -4.00627878662055092, -4.08708686237812735, -4.16789493813570289, -4.24870301389327842, -4.32951108965085396, -4.41031916540843039, -4.49112724116600592, -4.57193531692358146, -4.65274339268115700, -4.73355146843873253, -4.81435954419630896, -4.89516761995388450, -4.97597569571146003, -5.05678377146903646, -5.13759184722661200, -5.21839992298418753, -5.29920799874176307, -5.38001607449933861, -5.46082415025691503, -5.54163222601449057, -5.62244030177206611, -5.70324837752964253, -5.78405645328721807, -5.86486452904479361, -5.94567260480236914, -6.02648068055994468, -6.10728875631752111, -6.18809683207509664, -6.26890490783267218, -6.34971298359024861, -6.43052105934782414, -6.51132913510539968, -6.59213721086297522, -6.67294528662055075, -6.75375336237812718, -6.83456143813570272, -6.91536951389327825, -6.99617758965085468, -7.07698566540843021, -7.15779374116600575, -7.23860181692358129, -7.31940989268115683, -7.40021796843873325, -7.48102604419630879, -7.56183411995388433, -7.64264219571146075, -7.72345027146903629, -7.80425834722661182, -7.88506642298418736, -7.96587449874176290, -8.04668257449933932, -8.12749065025691486, -8.20829872601449040, -8.28910680177206594, -8.36991487752964147, -8.45072295328721701, -8.53153102904479255, -8.61233910480236808, -8.69314718055994540};
    // run Temper chisquare::logpdf
    Tensor<float> result = stats::chisquare::logpdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.logpdf_random_test_dof_3
  * @brief Randomly generated chisquare logpdf test on 100 matrix with dof = 3.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, logpdf_random_test_dof_3)
{
    Tensor<float> x({100});
    x = std::vector<float>{0.00000100000000000, 0.19192018181818180, 0.38383936363636356, 0.57575854545454541, 0.76767772727272721, 0.95959690909090900, 1.15151609090909068, 1.34343527272727248, 1.53535445454545427, 1.72727363636363607, 1.91919281818181786, 2.11111199999999988, 2.30303118181818167, 2.49495036363636347, 2.68686954545454526, 2.87878872727272705, 3.07070790909090885, 3.26262709090909064, 3.45454627272727244, 3.64646545454545423, 3.83838463636363603, 4.03030381818181827, 4.22222299999999962, 4.41414218181818097, 4.60606136363636320, 4.79798054545454544, 4.98989972727272679, 5.18181890909090814, 5.37373809090909038, 5.56565727272727262, 5.75757645454545397, 5.94949563636363532, 6.14141481818181756, 6.33333399999999980, 6.52525318181818115, 6.71717236363636250, 6.90909154545454474, 7.10101072727272697, 7.29292990909090832, 7.48484909090908967, 7.67676827272727191, 7.86868745454545415, 8.06060663636363550, 8.25252581818181596, 8.44444499999999820, 8.63636418181818044, 8.82828336363636090, 9.02020254545454314, 9.21212172727272538, 9.40404090909090762, 9.59596009090908986, 9.78787927272727032, 9.97979845454545256, 10.17171763636363480, 10.36363681818181526, 10.55555599999999750, 10.74747518181817973, 10.93939436363636197, 11.13131354545454421, 11.32323272727272467, 11.51515190909090691, 11.70707109090908915, 11.89899027272726961, 12.09090945454545185, 12.28282863636363409, 12.47474781818181633, 12.66666699999999857, 12.85858618181817903, 13.05050536363636127, 13.24242454545454351, 13.43434372727272397, 13.62626290909090621, 13.81818209090908844, 14.01010127272727068, 14.20202045454545292, 14.39393963636363338, 14.58585881818181562, 14.77777799999999786, 14.96969718181817832, 15.16161636363636056, 15.35353554545454280, 15.54545472727272504, 15.73737390909090728, 15.92929309090908774, 16.12121227272727353, 16.31313145454545221, 16.50505063636363445, 16.69696981818181669, 16.88888899999999893, 17.08080818181818117, 17.27272736363636341, 17.46464654545454565, 17.65656572727272433, 17.84848490909090657, 18.04040409090908881, 18.23232327272727105, 18.42424245454545328, 18.61616163636363552, 18.80808081818181776, 19.00000000000000000};
    Tensor<float> k({1});
    k = 3.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{-7.82669431218680955, -1.84023648065712075, -1.58962378391279602, -1.48285125497741133, -1.43497002676555629, -1.41935797228055427, -1.42415687163469484, -1.44304118466018494, -1.47223512577954097, -1.50930323504463026, -1.55258259707216206, -1.60088712176329051, -1.65334104391440073, -1.70927929768712228, -1.76818491683398027, -1.82964808440560645, -1.89333842560117183, -1.95898571518021636, -2.02636610768326264, -2.09529209557494234, -2.16560504614621241, -2.23716956117359356, -2.30986914990433467, -2.38360286467674909, -2.45828265309612082, -2.53383125108718898, -2.61018048942773540, -2.68726992005660348, -2.76504569232637198, -2.84345962653827966, -2.92246844460408450, -3.00203312690303781, -3.08211837128111110, -3.16269213532393056, -3.24372524698016207, -3.32519107164192285, -3.40706522613533469, -3.48932533190627225, -3.57195080112724295, -3.65492265059264021, -3.73822333917962712, -3.82183662538210722, -3.90574744201459634, -3.98994178566114943, -4.07440661883487998, -4.15912978313373127, -4.24409992194201457, -4.32930641144564898, -4.41473929891063843, -4.50038924732604162, -4.58624748563974638, -4.67230576392241836, -4.75855631288533498, -4.84499180725438539, -4.93160533256769362, -5.01839035501987940, -5.10534069402349644, -5.19245049719907303, -5.27971421754026959, -5.36712659253103741, -5.45468262501788814, -5.54237756566319462, -5.63020689682525344, -5.71816631772811323, -5.80625173079928203, -5.89445922906665576, -5.98278508451763980, -6.07122573733361914, -6.15977778592197112, -6.24843797767574305, -6.33720320039817508, -6.42607047433548573, -6.51503694476684370, -6.60409987510544116, -6.69325664046892044, -6.78250472168135676, -6.87184169967250114, -6.96126525024310805, -7.05077313916802151, -7.14036321761119286, -7.23003341782907860, -7.31978174914093760, -7.40960629414636252, -7.49950520517206964, -7.58947670093147941, -7.67951906338195034, -7.76963063476584281, -7.85980981482259988, -7.95005505816016989, -8.04036487177493697, -8.13073781271021723, -8.22117248584411975, -8.31166754179830036, -8.40222167495977956, -8.49283362160851318, -8.58350215814407846, -8.67422609940518718, -8.76500429707627937, -8.85583563817584185, -8.94671904362145121};
    // run Temper chisquare::logpdf
    Tensor<float> result = stats::chisquare::logpdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.logpdf_random_test_dof_4
  * @brief Randomly generated chisquare logpdf test on 100 matrix with dof = 4.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, logpdf_random_test_dof_4)
{
    Tensor<float> x({100});
    x = std::vector<float>{0.00000100000000000, 0.22222321212121210, 0.44444542424242417, 0.66666763636363635, 0.88888984848484842, 1.11111206060606049, 1.33333427272727256, 1.55555648484848463, 1.77777869696969670, 2.00000090909090877, 2.22222312121212129, 2.44444533333333336, 2.66666754545454543, 2.88888975757575750, 3.11111196969696957, 3.33333418181818164, 3.55555639393939371, 3.77777860606060578, 4.00000081818181741, 4.22222303030302992, 4.44444524242424244, 4.66666745454545406, 4.88888966666666658, 5.11111187878787820, 5.33333409090909072, 5.55555630303030235, 5.77777851515151486, 6.00000072727272649, 6.22222293939393900, 6.44444515151515063, 6.66666736363636314, 6.88888957575757477, 7.11111178787878728, 7.33333399999999980, 7.55555621212121142, 7.77777842424242394, 8.00000063636363556, 8.22222284848484719, 8.44444506060605882, 8.66666727272727044, 8.88888948484848385, 9.11111169696969547, 9.33333390909090710, 9.55555612121211873, 9.77777833333333213, 10.00000054545454375, 10.22222275757575538, 10.44444496969696701, 10.66666718181818041, 10.88888939393939204, 11.11111160606060366, 11.33333381818181707, 11.55555603030302869, 11.77777824242424032, 12.00000045454545194, 12.22222266666666535, 12.44444487878787697, 12.66666709090908860, 12.88888930303030023, 13.11111151515151363, 13.33333372727272526, 13.55555593939393688, 13.77777815151514851, 14.00000036363636191, 14.22222257575757354, 14.44444478787878516, 14.66666699999999857, 14.88888921212121019, 15.11111142424242182, 15.33333363636363345, 15.55555584848484685, 15.77777806060605847, 16.00000027272727010, 16.22222248484848350, 16.44444469696969691, 16.66666690909090676, 16.88888912121212016, 17.11111133333333356, 17.33333354545454341, 17.55555575757575681, 17.77777796969697022, 18.00000018181818007, 18.22222239393939347, 18.44444460606060687, 18.66666681818181672, 18.88888903030303013, 19.11111124242423998, 19.33333345454545338, 19.55555566666666678, 19.77777787878787663, 20.00000009090909003, 20.22222230303030344, 20.44444451515151329, 20.66666672727272669, 20.88888893939393654, 21.11111115151514994, 21.33333336363636334, 21.55555557575757319, 21.77777778787878660, 22.00000000000000000};
    Tensor<float> k({1});
    k = 4.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{-15.20180541908416494, -3.00147890942123752, -2.41944508491440713, -2.12509183286547643, -1.94852124147382644, -1.83648902122000512, -1.76527872048653967, -1.72223925386267496, -1.69981904765585634, -1.69314718056004843, -1.69889782096280673, -1.71469878812816323, -1.73879855129003680, -1.76986697852325126, -1.80687013715540301, -1.84898839315762320, -1.89556099683065349, -1.94604749761893858, -2.00000020454547522, -2.05704410249369785, -2.11686192600885636, -2.17918287861431414, -2.24377397878028573, -2.31043333116333693, -2.37898483095731983, -2.44927394999766967, -2.52116434982807069, -2.59453513431608496, -2.66927860215819646, -2.74529839394940378, -2.82250795350674188, -2.90082924158306632, -2.98019165386538187, -3.06053110552059771, -3.14178925244221752, -3.22391282541108293, -3.30685305807642127, -3.39056519332729067, -3.47500805550630432, -3.56014367820008637, -3.64593697916101789, -3.73235547537515444, -3.81936903246994053, -3.90694964361204633, -3.99507123382638962, -4.08370948630766417, -4.17284168782340714, -4.26244659074445575, -4.35250428960191105, -4.44299611037304576, -4.53390451095286728, -4.62521299148199994, -4.71690601338233684, -4.80896892610504878, -4.90138790072582964, -4.99414986963339125, -5.08724247165235699, -5.18065400202333670, -5.27437336673323465, -5.36839004074956172, -5.46269402976497265, -5.55727583510387646, -5.65212642148254840, -5.74723718734878730, -5.84259993755732587, -5.93820685816369753, -6.03405049314246611, -6.13012372285617069, -6.22641974411934385, -6.32293205171787687, -6.41965442125806085, -6.51658089323214273, -6.61370575819829032, -6.71102354298272541, -6.80852899782057897, -6.90621708435985404, -7.00408296445991319, -7.10212198972213482, -7.20032969169608261, -7.29870177270954201, -7.39723409727531411, -7.49592268403180562, -7.59476369817810504, -7.69375344436754816, -7.79288836002687724, -7.89216500907073204, -7.99158007598374098, -8.09113036024471555, -8.19081277106947425, -8.29062432245071079, -8.39056212847498983, -8.49062339889846207, -8.59080543496438231, -8.69110562544672050, -8.79152144290533499, -8.89205044013932344, -8.99269024682605611, -9.09343856633436154, -9.19429317270116364, -9.29525190776157473};
    // run Temper chisquare::logpdf
    Tensor<float> result = stats::chisquare::logpdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.logpdf_random_test_dof_5
  * @brief Randomly generated chisquare logpdf test on 100 matrix with dof = 5.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, logpdf_random_test_dof_5)
{
    Tensor<float> x({100});
    x = std::vector<float>{0.00000100000000000, 0.25252624242424238, 0.50505148484848483, 0.75757672727272729, 1.01010196969696953, 1.26262721212121187, 1.51515245454545444, 1.76767769696969679, 2.02020293939393936, 2.27272818181818170, 2.52525342424242405, 2.77777866666666640, 3.03030390909090919, 3.28282915151515153, 3.53535439393939388, 3.78787963636363623, 4.04040487878787857, 4.29293012121212136, 4.54545536363636327, 4.79798060606060606, 5.05050584848484796, 5.30303109090909075, 5.55555633333333265, 5.80808157575757544, 6.06060681818181823, 6.31313206060606014, 6.56565730303030293, 6.81818254545454483, 7.07070778787878762, 7.32323303030302952, 7.57575827272727231, 7.82828351515151422, 8.08080875757575612, 8.33333399999999891, 8.58585924242424170, 8.83838448484848271, 9.09090972727272550, 9.34343496969696830, 9.59596021212121109, 9.84848545454545210, 10.10101069696969489, 10.35353593939393768, 10.60606118181818047, 10.85858642424242326, 11.11111166666666428, 11.36363690909090707, 11.61616215151514986, 11.86868739393939265, 12.12121263636363544, 12.37373787878787645, 12.62626312121211924, 12.87878836363636204, 13.13131360606060483, 13.38383884848484584, 13.63636409090908863, 13.88888933333333142, 14.14141457575757421, 14.39393981818181700, 14.64646506060605802, 14.89899030303030081, 15.15151554545454360, 15.40404078787878639, 15.65656603030302740, 15.90909127272727019, 16.16161651515151476, 16.41414175757575578, 16.66666700000000034, 16.91919224242424136, 17.17171748484848592, 17.42424272727272694, 17.67676796969696795, 17.92929321212121252, 18.18181845454545353, 18.43434369696969810, 18.68686893939393912, 18.93939418181818013, 19.19191942424242470, 19.44444466666666571, 19.69696990909090673, 19.94949515151515129, 20.20202039393939231, 20.45454563636363687, 20.70707087878787789, 20.95959612121211890, 21.21212136363636347, 21.46464660606060448, 21.71717184848484905, 21.96969709090909006, 22.22222233333333108, 22.47474757575757565, 22.72727281818181666, 22.97979806060606123, 23.23232330303030224, 23.48484854545454326, 23.73737378787878782, 23.98989903030302884, 24.24242427272727340, 24.49494951515151442, 24.74747475757575543, 25.00000000000000000};
    Tensor<float> k({1});
    k = 5.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{-22.74081715881919408, -4.20817410099601208, -3.29471892135951361, -2.81278487040779446, -2.50752487794169188, -2.29907246918224573, -2.15185295320329928, -2.04688969610302340, -1.97285533444973726, -1.92244348467724802, -1.89066539840260495, -1.87396280390822079, -1.86970840463588339, -1.87590700241461250, -1.89100769803350532, -1.91378104030090679, -1.94323590455666584, -1.97856161488236570, -2.01908663474632544, -2.06424844142145059, -2.11357113668382279, -2.16664852578465084, -2.22313113640157400, -2.28271612549657288, -2.34513933584136858, -2.41016897517310547, -2.47760053579376560, -2.54725267349315398, -2.61896383630610519, -2.69258948511659124, -2.76799978564277538, -2.84507767900750697, -2.92371725873566035, -3.00382239757264990, -3.08530557935436711, -3.16808690024820550, -3.25209321072456792, -3.33725737511397647, -3.42351762992760644, -3.51081702554293340, -3.59910293858631203, -3.68832664453482728, -3.77844294182783447, -3.86940982021370150, -3.96118816722830847, -4.05374150766234198, -4.14703577166586612, -4.24103908779399763, -4.33572159784234934, -4.43105529077587601, -4.52701385343620810, -4.62357253603347207, -4.72070803069975931, -4.81839836161113588, -4.91662278538049957, -5.01536170059032660, -5.11459656547700181, -5.21430982290092349, -5.31448483184197418, -5.41510580475097214, -5.51615775016648779, -5.61762642007474344, -5.71949826154979135, -5.82176037226298870, -5.92440045949611704, -6.02740680233217407, -6.13076821673272843, -6.23447402324132138, -6.33851401707950846, -6.44287844042588365, -6.54755795668966822, -6.65254362660902832, -6.75782688602101000, -6.86339952516476526, -6.96925366939281066, -7.07538176117699091, -7.18177654330618775, -7.28843104318231649, -7.39533855812958674, -7.50249264163953722, -7.60988709048123990, -7.71751593261219337, -7.82537341583090207, -7.93345399711726440, -8.04175233261129030, -8.15026326818484037, -8.25898183056476043, -8.36790321896917355, -8.47702279722172136, -8.58633608631136980, -8.69583875736787704, -8.80552662502539540, -8.91539564114873961, -9.02544188889878640, -9.13566157711526472, -9.24605103499675351, -9.35660670705924780, -9.46732514835593442, -9.57820301994214063, -9.68923708457048072};
    // run Temper chisquare::logpdf
    Tensor<float> result = stats::chisquare::logpdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.logpdf_random_test_dof_6
  * @brief Randomly generated chisquare logpdf test on 100 matrix with dof = 6.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, logpdf_random_test_dof_6)
{
    Tensor<float> x({100});
    x = std::vector<float>{0.00000100000000000, 0.28282927272727271, 0.56565754545454550, 0.84848581818181823, 1.13131409090909085, 1.41414236363636348, 1.69697063636363632, 1.97979890909090916, 2.26262718181818201, 2.54545545454545463, 2.82828372727272725, 3.11111200000000032, 3.39394027272727294, 3.67676854545454557, 3.95959681818181863, 4.24242509090909081, 4.52525336363636388, 4.80808163636363695, 5.09090990909090912, 5.37373818181818219, 5.65656645454545437, 5.93939472727272744, 6.22222300000000050, 6.50505127272727268, 6.78787954545454575, 7.07070781818181882, 7.35353609090909099, 7.63636436363636406, 7.91919263636363713, 8.20202090909090842, 8.48484918181818060, 8.76767745454545455, 9.05050572727272673, 9.33333399999999891, 9.61616227272727286, 9.89899054545454504, 10.18181881818181722, 10.46464709090909118, 10.74747536363636335, 11.03030363636363553, 11.31313190909090771, 11.59596018181818167, 11.87878845454545385, 12.16161672727272602, 12.44444499999999998, 12.72727327272727216, 13.01010154545454434, 13.29292981818181829, 13.57575809090909047, 13.85858636363636265, 14.14141463636363660, 14.42424290909090878, 14.70707118181818096, 14.98989945454545492, 15.27272772727272709, 15.55555599999999927, 15.83838427272727323, 16.12121254545454718, 16.40404081818181936, 16.68686909090909154, 16.96969736363636372, 17.25252563636363945, 17.53535390909091163, 17.81818218181818381, 18.10101045454545599, 18.38383872727272816, 18.66666700000000034, 18.94949527272727252, 19.23232354545454825, 19.51515181818182043, 19.79798009090909261, 20.08080836363636479, 20.36363663636363697, 20.64646490909090915, 20.92929318181818488, 21.21212145454545706, 21.49494972727272923, 21.77777800000000141, 22.06060627272727359, 22.34343454545454577, 22.62626281818181795, 22.90909109090909368, 23.19191936363636586, 23.47474763636363804, 23.75757590909091022, 24.04040418181818239, 24.32323245454545457, 24.60606072727273030, 24.88888900000000248, 25.17171727272727466, 25.45454554545454684, 25.73737381818181902, 26.02020209090909120, 26.30303036363636693, 26.58585863636363911, 26.86868690909091129, 27.15151518181818346, 27.43434345454545564, 27.71717172727272782, 28.00000000000000000};
    Tensor<float> k({1});
    k = 6.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{-30.40361033816832403, -5.43982703853443894, -4.19495034948322143, -3.52543544820026300, -3.09148602894546531, -2.78661341625184233, -2.56338467474171061, -2.39649761981809117, -2.27084909720813721, -2.17669726047325485, -2.10739044409264054, -2.05818428513332208, -2.02557572108911277, -2.00690448743533567, -2.00010271834552267, -2.00353114540871857, -2.01586826896149240, -2.03603318769015385, -2.06313051948313264, -2.09641023398290605, -2.13523780018046105, -2.17907162504196616, -2.22744574544193696, -2.27995637063905932, -2.33625129097566164, -2.39602145008450051, -2.45899417102069417, -2.52492766149189540, -2.59360651886752258, -2.66483802431727357, -2.73844906545762568, -2.81428356377896671, -2.89220031064189742, -2.97207113636845444, -3.05377935273524992, -3.13721842129475759, -3.22229080933724576, -3.30890700263353343, -3.39698464986231263, -3.48644781819097149, -3.57722634311899457, -3.66925525861373503, -3.76247429592577065, -3.85682744138453826, -3.95226254503631891, -4.04873097326726672, -4.14618729960950105, -4.24458902880199140, -4.34389634990446005, -4.44407191486918585, -4.54508063948408036, -4.64688952402846667, -4.74946749134435109, -4.85278524033242853, -4.95681511314255907, -5.06153097455075418, -5.16690810220495322, -5.27292308658514841, -5.37955373966401318, -5.48677901137551061, -5.59457891310396249, -5.70293444749726319, -5.81182754398709811, -5.92124099946825311, -6.03115842364943688, -6.14156418864100573, -6.25244338239141761, -6.36378176562511833, -6.47556573197058860, -6.58778227099904434, -6.70041893392254551, -6.81346380172509036, -6.92690545552254733, -7.04073294896691237, -7.15493578252803175, -7.26950387950151722, -7.38442756360571373, -7.49969753804302286, -7.61530486591223799, -7.73124095186859961, -7.84749752493741326, -7.96406662239520635, -8.08094057463986815, -8.19811199097781262, -8.31557374626227919, -8.43331896832230576, -8.55134102612692359, -8.66963351863353360, -8.78819026427357031, -8.90700529103222927, -9.02607282708243908, -9.14538729193632705, -9.26494328808023582, -9.38473559306192939, -9.50475915200097177, -9.62500907049540899, -9.74548060789982884, -9.86616917095176049, -9.98707030772490967, -10.10817970188937309};
    // run Temper chisquare::logpdf
    Tensor<float> result = stats::chisquare::logpdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.logpdf_random_test_dof_7
  * @brief Randomly generated chisquare logpdf test on 100 matrix with dof = 7.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, logpdf_random_test_dof_7)
{
    Tensor<float> x({100});
    x = std::vector<float>{0.00000100000000000, 0.31313230303030298, 0.62626360606060605, 0.93939490909090906, 1.25252621212121196, 1.56565751515151486, 1.87878881818181798, 2.19192012121212132, 2.50505142424242422, 2.81818272727272712, 3.13131403030303002, 3.44444533333333336, 3.75757663636363626, 4.07070793939393916, 4.38383924242424250, 4.69697054545454495, 5.01010184848484830, 5.32323315151515164, 5.63636445454545409, 5.94949575757575744, 6.26262706060605989, 6.57575836363636324, 6.88888966666666658, 7.20202096969696903, 7.51515227272727238, 7.82828357575757572, 8.14141487878787729, 8.45454618181818063, 8.76767748484848397, 9.08080878787878731, 9.39394009090908888, 9.70707139393939222, 10.02020269696969557, 10.33333399999999891, 10.64646530303030225, 10.95959660606060382, 11.27272790909090716, 11.58585921212121050, 11.89899051515151385, 12.21212181818181719, 12.52525312121211876, 12.83838442424242210, 13.15151572727272544, 13.46464703030302879, 13.77777833333333213, 14.09090963636363547, 14.40404093939393704, 14.71717224242424038, 15.03030354545454372, 15.34343484848484707, 15.65656615151515041, 15.96969745454545198, 16.28282875757575709, 16.59596006060606044, 16.90909136363636378, 17.22222266666666712, 17.53535396969697047, 17.84848527272727381, 18.16161657575757715, 18.47474787878787694, 18.78787918181818029, 19.10101048484848363, 19.41414178787878697, 19.72727309090909031, 20.04040439393939366, 20.35353569696969700, 20.66666700000000034, 20.97979830303030369, 21.29292960606060703, 21.60606090909091037, 21.91919221212121016, 22.23232351515151350, 22.54545481818181685, 22.85858612121212019, 23.17171742424242353, 23.48484872727272688, 23.79798003030303022, 24.11111133333333356, 24.42424263636363690, 24.73737393939394025, 25.05050524242424004, 25.36363654545454338, 25.67676784848484672, 25.98989915151515007, 26.30303045454545341, 26.61616175757575675, 26.92929306060606010, 27.24242436363636344, 27.55555566666666678, 27.86868696969697012, 28.18181827272727347, 28.49494957575757326, 28.80808087878787660, 29.12121218181817994, 29.43434348484848329, 29.74747478787878663, 30.06060609090908997, 30.37373739393939331, 30.68686869696969666, 31.00000000000000000};
    Tensor<float> k({1});
    k = 7.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{-38.16576562921756732, -6.68637859673232882, -5.11008028877366804, -4.25298450066184319, -3.69034563636952484, -3.28905280879242623, -2.98981483445157625, -2.76100397649065998, -2.58374128901357292, -2.44584946227482458, -2.33901391335506004, -2.25730418794002530, -2.19634145746495868, -2.15280039097491738, -2.12409615597317813, -2.10817966678937729, -2.10339904872672401, -2.10840317505324970, -2.12207281805960779, -2.14347043974371854, -2.17180287630017821, -2.20639313640096413, -2.24665876610998749, -2.29209502697645373, -2.34226165690814714, -2.39677233542911150, -2.45528621634393751, -2.51750105927500556, -2.58314761092364442, -2.65198497274297473, -2.72379675424578505, -2.79838785728826522, -2.87558177106522272, -2.95521828347397353, -3.03715153423067097, -3.12124835027182623, -3.20738681570664319, -3.29545503774540549, -3.38535007723358206, -3.47697701812780835, -3.57024815480010016, -3.66508227970753797, -3.76140405691143176, -3.85914346932184671, -3.95823532949505541, -4.05861884541231799, -4.16023723398747425, -4.26303737614303380, -4.36696950820255481, -4.47198694510536932, -4.57804583158544531, -4.68510491799107687, -4.79312535787398453, -4.90207052485930461, -5.01190584663368721, -5.12259865416652005, -5.23411804451714069, -5.34643475578500382, -5.45952105293544587, -5.57335062338544684, -5.68789848136497600, -5.80314088018348695, -5.91905523163020586, -6.03562003182325668, -6.15281479289818733, -6.27061997999262477, -6.38901695304184791, -6.50798791295113688, -6.62751585175582214, -6.74758450641968466, -6.86817831595756090, -6.98928238159923332, -7.11088242973932694, -7.23296477744263910, -7.35551630029629244, -7.47852440241962846, -7.60197698846040737, -7.72586243742147438, -7.85016957817617111, -7.97488766654341141, -8.10000636380468286, -8.22551571655552038, -8.35140613779316432, -8.47766838915051757, -8.60429356419401259, -8.73127307270984687, -8.85859862590920422, -8.98626222248874384, -9.11425613548766300, -9.24257289988737440, -9.37120530090395043, -9.50014636292746850, -9.62938933906578498, -9.75892770125352804, -9.88875513089008784, -10.01886550997294734, -10.14925291269528529, -10.27991159747894478, -10.41083599941600113, -10.54202072309401750};
    // run Temper chisquare::logpdf
    Tensor<float> result = stats::chisquare::logpdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.logpdf_random_test_dof_8
  * @brief Randomly generated chisquare logpdf test on 100 matrix with dof = 8.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, logpdf_random_test_dof_8)
{
    Tensor<float> x({100});
    x = std::vector<float>{0.00000100000000000, 0.34343533333333331, 0.68686966666666671, 1.03030399999999989, 1.37373833333333328, 1.71717266666666668, 2.06060700000000008, 2.40404133333333370, 2.74747566666666687, 3.09091000000000005, 3.43434433333333367, 3.77777866666666684, 4.12121300000000002, 4.46464733333333363, 4.80808166666666725, 5.15151599999999998, 5.49495033333333360, 5.83838466666666722, 6.18181899999999995, 6.52525333333333357, 6.86868766666666719, 7.21212199999999992, 7.55555633333333354, 7.89899066666666716, 8.24242499999999900, 8.58585933333333351, 8.92929366666666624, 9.27272799999999897, 9.61616233333333348, 9.95959666666666621, 10.30303099999999894, 10.64646533333333345, 10.98989966666666618, 11.33333399999999891, 11.67676833333333342, 12.02020266666666615, 12.36363699999999888, 12.70707133333333338, 13.05050566666666612, 13.39393999999999885, 13.73737433333333335, 14.08080866666666608, 14.42424299999999882, 14.76767733333333332, 15.11111166666666605, 15.45454599999999878, 15.79798033333333329, 16.14141466666666958, 16.48484900000000053, 16.82828333333333504, 17.17171766666666954, 17.51515200000000050, 17.85858633333333501, 18.20202066666666951, 18.54545500000000047, 18.88888933333333497, 19.23232366666666948, 19.57575800000000044, 19.91919233333333494, 20.26262666666666945, 20.60606100000000040, 20.94949533333333491, 21.29292966666666942, 21.63636400000000037, 21.97979833333333488, 22.32323266666666939, 22.66666700000000034, 23.01010133333333485, 23.35353566666666936, 23.69697000000000031, 24.04040433333333482, 24.38383866666666933, 24.72727300000000028, 25.07070733333333479, 25.41414166666666929, 25.75757600000000025, 26.10101033333333476, 26.44444466666666926, 26.78787900000000022, 27.13131333333333473, 27.47474766666666923, 27.81818200000000019, 28.16161633333333469, 28.50505066666666920, 28.84848500000000016, 29.19191933333333466, 29.53535366666666917, 29.87878800000000012, 30.22222233333333463, 30.56565666666666914, 30.90909100000000009, 31.25252533333333460, 31.59595966666666911, 31.93939400000000006, 32.28282833333333457, 32.62626266666666197, 32.96969699999999648, 33.31313133333333099, 33.65656566666666549, 34.00000000000000000};
    Tensor<float> k({1});
    k = 8.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{-46.01088036536065573, -7.94233518764342783, -6.03461518026790600, -4.98993847849070971, -4.29861015574261351, -3.80089710523108293, -3.42564989269220943, -3.13491522786020660, -2.90603837264064424, -2.72440655366165219, -2.58004227041363610, -2.46582897707907378, -2.37651207895330652, -2.30810117859482755, -2.25749447679644133, -2.22223307059888553, -2.20033471024989158, -2.19017804358230039, -2.19041999727583070, -2.19993552567346207, -2.21777283216509025, -2.24311952712177787, -2.27527666579132681, -2.31363856200891727, -2.35767690124400264, -2.40692809890872628, -2.46098313955446280, -2.51947933471602603, -2.58209358042468917, -2.64853679841529654, -2.71854932009548644, -2.79189702768596870, -2.86836810821463395, -2.94777030715309696, -3.02992859215618804, -3.11468315554368047, -3.20188769824303154, -3.29140794890338295, -3.38312038053643427, -3.47691109388757891, -3.57267484220092246, -3.67031417642287394, -3.76973869342511936, -3.87086437269802186, -3.97361298930755602, -4.07791159282980953, -4.18369204356010105, -4.29089059860425337, -4.39944754154945095, -4.50930685032189515, -4.62041589860143098, -4.73272518680516363, -4.84618809919437687, -4.96076068411851523, -5.07640145480088911, -5.19307120840414171, -5.31073286139890754, -5.42935129950399187, -5.54889324067730705, -5.66932710981875942, -5.79062292400387868, -5.91275218720360662, -6.03568779356463558, -6.15940393842835654, -6.28387603635709624, -6.40908064551569900, -6.53499539782619898, -6.66159893437466089, -6.78887084560322229, -6.91679161586817237, -7.04534257198709035, -7.17450583543549314, -7.30426427788671973, -7.43460147981834751, -7.56550169193472577, -7.69694979917889555, -7.82893128712800923, -7.96143221058532191, -8.09443916419869147, -8.22793925495067491, -8.36192007637892942, -8.49636968439796192, -8.63127657460434605, -8.76662966095744878, -8.90241825573687784, -9.03863205068596720, -9.17526109925803901, -9.31229579988898593, -9.44972688022575724, -9.58754538224595976, -9.72574264820879719, -9.86431030738228998, -10.00324026349577977, -10.14252468287075537, -10.28215598318641000, -10.42212682283965997, -10.56243009086225904, -10.70305889736035354, -10.84400656444437772, -10.98526661761935230};
    // run Temper chisquare::logpdf
    Tensor<float> result = stats::chisquare::logpdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.logpdf_random_test_dof_9
  * @brief Randomly generated chisquare logpdf test on 100 matrix with dof = 9.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, logpdf_random_test_dof_9)
{
    Tensor<float> x({100});
    x = std::vector<float>{0.00000100000000000, 0.37373836363636365, 0.74747572727272737, 1.12121309090909094, 1.49495045454545461, 1.86868781818181828, 2.24242518181818218, 2.61616254545454563, 2.98989990909090952, 3.36363727272727342, 3.73737463636363687, 4.11111200000000032, 4.48484936363636422, 4.85858672727272811, 5.23232409090909112, 5.60606145454545501, 5.97979881818181891, 6.35353618181818280, 6.72727354545454670, 7.10101090909090971, 7.47474827272727360, 7.84848563636363750, 8.22222299999999962, 8.59596036363636351, 8.96969772727272741, 9.34343509090909130, 9.71717245454545520, 10.09090981818181909, 10.46464718181818121, 10.83838454545454510, 11.21212190909090900, 11.58585927272727290, 11.95959663636363679, 12.33333400000000069, 12.70707136363636458, 13.08080872727272848, 13.45454609090909237, 13.82828345454545449, 14.20202081818181838, 14.57575818181818228, 14.94949554545454617, 15.32323290909091007, 15.69697027272727397, 16.07070763636363964, 16.44444500000000176, 16.81818236363636743, 17.19191972727272955, 17.56565709090909522, 17.93939445454545734, 18.31313181818181945, 18.68686918181818513, 19.06060654545454724, 19.43434390909091292, 19.80808127272727504, 20.18181863636364071, 20.55555600000000283, 20.92929336363636494, 21.30303072727273062, 21.67676809090909273, 22.05050545454545841, 22.42424281818182052, 22.79798018181818620, 23.17171754545454831, 23.54545490909091399, 23.91919227272727611, 24.29292963636363822, 24.66666700000000390, 25.04040436363636601, 25.41414172727273169, 25.78787909090909380, 26.16161645454545948, 26.53535381818182159, 26.90909118181818727, 27.28282854545454938, 27.65656590909091150, 28.03030327272727718, 28.40404063636363929, 28.77777800000000497, 29.15151536363636708, 29.52525272727273276, 29.89899009090909487, 30.27272745454545699, 30.64646481818182266, 31.02020218181818478, 31.39393954545455045, 31.76767690909091257, 32.14141427272727469, 32.51515163636364036, 32.88888899999999893, 33.26262636363636460, 33.63636372727273027, 34.01010109090908884, 34.38383845454545451, 34.75757581818182018, 35.13131318181818585, 35.50505054545454442, 35.87878790909091009, 36.25252527272727576, 36.62626263636363433, 37.00000000000000000};
    Tensor<float> k({1});
    k = 9.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{-53.92718633623715618, -9.20446557613866290, -6.96532380842019982, -5.73306617266891827, -4.91304838131068422, -4.31891510177210680, -3.86765864697346462, -3.51500017236912887, -3.23450914723115535, -3.00913733431952535, -2.82724431538934251, -2.68052745302750317, -2.56285638632791191, -2.46957565131989032, -2.39706648205533890, -2.34246015826377763, -2.30344405512072514, -2.27812659501103054, -2.26494085899352227, -2.26257429374838104, -2.26991646985451379, -2.28601959937697963, -2.31006824674330424, -2.34135577807120399, -2.37926582638893347, -2.42325754299432994, -2.47285374318351092, -2.52763129040198908, -2.58721323000949521, -2.65126230402131569, -2.71947556573882476, -2.79157987774628502, -2.86732812490382383, -2.94649601025660957, -3.02887932939748961, -3.11429164002892378, -3.20256225989609877, -3.29353453908656046, -3.38706436277782075, -3.48301884850366239, -3.58127520837994595, -3.68171975184211231, -3.78424700857194729, -3.88875895463986865, -3.99516432762132112, -4.10337801868702812, -4.21332053151358465, -4.32491749938997039, -4.43809925316683085, -4.55280043375709553, -4.66895964378635497, -4.78651913374040205, -4.90542451858997630, -5.02562452140871763, -5.14707074095650619, -5.26971744058915270, -5.39352135618850248, -5.51844152109263497, -5.64443910625196210, -5.77147727404925881, -5.89952104440554592, -6.02853717195319838, -6.15849403319631605, -6.28936152269951521, -6.42111095745184279, -6.55371498864531432, -6.68714752018868985, -6.82138363334876807, -6.95639951697446079, -7.09217240281452987, -7.22868050548925822, -7.36590296671987055, -7.50381980345840205, -7.64241185959515512, -7.78166076095170212, -7.92154887329475699, -8.06205926313082344, -8.20317566106355756, -8.34488242751531217, -8.48716452063226789, -8.63000746620821957, -8.77339732947664785, -8.91732068863342597, -9.06176460996437250, -9.20671662446225980, -9.35216470582753701, -9.49809724975565217, -9.64450305442172073, -9.79137130208042805, -9.93869154170556257, -10.08645367259945225, -10.23464792890803743, -10.38326486498214685, -10.53229534153011215, -10.68173051251092787, -10.83156181272092411, -10.98178094603042254, -11.13237987422986919, -11.28335080644803945, -11.43468618910741164};
    // run Temper chisquare::logpdf
    Tensor<float> result = stats::chisquare::logpdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.logpdf_random_test_dof_10
  * @brief Randomly generated chisquare logpdf test on 100 matrix with dof = 10.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, logpdf_random_test_dof_10)
{
    Tensor<float> x({100});
    x = std::vector<float>{0.00000100000000000, 0.40404139393939392, 0.80808178787878793, 1.21212218181818177, 1.61616257575757571, 2.02020296969697011, 2.42424336363636383, 2.82828375757575756, 3.23232415151515173, 3.63636454545454590, 4.04040493939394008, 4.44444533333333336, 4.84848572727272753, 5.25252612121212170, 5.65656651515151498, 6.06060690909090916, 6.46464730303030333, 6.86868769696969750, 7.27272809090909167, 7.67676848484848495, 8.08080887878787912, 8.48484927272727241, 8.88888966666666569, 9.29293006060606075, 9.69697045454545403, 10.10101084848484732, 10.50505124242424237, 10.90909163636363566, 11.31313203030302894, 11.71717242424242400, 12.12121281818181728, 12.52525321212121234, 12.92929360606060563, 13.33333399999999891, 13.73737439393939397, 14.14141478787878725, 14.54545518181818231, 14.94949557575757559, 15.35353596969696888, 15.75757636363636394, 16.16161675757576077, 16.56565715151515406, 16.96969754545454734, 17.37373793939394062, 17.77777833333333390, 18.18181872727272719, 18.58585912121212402, 18.98989951515151731, 19.39393990909091059, 19.79798030303030387, 20.20202069696969716, 20.60606109090909399, 21.01010148484848727, 21.41414187878788056, 21.81818227272727384, 22.22222266666666712, 22.62626306060606041, 23.03030345454545724, 23.43434384848485053, 23.83838424242424381, 24.24242463636363709, 24.64646503030303037, 25.05050542424242721, 25.45454581818182049, 25.85858621212121378, 26.26262660606060706, 26.66666700000000034, 27.07070739393939718, 27.47474778787879046, 27.87878818181818374, 28.28282857575757703, 28.68686896969697031, 29.09090936363636715, 29.49494975757576043, 29.89899015151515371, 30.30303054545454700, 30.70707093939394028, 31.11111133333333356, 31.51515172727273040, 31.91919212121212368, 32.32323251515151696, 32.72727290909090669, 33.13131330303030353, 33.53535369696969326, 33.93939409090909010, 34.34343448484847983, 34.74747487878787666, 35.15151527272727350, 35.55555566666666323, 35.95959606060606006, 36.36363645454544979, 36.76767684848484663, 37.17171724242424347, 37.57575763636363320, 37.97979803030303003, 38.38383842424241976, 38.78787881818181660, 39.19191921212121343, 39.59595960606060316, 40.00000000000000000};
    Tensor<float> k({1});
    k = 10.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{-61.90583246500477088, -10.47076221421198916, -7.90019863893284047, -6.48036005346821931, -5.53165278563021801, -4.84109927234281123, -4.31383357213654861, -3.89925128551141409, -3.56714608876868011, -3.29803428061280712, -3.07861252495117244, -2.89939209270355169, -2.75336685671471493, -2.63521628645179362, -2.54080464920219917, -2.46685340736694059, -2.41071956103634655, -2.37024130713735914, -2.34362788110019871, -2.32937922193615776, -2.32622626740828142, -2.33308583127167690, -2.34902598713037225, -2.37323915338194880, -2.40502091061124368, -2.44375314599991889, -2.48889050558725966, -2.53994940472813102, -2.59649903810956584, -2.65815396802629955, -2.72456796967258086, -2.79542888599547457, -2.87045429968668930, -2.94938787136436975, -3.03199622455887230, -3.11806628235488681, -3.20740297931494123, -3.29982728696461347, -3.39517450264691600, -3.49329276068373140, -3.59404173206242383, -3.69729148470722002, -3.80292148110980399, -3.91081969392045181, -4.02088182322391141, -4.13301060178537405, -4.24711517666257876, -4.36311055732751463, -4.48091712189417990, -4.60046017426211762, -4.72166954600255195, -4.84447923766988353, -4.96882709494420638, -5.09465451562328830, -5.22190618400349393, -5.35052982963373758, -5.48047600780700606, -5.61169789948060505, -5.74415112859738031, -5.87779359502292031, -6.01258532152370329, -6.14848831339347512, -6.28546642949371481, -6.42348526361220884, -6.56251203516470660, -6.70251548837035038, -6.84346579912458530, -6.98533448887492625, -7.12809434487702021, -7.27171934627208039, -7.41618459548306852, -7.56146625447689047, -7.70754148548424922, -7.85438839580816328, -8.00198598638740144, -8.15031410381231858, -8.29935339551877505, -8.44908526791078884, -8.59949184718520776, -8.75055594265180758, -8.90226101236051903, -9.05459113086376277, -9.20753095895671869, -9.36106571525163389, -9.51518114945443472, -9.66986351722267301, -9.82509955649391564, -9.98087646518248484, -10.13718188015079313, -10.29400385736880175, -10.45133085318195221, -10.60915170661410123, -10.76745562263755218, -10.92623215634746714, -11.08547119798263658, -11.24516295873880800, -11.40529795732484963, -11.56586700721550720, -11.72686120455789194, -11.88827191669192729};
    // run Temper chisquare::logpdf
    Tensor<float> result = stats::chisquare::logpdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.logpdf_random_test_dof_11
  * @brief Randomly generated chisquare logpdf test on 100 matrix with dof = 11.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, logpdf_random_test_dof_11)
{
    Tensor<float> x({100});
    x = std::vector<float>{0.00000100000000000, 0.43434442424242425, 0.86868784848484859, 1.30303127272727282, 1.73737469696969704, 2.17171812121212149, 2.60606154545454594, 3.04040496969696994, 3.47474839393939439, 3.90909181818181883, 4.34343524242424284, 4.77777866666666728, 5.21212209090909173, 5.64646551515151618, 6.08080893939393974, 6.51515236363636419, 6.94949578787878863, 7.38383921212121308, 7.81818263636363753, 8.25252606060606020, 8.68686948484848465, 9.12121290909090909, 9.55555633333333354, 9.98989975757575799, 10.42424318181818244, 10.85858660606060688, 11.29293003030303133, 11.72727345454545400, 12.16161687878787845, 12.59596030303030290, 13.03030372727272734, 13.46464715151515179, 13.89899057575757624, 14.33333400000000069, 14.76767742424242513, 15.20202084848484958, 15.63636427272727403, 16.07070769696969847, 16.50505112121212292, 16.93939454545454737, 17.37373796969697182, 17.80808139393939626, 18.24242481818182071, 18.67676824242424516, 19.11111166666666961, 19.54545509090909405, 19.97979851515151850, 20.41414193939394295, 20.84848536363636740, 21.28282878787879184, 21.71717221212121629, 22.15151563636364074, 22.58585906060606519, 23.02020248484848963, 23.45454590909091053, 23.88888933333333497, 24.32323275757575942, 24.75757618181818387, 25.19191960606060832, 25.62626303030303276, 26.06060645454545721, 26.49494987878788166, 26.92929330303030611, 27.36363672727273055, 27.79798015151515500, 28.23232357575757945, 28.66666700000000390, 29.10101042424242834, 29.53535384848485279, 29.96969727272727724, 30.40404069696970168, 30.83838412121212613, 31.27272754545455058, 31.70707096969697503, 32.14141439393939237, 32.57575781818182037, 33.01010124242424126, 33.44444466666666926, 33.87878809090909016, 34.31313151515151816, 34.74747493939393905, 35.18181836363636705, 35.61616178787878795, 36.05050521212121595, 36.48484863636363684, 36.91919206060606484, 37.35353548484848574, 37.78787890909090663, 38.22222233333333463, 38.65656575757575553, 39.09090918181818353, 39.52525260606060442, 39.95959603030303242, 40.39393945454545332, 40.82828287878788132, 41.26262630303030221, 41.69696972727273021, 42.13131315151515111, 42.56565657575757911, 43.00000000000000000};
    Tensor<float> k({1});
    k = 11.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{-69.93992147153764449, -11.73992422200198504, -8.83793880182717650, -7.23051925420421870, -6.15312250366395030, -5.36614875289421711, -4.76287380479133304, -4.28636770436754233, -3.90264833468665584, -3.58979653024945522, -3.33284603702670124, -3.12112203421448120, -2.94674262837071721, -2.80372222237424173, -2.68740811672932933, -2.59411195649480275, -2.52086036666554270, -2.46522131870273986, -2.42518020240190912, -2.39904944910063422, -2.38540136374224732, -2.38301736176878842, -2.39084902595823090, -2.40798782698591518, -2.43364129299150322, -2.46711404703900827, -2.50779256590963096, -2.55513281686652816, -2.60865014392311911, -2.66791092965281029, -2.73252567114203471, -2.80214319170007320, -2.87644577184968986, -2.95514502978155624, -3.03797841696313098, -3.12470622186098046, -3.21510899585465060, -3.30898533190747335, -3.40614993952771128, -3.50643196982511851, -3.60967355265834966, -3.71572851444024499, -3.82446125047221441, -3.93574572998424577, -4.04946461557024762, -4.16550848158975207, -4.28377511848153247, -4.40416891190048432, -4.52660028722385555, -4.65098521133771570, -4.77724474475885152, -4.90530463811018258, -5.03509496778109877, -5.16654980629342475, -5.29960692347995987, -5.43420751508265809, -5.57029595580560510, -5.70781957422527420, -5.84672844727691121, -5.98697521230887730, -6.12851489493306012, -6.27130475110455166, -6.41530412204216738, -6.56047430075684446, -6.70677840909098855, -6.85418128429085272, -7.00264937423854406, -7.15215064056226169, -7.30265446892436820, -7.45413158585850688, -7.60655398159029339, -7.75989483833230231, -7.91412846359387956, -8.06923022809074908, -8.22517650787885124, -8.38194463037218007, -8.53951282393592415, -8.69786017077446516, -8.85696656285911033, -9.01681266066323595, -9.17737985449289084, -9.33865022821943747, -9.50060652523732152, -9.66323211648523817, -9.82651097038223931, -9.99042762454298305, -10.15496715914713555, -10.32011517184822402, -10.48585775411638288, -10.65218146891773010, -10.81907332964082080, -10.98652078018741385, -11.15451167615128547, -11.32303426701442639, -11.49207717929541239, -11.66162940058939235, -11.83168026444378995, -12.00221943601763641, -12.17323689847638590, -12.34472294007738213};
    // run Temper chisquare::logpdf
    Tensor<float> result = stats::chisquare::logpdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.logpdf_random_test_dof_12
  * @brief Randomly generated chisquare logpdf test on 100 matrix with dof = 12.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, logpdf_random_test_dof_12)
{
    Tensor<float> x({100});
    x = std::vector<float>{0.00000100000000000, 0.46464745454545453, 0.92929390909090914, 1.39394036363636364, 1.85858681818181815, 2.32323327272727287, 2.78787972727272759, 3.25252618181818187, 3.71717263636363660, 4.18181909090909087, 4.64646554545454560, 5.11111200000000032, 5.57575845454545505, 6.04040490909090977, 6.50505136363636360, 6.96969781818181833, 7.43434427272727305, 7.89899072727272777, 8.36363718181818072, 8.82828363636363633, 9.29293009090909017, 9.75757654545454578, 10.22222299999999962, 10.68686945454545345, 11.15151590909090906, 11.61616236363636290, 12.08080881818181851, 12.54545527272727234, 13.01010172727272618, 13.47474818181818179, 13.93939463636363563, 14.40404109090909124, 14.86868754545454507, 15.33333399999999891, 15.79798045454545452, 16.26262690909091191, 16.72727336363636397, 17.19191981818181958, 17.65656627272727519, 18.12121272727272725, 18.58585918181818286, 19.05050563636363847, 19.51515209090909408, 19.97979854545454614, 20.44444500000000176, 20.90909145454545737, 21.37373790909090943, 21.83838436363636504, 22.30303081818182065, 22.76767727272727271, 23.23232372727272832, 23.69697018181818393, 24.16161663636363954, 24.62626309090909160, 25.09090954545454721, 25.55555600000000283, 26.02020245454545488, 26.48484890909091050, 26.94949536363636611, 27.41414181818181817, 27.87878827272727378, 28.34343472727272939, 28.80808118181818500, 29.27272763636363706, 29.73737409090909267, 30.20202054545454828, 30.66666700000000034, 31.13131345454545595, 31.59595990909091157, 32.06060636363636007, 32.52525281818181924, 32.98989927272727130, 33.45454572727272335, 33.91919218181818252, 34.38383863636363458, 34.84848509090908664, 35.31313154545454580, 35.77777799999999786, 36.24242445454544992, 36.70707090909090908, 37.17171736363636114, 37.63636381818181320, 38.10101027272727237, 38.56565672727272442, 39.03030318181818359, 39.49494963636363565, 39.95959609090908771, 40.42424254545454687, 40.88888899999999893, 41.35353545454545099, 41.81818190909091015, 42.28282836363636221, 42.74747481818181427, 43.21212127272727344, 43.67676772727272549, 44.14141418181817755, 44.60606063636363672, 45.07070709090908878, 45.53535354545454084, 46.00000000000000000};
    Tensor<float> k({1});
    k = 12.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{-78.02392811596308775, -13.01108016947935297, -9.77767287437856858, -7.98267235458716584, -6.77658611633957531, -5.89319212508448231, -5.21390792708295514, -4.67547801143049213, -4.24014446773893994, -3.88355266618623673, -3.58907343473502571, -3.34484586081219692, -3.14211228465850034, -2.97422204254346845, -2.83600546817323629, -2.72336438925343494, -2.63299505567525749, -2.56219521342782919, -2.50872640666704960, -2.47071355905292478, -2.44657034270597595, -2.43494277475265886, -2.43466594714284490, -2.44473038282794075, -2.46425555750101655, -2.49246883010724929, -2.52868850816875401, -2.57231011085611971, -2.62279513150842547, -2.67966177297710395, -2.74247725424023958, -2.81085137896883897, -2.88443112551631486, -2.96289606964549090, -3.04595449076060465, -3.13334004270981836, -3.22480889368943657, -3.32013725810032234, -3.41911925761577784, -3.52156506013324666, -3.62729925438251755, -3.73615942526489420, -3.84799490089137208, -3.96266564707152646, -4.08004128890832263, -4.20000024235554115, -4.32242894123287691, -4.44722114737806251, -4.57427733343151921, -4.70350412926576489, -4.83481382434308671, -4.96812391935486453, -5.10335672139972907, -5.24043897772350675, -5.37930154369538549, -5.51987908125031623, -5.66210978450343916, -5.80593512965036318, -5.95129964661869693, -6.09815071023953692, -6.24643834897015360, -6.39611506942695485, -6.54713569518606597, -6.69945721848154641, -6.85303866358244562, -7.00784096076209373, -7.16382682988924024, -7.32096067277274898, -7.47920847348168572, -7.63853770594209536, -7.79891724818225285, -7.96031730266036064, -8.12270932216440755, -8.28606594082280878, -8.45036090980865495, -8.61556903735957746, -8.78166613277007357, -8.94862895404487091, -9.11643515892974321, -9.28506325906165131, -9.45449257700274615, -9.62470320594331596, -9.79567597187709538, -9.96739239806918675, -10.13983467165177643, -10.31298561219661636, -10.48682864212545951, -10.66134775883104169, -10.83652750839120316, -11.01235296076822223, -11.18880968639375695, -11.36588373404746122, -11.54356160994457525, -11.72183025795392552, -11.90067704087385181, -12.08008972269891856, -12.26005645181508896, -12.44056574506567259, -12.62160647263446478, -12.80316784369624017};
    // run Temper chisquare::logpdf
    Tensor<float> result = stats::chisquare::logpdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.logpdf_random_test_dof_13
  * @brief Randomly generated chisquare logpdf test on 100 matrix with dof = 13.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, logpdf_random_test_dof_13)
{
    Tensor<float> x({100});
    x = std::vector<float>{0.00000100000000000, 0.49495048484848486, 0.98989996969696981, 1.48484945454545447, 1.97979893939393947, 2.47474842424242469, 2.96969790909090925, 3.46464739393939425, 3.95959687878787925, 4.45454636363636425, 4.94949584848484925, 5.44444533333333425, 5.93939481818181836, 6.43434430303030336, 6.92929378787878836, 7.42424327272727336, 7.91919275757575836, 8.41414224242424247, 8.90909172727272747, 9.40404121212121247, 9.89899069696969747, 10.39394018181818247, 10.88888966666666747, 11.38383915151515247, 11.87878863636363569, 12.37373812121212069, 12.86868760606060569, 13.36363709090909069, 13.85858657575757569, 14.35353606060606069, 14.84848554545454569, 15.34343503030303069, 15.83838451515151569, 16.33333400000000069, 16.82828348484848746, 17.32323296969697068, 17.81818245454545746, 18.31313193939394068, 18.80808142424242746, 19.30303090909091068, 19.79798039393939746, 20.29292987878788068, 20.78787936363636746, 21.28282884848485068, 21.77777833333333746, 22.27272781818182068, 22.76767730303030746, 23.26262678787879068, 23.75757627272727390, 24.25252575757576068, 24.74747524242424390, 25.24242472727273068, 25.73737421212121390, 26.23232369696970068, 26.72727318181818390, 27.22222266666667068, 27.71717215151515390, 28.21212163636364068, 28.70707112121212390, 29.20202060606061067, 29.69697009090909390, 30.19191957575758067, 30.68686906060606390, 31.18181854545455067, 31.67676803030303390, 32.17171751515151357, 32.66666699999999679, 33.16161648484848712, 33.65656596969697034, 34.15151545454545357, 34.64646493939393679, 35.14141442424242712, 35.63636390909091034, 36.13131339393939356, 36.62626287878787679, 37.12121236363636712, 37.61616184848485034, 38.11111133333333356, 38.60606081818181678, 39.10101030303030711, 39.59595978787879034, 40.09090927272727356, 40.58585875757575678, 41.08080824242424001, 41.57575772727273034, 42.07070721212121356, 42.56565669696969678, 43.06060618181818000, 43.55555566666667033, 44.05050515151515356, 44.54545463636363678, 45.04040412121212000, 45.53535360606061033, 46.03030309090909356, 46.52525257575757678, 47.02020206060606000, 47.51515154545454322, 48.01010103030303355, 48.50505051515151678, 49.00000000000000000};
    Tensor<float> k({1});
    k = 13.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{-86.15332730230028346, -14.28363051206382472, -10.71880131752251231, -8.73621981739114517, -7.40144408735047410, -6.42162985315856538, -5.66633640362409174, -5.06598267157559601, -4.57903495299785845, -4.17870315364869249, -3.84669518342425487, -3.56996403794510186, -3.33887629111004003, -3.14611621256216267, -2.98599716919721558, -2.85401117135867111, -2.74652409382728813, -2.66056345711497588, -2.59366695973402273, -2.54377201766368888, -2.50913367019915334, -2.48826253614924209, -2.47987721663404947, -2.48286728687966463, -2.49626417013140500, -2.51921796121465214, -2.55097879839160679, -2.59088175273959997, -2.63833446692276663, -2.69280696407005316, -2.75382318505074242, -2.82095391389718486, -2.89381082679309554, -2.97204145707314993, -3.05532491207810963, -3.14336821103748321, -3.23590313896413839, -3.33268353169627751, -3.43348292307207714, -3.53809249777652468, -3.64631930341040977, -3.75798468336336633, -3.87292289855588123, -3.99097991137701413, -4.11201230943869511, -4.23588635028885641, -4.36247711112807224, -4.49166772997681107, -4.62334872673861597, -4.75741739427240695, -4.89377725098590410, -5.03233754763889962, -5.17301282203922241, -5.31572249615666159, -5.46039051089675276, -5.60694499438741190, -5.75531796015479458, -5.90544503201361159, -6.05726519288380949, -6.21072055507919529, -6.36575614990239202, -6.52231973463110926, -6.68036161519875016, -6.83983448306248576, -7.00069326491797739, -7.16289498406562153, -7.32639863236079059, -7.49116505179300951, -7.65715682483801352, -7.82433817281425270, -7.99267486155262041, -8.16213411375696829, -8.33268452749389787, -8.50429600030449429, -8.67693965847901616, -8.85058779107869320, -9.02521378832733667, -9.20079208403001836, -9.37729810170695721, -9.55470820415868793, -9.73299964620346536, -9.91215053035049642, -10.09213976519278511, -10.27294702632184631, -10.45455271958299370, -10.63693794650505176, -10.82008447175188515, -11.00397469245540982, -11.18859160930116836, -11.37391879924760296, -11.55994038976945326, -11.74664103452428598, -11.93400589034879467, -12.12202059549861666, -12.31067124905187704, -12.49994439140253810, -12.68982698577510426, -12.88030640069716704, -13.07137039337083984, -13.26300709388833887};
    // run Temper chisquare::logpdf
    Tensor<float> result = stats::chisquare::logpdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.logpdf_random_test_dof_14
  * @brief Randomly generated chisquare logpdf test on 100 matrix with dof = 14.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, logpdf_random_test_dof_14)
{
    Tensor<float> x({100});
    x = std::vector<float>{0.00000100000000000, 0.52525351515151519, 1.05050603030303025, 1.57575854545454530, 2.10101106060606080, 2.62626357575757607, 3.15151609090909091, 3.67676860606060618, 4.20202112121212146, 4.72727363636363673, 5.25252615151515201, 5.77777866666666728, 6.30303118181818167, 6.82828369696969695, 7.35353621212121222, 7.87878872727272750, 8.40404124242424189, 8.92929375757575627, 9.45454627272727244, 9.97979878787878683, 10.50505130303030299, 11.03030381818181738, 11.55555633333333354, 12.08080884848484793, 12.60606136363636232, 13.13131387878787848, 13.65656639393939287, 14.18181890909090903, 14.70707142424242342, 15.23232393939393958, 15.75757645454545397, 16.28282896969697191, 16.80808148484848630, 17.33333400000000069, 17.85858651515151507, 18.38383903030303301, 18.90909154545454740, 19.43434406060606179, 19.95959657575757618, 20.48484909090909412, 21.01010160606060850, 21.53535412121212289, 22.06060663636363728, 22.58585915151515167, 23.11111166666666961, 23.63636418181818399, 24.16161669696969838, 24.68686921212121277, 25.21212172727272716, 25.73737424242424510, 26.26262675757575948, 26.78787927272727387, 27.31313178787878826, 27.83838430303030620, 28.36363681818182059, 28.88888933333333497, 29.41414184848484936, 29.93939436363636375, 30.46464687878788169, 30.98989939393939608, 31.51515190909091046, 32.04040442424242485, 32.56565693939393924, 33.09090945454545363, 33.61616196969696801, 34.14141448484848240, 34.66666699999999679, 35.19191951515151118, 35.71717203030302556, 36.24242454545454706, 36.76767706060606145, 37.29292957575757583, 37.81818209090909022, 38.34343460606060461, 38.86868712121211900, 39.39393963636363338, 39.91919215151514777, 40.44444466666666216, 40.96969718181818365, 41.49494969696969804, 42.02020221212121243, 42.54545472727272681, 43.07070724242424120, 43.59595975757575559, 44.12121227272726998, 44.64646478787878436, 45.17171730303029875, 45.69696981818182024, 46.22222233333333463, 46.74747484848484902, 47.27272736363636341, 47.79797987878787779, 48.32323239393939218, 48.84848490909090657, 49.37373742424242096, 49.89898993939393534, 50.42424245454544973, 50.94949496969697122, 51.47474748484848561, 52.00000000000000000};
    Tensor<float> k({1});
    k = 14.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{-94.32434532371536307, -15.55715371514279610, -11.66090260088930108, -9.49074011366075254, -8.02727488844838888, -6.95104040929250200, -6.11973770687363761, -5.45746015746379154, -4.91889826327588153, -4.47482646556715213, -4.10528975611900560, -3.79605503871495120, -3.53661312089137869, -3.31898320565076244, -3.13696169306833905, -2.98563077611798544, -2.86102595446446539, -2.75990452313821688, -2.67958033500459347, -2.61780329835950365, -2.57266981967068720, -2.54255511942765100, -2.52606130791932326, -2.52197701264532892, -2.52924560440229040, -2.54693991389497665, -2.57424191012500980, -2.61042621607587133, -2.65484662373627156, -2.70692497651223807, -2.76614193716387735, -2.83202927008456751, -2.90416334928804343, -2.98215966568058644, -3.06566815453925212, -3.15436920047471947, -3.24797020531623293, -3.34620262633918575, -3.44881940954649568, -3.55559275641057138, -3.66631217340307369, -3.78078276240189393, -3.89882371713689846, -4.02026699657655850, -4.14495615084169433, -4.27274527907432944, -4.40349810185583213, -4.53708713338937475, -4.67339294084155998, -4.81230348005765318, -4.95371349839077535, -5.09752399666909195, -5.24364174340958566, -5.39197883530597810, -5.54245229880011170, -5.69498372821284082, -5.84949895648132401, -6.00592775503933129, -6.16420355979913293, -6.32426322055721624, -6.48604677146154440, -6.64949722045109848, -6.81456035581655239, -6.98118456823815858, -7.14932068683818667, -7.31892182794408352, -7.48994325539783201, -7.66234225136958269, -7.83607799674175620, -8.01111146022518739, -8.18740529545337381, -8.36492374537579764, -8.54363255333767668, -8.72349888029275888, -8.90449122764844603, -9.08657936528957322, -9.26973426436925507, -9.45392803449288976, -9.63913386495514857, -9.82532596972012229, -10.01247953586216255, -10.20057067520939853, -10.38957637895409647, -10.57947447501416960, -10.77024358794805181, -10.96186310124166496, -11.15431312180093570, -11.34757444649698499, -11.54162853062304706, -11.73645745813371732, -11.93204391354682414, -12.12837115539782928, -12.32542299114488671, -12.52318375343044465, -12.72163827761240285, -12.92077188048411784, -13.12057034010863532, -13.32101987669781806, -13.52210713447211177, -13.72381916444115291};
    // run Temper chisquare::logpdf
    Tensor<float> result = stats::chisquare::logpdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.logpdf_random_test_dof_15
  * @brief Randomly generated chisquare logpdf test on 100 matrix with dof = 15.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, logpdf_random_test_dof_15)
{
    Tensor<float> x({100});
    x = std::vector<float>{0.00000100000000000, 0.55555654545454547, 1.11111209090909080, 1.66666763636363613, 2.22222318181818190, 2.77777872727272745, 3.33333427272727256, 3.88888981818181811, 4.44444536363636367, 5.00000090909090922, 5.55555645454545477, 6.11111200000000032, 6.66666754545454499, 7.22222309090909054, 7.77777863636363609, 8.33333418181818075, 8.88888972727272630, 9.44444527272727186, 10.00000081818181741, 10.55555636363636296, 11.11111190909090851, 11.66666745454545406, 12.22222299999999962, 12.77777854545454517, 13.33333409090908894, 13.88888963636363449, 14.44444518181818005, 15.00000072727272560, 15.55555627272727115, 16.11111181818181848, 16.66666736363636403, 17.22222290909090958, 17.77777845454545513, 18.33333400000000069, 18.88888954545454624, 19.44444509090909179, 20.00000063636363734, 20.55555618181818289, 21.11111172727272844, 21.66666727272727400, 22.22222281818181955, 22.77777836363636510, 23.33333390909091065, 23.88888945454545620, 24.44444500000000176, 25.00000054545454731, 25.55555609090909286, 26.11111163636363841, 26.66666718181818041, 27.22222272727272596, 27.77777827272727151, 28.33333381818181707, 28.88888936363636262, 29.44444490909090817, 30.00000045454545372, 30.55555599999999927, 31.11111154545454482, 31.66666709090909038, 32.22222263636363238, 32.77777818181817793, 33.33333372727272348, 33.88888927272726903, 34.44444481818181458, 35.00000036363636013, 35.55555590909090569, 36.11111145454545124, 36.66666699999999679, 37.22222254545454234, 37.77777809090908789, 38.33333363636363345, 38.88888918181817900, 39.44444472727272455, 40.00000027272727010, 40.55555581818181565, 41.11111136363636120, 41.66666690909090676, 42.22222245454545231, 42.77777799999999786, 43.33333354545454341, 43.88888909090908896, 44.44444463636363452, 45.00000018181818007, 45.55555572727272562, 46.11111127272727117, 46.66666681818181672, 47.22222236363636227, 47.77777790909090783, 48.33333345454545338, 48.88888899999999893, 49.44444454545454448, 50.00000009090909003, 50.55555563636363559, 51.11111118181818114, 51.66666672727272669, 52.22222227272727224, 52.77777781818181779, 53.33333336363635624, 53.88888890909090179, 54.44444445454544734, 55.00000000000000000};
    Tensor<float> k({1});
    k = 15.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{-102.53378721772610049, -16.83134810374150447, -12.60367505282134459, -10.24593157284412115, -8.65377684963432259, -7.48112212381900576, -6.57381016738545210, -5.84960879980690240, -5.25943272940330342, -4.77162093286405042, -4.36455548381542968, -4.02281719417821293, -3.73502110510924190, -3.49252135295851751, -3.28859737097230465, -3.11792153474867462, -2.97619896883173141, -2.85991674276687746, -2.76616486376977733, -2.69250573245077973, -2.63687712244844441, -2.59751885593154874, -2.57291655235669126, -2.56175789149607525, -2.56289819169682431, -2.57533301954243754, -2.59817617477338203, -2.63064183227881543, -2.67202993337159000, -2.72171414173447346, -2.77913184201809216, -2.84377577897657119, -2.91518702445342370, -2.99294902692634324, -3.07668254960849552, -3.16604134249156033, -3.26070842422102203, -3.36039287350933336, -3.46482704852403955, -3.57376416752485326, -3.68697619585424263, -3.80425199387824620, -3.92539568813604944, -4.05022523417546765, -4.17857114462612600, -4.31027536022411084, -4.44519024493151704, -4.58317768913418533, -4.72410830726171760, -4.86786071814569432, -5.01432089808460368, -5.16338159797494178, -5.31494181704282020, -5.46890632670586108, -5.62518523894219236, -5.78369361426558193, -5.94435110502414510, -6.10708163027072537, -6.27181307890986872, -6.43847703822074280, -6.60700854519662428, -6.77734585843774795, -6.94943024859205138, -7.12320580556284710, -7.29861926089899882, -7.47561982395500024, -7.65415903055941982, -7.83419060306304260, -8.01567032075494268, -8.19855589973833077, -8.38280688144931574, -8.56838452908299431, -8.75525173126319345, -8.94337291235630616, -9.13271394888688448, -9.32324209156335115, -9.51492589246812059, -9.70773513700691737, -9.90164078024884020, -10.09661488732155377, -10.29263057755550292, -10.48966197209771067, -10.68768414473970552, -10.88667307572580967, -11.08660560832757014, -11.28745940798798131, -11.48921292385505666, -11.69184535253909019, -11.89533660394102554, -12.09966726901160428, -12.30481858931173633, -12.51077242825477853, -12.71751124392033105, -12.92501806333766368, -13.13327645814444011, -13.34227052153341475, -13.55198484640615675, -13.76240450465882148, -13.97351502753016561, -14.18530238694726009};
    // run Temper chisquare::logpdf
    Tensor<float> result = stats::chisquare::logpdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.logpdf_random_test_dof_16
  * @brief Randomly generated chisquare logpdf test on 100 matrix with dof = 16.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, logpdf_random_test_dof_16)
{
    Tensor<float> x({100});
    x = std::vector<float>{0.00000100000000000, 0.58585957575757586, 1.17171815151515157, 1.75757672727272740, 2.34343530303030345, 2.92929387878787928, 3.51515245454545511, 4.10101103030303094, 4.68686960606060676, 5.27272818181818259, 5.85858675757575842, 6.44444533333333425, 7.03030390909091008, 7.61616248484848590, 8.20202106060606084, 8.78787963636363578, 9.37373821212121250, 9.95959678787878921, 10.54545536363636415, 11.13131393939393909, 11.71717251515151581, 12.30303109090909253, 12.88888966666666747, 13.47474824242424241, 14.06060681818181912, 14.64646539393939584, 15.23232396969697078, 15.81818254545454572, 16.40404112121212421, 16.98989969696970093, 17.57575827272727409, 18.16161684848485081, 18.74747542424242752, 19.33333400000000424, 19.91919257575758095, 20.50505115151515412, 21.09090972727273083, 21.67676830303030755, 22.26262687878788071, 22.84848545454545743, 23.43434403030303415, 24.02020260606061086, 24.60606118181818758, 25.19191975757576074, 25.77777833333333746, 26.36363690909091417, 26.94949548484848734, 27.53535406060606405, 28.12121263636364077, 28.70707121212121748, 29.29292978787879420, 29.87878836363636736, 30.46464693939394408, 31.05050551515152080, 31.63636409090909396, 32.22222266666666712, 32.80808124242424384, 33.39393981818182056, 33.97979839393939727, 34.56565696969697399, 35.15151554545454360, 35.73737412121212031, 36.32323269696969703, 36.90909127272727375, 37.49494984848485046, 38.08080842424242718, 38.66666700000000390, 39.25252557575758061, 39.83838415151515733, 40.42424272727272694, 41.01010130303030365, 41.59595987878788037, 42.18181845454545709, 42.76767703030303380, 43.35353560606061052, 43.93939418181818723, 44.52525275757575685, 45.11111133333333356, 45.69696990909091028, 46.28282848484848699, 46.86868706060606371, 47.45454563636364043, 48.04040421212121714, 48.62626278787879386, 49.21212136363637057, 49.79797993939394019, 50.38383851515151690, 50.96969709090909362, 51.55555566666667033, 52.14141424242424705, 52.72727281818182377, 53.31313139393940048, 53.89898996969697009, 54.48484854545454681, 55.07070712121212352, 55.65656569696970024, 56.24242427272727696, 56.82828284848485367, 57.41414142424243039, 58.00000000000000000};
    Tensor<float> k({1});
    k = 16.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{-110.77891321129489199, -18.10599464296474181, -13.54689964105429922, -11.00157516355386633, -9.28073093995936560, -8.01165596605225794, -7.02833475464910595, -6.24220956821977691, -5.60041932108892926, -5.06886752532127627, -4.62427333635388127, -4.25003147422306871, -3.93388121369167809, -3.66651162444721646, -3.44068517289980935, -3.25066441726648403, -3.09182410696675003, -2.96038108605797401, -2.85320151610377248, -2.76766029002710479, -2.70153654863587089, -2.65293471577690720, -2.62022392007351446, -2.60199089356965541, -2.59700290216229757, -2.60417824831308931, -2.62256256250087372, -2.65130957152006541, -2.68966536600732820, -2.73695542992185192, -2.79257386980451816, -2.85597441076997871, -2.92666282249133847, -3.00419051101750245, -3.08814906749761153, -3.17816560730420061, -3.27389876589886963, -3.37503524343103489, -3.48128681023275721, -3.59238770135098395, -3.70809234099889284, -3.82817334803061815, -3.95241978179458275, -4.08063559441789092, -4.21263826103894257, -4.34825756398780339, -4.48733451060727706, -4.62972036746581228, -4.77527579625599774, -4.92387007879568461, -5.07538042032868209, -5.22969132181981333, -5.38669401320426910, -5.54628594062356495, -5.70837030159208414, -5.87285562281648676, -6.03965537605583602, -6.20868762798201157, -6.37987472049183335, -6.55314297834712800, -6.72842244138646262, -6.90564661887133280, -7.08475226380690426, -7.26567916531956381, -7.44836995738473728, -7.63276994238395101, -7.81882692813236613, -8.00649107716137820, -8.19571476716672009, -8.38645246164395530, -8.57866058983180935, -8.77229743517098370, -8.96732303156389321, -9.16369906678959367, -9.36138879248975542, -9.56035694019640303, -9.76056964292123297, -9.96199436187029264, -10.16459981788711531, -10.36835592726292177, -10.57323374158423945, -10.77920539131699584, -10.98624403285198170, -11.19432379875990691, -11.40341975102543870, -11.61350783704862977, -11.82456484821959108, -12.03656838088778613, -12.24949679956185733, -12.46332920218868168, -12.67804538737226139, -12.89362582340384122, -13.11005161898446758, -13.32730449553022467, -13.54536676095854375, -13.76422128486156993, -13.98385147497940650, -14.20424125489247302, -14.42537504285785843, -14.64723773172004329};
    // run Temper chisquare::logpdf
    Tensor<float> result = stats::chisquare::logpdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.logpdf_random_test_dof_17
  * @brief Randomly generated chisquare logpdf test on 100 matrix with dof = 17.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, logpdf_random_test_dof_17)
{
    Tensor<float> x({100});
    x = std::vector<float>{0.00000100000000000, 0.61616260606060613, 1.23232421212121213, 1.84848581818181823, 2.46464742424242456, 3.08080903030303066, 3.69697063636363676, 4.31313224242424287, 4.92929384848484897, 5.54545545454545508, 6.16161706060606118, 6.77777866666666728, 7.39394027272727339, 8.01010187878787860, 8.62626348484848471, 9.24242509090909081, 9.85858669696969692, 10.47474830303030302, 11.09090990909090912, 11.70707151515151523, 12.32323312121212133, 12.93939472727272744, 13.55555633333333354, 14.17171793939393964, 14.78787954545454575, 15.40404115151515185, 16.02020275757575973, 16.63636436363636406, 17.25252596969697194, 17.86868757575757982, 18.48484918181818415, 19.10101078787878848, 19.71717239393939636, 20.33333400000000424, 20.94949560606060857, 21.56565721212121289, 22.18181881818182077, 22.79798042424242865, 23.41414203030303298, 24.03030363636363731, 24.64646524242424519, 25.26262684848485307, 25.87878845454545740, 26.49495006060606173, 27.11111166666666961, 27.72727327272727749, 28.34343487878788181, 28.95959648484848614, 29.57575809090909402, 30.19191969696970190, 30.80808130303030623, 31.42424290909091056, 32.04040451515151489, 32.65656612121212277, 33.27272772727272354, 33.88888933333333142, 34.50505093939393930, 35.12121254545454718, 35.73737415151515506, 36.35353575757575584, 36.96969736363636372, 37.58585896969697160, 38.20202057575757237, 38.81818218181818025, 39.43434378787878813, 40.05050539393939601, 40.66666700000000390, 41.28282860606060467, 41.89899021212121255, 42.51515181818182043, 43.13131342424242121, 43.74747503030302909, 44.36363663636363697, 44.97979824242424485, 45.59595984848485273, 46.21212145454545350, 46.82828306060606138, 47.44444466666666926, 48.06060627272727004, 48.67676787878787792, 49.29292948484848580, 49.90909109090909368, 50.52525269696970156, 51.14141430303030234, 51.75757590909091022, 52.37373751515151810, 52.98989912121211887, 53.60606072727272675, 54.22222233333333463, 54.83838393939394251, 55.45454554545455039, 56.07070715151515117, 56.68686875757575905, 57.30303036363636693, 57.91919196969696770, 58.53535357575757558, 59.15151518181818346, 59.76767678787879134, 60.38383839393939923, 61.00000000000000000};
    Tensor<float> k({1});
    k = 17.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{-119.05734797679258463, -19.38093244062977760, -14.49041547551875553, -11.75750999642501071, -9.90797627041075479, -8.54248104719082946, -7.48315058000406452, -6.63510157414250834, -5.94169714984833419, -5.36640535451310718, -4.88428242535559498, -4.47753699050918286, -4.13303255833036509, -3.84079313183561943, -3.59306421059284453, -3.38369853543353116, -3.20774048064925843, -3.06113666480677971, -2.94052940381567574, -2.84310608290993372, -2.76648721006552556, -2.70864181080635369, -2.66782252292156308, -2.64251513072620625, -2.63139884766650134, -2.63331471208177526, -2.64724018518882254, -2.67226854568699324, -2.70759203353643230, -2.75248795297252258, -2.80630713242616814, -2.86846427737235032, -2.93842985531359702, -3.01572322986988439, -3.09990682012618102, -3.19058110683577212, -3.28738034227627551, -3.38996884803395560, -3.49803780660532659, -3.61130246982448710, -3.72949972077526581, -3.85238593679981278, -3.97973511005576164, -4.11133718924943636, -4.24699661202797429, -4.38653100231537962, -4.52977001083512398, -4.67655428033823028, -4.82673451978024204, -4.98017067396525448, -5.13673117708237648, -5.29629228016471743, -5.45873744385654724, -5.62395678902323759, -5.79184659871541108, -5.96230886583260222, -6.13525088154480791, -6.31058486014292974, -6.48822759651604564, -6.66810015290861990, -6.85012757200451539, -7.03423861372645653, -7.22036551343684430, -7.40844375948510780, -7.59841188827324565, -7.79021129520980260, -7.98378606009652181, -8.17908278564540048, -8.37605044795881959, -8.57464025792470785, -8.77480553258437546, -8.97650157562412510, -9.17968556622497012, -9.38431645557860783, -9.59035487044383750, -9.79776302317626069, -10.00650462771687010, -10.21654482107202178, -10.42785008985967643, -10.64038820153461096, -10.85412813993943182, -11.06904004485897097, -11.28509515528327078, -11.50226575610942525, -11.72052512803522184, -11.93984750041778220, -12.16020800688928638, -12.38158264353837446, -12.60394822948138760, -12.82728236966134894, -13.05156341972532807, -13.27677045284246127, -13.50288322833524468, -13.72988216200657341, -13.95774829805363915, -14.18646328246798127, -14.41600933782822658, -14.64636923939908009, -14.87752629245593106, -15.10946431076069807};
    // run Temper chisquare::logpdf
    Tensor<float> result = stats::chisquare::logpdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.logpdf_random_test_dof_18
  * @brief Randomly generated chisquare logpdf test on 100 matrix with dof = 18.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, logpdf_random_test_dof_18)
{
    Tensor<float> x({100});
    x = std::vector<float>{0.00000100000000000, 0.64646563636363641, 1.29293027272727268, 1.93939490909090906, 2.58585954545454566, 3.23232418181818204, 3.87878881818181842, 4.52525345454545480, 5.17171809090909118, 5.81818272727272756, 6.46464736363636394, 7.11111200000000032, 7.75757663636363670, 8.40404127272727131, 9.05050590909090857, 9.69697054545454584, 10.34343518181818133, 10.98989981818181683, 11.63636445454545409, 12.28282909090909136, 12.92929372727272685, 13.57575836363636235, 14.22222299999999962, 14.86868763636363688, 15.51515227272727238, 16.16161690909090964, 16.80808154545454514, 17.45454618181818418, 18.10101081818181967, 18.74747545454545516, 19.39394009090909421, 20.04040472727272970, 20.68686936363636519, 21.33333400000000069, 21.97979863636363618, 22.62626327272727522, 23.27272790909091071, 23.91919254545454621, 24.56565718181818525, 25.21212181818182074, 25.85858645454545623, 26.50505109090909173, 27.15151572727272722, 27.79798036363636626, 28.44444500000000176, 29.09090963636363725, 29.73737427272727629, 30.38383890909091178, 31.03030354545454728, 31.67676818181818277, 32.32323281818181471, 32.96969745454545375, 33.61616209090908569, 34.26262672727272474, 34.90909136363636378, 35.55555599999999572, 36.20202063636363476, 36.84848527272727381, 37.49494990909090575, 38.14141454545454479, 38.78787918181818384, 39.43434381818181578, 40.08080845454545482, 40.72727309090908676, 41.37373772727272581, 42.02020236363636485, 42.66666699999999679, 43.31313163636363583, 43.95959627272726777, 44.60606090909090682, 45.25252554545454586, 45.89899018181817780, 46.54545481818181685, 47.19191945454545589, 47.83838409090908783, 48.48484872727272688, 49.13131336363636592, 49.77777799999999786, 50.42424263636363690, 51.07070727272726884, 51.71717190909090789, 52.36363654545454693, 53.01010118181817887, 53.65656581818181792, 54.30303045454544986, 54.94949509090908890, 55.59595972727272795, 56.24242436363635989, 56.88888899999999893, 57.53535363636363797, 58.18181827272726991, 58.82828290909090896, 59.47474754545454800, 60.12121218181817994, 60.76767681818181899, 61.41414145454545093, 62.06060609090908997, 62.70707072727272902, 63.35353536363636096, 64.00000000000000000};
    Tensor<float> k({1});
    k = 18.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{-127.36701249149895432, -20.65604223017529861, -15.43410329137047299, -12.51361680718568081, -10.53539357700280021, -9.07347810342073657, -7.93813837975080627, -7.02816555395734976, -6.28314695212508756, -5.66411515693080947, -5.14446348734999592, -4.70521447959720174, -4.33235587561196933, -4.01524661173241082, -3.74561522067895236, -3.51690462589372554, -3.32382882653747114, -3.16206421568413187, -3.02802926358753144, -2.91872384779135086, -2.83160984343855571, -2.76452087772919963, -2.71559309761758794, -2.68321133968925718, -2.66596676493918405, -2.66262314758396013, -2.67208977957798854, -2.69339949152523506, -2.72569067270910192, -2.76819244764090744, -2.82021236664141117, -2.88112611554575349, -2.95036885968572538, -3.02742792025226404, -3.11183654426604495, -3.20316857786100417, -3.30103389013068149, -3.40507442409812544, -3.51496077442421484, -3.63038920973014978, -3.75107907197034240, -3.87677049697491949, -4.00722240971066501, -4.14221075546309070, -4.28152693438801446, -4.42497641200336478, -4.57237748241324216, -4.72356016455121885, -4.87836521463575057, -5.03664324045716238, -5.19825390514984331, -5.36306520981516766, -5.53095284580645963, -5.70179960871292746, -5.87549486712142421, -6.05193408012433576, -6.23101835830258377, -6.41265406356607581, -6.59675244379613357, -6.78322929871985902, -6.97200467386638945, -7.16300257981967103, -7.35615073429932576, -7.55138032487781441, -7.74862579038371546, -7.94782461925257433, -8.14891716327269933, -8.35184646533670261, -8.55655809995359107, -8.76300002540365597, -8.97112244653079216, -9.18087768726689646, -9.39222007207157006, -9.60510581554915532, -9.81949291957555914, -10.03534107732998493, -10.25261158368268966, -10.47126725144034509, -10.69127233299534296, -10.91259244696599850, -11.13519450945100431, -11.35904666955408970, -11.58411824886453445, -11.81037968460584509, -12.03780247618889376, -12.26635913492788532, -12.49602313669705467, -12.72676887732423268, -12.95857163053345218, -13.19140750826385755, -13.42525342320561776, -13.66008705340574991, -13.89588680880818572, -14.13263179960262761, -14.37030180626604547, -14.60887725118934455, -14.84833917178971063, -15.08866919501608450, -15.32984951316219835, -15.57186286090738747};
    // run Temper chisquare::logpdf
    Tensor<float> result = stats::chisquare::logpdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.logpdf_random_test_dof_19
  * @brief Randomly generated chisquare logpdf test on 100 matrix with dof = 19.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, logpdf_random_test_dof_19)
{
    Tensor<float> x({100});
    x = std::vector<float>{0.00000100000000000, 0.67676866666666669, 1.35353633333333323, 2.03030400000000011, 2.70707166666666676, 3.38383933333333342, 4.06060700000000008, 4.73737466666666673, 5.41414233333333339, 6.09091000000000005, 6.76767766666666670, 7.44444533333333336, 8.12121299999999913, 8.79798066666666578, 9.47474833333333244, 10.15151599999999910, 10.82828366666666575, 11.50505133333333241, 12.18181899999999906, 12.85858666666666572, 13.53535433333333238, 14.21212199999999903, 14.88888966666666569, 15.56565733333333235, 16.24242500000000078, 16.91919266666666744, 17.59596033333333409, 18.27272800000000075, 18.94949566666666740, 19.62626333333333406, 20.30303100000000072, 20.97979866666666737, 21.65656633333333403, 22.33333400000000069, 23.01010166666666734, 23.68686933333333400, 24.36363700000000065, 25.04040466666666731, 25.71717233333333397, 26.39394000000000062, 27.07070766666666728, 27.74747533333333394, 28.42424300000000059, 29.10101066666666725, 29.77777833333333390, 30.45454600000000056, 31.13131366666666722, 31.80808133333333387, 32.48484899999999698, 33.16161666666666008, 33.83838433333333029, 34.51515200000000050, 35.19191966666666360, 35.86868733333332671, 36.54545499999999691, 37.22222266666666712, 37.89899033333333023, 38.57575799999999333, 39.25252566666666354, 39.92929333333333375, 40.60606099999999685, 41.28282866666665996, 41.95959633333333016, 42.63636400000000037, 43.31313166666666348, 43.98989933333332658, 44.66666699999999679, 45.34343466666666700, 46.02020233333333010, 46.69696999999999321, 47.37373766666666342, 48.05050533333333362, 48.72727299999999673, 49.40404066666665983, 50.08080833333333004, 50.75757600000000025, 51.43434366666666335, 52.11111133333332646, 52.78787899999999667, 53.46464666666666687, 54.14141433333332998, 54.81818199999999308, 55.49494966666666329, 56.17171733333333350, 56.84848499999999660, 57.52525266666665971, 58.20202033333332992, 58.87878800000000012, 59.55555566666666323, 60.23232333333332633, 60.90909099999999654, 61.58585866666666675, 62.26262633333332985, 62.93939399999999296, 63.61616166666666317, 64.29292933333333337, 64.96969699999999648, 65.64646466666665958, 66.32323233333332269, 67.00000000000000000};
    Tensor<float> k({1});
    k = 19.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{-135.70607187881307709, -21.93123499794415565, -16.37787407636183445, -13.26980658405809521, -11.16289384819264718, -9.60455812334007319, -8.39320914258140327, -7.42131249642348756, -6.62467971672872125, -5.96190792142306591, -5.40472751121709472, -4.93297493039275636, -4.53176215446347896, -4.18978305308265320, -3.89824919211869059, -3.65019367762103641, -3.44000013361709733, -3.26307472768610651, -3.11561208442464732, -2.99442457368490977, -2.89681543777590633, -2.82048290557311887, -2.76344663319536110, -2.72399050949815091, -2.70061764302480078, -2.69201454386879746, -2.69702233472185604, -2.71461339809230395, -2.74387227258656274, -2.78397990299171383, -2.83420056151818933, -2.89387091436115540, -2.96239082468154713, -3.03921557124113306, -3.12384922899620499, -3.21583900946126278, -3.31477039854569178, -3.42026296070925895, -3.53196670277715263, -3.64955891015760159, -3.77274138367556411, -3.90123801764909572, -4.03479266985408280, -4.17316728215519461, -4.31614021721691010, -4.46350478215103053, -4.61506791444226216, -4.77064900920670354, -4.93007886992570477, -5.09319876737579236, -5.25985959363661593, -5.42992109987779870, -5.60325120816170497, -5.77972538880135289, -5.95922609591982777, -6.14164225480234549, -6.32686879544073832, -6.51480622736390558, -6.70536025144541625, -6.89844140489497804, -7.09396473608700973, -7.29184950626666506, -7.49201891551078347, -7.69439985061485743, -7.89892265283400619, -8.10552090363079358, -8.31413122678009842, -8.52469310535511582, -8.73714871227148748, -8.95144275320185656, -9.16752232079269902, -9.38533675922150579, -9.60483753822645880, -9.82597813582452417, -10.04871392900874838, -10.27300209178190116, -10.49880149994350731, -10.72607264210057210, -10.95477753641988272, -11.18487965268331052, -11.41634383924563068, -11.64913625452944856, -11.88322430272331331, -12.11857657337710137, -12.35516278461480155, -12.59295372970766991, -12.83192122677203173, -13.07203807137488027, -13.31327799184792227, -13.55561560712645885, -13.79902638694372996, -14.04348661422463707, -14.28897334953455456, -14.53546439744999574, -14.78293827472767674, -15.03137418015790772, -15.28075196599639085, -15.53105211087634174, -15.78225569410980356, -16.03434437129353896};
    // run Temper chisquare::logpdf
    Tensor<float> result = stats::chisquare::logpdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.logpdf_random_test_dof_20
  * @brief Randomly generated chisquare logpdf test on 100 matrix with dof = 20.
  *
  * The test is generated from the script, expecting values from numpy
  */
TEST(CHISQUARE, logpdf_random_test_dof_20)
{
    Tensor<float> x({100});
    x = std::vector<float>{0.00000100000000000, 0.70707169696969707, 1.41414239393939400, 2.12121309090909138, 2.82828378787878831, 3.53535448484848525, 4.24242518181818262, 4.94949587878787955, 5.65656657575757649, 6.36363727272727342, 7.07070796969697035, 7.77777866666666728, 8.48484936363636422, 9.19192006060606026, 9.89899075757575808, 10.60606145454545413, 11.31313215151515195, 12.02020284848484977, 12.72727354545454581, 13.43434424242424363, 14.14141493939393968, 14.84848563636363750, 15.55555633333333354, 16.26262703030303314, 16.96969772727273096, 17.67676842424242878, 18.38383912121212305, 19.09090981818182087, 19.79798051515151869, 20.50505121212121651, 21.21212190909091078, 21.91919260606060860, 22.62626330303030642, 23.33333400000000424, 24.04040469696970206, 24.74747539393939633, 25.45454609090909415, 26.16161678787879197, 26.86868748484848979, 27.57575818181818406, 28.28282887878788188, 28.98989957575757970, 29.69697027272727752, 30.40404096969697534, 31.11111166666666961, 31.81818236363636743, 32.52525306060606169, 33.23232375757575596, 33.93939445454545734, 34.64646515151515160, 35.35353584848485298, 36.06060654545454724, 36.76767724242424151, 37.47474793939394289, 38.18181863636363715, 38.88888933333333142, 39.59596003030303280, 40.30303072727272706, 41.01010142424242844, 41.71717212121212270, 42.42424281818181697, 43.13131351515151835, 43.83838421212121261, 44.54545490909091399, 45.25252560606060825, 45.95959630303030252, 46.66666700000000390, 47.37373769696969816, 48.08080839393939954, 48.78787909090909380, 49.49494978787878807, 50.20202048484848945, 50.90909118181818371, 51.61616187878788509, 52.32323257575757935, 53.03030327272727362, 53.73737396969697500, 54.44444466666666926, 55.15151536363636353, 55.85858606060606490, 56.56565675757575917, 57.27272745454546055, 57.97979815151515481, 58.68686884848484908, 59.39393954545455045, 60.10101024242424472, 60.80808093939394610, 61.51515163636364036, 62.22222233333333463, 62.92929303030303601, 63.63636372727273027, 64.34343442424243165, 65.05050512121212591, 65.75757581818182018, 66.46464651515151445, 67.17171721212122293, 67.87878790909091720, 68.58585860606061146, 69.29292930303030573, 70.00000000000000000};
    Tensor<float> k({1});
    k = 20.00000000000000000;
    Tensor<float> expected_result({100});
    expected_result = std::vector<float>{-144.07289480735937559, -23.20644400694166976, -17.32166109466606230, -14.02601259160478264, -11.79041034873746696, -10.13565437182280604, -8.84829613344767196, -7.81447566654835857, -6.96622870870838273, -6.25971691307146916, -5.66500776206443124, -5.16075160802462829, -4.73118466003137161, -4.36433572104778822, -4.05089939008634392, -3.78349895580086670, -3.55618766708328682, -3.36410146601643323, -3.20321113153837889, -3.07014152580879074, -2.96203725830192344, -2.87646115956800319, -2.81131639488983698, -2.76478590539245861, -2.73528474716715042, -2.72142216618398525, -2.72197111587171836, -2.73584353064281505, -2.76207009842652074, -2.79978358428551832, -2.84820498231977570, -2.90663193908434270, -2.97442901556919015, -3.05101944810682202, -3.13587813958907891, -3.22852566691093745, -3.32852313279755752, -3.43546772314536231, -3.54898885694379462, -3.66874483638807991, -3.79441992117365690, -3.92572176410648677, -4.06237915577152808, -4.20414003461256680, -4.35076972580269850, -4.50204937804759187, -4.65777457221253233, -4.81775407959611091, -4.98180875094256681, -5.14977052001460311, -5.32148150783711404, -5.49679321564794154, -5.67556579621848645, -5.85766739458558039, -6.04297355040849471, -6.23136665516528598, -6.42273545825868641, -6.61697461683657284, -6.81398428476474027, -7.01366973673551986, -7.21594102396857284, -7.42071265837027827, -7.62790332237467172, -7.83743560200027378, -8.04923574092875427, -8.26323341364966879, -8.47936151592445952, -8.69755597100690636, -8.91775555021929378, -9.13990170662659196, -9.36393842067785798, -9.58981205679617688, -9.81747122999831134, -10.04686668171385477, -10.27795116405296838, -10.51067933184198111, -10.74500764180973533, -10.98089425836348454, -11.21829896544446825, -11.45718308399811391, -11.69750939463523665, -11.93924206509734631, -12.18234658217224364, -12.42678968773618919, -12.67253931862627425, -12.91956455007080606, -13.16783554242818610, -13.41732349100457355, -13.66800057873937391, -13.91983993156403088, -14.17281557625483757, -14.42690240061457985, -14.68207611583008543, -14.93831322086467139, -15.19559096875481430, -15.45388733469020792, -15.71318098576507083, -15.97345125229690410, -16.23467810061605121, -16.49684210723668798};
    // run Temper chisquare::logpdf
    Tensor<float> result = stats::chisquare::logpdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
    EXPECT_NEAR(result[4], expected_result[4], 0.0001);
    EXPECT_NEAR(result[5], expected_result[5], 0.0001);
    EXPECT_NEAR(result[6], expected_result[6], 0.0001);
    EXPECT_NEAR(result[7], expected_result[7], 0.0001);
    EXPECT_NEAR(result[8], expected_result[8], 0.0001);
    EXPECT_NEAR(result[9], expected_result[9], 0.0001);
    EXPECT_NEAR(result[10], expected_result[10], 0.0001);
    EXPECT_NEAR(result[11], expected_result[11], 0.0001);
    EXPECT_NEAR(result[12], expected_result[12], 0.0001);
    EXPECT_NEAR(result[13], expected_result[13], 0.0001);
    EXPECT_NEAR(result[14], expected_result[14], 0.0001);
    EXPECT_NEAR(result[15], expected_result[15], 0.0001);
    EXPECT_NEAR(result[16], expected_result[16], 0.0001);
    EXPECT_NEAR(result[17], expected_result[17], 0.0001);
    EXPECT_NEAR(result[18], expected_result[18], 0.0001);
    EXPECT_NEAR(result[19], expected_result[19], 0.0001);
    EXPECT_NEAR(result[20], expected_result[20], 0.0001);
    EXPECT_NEAR(result[21], expected_result[21], 0.0001);
    EXPECT_NEAR(result[22], expected_result[22], 0.0001);
    EXPECT_NEAR(result[23], expected_result[23], 0.0001);
    EXPECT_NEAR(result[24], expected_result[24], 0.0001);
    EXPECT_NEAR(result[25], expected_result[25], 0.0001);
    EXPECT_NEAR(result[26], expected_result[26], 0.0001);
    EXPECT_NEAR(result[27], expected_result[27], 0.0001);
    EXPECT_NEAR(result[28], expected_result[28], 0.0001);
    EXPECT_NEAR(result[29], expected_result[29], 0.0001);
    EXPECT_NEAR(result[30], expected_result[30], 0.0001);
    EXPECT_NEAR(result[31], expected_result[31], 0.0001);
    EXPECT_NEAR(result[32], expected_result[32], 0.0001);
    EXPECT_NEAR(result[33], expected_result[33], 0.0001);
    EXPECT_NEAR(result[34], expected_result[34], 0.0001);
    EXPECT_NEAR(result[35], expected_result[35], 0.0001);
    EXPECT_NEAR(result[36], expected_result[36], 0.0001);
    EXPECT_NEAR(result[37], expected_result[37], 0.0001);
    EXPECT_NEAR(result[38], expected_result[38], 0.0001);
    EXPECT_NEAR(result[39], expected_result[39], 0.0001);
    EXPECT_NEAR(result[40], expected_result[40], 0.0001);
    EXPECT_NEAR(result[41], expected_result[41], 0.0001);
    EXPECT_NEAR(result[42], expected_result[42], 0.0001);
    EXPECT_NEAR(result[43], expected_result[43], 0.0001);
    EXPECT_NEAR(result[44], expected_result[44], 0.0001);
    EXPECT_NEAR(result[45], expected_result[45], 0.0001);
    EXPECT_NEAR(result[46], expected_result[46], 0.0001);
    EXPECT_NEAR(result[47], expected_result[47], 0.0001);
    EXPECT_NEAR(result[48], expected_result[48], 0.0001);
    EXPECT_NEAR(result[49], expected_result[49], 0.0001);
    EXPECT_NEAR(result[50], expected_result[50], 0.0001);
    EXPECT_NEAR(result[51], expected_result[51], 0.0001);
    EXPECT_NEAR(result[52], expected_result[52], 0.0001);
    EXPECT_NEAR(result[53], expected_result[53], 0.0001);
    EXPECT_NEAR(result[54], expected_result[54], 0.0001);
    EXPECT_NEAR(result[55], expected_result[55], 0.0001);
    EXPECT_NEAR(result[56], expected_result[56], 0.0001);
    EXPECT_NEAR(result[57], expected_result[57], 0.0001);
    EXPECT_NEAR(result[58], expected_result[58], 0.0001);
    EXPECT_NEAR(result[59], expected_result[59], 0.0001);
    EXPECT_NEAR(result[60], expected_result[60], 0.0001);
    EXPECT_NEAR(result[61], expected_result[61], 0.0001);
    EXPECT_NEAR(result[62], expected_result[62], 0.0001);
    EXPECT_NEAR(result[63], expected_result[63], 0.0001);
    EXPECT_NEAR(result[64], expected_result[64], 0.0001);
    EXPECT_NEAR(result[65], expected_result[65], 0.0001);
    EXPECT_NEAR(result[66], expected_result[66], 0.0001);
    EXPECT_NEAR(result[67], expected_result[67], 0.0001);
    EXPECT_NEAR(result[68], expected_result[68], 0.0001);
    EXPECT_NEAR(result[69], expected_result[69], 0.0001);
    EXPECT_NEAR(result[70], expected_result[70], 0.0001);
    EXPECT_NEAR(result[71], expected_result[71], 0.0001);
    EXPECT_NEAR(result[72], expected_result[72], 0.0001);
    EXPECT_NEAR(result[73], expected_result[73], 0.0001);
    EXPECT_NEAR(result[74], expected_result[74], 0.0001);
    EXPECT_NEAR(result[75], expected_result[75], 0.0001);
    EXPECT_NEAR(result[76], expected_result[76], 0.0001);
    EXPECT_NEAR(result[77], expected_result[77], 0.0001);
    EXPECT_NEAR(result[78], expected_result[78], 0.0001);
    EXPECT_NEAR(result[79], expected_result[79], 0.0001);
    EXPECT_NEAR(result[80], expected_result[80], 0.0001);
    EXPECT_NEAR(result[81], expected_result[81], 0.0001);
    EXPECT_NEAR(result[82], expected_result[82], 0.0001);
    EXPECT_NEAR(result[83], expected_result[83], 0.0001);
    EXPECT_NEAR(result[84], expected_result[84], 0.0001);
    EXPECT_NEAR(result[85], expected_result[85], 0.0001);
    EXPECT_NEAR(result[86], expected_result[86], 0.0001);
    EXPECT_NEAR(result[87], expected_result[87], 0.0001);
    EXPECT_NEAR(result[88], expected_result[88], 0.0001);
    EXPECT_NEAR(result[89], expected_result[89], 0.0001);
    EXPECT_NEAR(result[90], expected_result[90], 0.0001);
    EXPECT_NEAR(result[91], expected_result[91], 0.0001);
    EXPECT_NEAR(result[92], expected_result[92], 0.0001);
    EXPECT_NEAR(result[93], expected_result[93], 0.0001);
    EXPECT_NEAR(result[94], expected_result[94], 0.0001);
    EXPECT_NEAR(result[95], expected_result[95], 0.0001);
    EXPECT_NEAR(result[96], expected_result[96], 0.0001);
    EXPECT_NEAR(result[97], expected_result[97], 0.0001);
    EXPECT_NEAR(result[98], expected_result[98], 0.0001);
    EXPECT_NEAR(result[99], expected_result[99], 0.0001);
}

/**
  * @test CHISQUARE.logpdf_broadcast_x_vector_k_scalar
  * @brief Verify broadcasting: logpdf broadcast x vector k scalar
  */
TEST(CHISQUARE, logpdf_broadcast_x_vector_k_scalar)
{
    Tensor<float> x({4});
    x = std::vector<float>{0.00000100000000000, 0.00000100000000000, 0.50000000000000000, 2.00000000000000000};
    Tensor<float> k({1});
    k = 3.00000000000000000;
    Tensor<float> expected_result({4});
    expected_result = std::vector<float>{-7.82669431218680955, -7.82669431218680955, -1.51551212348464537, -1.57236494292469997};
    Tensor<float> result = stats::chisquare::logpdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[3], expected_result[3], 0.0001);
}

/**
  * @test CHISQUARE.logpdf_broadcast_x_scalar_k_vector
  * @brief Verify broadcasting: logpdf broadcast x scalar k vector
  */
TEST(CHISQUARE, logpdf_broadcast_x_scalar_k_vector)
{
    Tensor<float> x({1});
    x = 1.00000000000000000;
    Tensor<float> k({3});
    k = std::vector<float>{3.00000000000000000, 4.00000000000000000, 2.00000000000000000};
    Tensor<float> expected_result({3});
    expected_result = std::vector<float>{-1.41893853320467267, -1.88629436111989057, -1.19314718055994540};
    Tensor<float> result = stats::chisquare::logpdf(x, k);
    // check values
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
}

/**
  * @test CHISQUARE.logpdf_broadcast_2d_x_k_vector
  * @brief Verify broadcasting: logpdf broadcast 2d x k vector
  */
TEST(CHISQUARE, logpdf_broadcast_2d_x_k_vector)
{
    Tensor<float> x({2,2});
    x = std::vector<float>{0.00000100000000000, 1.00000000000000000, 2.00000000000000000, 3.00000000000000000};
    Tensor<float> k({2});
    k = std::vector<float>{3.00000000000000000, 2.00000000000000000};
    Tensor<float> expected_result({4});
    expected_result = std::vector<float>{-7.82669431218680955, -1.19314718055994540, -1.57236494292469997, -2.19314718055994540};
    Tensor<float> result = stats::chisquare::logpdf(x, k);
    // check values
    EXPECT_NEAR(result[0][0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[0][1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[1][0], expected_result[2], 0.0001);
    EXPECT_NEAR(result[1][1], expected_result[3], 0.0001);
}

/**
  * @test CHISQUARE.logpdf_broadcast_mixed_shapes_all_operands
  * @brief Verify broadcasting: logpdf broadcast mixed shapes all operands
  */
TEST(CHISQUARE, logpdf_broadcast_mixed_shapes_all_operands)
{
    Tensor<float> x({2,1});
    x = std::vector<float>{0.00000100000000000, 1.00000000000000000};
    Tensor<float> k({1,3});
    k = std::vector<float>{2.00000000000000000, 3.00000000000000000, 4.00000000000000000};
    Tensor<float> expected_result({6});
    expected_result = std::vector<float>{-0.69314768055994525, -7.82669431218680955, -15.20180541908416494, -1.19314718055994540, -1.41893853320467267, -1.88629436111989057};
    Tensor<float> result = stats::chisquare::logpdf(x, k);
    // check values
    EXPECT_NEAR(result[0][0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[0][1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[0][2], expected_result[2], 0.0001);
    EXPECT_NEAR(result[1][0], expected_result[3], 0.0001);
    EXPECT_NEAR(result[1][1], expected_result[4], 0.0001);
    EXPECT_NEAR(result[1][2], expected_result[5], 0.0001);
}

/**
  * @test CHISQUARE.logpdf_view_with_weird_strides
  * @brief Ensure chisquare::logpdf accepts non-contiguous/alias views for x and k
  */
TEST(CHISQUARE, logpdf_view_with_weird_strides)
{
    Tensor<float> x_owner({6}, MemoryLocation::DEVICE);
    std::vector<float> x_owner_vals = {
        2.00000000000000000, 99.00000000000000000, 1.00000000000000000, 99.00000000000000000, 5.00000000000000000, 99.00000000000000000
    };
    x_owner = x_owner_vals;

    Tensor<float> x_alias(
        x_owner,
        std::vector<uint64_t>{0ull},
        std::vector<uint64_t>{3ull},
        std::vector<uint64_t>{2ull}
    );

    Tensor<float> k_owner({6}, MemoryLocation::DEVICE);
    std::vector<float> k_owner_vals = {
        1.00000000000000000, 99.00000000000000000, 5.00000000000000000, 99.00000000000000000, 10.00000000000000000, 99.00000000000000000
    };
    k_owner = k_owner_vals;

    Tensor<float> k_alias(
        k_owner,
        std::vector<uint64_t>{0ull},
        std::vector<uint64_t>{3ull},
        std::vector<uint64_t>{2ull}
    );

    Tensor<float> result = stats::chisquare::logpdf(x_alias, k_alias);

    Tensor<float> expected_result({3});
    expected_result = std::vector<float>{-2.26551212348464537, -2.51755082187278223, -2.70603808341127117};

    // compare element-wise (unroll to report precise index on failure)
    EXPECT_NEAR(result[0], expected_result[0], 0.0001);
    EXPECT_NEAR(result[1], expected_result[1], 0.0001);
    EXPECT_NEAR(result[2], expected_result[2], 0.0001);
}
